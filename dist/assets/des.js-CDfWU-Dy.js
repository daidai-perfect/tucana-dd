import{m as k}from"./minimalistic-assert-DDtZfRm3.js";import{i as x}from"./inherits-BlmhoU4v.js";var _={},u={};u.readUInt32BE=function(t,r){var e=t[0+r]<<24|t[1+r]<<16|t[2+r]<<8|t[3+r];return e>>>0};u.writeUInt32BE=function(t,r,e){t[0+e]=r>>>24,t[1+e]=r>>>16&255,t[2+e]=r>>>8&255,t[3+e]=r&255};u.ip=function(t,r,e,n){for(var i=0,p=0,s=6;s>=0;s-=2){for(var a=0;a<=24;a+=8)i<<=1,i|=r>>>a+s&1;for(var a=0;a<=24;a+=8)i<<=1,i|=t>>>a+s&1}for(var s=6;s>=0;s-=2){for(var a=1;a<=25;a+=8)p<<=1,p|=r>>>a+s&1;for(var a=1;a<=25;a+=8)p<<=1,p|=t>>>a+s&1}e[n+0]=i>>>0,e[n+1]=p>>>0};u.rip=function(t,r,e,n){for(var i=0,p=0,s=0;s<4;s++)for(var a=24;a>=0;a-=8)i<<=1,i|=r>>>a+s&1,i<<=1,i|=t>>>a+s&1;for(var s=4;s<8;s++)for(var a=24;a>=0;a-=8)p<<=1,p|=r>>>a+s&1,p<<=1,p|=t>>>a+s&1;e[n+0]=i>>>0,e[n+1]=p>>>0};u.pc1=function(t,r,e,n){for(var i=0,p=0,s=7;s>=5;s--){for(var a=0;a<=24;a+=8)i<<=1,i|=r>>a+s&1;for(var a=0;a<=24;a+=8)i<<=1,i|=t>>a+s&1}for(var a=0;a<=24;a+=8)i<<=1,i|=r>>a+s&1;for(var s=1;s<=3;s++){for(var a=0;a<=24;a+=8)p<<=1,p|=r>>a+s&1;for(var a=0;a<=24;a+=8)p<<=1,p|=t>>a+s&1}for(var a=0;a<=24;a+=8)p<<=1,p|=t>>a+s&1;e[n+0]=i>>>0,e[n+1]=p>>>0};u.r28shl=function(t,r){return t<<r&268435455|t>>>28-r};var b=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];u.pc2=function(t,r,e,n){for(var i=0,p=0,s=b.length>>>1,a=0;a<s;a++)i<<=1,i|=t>>>b[a]&1;for(var a=s;a<b.length;a++)p<<=1,p|=r>>>b[a]&1;e[n+0]=i>>>0,e[n+1]=p>>>0};u.expand=function(t,r,e){var n=0,i=0;n=(t&1)<<5|t>>>27;for(var p=23;p>=15;p-=4)n<<=6,n|=t>>>p&63;for(var p=11;p>=3;p-=4)i|=t>>>p&63,i<<=6;i|=(t&31)<<1|t>>>31,r[e+0]=n>>>0,r[e+1]=i>>>0};var z=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];u.substitute=function(t,r){for(var e=0,n=0;n<4;n++){var i=t>>>18-n*6&63,p=z[n*64+i];e<<=4,e|=p}for(var n=0;n<4;n++){var i=r>>>18-n*6&63,p=z[4*64+n*64+i];e<<=4,e|=p}return e>>>0};var B=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];u.permute=function(t){for(var r=0,e=0;e<B.length;e++)r<<=1,r|=t>>>B[e]&1;return r>>>0};u.padSplit=function(t,r,e){for(var n=t.toString(2);n.length<r;)n="0"+n;for(var i=[],p=0;p<r;p+=e)i.push(n.slice(p,p+e));return i.join(" ")};var A=k;function h(f){this.options=f,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=f.padding!==!1}var w=h;h.prototype._init=function(){};h.prototype.update=function(t){return t.length===0?[]:this.type==="decrypt"?this._updateDecrypt(t):this._updateEncrypt(t)};h.prototype._buffer=function(t,r){for(var e=Math.min(this.buffer.length-this.bufferOff,t.length-r),n=0;n<e;n++)this.buffer[this.bufferOff+n]=t[r+n];return this.bufferOff+=e,e};h.prototype._flushBuffer=function(t,r){return this._update(this.buffer,0,t,r),this.bufferOff=0,this.blockSize};h.prototype._updateEncrypt=function(t){var r=0,e=0,n=(this.bufferOff+t.length)/this.blockSize|0,i=new Array(n*this.blockSize);this.bufferOff!==0&&(r+=this._buffer(t,r),this.bufferOff===this.buffer.length&&(e+=this._flushBuffer(i,e)));for(var p=t.length-(t.length-r)%this.blockSize;r<p;r+=this.blockSize)this._update(t,r,i,e),e+=this.blockSize;for(;r<t.length;r++,this.bufferOff++)this.buffer[this.bufferOff]=t[r];return i};h.prototype._updateDecrypt=function(t){for(var r=0,e=0,n=Math.ceil((this.bufferOff+t.length)/this.blockSize)-1,i=new Array(n*this.blockSize);n>0;n--)r+=this._buffer(t,r),e+=this._flushBuffer(i,e);return r+=this._buffer(t,r),i};h.prototype.final=function(t){var r;t&&(r=this.update(t));var e;return this.type==="encrypt"?e=this._finalEncrypt():e=this._finalDecrypt(),r?r.concat(e):e};h.prototype._pad=function(t,r){if(r===0)return!1;for(;r<t.length;)t[r++]=0;return!0};h.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var t=new Array(this.blockSize);return this._update(this.buffer,0,t,0),t};h.prototype._unpad=function(t){return t};h.prototype._finalDecrypt=function(){A.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var t=new Array(this.blockSize);return this._flushBuffer(t,0),this._unpad(t)};var I=k,O=x,o=u,D=w;function q(){this.tmp=new Array(2),this.keys=null}function c(f){D.call(this,f);var t=new q;this._desState=t,this.deriveKeys(t,f.key)}O(c,D);var C=c;c.create=function(t){return new c(t)};var j=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(t,r){t.keys=new Array(16*2),I.equal(r.length,this.blockSize,"Invalid key length");var e=o.readUInt32BE(r,0),n=o.readUInt32BE(r,4);o.pc1(e,n,t.tmp,0),e=t.tmp[0],n=t.tmp[1];for(var i=0;i<t.keys.length;i+=2){var p=j[i>>>1];e=o.r28shl(e,p),n=o.r28shl(n,p),o.pc2(e,n,t.keys,i)}};c.prototype._update=function(t,r,e,n){var i=this._desState,p=o.readUInt32BE(t,r),s=o.readUInt32BE(t,r+4);o.ip(p,s,i.tmp,0),p=i.tmp[0],s=i.tmp[1],this.type==="encrypt"?this._encrypt(i,p,s,i.tmp,0):this._decrypt(i,p,s,i.tmp,0),p=i.tmp[0],s=i.tmp[1],o.writeUInt32BE(e,p,n),o.writeUInt32BE(e,s,n+4)};c.prototype._pad=function(t,r){if(this.padding===!1)return!1;for(var e=t.length-r,n=r;n<t.length;n++)t[n]=e;return!0};c.prototype._unpad=function(t){if(this.padding===!1)return t;for(var r=t[t.length-1],e=t.length-r;e<t.length;e++)I.equal(t[e],r);return t.slice(0,t.length-r)};c.prototype._encrypt=function(t,r,e,n,i){for(var p=r,s=e,a=0;a<t.keys.length;a+=2){var y=t.keys[a],d=t.keys[a+1];o.expand(s,t.tmp,0),y^=t.tmp[0],d^=t.tmp[1];var S=o.substitute(y,d),m=o.permute(S),E=s;s=(p^m)>>>0,p=E}o.rip(s,p,n,i)};c.prototype._decrypt=function(t,r,e,n,i){for(var p=e,s=r,a=t.keys.length-2;a>=0;a-=2){var y=t.keys[a],d=t.keys[a+1];o.expand(p,t.tmp,0),y^=t.tmp[0],d^=t.tmp[1];var S=o.substitute(y,d),m=o.permute(S),E=p;p=(s^m)>>>0,s=E}o.rip(p,s,n,i)};var U={},K=k,T=x,g={};function M(f){K.equal(f.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=f[t]}function N(f){function t(i){f.call(this,i),this._cbcInit()}T(t,f);for(var r=Object.keys(g),e=0;e<r.length;e++){var n=r[e];t.prototype[n]=g[n]}return t.create=function(p){return new t(p)},t}U.instantiate=N;g._cbcInit=function(){var t=new M(this.options.iv);this._cbcState=t};g._update=function(t,r,e,n){var i=this._cbcState,p=this.constructor.super_.prototype,s=i.iv;if(this.type==="encrypt"){for(var a=0;a<this.blockSize;a++)s[a]^=t[r+a];p._update.call(this,s,0,e,n);for(var a=0;a<this.blockSize;a++)s[a]=e[n+a]}else{p._update.call(this,t,r,e,n);for(var a=0;a<this.blockSize;a++)e[n+a]^=s[a];for(var a=0;a<this.blockSize;a++)s[a]=t[r+a]}};var P=k,V=x,$=w,v=C;function F(f,t){P.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),e=t.slice(8,16),n=t.slice(16,24);f==="encrypt"?this.ciphers=[v.create({type:"encrypt",key:r}),v.create({type:"decrypt",key:e}),v.create({type:"encrypt",key:n})]:this.ciphers=[v.create({type:"decrypt",key:n}),v.create({type:"encrypt",key:e}),v.create({type:"decrypt",key:r})]}function l(f){$.call(this,f);var t=new F(this.type,this.options.key);this._edeState=t}V(l,$);var G=l;l.create=function(t){return new l(t)};l.prototype._update=function(t,r,e,n){var i=this._edeState;i.ciphers[0]._update(t,r,e,n),i.ciphers[1]._update(e,n,e,n),i.ciphers[2]._update(e,n,e,n)};l.prototype._pad=v.prototype._pad;l.prototype._unpad=v.prototype._unpad;_.utils=u;_.Cipher=w;_.DES=C;_.CBC=U;_.EDE=G;export{_ as d};
