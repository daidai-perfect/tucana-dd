import{p as se}from"./process-nextick-args-qzFE9GA4.js";import{s as xe}from"./safe-buffer-B7h8REzA.js";import{b as er}from"./create-hash-B2etqZ4B.js";import{r as rr,p as fe}from"./vite-plugin-node-polyfills-2b3IylRN.js";import{c as oe}from"./@improbable-eng-BU3rlaSz.js";import{e as Oe}from"./events-BYvclee5.js";import{u as re}from"./core-util-is-BRatBjl-.js";import{i as Q}from"./inherits-BlmhoU4v.js";import{u as Pe}from"./util-mxsps8Rg.js";import{b as tr}from"./util-deprecate-DPVjTvyT.js";import{s as We}from"./string_decoder-0MzJkBYb.js";import{b as ir}from"./create-hmac--QaKJlMo.js";import{b as nr}from"./browserify-rsa-CryRCbDk.js";import{r as Ue}from"./elliptic-CmlQxMT_.js";import{b as Ie}from"./bn.js-CjHYPH1W.js";import{p as Fe}from"./parse-asn1-DRtj1sMn.js";const ar={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},fr={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},or={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sr={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},lr={sign:"ecdsa",hash:"sha256",id:""},dr={sign:"ecdsa",hash:"sha224",id:""},ur={sign:"ecdsa",hash:"sha384",id:""},hr={sign:"ecdsa",hash:"sha512",id:""},cr={sign:"dsa",hash:"sha1",id:""},pr={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},gr={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},$e={sha224WithRSAEncryption:ar,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:fr,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:or,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:sr,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:lr,sha224:dr,sha384:ur,sha512:hr,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:cr,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:pr,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:gr,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var $r=$e,Re={exports:{}},vr={}.toString,wr=Array.isArray||function(n){return vr.call(n)=="[object Array]"},Ke=Oe.EventEmitter,Ee={exports:{}};(function(n,l){var h=rr(),p=h.Buffer;function x(v,S){for(var g in v)S[g]=v[g]}p.from&&p.alloc&&p.allocUnsafe&&p.allocUnsafeSlow?n.exports=h:(x(h,l),l.Buffer=_);function _(v,S,g){return p(v,S,g)}x(p,_),_.from=function(v,S,g){if(typeof v=="number")throw new TypeError("Argument must not be a number");return p(v,S,g)},_.alloc=function(v,S,g){if(typeof v!="number")throw new TypeError("Argument must be a number");var m=p(v);return S!==void 0?typeof g=="string"?m.fill(S,g):m.fill(S):m.fill(0),m},_.allocUnsafe=function(v){if(typeof v!="number")throw new TypeError("Argument must be a number");return p(v)},_.allocUnsafeSlow=function(v){if(typeof v!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(v)}})(Ee,Ee.exports);var Me=Ee.exports,we={exports:{}},De;function br(){return De||(De=1,function(n){function l(_,v){if(!(_ instanceof v))throw new TypeError("Cannot call a class as a function")}var h=Me.Buffer,p=Pe;function x(_,v,S){_.copy(v,S)}n.exports=function(){function _(){l(this,_),this.head=null,this.tail=null,this.length=0}return _.prototype.push=function(S){var g={data:S,next:null};this.length>0?this.tail.next=g:this.head=g,this.tail=g,++this.length},_.prototype.unshift=function(S){var g={data:S,next:this.head};this.length===0&&(this.tail=g),this.head=g,++this.length},_.prototype.shift=function(){if(this.length!==0){var S=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,S}},_.prototype.clear=function(){this.head=this.tail=null,this.length=0},_.prototype.join=function(S){if(this.length===0)return"";for(var g=this.head,m=""+g.data;g=g.next;)m+=S+g.data;return m},_.prototype.concat=function(S){if(this.length===0)return h.alloc(0);for(var g=h.allocUnsafe(S>>>0),m=this.head,B=0;m;)x(m.data,g,B),B+=m.data.length,m=m.next;return g},_}(),p&&p.inspect&&p.inspect.custom&&(n.exports.prototype[p.inspect.custom]=function(){var _=p.inspect({length:this.length});return this.constructor.name+" "+_})}(we)),we.exports}var ne=se;function yr(n,l){var h=this,p=this._readableState&&this._readableState.destroyed,x=this._writableState&&this._writableState.destroyed;return p||x?(l?l(n):n&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,ne.nextTick(ae,this,n)):ne.nextTick(ae,this,n)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(n||null,function(_){!l&&_?h._writableState?h._writableState.errorEmitted||(h._writableState.errorEmitted=!0,ne.nextTick(ae,h,_)):ne.nextTick(ae,h,_):l&&l(_)}),this)}function mr(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function ae(n,l){n.emit("error",l)}var Ne={destroy:yr,undestroy:mr},be,Be;function Ve(){if(Be)return be;Be=1;var n=se;be=E;function l(t){var i=this;this.next=null,this.entry=null,this.finish=function(){ue(i,t)}}var h=!fe.browser&&["v0.10","v0.9."].indexOf(fe.version.slice(0,5))>-1?setImmediate:n.nextTick,p;E.WritableState=R;var x=Object.create(re);x.inherits=Q;var _={deprecate:tr},v=Ke,S=Me.Buffer,g=(typeof oe<"u"?oe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function m(t){return S.from(t)}function B(t){return S.isBuffer(t)||t instanceof g}var a=Ne;x.inherits(E,v);function c(){}function R(t,i){p=p||J(),t=t||{};var s=i instanceof p;this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var b=t.highWaterMark,W=t.writableHighWaterMark,j=this.objectMode?16:16*1024;b||b===0?this.highWaterMark=b:s&&(W||W===0)?this.highWaterMark=W:this.highWaterMark=j,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var U=t.decodeStrings===!1;this.decodeStrings=!U,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(I){P(i,I)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}R.prototype.getBuffer=function(){for(var i=this.bufferedRequest,s=[];i;)s.push(i),i=i.next;return s},function(){try{Object.defineProperty(R.prototype,"buffer",{get:_.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var k;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(k=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(t){return k.call(this,t)?!0:this!==E?!1:t&&t._writableState instanceof R}})):k=function(t){return t instanceof this};function E(t){if(p=p||J(),!k.call(E,this)&&!(this instanceof p))return new E(t);this._writableState=new R(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),v.call(this)}E.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function q(t,i){var s=new Error("write after end");t.emit("error",s),n.nextTick(i,s)}function u(t,i,s,b){var W=!0,j=!1;return s===null?j=new TypeError("May not write null values to stream"):typeof s!="string"&&s!==void 0&&!i.objectMode&&(j=new TypeError("Invalid non-string/buffer chunk")),j&&(t.emit("error",j),n.nextTick(b,j),W=!1),W}E.prototype.write=function(t,i,s){var b=this._writableState,W=!1,j=!b.objectMode&&B(t);return j&&!S.isBuffer(t)&&(t=m(t)),typeof i=="function"&&(s=i,i=null),j?i="buffer":i||(i=b.defaultEncoding),typeof s!="function"&&(s=c),b.ended?q(this,s):(j||u(this,b,t,s))&&(b.pendingcb++,W=M(this,b,j,t,i,s)),W},E.prototype.cork=function(){var t=this._writableState;t.corked++},E.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&$(this,t))},E.prototype.setDefaultEncoding=function(i){if(typeof i=="string"&&(i=i.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((i+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+i);return this._writableState.defaultEncoding=i,this};function o(t,i,s){return!t.objectMode&&t.decodeStrings!==!1&&typeof i=="string"&&(i=S.from(i,s)),i}Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function M(t,i,s,b,W,j){if(!s){var U=o(i,b,W);b!==U&&(s=!0,W="buffer",b=U)}var I=i.objectMode?1:b.length;i.length+=I;var N=i.length<i.highWaterMark;if(N||(i.needDrain=!0),i.writing||i.corked){var V=i.lastBufferedRequest;i.lastBufferedRequest={chunk:b,encoding:W,isBuf:s,callback:j,next:null},V?V.next=i.lastBufferedRequest:i.bufferedRequest=i.lastBufferedRequest,i.bufferedRequestCount+=1}else w(t,i,!1,I,b,W,j);return N}function w(t,i,s,b,W,j,U){i.writelen=b,i.writecb=U,i.writing=!0,i.sync=!0,s?t._writev(W,i.onwrite):t._write(W,j,i.onwrite),i.sync=!1}function L(t,i,s,b,W){--i.pendingcb,s?(n.nextTick(W,b),n.nextTick(K,t,i),t._writableState.errorEmitted=!0,t.emit("error",b)):(W(b),t._writableState.errorEmitted=!0,t.emit("error",b),K(t,i))}function C(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function P(t,i){var s=t._writableState,b=s.sync,W=s.writecb;if(C(s),i)L(t,s,b,i,W);else{var j=O(s);!j&&!s.corked&&!s.bufferProcessing&&s.bufferedRequest&&$(t,s),b?h(T,t,s,j,W):T(t,s,j,W)}}function T(t,i,s,b){s||H(t,i),i.pendingcb--,b(),K(t,i)}function H(t,i){i.length===0&&i.needDrain&&(i.needDrain=!1,t.emit("drain"))}function $(t,i){i.bufferProcessing=!0;var s=i.bufferedRequest;if(t._writev&&s&&s.next){var b=i.bufferedRequestCount,W=new Array(b),j=i.corkedRequestsFree;j.entry=s;for(var U=0,I=!0;s;)W[U]=s,s.isBuf||(I=!1),s=s.next,U+=1;W.allBuffers=I,w(t,i,!0,i.length,W,"",j.finish),i.pendingcb++,i.lastBufferedRequest=null,j.next?(i.corkedRequestsFree=j.next,j.next=null):i.corkedRequestsFree=new l(i),i.bufferedRequestCount=0}else{for(;s;){var N=s.chunk,V=s.encoding,e=s.callback,r=i.objectMode?1:N.length;if(w(t,i,!1,r,N,V,e),s=s.next,i.bufferedRequestCount--,i.writing)break}s===null&&(i.lastBufferedRequest=null)}i.bufferedRequest=s,i.bufferProcessing=!1}E.prototype._write=function(t,i,s){s(new Error("_write() is not implemented"))},E.prototype._writev=null,E.prototype.end=function(t,i,s){var b=this._writableState;typeof t=="function"?(s=t,t=null,i=null):typeof i=="function"&&(s=i,i=null),t!=null&&this.write(t,i),b.corked&&(b.corked=1,this.uncork()),b.ending||de(this,b,s)};function O(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function G(t,i){t._final(function(s){i.pendingcb--,s&&t.emit("error",s),i.prefinished=!0,t.emit("prefinish"),K(t,i)})}function te(t,i){!i.prefinished&&!i.finalCalled&&(typeof t._final=="function"?(i.pendingcb++,i.finalCalled=!0,n.nextTick(G,t,i)):(i.prefinished=!0,t.emit("prefinish")))}function K(t,i){var s=O(i);return s&&(te(t,i),i.pendingcb===0&&(i.finished=!0,t.emit("finish"))),s}function de(t,i,s){i.ending=!0,K(t,i),s&&(i.finished?n.nextTick(s):t.once("finish",s)),i.ended=!0,t.writable=!1}function ue(t,i,s){var b=t.entry;for(t.entry=null;b;){var W=b.callback;i.pendingcb--,W(s),b=b.next}i.corkedRequestsFree.next=t}return Object.defineProperty(E.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),E.prototype.destroy=a.destroy,E.prototype._undestroy=a.undestroy,E.prototype._destroy=function(t,i){this.end(),i(t)},be}var ye,je;function J(){if(je)return ye;je=1;var n=se,l=Object.keys||function(a){var c=[];for(var R in a)c.push(R);return c};ye=g;var h=Object.create(re);h.inherits=Q;var p=Ge(),x=Ve();h.inherits(g,p);for(var _=l(x.prototype),v=0;v<_.length;v++){var S=_[v];g.prototype[S]||(g.prototype[S]=x.prototype[S])}function g(a){if(!(this instanceof g))return new g(a);p.call(this,a),x.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",m)}Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function m(){this.allowHalfOpen||this._writableState.ended||n.nextTick(B,this)}function B(a){a.end()}return Object.defineProperty(g.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(a){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=a,this._writableState.destroyed=a)}}),g.prototype._destroy=function(a,c){this.push(null),this.end(),n.nextTick(c,a)},ye}var me,Te;function Ge(){if(Te)return me;Te=1;var n=se;me=o;var l=wr,h;o.ReadableState=u,Oe.EventEmitter;var p=function(e,r){return e.listeners(r).length},x=Ke,_=Me.Buffer,v=(typeof oe<"u"?oe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function S(e){return _.from(e)}function g(e){return _.isBuffer(e)||e instanceof v}var m=Object.create(re);m.inherits=Q;var B=Pe,a=void 0;B&&B.debuglog?a=B.debuglog("stream"):a=function(){};var c=br(),R=Ne,k;m.inherits(o,x);var E=["error","close","destroy","pause","resume"];function q(e,r,f){if(typeof e.prependListener=="function")return e.prependListener(r,f);!e._events||!e._events[r]?e.on(r,f):l(e._events[r])?e._events[r].unshift(f):e._events[r]=[f,e._events[r]]}function u(e,r){h=h||J(),e=e||{};var f=r instanceof h;this.objectMode=!!e.objectMode,f&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var d=e.highWaterMark,D=e.readableHighWaterMark,y=this.objectMode?16:16*1024;d||d===0?this.highWaterMark=d:f&&(D||D===0)?this.highWaterMark=D:this.highWaterMark=y,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(k||(k=We.StringDecoder),this.decoder=new k(e.encoding),this.encoding=e.encoding)}function o(e){if(h=h||J(),!(this instanceof o))return new o(e);this._readableState=new u(e,this),this.readable=!0,e&&(typeof e.read=="function"&&(this._read=e.read),typeof e.destroy=="function"&&(this._destroy=e.destroy)),x.call(this)}Object.defineProperty(o.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),o.prototype.destroy=R.destroy,o.prototype._undestroy=R.undestroy,o.prototype._destroy=function(e,r){this.push(null),r(e)},o.prototype.push=function(e,r){var f=this._readableState,d;return f.objectMode?d=!0:typeof e=="string"&&(r=r||f.defaultEncoding,r!==f.encoding&&(e=_.from(e,r),r=""),d=!0),M(this,e,r,!1,d)},o.prototype.unshift=function(e){return M(this,e,null,!0,!1)};function M(e,r,f,d,D){var y=e._readableState;if(r===null)y.reading=!1,$(e,y);else{var A;D||(A=L(y,r)),A?e.emit("error",A):y.objectMode||r&&r.length>0?(typeof r!="string"&&!y.objectMode&&Object.getPrototypeOf(r)!==_.prototype&&(r=S(r)),d?y.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,y,r,!0):y.ended?e.emit("error",new Error("stream.push() after EOF")):(y.reading=!1,y.decoder&&!f?(r=y.decoder.write(r),y.objectMode||r.length!==0?w(e,y,r,!1):te(e,y)):w(e,y,r,!1))):d||(y.reading=!1)}return C(y)}function w(e,r,f,d){r.flowing&&r.length===0&&!r.sync?(e.emit("data",f),e.read(0)):(r.length+=r.objectMode?1:f.length,d?r.buffer.unshift(f):r.buffer.push(f),r.needReadable&&O(e)),te(e,r)}function L(e,r){var f;return!g(r)&&typeof r!="string"&&r!==void 0&&!e.objectMode&&(f=new TypeError("Invalid non-string/buffer chunk")),f}function C(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}o.prototype.isPaused=function(){return this._readableState.flowing===!1},o.prototype.setEncoding=function(e){return k||(k=We.StringDecoder),this._readableState.decoder=new k(e),this._readableState.encoding=e,this};var P=8388608;function T(e){return e>=P?e=P:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function H(e,r){return e<=0||r.length===0&&r.ended?0:r.objectMode?1:e!==e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=T(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}o.prototype.read=function(e){a("read",e),e=parseInt(e,10);var r=this._readableState,f=e;if(e!==0&&(r.emittedReadable=!1),e===0&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return a("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?I(this):O(this),null;if(e=H(e,r),e===0&&r.ended)return r.length===0&&I(this),null;var d=r.needReadable;a("need readable",d),(r.length===0||r.length-e<r.highWaterMark)&&(d=!0,a("length less than watermark",d)),r.ended||r.reading?(d=!1,a("reading or ended",d)):d&&(a("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=H(f,r)));var D;return e>0?D=b(e,r):D=null,D===null?(r.needReadable=!0,e=0):r.length-=e,r.length===0&&(r.ended||(r.needReadable=!0),f!==e&&r.ended&&I(this)),D!==null&&this.emit("data",D),D};function $(e,r){if(!r.ended){if(r.decoder){var f=r.decoder.end();f&&f.length&&(r.buffer.push(f),r.length+=r.objectMode?1:f.length)}r.ended=!0,O(e)}}function O(e){var r=e._readableState;r.needReadable=!1,r.emittedReadable||(a("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?n.nextTick(G,e):G(e))}function G(e){a("emit readable"),e.emit("readable"),s(e)}function te(e,r){r.readingMore||(r.readingMore=!0,n.nextTick(K,e,r))}function K(e,r){for(var f=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(a("maybeReadMore read 0"),e.read(0),f!==r.length);)f=r.length;r.readingMore=!1}o.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},o.prototype.pipe=function(e,r){var f=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e);break}d.pipesCount+=1,a("pipe count=%d opts=%j",d.pipesCount,r);var D=(!r||r.end!==!1)&&e!==fe.stdout&&e!==fe.stderr,y=D?ie:Y;d.endEmitted?n.nextTick(y):f.once("end",y),e.on("unpipe",A);function A(X,Z){a("onunpipe"),X===f&&Z&&Z.hasUnpiped===!1&&(Z.hasUnpiped=!0,ze())}function ie(){a("onend"),e.end()}var he=de(f);e.on("drain",he);var Ae=!1;function ze(){a("cleanup"),e.removeListener("close",ge),e.removeListener("finish",ve),e.removeListener("drain",he),e.removeListener("error",pe),e.removeListener("unpipe",A),f.removeListener("end",ie),f.removeListener("end",Y),f.removeListener("data",ke),Ae=!0,d.awaitDrain&&(!e._writableState||e._writableState.needDrain)&&he()}var ce=!1;f.on("data",ke);function ke(X){a("ondata"),ce=!1;var Z=e.write(X);Z===!1&&!ce&&((d.pipesCount===1&&d.pipes===e||d.pipesCount>1&&V(d.pipes,e)!==-1)&&!Ae&&(a("false write response, pause",d.awaitDrain),d.awaitDrain++,ce=!0),f.pause())}function pe(X){a("onerror",X),Y(),e.removeListener("error",pe),p(e,"error")===0&&e.emit("error",X)}q(e,"error",pe);function ge(){e.removeListener("finish",ve),Y()}e.once("close",ge);function ve(){a("onfinish"),e.removeListener("close",ge),Y()}e.once("finish",ve);function Y(){a("unpipe"),f.unpipe(e)}return e.emit("pipe",f),d.flowing||(a("pipe resume"),f.resume()),e};function de(e){return function(){var r=e._readableState;a("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&p(e,"data")&&(r.flowing=!0,s(e))}}o.prototype.unpipe=function(e){var r=this._readableState,f={hasUnpiped:!1};if(r.pipesCount===0)return this;if(r.pipesCount===1)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,f),this);if(!e){var d=r.pipes,D=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var y=0;y<D;y++)d[y].emit("unpipe",this,{hasUnpiped:!1});return this}var A=V(r.pipes,e);return A===-1?this:(r.pipes.splice(A,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,f),this)},o.prototype.on=function(e,r){var f=x.prototype.on.call(this,e,r);if(e==="data")this._readableState.flowing!==!1&&this.resume();else if(e==="readable"){var d=this._readableState;!d.endEmitted&&!d.readableListening&&(d.readableListening=d.needReadable=!0,d.emittedReadable=!1,d.reading?d.length&&O(this):n.nextTick(ue,this))}return f},o.prototype.addListener=o.prototype.on;function ue(e){a("readable nexttick read 0"),e.read(0)}o.prototype.resume=function(){var e=this._readableState;return e.flowing||(a("resume"),e.flowing=!0,t(this,e)),this};function t(e,r){r.resumeScheduled||(r.resumeScheduled=!0,n.nextTick(i,e,r))}function i(e,r){r.reading||(a("resume read 0"),e.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,e.emit("resume"),s(e),r.flowing&&!r.reading&&e.read(0)}o.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function s(e){var r=e._readableState;for(a("flow",r.flowing);r.flowing&&e.read()!==null;);}o.prototype.wrap=function(e){var r=this,f=this._readableState,d=!1;e.on("end",function(){if(a("wrapped end"),f.decoder&&!f.ended){var A=f.decoder.end();A&&A.length&&r.push(A)}r.push(null)}),e.on("data",function(A){if(a("wrapped data"),f.decoder&&(A=f.decoder.write(A)),!(f.objectMode&&A==null)&&!(!f.objectMode&&(!A||!A.length))){var ie=r.push(A);ie||(d=!0,e.pause())}});for(var D in e)this[D]===void 0&&typeof e[D]=="function"&&(this[D]=function(A){return function(){return e[A].apply(e,arguments)}}(D));for(var y=0;y<E.length;y++)e.on(E[y],this.emit.bind(this,E[y]));return this._read=function(A){a("wrapped _read",A),d&&(d=!1,e.resume())},this},Object.defineProperty(o.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),o._fromList=b;function b(e,r){if(r.length===0)return null;var f;return r.objectMode?f=r.buffer.shift():!e||e>=r.length?(r.decoder?f=r.buffer.join(""):r.buffer.length===1?f=r.buffer.head.data:f=r.buffer.concat(r.length),r.buffer.clear()):f=W(e,r.buffer,r.decoder),f}function W(e,r,f){var d;return e<r.head.data.length?(d=r.head.data.slice(0,e),r.head.data=r.head.data.slice(e)):e===r.head.data.length?d=r.shift():d=f?j(e,r):U(e,r),d}function j(e,r){var f=r.head,d=1,D=f.data;for(e-=D.length;f=f.next;){var y=f.data,A=e>y.length?y.length:e;if(A===y.length?D+=y:D+=y.slice(0,e),e-=A,e===0){A===y.length?(++d,f.next?r.head=f.next:r.head=r.tail=null):(r.head=f,f.data=y.slice(A));break}++d}return r.length-=d,D}function U(e,r){var f=_.allocUnsafe(e),d=r.head,D=1;for(d.data.copy(f),e-=d.data.length;d=d.next;){var y=d.data,A=e>y.length?y.length:e;if(y.copy(f,f.length-e,0,A),e-=A,e===0){A===y.length?(++D,d.next?r.head=d.next:r.head=r.tail=null):(r.head=d,d.data=y.slice(A));break}++D}return r.length-=D,f}function I(e){var r=e._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,n.nextTick(N,r,e))}function N(e,r){!e.endEmitted&&e.length===0&&(e.endEmitted=!0,r.readable=!1,r.emit("end"))}function V(e,r){for(var f=0,d=e.length;f<d;f++)if(e[f]===r)return f;return-1}return me}var Xe=F,le=J(),Je=Object.create(re);Je.inherits=Q;Je.inherits(F,le);function _r(n,l){var h=this._transformState;h.transforming=!1;var p=h.writecb;if(!p)return this.emit("error",new Error("write callback called multiple times"));h.writechunk=null,h.writecb=null,l!=null&&this.push(l),p(n);var x=this._readableState;x.reading=!1,(x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}function F(n){if(!(this instanceof F))return new F(n);le.call(this,n),this._transformState={afterTransform:_r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.on("prefinish",Sr)}function Sr(){var n=this;typeof this._flush=="function"?this._flush(function(l,h){Ce(n,l,h)}):Ce(this,null,null)}F.prototype.push=function(n,l){return this._transformState.needTransform=!1,le.prototype.push.call(this,n,l)};F.prototype._transform=function(n,l,h){throw new Error("_transform() is not implemented")};F.prototype._write=function(n,l,h){var p=this._transformState;if(p.writecb=h,p.writechunk=n,p.writeencoding=l,!p.transforming){var x=this._readableState;(p.needTransform||x.needReadable||x.length<x.highWaterMark)&&this._read(x.highWaterMark)}};F.prototype._read=function(n){var l=this._transformState;l.writechunk!==null&&l.writecb&&!l.transforming?(l.transforming=!0,this._transform(l.writechunk,l.writeencoding,l.afterTransform)):l.needTransform=!0};F.prototype._destroy=function(n,l){var h=this;le.prototype._destroy.call(this,n,function(p){l(p),h.emit("close")})};function Ce(n,l,h){if(l)return n.emit("error",l);if(h!=null&&n.push(h),n._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(n._transformState.transforming)throw new Error("Calling transform done when still transforming");return n.push(null)}var Rr=ee,Qe=Xe,Ye=Object.create(re);Ye.inherits=Q;Ye.inherits(ee,Qe);function ee(n){if(!(this instanceof ee))return new ee(n);Qe.call(this,n)}ee.prototype._transform=function(n,l,h){h(null,n)};(function(n,l){l=n.exports=Ge(),l.Stream=l,l.Readable=l,l.Writable=Ve(),l.Duplex=J(),l.Transform=Xe,l.PassThrough=Rr})(Re,Re.exports);var Er=Re.exports,z={exports:{}};const Ze={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var qe;function xr(){if(qe)return z.exports;qe=1;var n=xe.Buffer,l=ir,h=nr,p=Ue().ec,x=Ie,_=Fe,v=Ze,S=1;function g(u,o,M,w,L){var C=_(o);if(C.curve){if(w!=="ecdsa"&&w!=="ecdsa/rsa")throw new Error("wrong private key type");return m(u,C)}else if(C.type==="dsa"){if(w!=="dsa")throw new Error("wrong private key type");return B(u,C,M)}if(w!=="rsa"&&w!=="ecdsa/rsa")throw new Error("wrong private key type");if(o.padding!==void 0&&o.padding!==S)throw new Error("illegal or unsupported padding mode");u=n.concat([L,u]);for(var P=C.modulus.byteLength(),T=[0,1];u.length+T.length+1<P;)T.push(255);T.push(0);for(var H=-1;++H<u.length;)T.push(u[H]);var $=h(T,C);return $}function m(u,o){var M=v[o.curve.join(".")];if(!M)throw new Error("unknown curve "+o.curve.join("."));var w=new p(M),L=w.keyFromPrivate(o.privateKey),C=L.sign(u);return n.from(C.toDER())}function B(u,o,M){for(var w=o.params.priv_key,L=o.params.p,C=o.params.q,P=o.params.g,T=new x(0),H,$=R(u,C).mod(C),O=!1,G=c(w,C,u,M);O===!1;)H=E(C,G,M),T=q(P,H,L,C),O=H.invm(C).imul($.add(w.mul(T))).mod(C),O.cmpn(0)===0&&(O=!1,T=new x(0));return a(T,O)}function a(u,o){u=u.toArray(),o=o.toArray(),u[0]&128&&(u=[0].concat(u)),o[0]&128&&(o=[0].concat(o));var M=u.length+o.length+4,w=[48,M,2,u.length];return w=w.concat(u,[2,o.length],o),n.from(w)}function c(u,o,M,w){if(u=n.from(u.toArray()),u.length<o.byteLength()){var L=n.alloc(o.byteLength()-u.length);u=n.concat([L,u])}var C=M.length,P=k(M,o),T=n.alloc(C);T.fill(1);var H=n.alloc(C);return H=l(w,H).update(T).update(n.from([0])).update(u).update(P).digest(),T=l(w,H).update(T).digest(),H=l(w,H).update(T).update(n.from([1])).update(u).update(P).digest(),T=l(w,H).update(T).digest(),{k:H,v:T}}function R(u,o){var M=new x(u),w=(u.length<<3)-o.bitLength();return w>0&&M.ishrn(w),M}function k(u,o){u=R(u,o),u=u.mod(o);var M=n.from(u.toArray());if(M.length<o.byteLength()){var w=n.alloc(o.byteLength()-M.length);M=n.concat([w,M])}return M}function E(u,o,M){var w,L;do{for(w=n.alloc(0);w.length*8<u.bitLength();)o.v=l(M,o.k).update(o.v).digest(),w=n.concat([w,o.v]);L=R(w,u),o.k=l(M,o.k).update(o.v).update(n.from([0])).digest(),o.v=l(M,o.k).update(o.v).digest()}while(L.cmp(u)!==-1);return L}function q(u,o,M,w){return u.toRed(x.mont(M)).redPow(o).fromRed().mod(w)}return z.exports=g,z.exports.getKey=c,z.exports.makeKey=E,z.exports}var _e,He;function Mr(){if(He)return _e;He=1;var n=xe.Buffer,l=Ie,h=Ue().ec,p=Fe,x=Ze;function _(m,B,a,c,R){var k=p(a);if(k.type==="ec"){if(c!=="ecdsa"&&c!=="ecdsa/rsa")throw new Error("wrong public key type");return v(m,B,k)}else if(k.type==="dsa"){if(c!=="dsa")throw new Error("wrong public key type");return S(m,B,k)}if(c!=="rsa"&&c!=="ecdsa/rsa")throw new Error("wrong public key type");B=n.concat([R,B]);for(var E=k.modulus.byteLength(),q=[1],u=0;B.length+q.length+2<E;)q.push(255),u+=1;q.push(0);for(var o=-1;++o<B.length;)q.push(B[o]);q=n.from(q);var M=l.mont(k.modulus);m=new l(m).toRed(M),m=m.redPow(new l(k.publicExponent)),m=n.from(m.fromRed().toArray());var w=u<8?1:0;for(E=Math.min(m.length,q.length),m.length!==q.length&&(w=1),o=-1;++o<E;)w|=m[o]^q[o];return w===0}function v(m,B,a){var c=x[a.data.algorithm.curve.join(".")];if(!c)throw new Error("unknown curve "+a.data.algorithm.curve.join("."));var R=new h(c),k=a.data.subjectPrivateKey.data;return R.verify(B,m,k)}function S(m,B,a){var c=a.data.p,R=a.data.q,k=a.data.g,E=a.data.pub_key,q=p.signature.decode(m,"der"),u=q.s,o=q.r;g(u,R),g(o,R);var M=l.mont(c),w=u.invm(R),L=k.toRed(M).redPow(new l(B).mul(w).mod(R)).fromRed().mul(E.toRed(M).redPow(o.mul(w).mod(R)).fromRed()).mod(c).mod(R);return L.cmp(o)===0}function g(m,B){if(m.cmpn(0)<=0)throw new Error("invalid sig");if(m.cmp(B)>=0)throw new Error("invalid sig")}return _e=_,_e}var Se,Le;function Kr(){if(Le)return Se;Le=1;var n=xe.Buffer,l=er,h=Er,p=Q,x=xr(),_=Mr(),v=$e;Object.keys(v).forEach(function(a){v[a].id=n.from(v[a].id,"hex"),v[a.toLowerCase()]=v[a]});function S(a){h.Writable.call(this);var c=v[a];if(!c)throw new Error("Unknown message digest");this._hashType=c.hash,this._hash=l(c.hash),this._tag=c.id,this._signType=c.sign}p(S,h.Writable),S.prototype._write=function(c,R,k){this._hash.update(c),k()},S.prototype.update=function(c,R){return this._hash.update(typeof c=="string"?n.from(c,R):c),this},S.prototype.sign=function(c,R){this.end();var k=this._hash.digest(),E=x(k,c,this._hashType,this._signType,this._tag);return R?E.toString(R):E};function g(a){h.Writable.call(this);var c=v[a];if(!c)throw new Error("Unknown message digest");this._hash=l(c.hash),this._tag=c.id,this._signType=c.sign}p(g,h.Writable),g.prototype._write=function(c,R,k){this._hash.update(c),k()},g.prototype.update=function(c,R){return this._hash.update(typeof c=="string"?n.from(c,R):c),this},g.prototype.verify=function(c,R,k){var E=typeof R=="string"?n.from(R,k):R;this.end();var q=this._hash.digest();return _(E,q,c,this._signType,this._tag)};function m(a){return new S(a)}function B(a){return new g(a)}return Se={Sign:m,Verify:B,createSign:m,createVerify:B},Se}export{$r as a,Kr as r};
