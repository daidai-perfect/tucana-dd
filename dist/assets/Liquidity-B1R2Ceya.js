import{j as o,E as ho,w as Qe,aH as Ni,aI as ue,m as Bn,aJ as fo,r as _,aK as Or,v as V,aL as Fr,p as me,V as J,F as dt,t as et,R as Ie,N as ge,x as Br,y as Hr,aM as po,z as go,T as F,ar as he,H as I,B as Gs,aN as Pe,aO as Ts,I as zt,f as ke,aP as Hn,K as Ks,aQ as Zs,U as ie,W as Ye,aR as zi,af as qn,S as Ae,aS as jn,A as Xe,aT as Se,aU as ut,aV as sn,au as xo,av as mo,aw as yo,ax as _o,M as vo,a as wo,b as ko,c as bo,d as To,e as So,aW as jo,aD as Co,q as Js,Y as Qs,aX as re,i as Cn,Q as Mt,aY as Vn,aZ as Un,a_ as Ro,a$ as Eo,a6 as Wn,as as qr,_ as Mo,$ as No,a1 as Di,a2 as Ss,a3 as ss,a4 as zo,s as Do,b0 as Lo,aq as Rn,b1 as $o,b2 as Oo,b3 as Fo,b4 as Bo,b5 as Li,b6 as is,b7 as Ho,ag as qo,ah as Vo,ai as Uo,aj as $i,ak as rn,am as Wo,an,b8 as Po,b9 as Yo,ba as oe,bb as Oi,bc as Ao,o as Vr,bd as Fi,be as Bi,bf as Xo,bg as Go,bh as Ko,bi as Zo,bj as Jo,bk as Qo,bl as js,bm as Io,bn as Ur,bo as tc,a9 as Wr,a7 as Pn,bp as Cs,bq as Pr,br as ec,bs as nc,bt as sc,bu as ic,bv as rc,bw as ac,bx as oc,by as cc,bz as lc,bA as uc,Z as dc,X as hc,bB as fc,bC as pc}from"./index-BAe5U5I_.js";import{R as Is,u as gc,P as xc,a as mc}from"./RectangularTab-DKqtwVrG.js";import{B as yc}from"./BarChart-Y1ZGo-Yw.js";import{Y as Yr,X as Ar,A as _c,a as vc}from"./AreaChart-B2MXLoiw.js";import{g as ti,a as wc}from"./apiDataProcessing-D5YcVfO5.js";import{a as $e,b as kc,T as Hi,u as bc}from"./useSearchPools-DpfGX6Tg.js";import{u as Tc,P as Sc}from"./useSelectRange-DMtOtGZ1.js";import{u as jc,a as Cc,b as Rc,P as Ec,c as Mc,d as Nc,e as zc}from"./PositionIncreaseModal-BkeaPPBz.js";import{u as qi}from"./useGetBalance-DaI529vc.js";import{T as Vi}from"./TableCardH5-BPKM8br7.js";import{T as Ui,S as Dc}from"./SlippageSetting-B8ij9vhE.js";import{L as Wi}from"./LockMask-DqQkyiLz.js";import{A as Lc}from"./AprTooltip-82lt8mNw.js";function Xr(){return o.jsx(ho,{h:"120px",children:o.jsx(Qe,{size:"lg"})})}function Pi(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function ei(t,e){this._context=t,this._k=(1-e)/6}ei.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Pi(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Pi(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(s){return new ei(s,e)}return n.tension=function(s){return t(+s)},n})(0);function $c(t,e,n){var s=t._x1,i=t._y1,a=t._x2,r=t._y2;if(t._l01_a>Ni){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);s=(s*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Ni){var d=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,h=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*d+t._x1*t._l23_2a-e*t._l12_2a)/h,r=(r*d+t._y1*t._l23_2a-n*t._l12_2a)/h}t._context.bezierCurveTo(s,i,a,r,t._x2,t._y2)}function Gr(t,e){this._context=t,this._alpha=e}Gr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,s=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+s*s,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:$c(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Kr=function t(e){function n(s){return e?new Gr(s,e):new ei(s,0)}return n.alpha=function(s){return t(+s)},n}(.5);function Oc(t,e){let n,s;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=s=i):(n>i&&(n=i),s<i&&(s=i)));else{let i=-1;for(let a of t)(a=e(a,++i,t))!=null&&(n===void 0?a>=a&&(n=s=a):(n>a&&(n=a),s<a&&(s=a)))}return[n,s]}var Yi=180/Math.PI,Rs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zr(t,e,n,s,i,a){var r,u,c;return(r=Math.sqrt(t*t+e*e))&&(t/=r,e/=r),(c=t*n+e*s)&&(n-=t*c,s-=e*c),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,c/=u),t*s<e*n&&(t=-t,e=-e,c=-c,r=-r),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Yi,skewX:Math.atan(c)*Yi,scaleX:r,scaleY:u}}var on;function Fc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Rs:Zr(e.a,e.b,e.c,e.d,e.e,e.f)}function Bc(t){return t==null||(on||(on=document.createElementNS("http://www.w3.org/2000/svg","g")),on.setAttribute("transform",t),!(t=on.transform.baseVal.consolidate()))?Rs:(t=t.matrix,Zr(t.a,t.b,t.c,t.d,t.e,t.f))}function Jr(t,e,n,s){function i(d){return d.length?d.pop()+" ":""}function a(d,h,l,p,f,w){if(d!==l||h!==p){var b=f.push("translate(",null,e,null,n);w.push({i:b-4,x:ue(d,l)},{i:b-2,x:ue(h,p)})}else(l||p)&&f.push("translate("+l+e+p+n)}function r(d,h,l,p){d!==h?(d-h>180?h+=360:h-d>180&&(d+=360),p.push({i:l.push(i(l)+"rotate(",null,s)-2,x:ue(d,h)})):h&&l.push(i(l)+"rotate("+h+s)}function u(d,h,l,p){d!==h?p.push({i:l.push(i(l)+"skewX(",null,s)-2,x:ue(d,h)}):h&&l.push(i(l)+"skewX("+h+s)}function c(d,h,l,p,f,w){if(d!==l||h!==p){var b=f.push(i(f)+"scale(",null,",",null,")");w.push({i:b-4,x:ue(d,l)},{i:b-2,x:ue(h,p)})}else(l!==1||p!==1)&&f.push(i(f)+"scale("+l+","+p+")")}return function(d,h){var l=[],p=[];return d=t(d),h=t(h),a(d.translateX,d.translateY,h.translateX,h.translateY,l,p),r(d.rotate,h.rotate,l,p),u(d.skewX,h.skewX,l,p),c(d.scaleX,d.scaleY,h.scaleX,h.scaleY,l,p),d=h=null,function(f){for(var w=-1,b=p.length,g;++w<b;)l[(g=p[w]).i]=g.x(f);return l.join("")}}}var Hc=Jr(Fc,"px, ","px)","deg)"),qc=Jr(Bc,", ",")",")"),Vc=1e-12;function Ai(t){return((t=Math.exp(t))+1/t)/2}function Uc(t){return((t=Math.exp(t))-1/t)/2}function Wc(t){return((t=Math.exp(2*t))-1)/(t+1)}const Pc=function t(e,n,s){function i(a,r){var u=a[0],c=a[1],d=a[2],h=r[0],l=r[1],p=r[2],f=h-u,w=l-c,b=f*f+w*w,g,m;if(b<Vc)m=Math.log(p/d)/e,g=function(N){return[u+N*f,c+N*w,d*Math.exp(e*N*m)]};else{var S=Math.sqrt(b),T=(p*p-d*d+s*b)/(2*d*n*S),j=(p*p-d*d-s*b)/(2*p*n*S),R=Math.log(Math.sqrt(T*T+1)-T),M=Math.log(Math.sqrt(j*j+1)-j);m=(M-R)/e,g=function(N){var C=N*m,L=Ai(R),O=d/(n*S)*(L*Wc(e*C+R)-Uc(R));return[u+O*f,c+O*w,d*L/Ai(e*C+R)]}}return g.duration=m*1e3*e/Math.SQRT2,g}return i.rho=function(a){var r=Math.max(.001,+a),u=r*r,c=u*u;return t(r,u,c)},i}(Math.SQRT2,2,4);function Qr(){const t=Bn(fo),[e,n]=_.useState([]),[s,i]=_.useState(!0);return{loading:s,dataList:e,getHistogramData:async r=>{i(!0);try{const u=new URLSearchParams;u.append("date_type",String(r.date_type)),u.append("histogram_type",String(r.histogram_type)),u.append("limit",String(r.limit)),r.pool_address&&u.append("id",String(r.pool_address));const d=await(await fetch(`${t}?${u.toString()}`)).json();console.log("getHistogramData: ",d);const h=[];d&&d.data&&d.data.list&&d.data.list.forEach(l=>{h.push({name:"Page A",time:l.date,uv:0,pv:l.num,amt:0})}),console.log("getHistogramData list: ",h),n(h),i(!1)}catch(u){console.log(u,"getHistogramData"),i(!1)}}}}const Yc=Or(t=>({displayToken0Value:"",displayToken1Value:"",addToken0:void 0,addToken1:void 0,currentFeeTier:"",currentApiPoolInfo:null,currentContractPoolInfo:null,currentPrice:"",inversePrice:"",baseCoin:"",currentApiPoolInfoIsLoading:!0,currentContractPoolInfoIsLoading:!0,priceRangePercentage:0,defaultPriceRangePercentage:0,minPriceData:void 0,maxPriceData:void 0,precomputationInfo:void 0,ratio:{},submitIsLoading:!1,setSubmitIsLoading:e=>{t(()=>({submitIsLoading:e}))},setRatio:e=>{t(()=>({ratio:e}))},setDisplayToken0Value:e=>{t(()=>({displayToken0Value:e}))},setDisplayToken1Value:e=>{t(()=>({displayToken1Value:e}))},setAddToken0:e=>{t(()=>({addToken0:e}))},setAddToken1:e=>{t(()=>({addToken1:e}))},setCurrentFeeTier:e=>{const n=Fr(e);t(()=>({currentFeeTier:e,priceRangePercentage:n,defaultPriceRangePercentage:n}))},setCurrentApiPoolInfo:e=>{t(()=>({currentApiPoolInfo:e}))},setCurrentContractPoolInfo:e=>{t(()=>({currentContractPoolInfo:e}))},setCurrentPrice:e=>{t(()=>({currentPrice:e,inversePrice:V(1).div(e).toString()}))},setBaseCoin:e=>{t(()=>({baseCoin:e}))},setCurrentApiPoolInfoIsLoading:e=>{t(()=>({currentApiPoolInfoIsLoading:e}))},setCurrentContractPoolInfoIsLoading:e=>{t(()=>({currentContractPoolInfoIsLoading:e}))},setPriceRangePercentage:e=>{t(()=>({priceRangePercentage:e}))},saveMinPriceData:e=>{t(()=>({minPriceData:e}))},saveMaxPriceData:e=>{t(()=>({maxPriceData:e}))},setPrecomputationInfo:e=>{t(()=>({precomputationInfo:e}))},currentPoolPositions:[],setCurrentPoolPositions:e=>{t(()=>({currentPoolPositions:e}))},currentPoolPositionsIsLoading:!0,setCurrentPoolPositionsIsLoading:e=>{t(()=>({currentPoolPositionsIsLoading:e}))},isShowMinMaxDist:!1,setIsShowMinMaxDist:e=>{t(()=>({isShowMinMaxDist:e}))},minDistPercentange:"",maxDistPercentange:"",setMinDistPercentange:e=>{t(()=>({minDistPercentange:e}))},setMaxDistPercentange:e=>{t(()=>({maxDistPercentange:e}))},rangeChartType:"Liquidity",setRangeChartType:e=>{t(()=>({rangeChartType:e}))},resetLiquidityState:()=>{t(()=>({displayToken0Value:"",displayToken1Value:"",addToken0:void 0,addToken1:void 0,currentApiPoolInfo:null,currentContractPoolInfo:null,currentPrice:"",inversePrice:"",baseCoin:"",currentApiPoolInfoIsLoading:!0,currentContractPoolInfoIsLoading:!0,minPrice:"",maxPrice:"",lowerTick:"",upperTick:"",priceRangePercentage:0,defaultPriceRangePercentage:0,minPriceData:void 0,maxPriceData:void 0,precomputationInfo:void 0,ratio:{},submitIsLoading:!1,currentPoolPositionsIsLoading:!0,currentPoolPositions:[],isShowMinMaxDist:!1,rangeChartType:"Liquidity"}))}})),Rt=Yc,Ir=t=>{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=t.getUTCFullYear(),s=e[t.getUTCMonth()],i=t.getUTCDate();return`${s} ${i}, ${n} (UTC)`};function Ac(){const{currentApiPoolInfo:t}=Rt(),[e,n]=_.useState("Volume"),[s,i]=_.useState("1D"),a=_.useMemo(()=>{if(t)return console.log({radioValue:s,currentTab:e}),{date_type:s=="1D"?"day":s=="7D"?"week":"month",histogram_type:e==="Volume"?"vol":"pure_tvl",limit:s=="1D"?40:s=="7D"?30:20,pool_address:t.address}},[t,s,e]),r=d=>{console.log("handleRadioChange value: ",d),i(d)},u=()=>o.jsx(dt,{h:"20px",children:o.jsx(Ie,{options:["1D","7D","30D"],size:"s",value:s,onChange:r})}),{windowWidth:c}=me();return o.jsxs(J,{w:"100%",align:"flex-start",gap:"0",borderRadius:"12px",children:[o.jsxs(dt,{w:"100%",align:"center",justify:"space-between",children:[o.jsx(et,{children:o.jsx(Is,{w:"90px",h:"28px",p:"4px",borderRadius:"4px",currentTab:e,textList:["Volume","Liquidity"],onClick:d=>{n(d)}})}),c>810&&u()]}),e==="Volume"&&o.jsx(Xc,{requestParams:a,RadioCardGroupNode:u()}),e==="Liquidity"&&o.jsx(Gc,{requestParams:a,RadioCardGroupNode:u()})]})}function ta(t){const{windowWidth:e}=me(),{label:n,value:s,time:i,RadioCardGroupNode:a}=t;return o.jsxs(et,{children:[o.jsx(dt,{w:"100%",justify:"space-between",mt:"12px",children:o.jsxs(J,{gap:"0",align:"flex-start",children:[o.jsx(F,{fontSize:"xs",children:n}),o.jsx(F,{fontSize:"2xl",color:"text_caption",children:he(s,2)})]})}),o.jsx(F,{w:"100%",mb:"12px",fontSize:"xs",children:i}),e<=810&&o.jsx(et,{mb:"20px",children:a})]})}function Xc(t){const{requestParams:e,RadioCardGroupNode:n}=t,{loading:s,dataList:i,getHistogramData:a}=Qr(),r=_.useMemo(()=>i.slice().reverse(),[i]);_.useEffect(()=>{e&&a(e)},[e]);const[u,c]=_.useState(null),d=w=>{if(w&&w.activePayload&&w.activePayload.length){const b=w.activePayload[0];c(b.payload)}},h=()=>{},l=_.useMemo(()=>u?Ir(new Date(u.time)):"",[u]);_.useEffect(()=>{r.length>0?c(r[0]):c(null)},[r]);const p=(r==null?void 0:r.length)>0?Math.floor(Math.min(...r.map(w=>w.pv))):0,f=Math.ceil(Math.max(...r.map(w=>w.pv)));return o.jsxs(et,{width:"100%",children:[o.jsx(ta,{label:"Trading Volume (24H)",value:(u==null?void 0:u.pv)||"0",time:l,RadioCardGroupNode:n}),s?o.jsx(J,{p:"20px 0px 70px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(Qe,{})}):(r==null?void 0:r.length)==0?o.jsx(J,{p:"40px 0px 50px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(ge,{type:"nodata",noBg:!0,text:"No token data yet"})}):o.jsx(Br,{width:"100%",height:200,children:o.jsxs(yc,{data:r,barSize:5,barCategoryGap:120,onMouseEnter:d,onMouseMove:d,onMouseLeave:h,margin:{top:8,right:8,left:8,bottom:0},children:[o.jsx(Hr,{cursor:{stroke:"var(--chakra-colors-primary)",strokeWidth:10,strokeDasharray:"3 2"},content:o.jsx(na,{type:"Volume"})}),o.jsx(po,{dataKey:"pv",fill:"var(--chakra-colors-primary)",className:"custom-bar"}),o.jsx(Yr,{domain:[p,f],hide:!0}),o.jsx(Ar,{scale:"point",dataKey:"time",reversed:!0,tickLine:!1,tick:ea,interval:(r==null?void 0:r.length)<10?0:parseInt(String((r==null?void 0:r.length)/6))}),u&&o.jsx(go,{x:u.time,stroke:"var(--chakra-colors-chart_tooltip_line)",strokeDasharray:"3 3"})]})})]})}function Gc(t){const{requestParams:e,RadioCardGroupNode:n}=t,{loading:s,dataList:i,getHistogramData:a}=Qr(),r=_.useMemo(()=>i.reverse(),[i]),u=(r==null?void 0:r.length)>0?Math.floor(Math.min(...r.map(w=>w.pv))):0,c=Math.ceil(Math.max(...r.map(w=>w.pv)));_.useEffect(()=>{e&&a(e)},[e]);const[d,h]=_.useState(null),l=w=>{if(w&&w.activePayload&&w.activePayload.length){const b=w.activePayload[0];h(b.payload)}},p=()=>{},f=_.useMemo(()=>d?Ir(new Date(d.time)):"",[d]);return _.useEffect(()=>{r.length>0?h(r[0]):h(null)},[r]),o.jsxs(et,{width:"100%",children:[o.jsx(ta,{label:"Liquidity",value:(d==null?void 0:d.pv)||"0",time:f,RadioCardGroupNode:n}),s?o.jsx(J,{p:"20px 0px 70px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(Qe,{})}):(r==null?void 0:r.length)==0?o.jsx(J,{p:"40px 0px 50px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(ge,{type:"nodata",noBg:!0,text:"No token data yet"})}):o.jsx(Br,{width:"100%",height:200,children:o.jsxs(_c,{data:r,syncId:"Liquidity",onMouseEnter:l,onMouseMove:l,onMouseLeave:p,margin:{top:8,right:8,left:8,bottom:0},children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-primary)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-primary)",stopOpacity:0})]}),o.jsxs("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-primary)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-primary)",stopOpacity:0})]})]}),o.jsx(Ar,{dataKey:"time",reversed:!0,tickLine:!1,tick:ea,interval:(r==null?void 0:r.length)<10?0:parseInt(String((r==null?void 0:r.length)/6))}),o.jsx(Yr,{domain:[u,c],hide:!0}),o.jsx(Hr,{cursor:{stroke:"var(--chakra-colors-primary)",strokeWidth:1,strokeDasharray:"3 2"},content:o.jsx(na,{type:"Liquidity"})}),o.jsx(vc,{type:"monotone",dataKey:"pv",stroke:"var(--chakra-colors-primary)",fill:"url(#colorUv)"})]})})]})}const ea=t=>{const{x:e,y:n,payload:s,type:i}=t,a=new Date(s.value);["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][a.getUTCDay()];const u=Number(a.getUTCDate())>=10?`${a.getUTCDate()}`:`0${a.getUTCDate()}`;return o.jsx("g",{transform:`translate(${e},${n})`,children:o.jsx("text",{x:0,y:0,dy:i=="totalValue"?12:18,textAnchor:"middle",fill:"var(--chakra-colors-text_paragraph)",fontSize:12,children:u})})},na=t=>null;function Kc(){const{currentApiPoolInfo:t,currentFeeTier:e}=Rt(),{getExplorerUrl:n}=Hn(),{windowWidth:s}=me();return o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(F,{children:"Pool Info"}),o.jsxs(I,{justify:"space-between",h:"80px",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"8px",p:"12px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",h:"unset"}},children:[o.jsxs(dt,{w:"100%",align:"center",justify:"space-between",flexDirection:"column",sx:{"@media screen and (max-width: 810px)":{flexDirection:"row"}},children:[o.jsx(F,{fontSize:"xs",children:"Pool Address"}),o.jsxs(dt,{alignItems:"center",children:[o.jsx(Gs,{variant:"link",fontSize:"12px",children:Pe(t==null?void 0:t.address)}),o.jsx(et,{m:"0 4px",children:o.jsx(Ts,{text:t==null?void 0:t.address})}),o.jsx(zt,{xlinkHref:"#icon-icon_lead",cursor:"pointer",transform:"rotate(-45deg)",onClick:()=>{window.open(n(t==null?void 0:t.address),"_blank")}})]})]}),o.jsx(ke,{text:"Tick Spacing",textFontSize:"12px",valueFontSize:"12px",value:t==null?void 0:t.tickSpacing,isColumn:!(s<=810)}),o.jsx(ke,{text:"Fee Tier",textFontSize:"12px",valueFontSize:"12px",value:ti(e),isColumn:!(s<=810)})]})]})}function Zc(t,e,n){const{tucanaSpotSDK:s}=Ks(),[i,a]=_.useState(["0","0"]),[r,u]=_.useState(["0","0"]),{getCointAmountValue:c}=Zs(),d=_.useMemo(()=>c(i[0],e==null?void 0:e.metadata,2,!0),[i[0]]),h=_.useMemo(()=>c(i[1],n==null?void 0:n.metadata,2,!0),[i[1]]);return _.useEffect(()=>{t&&e&&n?s.Pool.getPoolTokenAmounts(t).then(l=>{console.log("------------------",l,n,e),a([ie(new Ye(l[0]),e.decimals).toString(),ie(new Ye(l[1]),n.decimals).toString()])}):a(["0","0"])},[t]),_.useEffect(()=>{try{if(t&&e&&n){const l=V(d).add(h);if(l.eq("0"))u(["--","--"]);else{const p=V(d).div(l).mul(100),f=V(100).sub(p);p.lessThanOrEqualTo(.01)?u(["<0.01","99.99"]):f.lessThanOrEqualTo(.01)?u(["99.99","<0.01"]):u([p.toFixed(2,zi.ROUND_DOWN),f.toFixed(2,zi.ROUND_UP)])}}else u(["--","--"])}catch{u(["--","--"])}},[d,h]),{tokenAmounts:i,tokenRatios:r,amount0Rate:d,amount1Rate:h}}function Jc(){var c,d,h,l,p,f,w,b,g,m,S,T;const{getExplorerUrl:t}=Hn(),{currentApiPoolInfo:e}=Rt(),{tokenAmounts:n,tokenRatios:s,amount0Rate:i,amount1Rate:a}=Zc(e==null?void 0:e.address,e==null?void 0:e.token0,e==null?void 0:e.token1),{isImportToken:r}=qn(),u=(e==null?void 0:e.isReverse)||!1;return o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(F,{children:"Pool Composition"}),o.jsxs(I,{justify:"space-between",w:"100%",h:"132px",align:"center",border:"1px solid",borderColor:"border",borderRadius:"8px",p:"12px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",h:"unset"}},children:[o.jsxs(J,{w:"50%",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[o.jsxs(I,{w:"100%",align:"center",justify:"space-between",children:[o.jsxs(I,{gap:"4px",children:[o.jsx(et,{children:o.jsx(Ae,{imageUrl:(c=e==null?void 0:e.displayToken0)==null?void 0:c.image,w:"20px",h:"20px",showTag:r((d=e==null?void 0:e.displayToken0)==null?void 0:d.metadata),showTagWidth:"12px",showTagHeight:"12px"})}),o.jsx(F,{fontSize:"xs",children:(h=e==null?void 0:e.displayToken0)==null?void 0:h.symbol})]}),o.jsxs(I,{alignItems:"center",children:[o.jsx(jn,{href:t((l=e==null?void 0:e.displayToken0)==null?void 0:l.metadata,"accounts"),fontSize:"xs",target:"_blank",children:Pe((p=e==null?void 0:e.displayToken0)==null?void 0:p.metadata)}),o.jsx(Ts,{text:((f=e==null?void 0:e.displayToken0)==null?void 0:f.metadata)||""})]})]}),o.jsx(F,{}),o.jsx(ke,{text:"Amount",textFontSize:"12px",valueFontSize:"12px",value:Xe(n[u?1:0]).toString()}),o.jsx(F,{w:"100%",align:"right",fontSize:"xs",mt:"-12px",children:`${he(u?a:i,2)}`}),o.jsx(ke,{text:"Token Ratio",textFontSize:"12px",valueFontSize:"12px",value:`${s[u?1:0]}%`})]}),o.jsx(et,{w:"1px",h:"92px",bg:"border",m:"0 24px",sx:{"@media screen and (max-width: 810px)":{w:"100%",h:"1px",m:"12px 24px"}}}),o.jsxs(J,{w:"50%",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[o.jsxs(I,{w:"100%",align:"center",justify:"space-between",children:[o.jsxs(I,{gap:"4px",children:[o.jsx(et,{children:o.jsx(Ae,{imageUrl:(w=e==null?void 0:e.displayToken1)==null?void 0:w.image,w:"20px",h:"20px",showTag:r((b=e==null?void 0:e.displayToken1)==null?void 0:b.metadata),showTagWidth:"12px",showTagHeight:"12px"})}),o.jsx(F,{fontSize:"xs",children:(g=e==null?void 0:e.displayToken1)==null?void 0:g.symbol})]}),o.jsxs(I,{alignItems:"center",children:[o.jsx(jn,{href:t((m=e==null?void 0:e.displayToken1)==null?void 0:m.metadata,"accounts"),fontSize:"xs",target:"_blank",children:Pe((S=e==null?void 0:e.displayToken1)==null?void 0:S.metadata)}),o.jsx(Ts,{text:((T=e==null?void 0:e.displayToken1)==null?void 0:T.metadata)||"0"})]})]}),o.jsx(F,{}),o.jsx(ke,{text:"Amount",textFontSize:"12px",valueFontSize:"12px",value:Xe(n[u?0:1]).toString()}),o.jsx(F,{w:"100%",align:"right",fontSize:"xs",mt:"-12px",children:`${he(u?i:a,2)}`}),o.jsx(ke,{text:"Token Ratio",textFontSize:"12px",valueFontSize:"12px",value:`${s[u?0:1]}%`})]})]})]})}function Qc(){const{currentApiPoolInfo:t}=Rt(),{getCointAmountValue:e}=Zs(),n=_.useMemo(()=>{var i;if(t){const a=(i=t==null?void 0:t.rewarderApr)==null?void 0:i.reduce((r,u)=>V(r).add(u.apr).toNumber(),0);return Se(V(a).mul(100).toNumber(),2)}return 0},[t]),s=_.useMemo(()=>{var a;const i=[];return(a=t==null?void 0:t.rewarderUSD)==null||a.forEach(r=>{if(V(r==null?void 0:r.amountSecond).gt(0)){const u=wc(r==null?void 0:r.amountSecond),c=e(u,r.metadata);i.push({...r,dayAmount:u,dayAmountRate:c})}}),i},[t]);return o.jsxs(J,{w:"100%",p:"16px",justifyContent:"center",gap:"24px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(J,{w:"100%",gap:"24px",children:[o.jsx(Kc,{}),o.jsx(Jc,{})]}),o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(Ac,{}),(s==null?void 0:s.length)>0&&o.jsxs(et,{w:"100%",mt:"8px",children:[o.jsx(F,{children:"Rewards"}),o.jsxs(I,{p:"20px",m:"12px 0",gap:"36px",align:"center",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"8px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",gap:"16px"}},children:[o.jsxs(dt,{children:[o.jsx(F,{mr:"8px",fontSize:"md",children:"APR"}),o.jsxs(F,{color:"primary",fontSize:"md",children:[n,"%"]})]}),o.jsx(J,{align:"flex-start",children:s==null?void 0:s.map(i=>o.jsxs(I,{gap:"4px",children:[o.jsx(et,{children:o.jsx(Ae,{imageUrl:i==null?void 0:i.image,w:"20px",h:"20px"})}),o.jsxs(F,{fontSize:"xs",color:"text_caption",display:"inline-block",children:[i==null?void 0:i.dayAmount,o.jsxs(F,{fontSize:"xs",display:"inline-block",children:["Â ($",i==null?void 0:i.dayAmountRate,")Â "]}),i==null?void 0:i.symbol," per day"]})]}))})]})]})]})]})}function Ic(t){const{w:e,current:n,feeTierDistribution:s,feeTierDistributionLoading:i,onClick:a}=t,[r,u]=_.useState(!1),c=()=>{u(!0)},d=()=>{u(!1)},h=_.useMemo(()=>[{title:(s==null?void 0:s[ut.LOWEST])!==-1?`${sn(s==null?void 0:s[ut.LOWEST],2)}% seclect`:"Not created",content:"Best for very stable pairs",percent:"0.01%",canCreate:(s==null?void 0:s[ut.LOWEST])===-1,value:ut.LOWEST},{title:(s==null?void 0:s[ut.LOW])!==-1?`${sn(s==null?void 0:s[ut.LOW],2)}% seclect`:"Not created",content:"Best for stable pairs",percent:"0.05%",canCreate:(s==null?void 0:s[ut.LOW])===-1,value:ut.LOW},{title:(s==null?void 0:s[ut.MEDIUM])!==-1?`${sn(s==null?void 0:s[ut.MEDIUM],2)}% seclect`:"Not created",content:"Best for most pairs",percent:"0.25%",canCreate:(s==null?void 0:s[ut.MEDIUM])===-1,value:ut.MEDIUM},{title:(s==null?void 0:s[ut.HIGH])!==-1?`${sn(s==null?void 0:s[ut.HIGH],2)}% seclect`:"Not created",content:"Best for exotic pairs",percent:"1%",canCreate:(s==null?void 0:s[ut.HIGH])===-1,value:ut.HIGH}],[s]),l=p=>{console.log("SelectFeeTier item: ",p),a(p)};return o.jsx(et,{pb:"8px",onClick:()=>u(!r),onMouseLeave:d,onMouseEnter:c,children:o.jsx(xo,{isOpen:r,onClose:d,children:({isOpen:p})=>o.jsxs(o.Fragment,{children:[o.jsx(mo,{w:e||"",p:"8px 12px",isActive:r,as:Gs,bg:"bg_secondary",h:"34px",borderRadius:"8px",sx:{_hover:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}},_active:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}}},children:o.jsxs(dt,{w:e||"",align:"center",justifyContent:"center",children:[o.jsxs(F,{color:"text_caption",mr:"4px",fontSize:"xs",children:[n&&ti(n)," fee tier"]}),o.jsx(zt,{xlinkHref:"#icon-icon_open",variant:"gray",transition:"transform 0.5s",transform:r?"rotate(180deg)":"rotate(0deg)"})]})}),o.jsx(yo,{p:"4px",opacity:"1",children:h.map(f=>o.jsx(_o,{p:"8px 12px",bg:f.value==n?"primary_10":"",borderRadius:"8px",sx:{_hover:{bg:"primary_10"}},onClick:()=>{u(!1),l(f)},children:o.jsxs(dt,{w:"100%",align:"center",justifyContent:"space-between",children:[o.jsxs(J,{gap:"0",align:"flex-start",children:[o.jsx(F,{color:"primary",fontSize:"xs",children:f.title}),o.jsx(F,{fontSize:"xs",children:f.content})]}),o.jsx(F,{color:f.value==n?"primary":"text_caption",ml:"12px",children:f.percent})]})},f.value))})]})})})}function tl(t){const{isOpen:e,onClose:n,onChange:s}=t,[i,a]=_.useState("");return _.useEffect(()=>{e||a("")},[e]),o.jsxs(vo,{isOpen:e,onClose:n,isCentered:!0,children:[o.jsx(wo,{}),o.jsxs(ko,{children:[o.jsx(bo,{children:"Select Pool"}),o.jsx(To,{}),o.jsxs(So,{pb:"16px",w:"100%",minH:"400px",maxH:"calc(100vh - 40px)",children:[o.jsx(jo,{searchText:i,placeholder:"Search by token or pool address",onChange:r=>{a(r)}}),o.jsx(et,{mt:"20px",w:"100%",h:"1px",bg:"border"}),o.jsx(el,{searchText:i,onChange:r=>{s(r),n()}})]})]})]})}function el(t){const{onChange:e,searchText:n}=t,[s,i]=_.useState($e.OfficialPools),{filterPoolList:a}=kc(n,s),r=_.useMemo(()=>a.sort((c,d)=>{var h,l;return V(((h=d.volUSD)==null?void 0:h.day)||"0").sub(((l=c.volUSD)==null?void 0:l.day)||"0").toNumber()}),[a]),u=_.useMemo(()=>s===$e.AllPools,[s]);return o.jsxs(et,{w:"100%",pt:"20px",minHeight:"300px",maxH:"calc(100vh - 180px)",overflowY:"scroll",children:[o.jsxs(I,{justifyContent:"space-between",children:[o.jsx(F,{children:"Pool"}),o.jsxs(dt,{alignItems:"center",children:[o.jsx(Co,{checked:u,onClick:()=>{s===$e.AllPools?i($e.OfficialPools):i($e.AllPools)}}),o.jsx(F,{ml:"14px",color:u?"primary":"text_paragraph",children:"Display All Pools"})]})]}),a.length===0&&o.jsx(et,{mt:"40px",children:o.jsx(ge,{type:"nodata",background:"transparent",h:"80px",text:"No pool found"})}),r.map((c,d)=>o.jsxs(et,{children:[o.jsx(nl,{pool:c,onChange:e},d),d!==a.length-1&&o.jsx(et,{w:"100%",h:"1px",bg:"border"})]}))]})}function nl(t){var i,a,r,u,c,d;const{onChange:e,pool:n}=t,{isImportToken:s}=qn();return o.jsxs(I,{w:"100%",h:"65px",justifyContent:"space-between",cursor:"pointer",_hover:{opacity:"0.8"},onClick:()=>e(n),children:[o.jsxs(I,{gap:"10px",alignItems:"center",children:[o.jsx(et,{children:o.jsx(Js,{w:"40px",coinAIconUrl:(i=n==null?void 0:n.displayToken0)==null?void 0:i.image,coinBIconUrl:(a=n==null?void 0:n.displayToken1)==null?void 0:a.image,variant:"border",showATag:s((r=n==null?void 0:n.displayToken0)==null?void 0:r.metadata),showBTag:s((u=n==null?void 0:n.displayToken1)==null?void 0:u.metadata)})}),o.jsxs(F,{color:"text_caption",fontSize:"md",children:[(c=n==null?void 0:n.displayToken0)==null?void 0:c.symbol," - ",(d=n==null?void 0:n.displayToken1)==null?void 0:d.symbol]})]}),o.jsx(F,{mt:"4px",p:"0px 8px",color:"primary",fontSize:"xs",minW:"52px",h:"16px",lineHeight:"16px",borderRadius:"8px",bg:"bg_secondary",textAlign:"center",children:ti(n==null?void 0:n.feeTier)})]})}function ni(){Qs();const{setBaseCoin:t,baseCoin:e,addToken0:n,addToken1:s,currentPrice:i,currentContractPoolInfo:a,currentApiPoolInfo:r,currentFeeTier:u,minPriceData:c,maxPriceData:d,saveMinPriceData:h,saveMaxPriceData:l,defaultPriceRangePercentage:p,priceRangePercentage:f,setPriceRangePercentage:w,isShowMinMaxDist:b,setIsShowMinMaxDist:g}=Rt(),m=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),S=_.useMemo(()=>n||(r==null?void 0:r.token0),[n,r]),T=_.useMemo(()=>s||(r==null?void 0:r.token1),[s,r]),j=(x,v,y,k,E)=>{const z=v,$=y;z&&$&&k?x===100?(h(re.buildMinTickPriceData(k,z,$)),l(re.buildMaxTickPriceData(k,z,$))):(h(re.buildTickPriceData(V(E).mul(V(1).minus(V(x).div(100))).toString(),k,z,$)),l(re.buildTickPriceData(V(E).mul(V(1).add(V(x).div(100))).toString(),k,z,$))):(h(void 0),l(void 0))},R=x=>{h(x)},M=x=>{l(x)},{isFullRange:N,handleMinPriceClick:C,handleMaxPriceClick:L,onInputPriceChange:O}=Tc({minPriceData:c,maxPriceData:d,saveMinPriceData:h,saveMaxPriceData:l,token0:S,token1:T,tickSpacing:m});return{minPriceData:c,maxPriceData:d,handleBaseCoinChange:x=>{var v;try{const y=r==null?void 0:r.token0,k=r==null?void 0:r.token1,E=a==null?void 0:a.tick_spacing;t(x),x!==e&&y&&k&&c&&d&&(R(d.getInverseTickPrice()),M(c.getInverseTickPrice()));const z=x===((v=r==null?void 0:r.token0)==null?void 0:v.symbol)}catch(y){console.log("handleBaseCoinChange error: ",y)}},handleMinPriceClick:C,handleMaxPriceClick:L,isFullRange:N,handleChangeRange:j,handleChangeMinPrice:R,handleChangeMaxPrice:M,handleInputPriceChange:(x,v,y)=>{console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ price:",x),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ isMin:",v),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ isInputComplete:",y),O(x,v,y),g(!0)},handleInputBlur:(x,v,y)=>{console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ price:",x),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ isMin:",v),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ isInputComplete:",y);let k=x;x===""&&(console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ price is empty:"),v?k=V(i).mul(V(1).minus(V(p).div(100))).toString():k=V(i).mul(V(1).add(V(p).div(100))).toString()),O(k,v,y),g(!0)}}}function si(){const{baseCoin:t,currentApiPoolInfo:e,currentPrice:n,inversePrice:s}=Rt(),i=_.useMemo(()=>{var r,u;return t&&e?(console.log("displayCurrentPrice baseCoin: ",t),console.log("displayCurrentPrice currentApiPoolInfo?.token0?.symbol: ",(r=e==null?void 0:e.token0)==null?void 0:r.symbol),t===((u=e==null?void 0:e.token0)==null?void 0:u.metadata)?Cn(n):Cn(s)):""},[t,n,s,e]),a=_.useMemo(()=>{var r;return t&&e?t===((r=e==null?void 0:e.token0)==null?void 0:r.metadata)?`${e==null?void 0:e.token1.symbol} per ${e==null?void 0:e.token0.symbol}`:`${e==null?void 0:e.token0.symbol} per ${e==null?void 0:e.token1.symbol}`:""},[t,n,s,e]);return{displayCurrentPrice:i,displayPerText:a}}function sa(){const{tucanaSpotSDK:t}=Ks(),{getCointAmountValue:e}=Zs(),{setCurrentPoolPositions:n,setCurrentPoolPositionsIsLoading:s}=Rt();return{getCurrentPoolPositions:async(a,r,u)=>{try{s(!0);const c=[],d=await t.Position.getPositionList(u,r?[r.position_collection]:[]);d==null||d.forEach(h=>{var l,p,f,w;if((h==null?void 0:h.pool_address)===(a==null?void 0:a.id)){const b=h.tick_lower_index===Mt.getInitializableTickIndex(Vn,r.tick_spacing)?"0":Mt.tickIndexToPrice(h.tick_lower_index,(l=a==null?void 0:a.token0)==null?void 0:l.decimals,(p=a==null?void 0:a.token1)==null?void 0:p.decimals).toString(),g=h.tick_upper_index===Mt.getInitializableTickIndex(Un,r.tick_spacing)?"âˆž":Mt.tickIndexToPrice(h.tick_upper_index,(f=a==null?void 0:a.token0)==null?void 0:f.decimals,(w=a==null?void 0:a.token1)==null?void 0:w.decimals).toString(),m=a!=null&&a.isReverse?g==="âˆž"?"0":V(1).div(g).toString():b,S=a!=null&&a.isReverse?b==="0"?"âˆž":V(1).div(b).toString():g,T=Ro(r==null?void 0:r.current_tick_index,h.tick_lower_index,h.tick_upper_index),j=Eo(h.liquidity,r.current_sqrt_price,h==null?void 0:h.tick_lower_index,h==null?void 0:h.tick_upper_index),R=ie(j==null?void 0:j.coinA,a.token0.decimals),M=ie(j==null?void 0:j.coinB,a.token1.decimals),N=R?e(R,a==null?void 0:a.token0.metadata,6,!0):"0",C=M?e(M,a==null?void 0:a.token1.metadata,6,!0):"0",L=N!=="--"&&C!=="--"?V(N).add(C).toString():"--";c.push({posId:h==null?void 0:h.id,displayToken0:a.displayToken0,displayToken1:a==null?void 0:a.displayToken1,token0:a==null?void 0:a.token0,token1:a==null?void 0:a.token1,minPrice:Cn(m),maxPrice:Cn(S),status:T,liquidityRate:L,coinAmount0:R,coinAmount1:M,coinAmount0Rate:N,coinAmount1Rate:C,...h})}}),console.log("useGetCurrentPoolPositions getPositions positionList: ",c),n(c),s(!1)}catch(c){s(!1),n([]),console.log("useGetCurrentPoolPositions getPositions Error: ",c)}}}}function ia(t){var Q;Wn();const{getAddLiquidityPaylod:e}=qr(),{signAndExecuteTransaction:n}=Mo(),{slippage:s}=No();Di();const{addToken0:i,addToken1:a,currentApiPoolInfo:r,currentContractPoolInfo:u,baseCoin:c,displayToken0Value:d,displayToken1Value:h,setDisplayToken0Value:l,setDisplayToken1Value:p,minPriceData:f,maxPriceData:w,precomputationInfo:b,setPrecomputationInfo:g,currentFeeTier:m,ratio:S,submitIsLoading:T,setSubmitIsLoading:j}=Rt();sa();const{fetchTokenBalances:R}=Di(),M=_.useMemo(()=>{var xt,G,Z;const U=c===((xt=r==null?void 0:r.token0)==null?void 0:xt.metadata);console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:52 ~ currentPriceStatusParams ~ direct:",U);const Y=U?f:w==null?void 0:w.getInverseTickPrice();console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:54 ~ currentPriceStatusParams ~ minPriceTickData:",Y);const X=U?w:f==null?void 0:f.getInverseTickPrice();console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:56 ~ currentPriceStatusParams ~ maxPriceTickData:",X);const st=u==null?void 0:u.current_tick_index;console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:58 ~ currentPriceStatusParams ~ currentTick:",st);const ct=Y==null?void 0:Y.tick,gt=X==null?void 0:X.tick;return{currentTick:st,lower:ct,upper:gt,metadata0:(G=r==null?void 0:r.token0)==null?void 0:G.metadata,metadata1:(Z=r==null?void 0:r.token1)==null?void 0:Z.metadata}},[r,u,f==null?void 0:f.fixsUiPrice,w==null?void 0:w.fixsUiPrice]),N=jc(M);_.useEffect(()=>{console.log("useLiquidityDeposit currentPriceStatus: ",N)},[N]);const C=qi(r==null?void 0:r.displayToken0),L=qi(r==null?void 0:r.displayToken1),{isDisabled:O,submitBtnText:A}=Cc(T,i,a,N,d,h,C,L),{displayPerText:P,displayCurrentPrice:D}=si(),[x,v]=_.useState(),y=_.useMemo(()=>{var U;return c===((U=r==null?void 0:r.displayToken0)==null?void 0:U.metadata)?"column":"column-reverse"},[c,(Q=r==null?void 0:r.displayToken0)==null?void 0:Q.metadata]),E=Ss((U,Y)=>{var K,rt,ht,qt,Dt,Lt,wt,Tt,ne;const X=c===((K=r==null?void 0:r.token0)==null?void 0:K.metadata),st=((rt=r==null?void 0:r.token0)==null?void 0:rt.metadata)===((ht=r==null?void 0:r.displayToken0)==null?void 0:ht.metadata),ct=X?f:w==null?void 0:w.getInverseTickPrice(),gt=X?w:f==null?void 0:f.getInverseTickPrice(),xt=ct==null?void 0:ct.tick,G=gt==null?void 0:gt.tick,Z=u==null?void 0:u.current_sqrt_price,pt=(Y==null?void 0:Y.metadata)===((qt=r==null?void 0:r.token0)==null?void 0:qt.metadata),it=(Y==null?void 0:Y.metadata)===((Dt=r==null?void 0:r.displayToken0)==null?void 0:Dt.metadata),vt=ss(U,Y==null?void 0:Y.decimals);if(console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:110 ~ preAdd ~ value:",U),console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:110 ~ preAdd ~ amount:",vt.toString()),!vt||V(vt.toString()).equals(0)){it?p(""):l("");return}if(xt===void 0||G===void 0||!Z)return;const q=Mt.sqrtPriceX64ToTickIndex(new Ye(Z));if(V(q).gte(xt)&&V(q).lt(G)){const Bt=Lo.estLiquidityAndcoinAmountFromOneAmounts(xt,G,vt,pt,!0,0,new Ye(Z));g(Bt),it?p(st?ie(Bt.coinAmountB,(Lt=r==null?void 0:r.token1)==null?void 0:Lt.decimals):ie(Bt.coinAmountA,(wt=r==null?void 0:r.token0)==null?void 0:wt.decimals)):l(st?ie(Bt.coinAmountA,(Tt=r==null?void 0:r.token0)==null?void 0:Tt.decimals):ie(Bt.coinAmountB,(ne=r==null?void 0:r.token1)==null?void 0:ne.decimals))}else g(void 0),V(q).lt(xt)?st?p(""):l(""):st?l(""):p("")},500),z=U=>{l(U),v(r==null?void 0:r.displayToken0),E(U,r==null?void 0:r.displayToken0)},$=U=>{p(U),v(r==null?void 0:r.displayToken1),E(U,r==null?void 0:r.displayToken1)};_.useEffect(()=>{var U;x&&(d||h)&&E((x==null?void 0:x.metadata)===((U=r==null?void 0:r.displayToken0)==null?void 0:U.metadata)?d:h,x)},[w==null?void 0:w.fixsUiPrice,f==null?void 0:f.fixsUiPrice,x==null?void 0:x.metadata]);const B=Rc(r==null?void 0:r.displayToken0,r==null?void 0:r.displayToken1,d,h);return{handleDisplayToken0ValueChange:z,handleDisplayToken1ValueChange:$,inputBoxDirection:y,currentPriceStatus:N,fixedToken:x,totalRate:B,getSecondaryModalData:()=>{var Y,X;return{token0:i,token1:a,amount0:((Y=r==null?void 0:r.displayToken0)==null?void 0:Y.metadata)===(i==null?void 0:i.metadata)?d:h,amount1:((X=r==null?void 0:r.displayToken0)==null?void 0:X.metadata)===(i==null?void 0:i.metadata)?h:d,fee:V(m).div(Math.pow(10,4)).toString(),ratio:S,totalRate:B,minPrice:f==null?void 0:f.fixsUiPrice,maxPrice:w==null?void 0:w.fixsUiPrice,displayPerText:P,displayCurrentPrice:D,currentPriceStatus:N}},handleSubmitAdd:async()=>{var U,Y,X,st,ct,gt,xt,G,Z,pt;j(!0);try{const it=(x==null?void 0:x.metadata)===((U=r==null?void 0:r.token0)==null?void 0:U.metadata),vt=c===((Y=r==null?void 0:r.token0)==null?void 0:Y.metadata),q=vt?f:w==null?void 0:w.getInverseTickPrice(),K=vt?w:f==null?void 0:f.getInverseTickPrice(),rt=((X=r==null?void 0:r.displayToken0)==null?void 0:X.metadata)===((st=r==null?void 0:r.token0)==null?void 0:st.metadata);let ht="0",qt="0";if(b)ht=b!=null&&b.fix_amount_a?(ct=b==null?void 0:b.coinAmountA)==null?void 0:ct.toString():V((gt=b==null?void 0:b.coinAmountA)==null?void 0:gt.toString()).mul(V(1).add(s)).toString(),qt=b!=null&&b.fix_amount_a?V((G=b==null?void 0:b.coinAmountB)==null?void 0:G.toString()).mul(V(1).add(s)).toString():(xt=b==null?void 0:b.coinAmountB)==null?void 0:xt.toString();else{const Dt=ss(d,(Z=r==null?void 0:r.displayToken0)==null?void 0:Z.decimals).toString(),Lt=ss(h,(pt=r==null?void 0:r.displayToken1)==null?void 0:pt.decimals).toString(),wt=rt?Dt:Lt,Tt=rt?Lt:Dt;ht=wt,qt=Tt}if(r!=null&&r.id&&(q==null?void 0:q.tick)!==void 0&&(K==null?void 0:K.tick)!==void 0){const Dt={pool_id:r==null?void 0:r.id,tick_lower:q==null?void 0:q.tick,tick_upper:K==null?void 0:K.tick,fix_amount_a:it,offer_amount_a:String(Se(ht,0)),offer_amount_b:String(Se(qt,0))};console.log("handleSubmitAdd slippage: ",s),console.log("handleSubmitAdd params: ",Dt);const Lt=e(Dt);console.log("handleSubmitAdd payload: ",Lt);const wt=await n([Lt],{action:zo.Add,description:"Add Liquidity",coinA:{...r==null?void 0:r.displayToken0,amount:d},coinB:{...r==null?void 0:r.displayToken1,amount:h}});j(!1),console.log("handleSubmitAdd response: ",wt),l(""),p(""),await Do(3e3),t&&t(),R()}}catch(it){console.log("handleSubmitAdd error: ",it),j(!1)}},displayToken0Balance:C,displayToken1Balance:L,isDisabled:O,submitBtnText:A}}function sl(){const{currentFeeTier:t,addToken0:e,addToken1:n,currentApiPoolInfo:s,currentContractPoolInfo:i,currentPrice:a,inversePrice:r,setBaseCoin:u,baseCoin:c,priceRangePercentage:d,setPriceRangePercentage:h,isShowMinMaxDist:l,setIsShowMinMaxDist:p,minDistPercentange:f,maxDistPercentange:w}=Rt(),{minPriceData:b,maxPriceData:g,handleMinPriceClick:m,handleMaxPriceClick:S,isFullRange:T,handleChangeRange:j,handleInputPriceChange:R,handleInputBlur:M,handleBaseCoinChange:N,handleChangeMinPrice:C,handleChangeMaxPrice:L}=ni(),{currentPriceStatus:O}=ia(),{displayPerText:A}=si(),[P,D]=_.useState(""),x=k=>{console.log("handleRadioChange value: ",k),D(k),k==="0.1%"&&h(.1),k==="0.5%"&&h(.5),k==="1%"&&h(1),k==="5%"&&h(5),k==="10%"&&h(10),k==="20%"&&h(20),k==="50%"&&h(50),k==="Full Range"&&h(100),p(!1)},v=_.useMemo(()=>{var k,E,z,$,B,H;return(k=s==null?void 0:s.displayToken0)!=null&&k.symbol&&((E=s==null?void 0:s.displayToken1)!=null&&E.symbol)?[{key:(z=s==null?void 0:s.displayToken0)==null?void 0:z.metadata,label:($=s==null?void 0:s.displayToken0)==null?void 0:$.symbol},{key:(B=s==null?void 0:s.displayToken1)==null?void 0:B.metadata,label:(H=s==null?void 0:s.displayToken1)==null?void 0:H.symbol}]:[]},[s]),y=k=>{h(k),p(!1)};return _.useEffect(()=>{var k;switch(d){case .1:D("0.1%");break;case .5:D("0.5%");break;case 1:D("1%");break;case 5:D("5%");break;case 10:D("10%");break;case 20:D("20%");break;case 50:D("50%");break;case 100:D("Full Range");break;default:D("")}if(s!=null&&s.token0&&(s!=null&&s.token1)&&a&&(i!=null&&i.tick_spacing)){const E=c===((k=s==null?void 0:s.token0)==null?void 0:k.metadata);j(d,E?s==null?void 0:s.token0:s==null?void 0:s.token1,E?s==null?void 0:s.token1:s==null?void 0:s.token0,i==null?void 0:i.tick_spacing,E?a:r)}},[d]),_.useMemo(()=>{var k;if(c&&c===((k=s==null?void 0:s.token0)==null?void 0:k.metadata))return!0},[c,s]),o.jsxs(J,{w:"100%",gap:"16px",p:"16px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(I,{w:"100%",justify:"space-between",children:[o.jsx(F,{fontSize:"md",color:"text_caption",children:"Select Range"}),o.jsx(et,{w:"140px",children:o.jsx(Is,{w:"62px",h:"28px",p:"4px",borderRadius:"4px",currentTab:c,textList:v,onClick:N})})]}),o.jsx(Sc,{direction:"column",unit:A,min_price:(b==null?void 0:b.uiPrice)||"",max_price:(g==null?void 0:g.uiPrice)||"",handleMinPriceActoin:k=>{m(k),p(!0)},handleMaxPriceActoin:k=>{S(k),p(!0)},onInputPriceChange:R,onInputPriceBlur:M,isFullRange:T}),O==="error"&&o.jsx(et,{w:"100%",zIndex:100,children:o.jsx(F,{color:"error",fontSize:"12px",children:"The max price should be higher than min price."})}),o.jsxs(J,{w:"100%",justifyContent:"flex-start",children:[o.jsxs(I,{w:"100%",align:"center",gap:"4px",children:[o.jsx(F,{children:"Range Size"}),o.jsx(Rn,{label:"The Range Size measures the percentage difference between the range selected Min and Max bounds and the current price.","aria-label":"Range Size",placement:"right",sx:{"@media screen and (max-width: 810px)":{w:"200px"}},children:o.jsx("button",{children:o.jsx(zt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsxs($o,{"aria-label":"slider-ex-1",value:l?0:d,min:0,max:100,onChange:y,children:[o.jsx(Oo,{children:o.jsx(Fo,{})}),o.jsx(Bo,{})]})]}),o.jsxs(I,{w:"100%",align:l?"flex-end":"center",justifyContent:"space-between",sx:{"@media screen and (max-width: 1150px)":{display:"flex",flexDirection:"column",alignItems:"flex-start"}},children:[!l&&P==="Full Range"?o.jsx(F,{fontSize:"md",color:"text_caption",lineHeight:"1",sx:{"@media screen and (max-width: 810px)":{fontSize:"sm"}},children:"Full Range"}):l?o.jsxs(I,{align:"center",children:[o.jsxs(J,{gap:"0",children:[o.jsx(F,{fontSize:"xs",children:"Min"}),o.jsxs(F,{fontSize:"md",color:"text_caption",lineHeight:"1",children:[Li(f),"%"]})]}),o.jsx(F,{color:"text_caption",pt:"8px",fontSize:"md",lineHeight:"1",children:"/"}),o.jsxs(J,{gap:"0",children:[o.jsx(F,{fontSize:"xs",children:"Max"}),o.jsxs(F,{fontSize:"md",color:"text_caption",lineHeight:"1",children:[Li(w),"%"]})]})]}):o.jsxs(F,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"sm"}},children:["Â±",d,"%"]}),is&&is[t]&&o.jsx(Ie,{h:"32px",options:is[t]||[],value:l?"-1":P,onChange:x})]})]})}function il(){const t=Bn(Ho),[e,n]=_.useState([]),[s,i]=_.useState(!0),[a,r]=_.useState(0);return{loading:s,dataList:e,fetchHistoryData:async c=>{i(!0);try{const d=new Date().getTime(),h=new URLSearchParams;h.append("timestamp",String(d)),h.append("id",String(c.pool_address)),h.append("limit",String(c.limit)),h.append("offset",String(c.offset)),c.event_type&&h.append("event_type",String(c.event_type));const p=await(await fetch(`${t}?${h.toString()}`)).json();if(console.log("fetchHistoryData: ",p),p&&p.data&&p.data.list){const f=p.data.list;f.forEach(w=>{w.eventType==="burn_event"&&(w.eventType="Remove Liquidity"),w.eventType==="mint_event"&&(w.eventType="Add Liquidity"),w.eventType==="swap_event"&&(w.eventType="Swap")}),r(Number(p.data.total)),n(f)}else n([]),r(0);i(!1)}catch(d){console.log(d,"fetchHistoryData"),i(!1)}},total:a}}const rs=10;function rl(t){const{windowWidth:e}=t,{currentApiPoolInfo:n}=Rt(),{fetchHistoryData:s,loading:i,dataList:a,total:r}=il(),[u,c]=_.useState(1),{getExplorerUrl:d}=Hn();_.useEffect(()=>{n&&h(1)},[n==null?void 0:n.address]);const h=g=>{c(g),s({limit:rs,pool_address:n==null?void 0:n.address,offset:(g-1)*rs})};if(i&&u===1&&r===0)return o.jsx(Xr,{});const l=g=>o.jsx(F,{color:"text_caption",fontSize:"xs",children:g==null?void 0:g.eventType}),p=g=>{let m=[];n!=null&&n.isReverse&&g.eventType!=="Swap"?m=g.items.slice().reverse():m=g==null?void 0:g.items;const S=m[0],T=m[1];return o.jsxs(J,{gap:"0px",align:"flex-end",children:[o.jsxs(I,{children:[o.jsx(Ae,{w:"20px",h:"20px",imageUrl:S==null?void 0:S.image}),o.jsx(F,{fontSize:"xs",color:"text_caption",children:Xe(S==null?void 0:S.amount)}),o.jsx(F,{fontSize:"xs",children:S==null?void 0:S.symbol})]}),(g==null?void 0:g.eventType)==="Swap"&&o.jsx(et,{mt:"-6px",children:o.jsx(zt,{xlinkHref:"#icon-icon_down",variant:"graygray"})}),(g==null?void 0:g.eventType)==="Add Liquidity"&&o.jsx(et,{mt:"-6px",children:o.jsx(zt,{xlinkHref:"#icon-icon_increase",variant:"graygray"})}),(g==null?void 0:g.eventType)==="Remove Liquidity"&&o.jsx(et,{mt:"-6px",children:o.jsx(zt,{xlinkHref:"#icon-icon_reduce4",variant:"graygray"})}),o.jsxs(I,{mt:"-4px",children:[o.jsx(Ae,{w:"20px",h:"20px",imageUrl:T==null?void 0:T.image}),o.jsx(F,{fontSize:"xs",color:"text_caption",children:Xe(T==null?void 0:T.amount)}),o.jsx(F,{fontSize:"xs",children:T==null?void 0:T.symbol})]}),o.jsx(F,{})]})},f=g=>o.jsx(dt,{justifyContent:"flex-end",children:o.jsx(jn,{href:d(g==null?void 0:g.tx,"tx"),variant:"link",color:"primary",fontSize:"xs",target:"_blank",children:Pe(g==null?void 0:g.tx)})}),w=g=>o.jsx(F,{fontSize:"xs",textAlign:"right",children:Yo(Date.parse(g==null?void 0:g.blockTime))}),b=g=>[{leftText:"Recent event",right:l(g)},{leftText:"Amounts",right:p(g),rowListAlign:"flex-start"},{leftText:"Transactions",right:f(g)},{leftText:"Time",right:w(g)}];return o.jsxs(J,{w:"100%",justifyContent:"center",gap:"0px",bg:"card_bg",backdropFilter:"blur(10px)",p:"8px",borderRadius:"12px",children:[o.jsx(qo,{w:"100%",children:e<=810?o.jsx(J,{w:"100%",children:i?[{},{},{}].map((g,m)=>o.jsx(J,{w:"100%",children:o.jsx(Vi,{isLoading:i})},m)):a==null?void 0:a.map((g,m)=>o.jsx(J,{w:"100%",children:o.jsx(Vi,{isLoading:i,rowList:b(g)})},g==null?void 0:g.tx))}):(a==null?void 0:a.length)>0&&o.jsxs(Vo,{size:"sm",variant:"striped",children:[o.jsx(Uo,{children:o.jsxs($i,{children:[o.jsx(rn,{children:o.jsx(F,{fontWeight:"200",children:"Recent event"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(F,{fontWeight:"200",children:"Amounts"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(F,{fontWeight:"200",children:"Transactions"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(F,{fontWeight:"200",children:"Time"})})]})}),o.jsx(Wo,{children:a.map((g,m)=>o.jsxs($i,{sx:{td:{background:m%2===0?"button_ghost_bg !important":"transparent",border:"none",_first:{borderRadius:"8px 0 0 8px"},_last:{borderRadius:"0px 8px 8px 0px"}}},children:[o.jsxs(an,{children:[" ",l(g)," "]}),o.jsx(an,{children:p(g)}),o.jsx(an,{children:f(g)}),o.jsx(an,{children:w(g)})]},g==null?void 0:g.tx))})]})}),a.length===0&&o.jsx(ge,{type:"nodata"}),r<10?null:o.jsx(et,{m:"20px 0",children:o.jsx(Po,{total:r,size:rs,currentPage:u,onChange:g=>{console.log({current:g}),h(g)}})})]})}function al(){const{address:t,onboard:e}=Wn(),{currentPoolPositionsIsLoading:n,currentPoolPositions:s}=Rt();return o.jsxs(o.Fragment,{children:[!t&&o.jsx(ge,{type:"nowallet",onboard:e}),t&&!n&&(s==null?void 0:s.length)===0&&o.jsx(ge,{type:"nodata",text:"You have no liquidity positions"}),t&&n&&o.jsx(Xr,{}),t&&!n&&(s==null?void 0:s.length)>0&&o.jsx(J,{w:"100%",justifyContent:"center",gap:"8px",children:s==null?void 0:s.map(i=>o.jsx(ol,{info:i},`current-pool-positions-${i==null?void 0:i.posId}`))})]})}function ol(t){var r,u,c,d,h,l,p,f,w,b,g,m;const e=Qs(),{setCurrentPositionTab:n}=gc(),{info:s}=t,{isImportToken:i}=qn(),a=(s==null?void 0:s.displayToken0.metadata)!==(s==null?void 0:s.token0.metadata);return o.jsxs(J,{w:"100%",align:"flex-start",bg:"card_bg",backdropFilter:"blur(10px)",borderRadius:"16px",p:"20px",position:"relative",onClick:()=>{n("increase"),e(`/position/${s==null?void 0:s.pool_address}/${s==null?void 0:s.posId}`)},children:[o.jsx(et,{position:"absolute",top:"0",right:"0",children:o.jsx(xc,{borderRadius:"0px  16px",status:s==null?void 0:s.status,isActive:(s==null?void 0:s.status)==="Active"})}),o.jsxs(I,{children:[o.jsx(Js,{w:"32px",coinAIconUrl:(r=s.displayToken0)==null?void 0:r.image,coinBIconUrl:(u=s.displayToken1)==null?void 0:u.image,variant:"border",p:"4px",showATag:i((c=s.displayToken0)==null?void 0:c.metadata),showBTag:i((d=s.displayToken1)==null?void 0:d.metadata)}),o.jsxs(F,{color:"Text_caption",children:[(h=s==null?void 0:s.displayToken0)==null?void 0:h.symbol,"-",(l=s==null?void 0:s.displayToken1)==null?void 0:l.symbol," LPï¼ˆ#",s==null?void 0:s.position_index,")"]})]}),o.jsxs(I,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{flexDirection:"column",alignItems:"flex-start"}},children:[o.jsx(Ec,{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,baseSymbol:(p=s==null?void 0:s.token0)==null?void 0:p.symbol,quoteSymbol:(f=s==null?void 0:s.token1)==null?void 0:f.symbol}),o.jsxs(dt,{align:"center",gap:"10px",sx:{"@media screen and (max-width: 810px)":{w:"100%",justifyContent:"space-between"}},children:[o.jsx(F,{fontSize:"xs",children:"Liquidtity"}),o.jsx(Rn,{label:o.jsxs(J,{gap:"12px",p:"4px 0",minW:"280px",flexDirection:a?"column-reverse":"column",children:[o.jsx(Hi,{icon:((w=s==null?void 0:s.token0)==null?void 0:w.image)||"",amount:(s==null?void 0:s.coinAmount0)||"0",amountValue:(s==null?void 0:s.coinAmount0Rate)||"--",symbol:((b=s==null?void 0:s.token0)==null?void 0:b.symbol)||""}),o.jsx(Hi,{icon:((g=s==null?void 0:s.token1)==null?void 0:g.image)||"",amount:(s==null?void 0:s.coinAmount1)||"0",amountValue:(s==null?void 0:s.coinAmount1Rate)||"--",symbol:((m=s==null?void 0:s.token1)==null?void 0:m.symbol)||""})]}),"aria-label":"LiquidityRate",children:o.jsx("button",{children:o.jsx(F,{color:"text_caption",textDecoration:"underline dotted",dangerouslySetInnerHTML:{__html:`${he(s==null?void 0:s.liquidityRate,2)}`}})})})]})]})]})}function cl(){const{tucanaSpotSDK:t}=Ks();return{getContractPool:async n=>{if(!n)return null;const s=await t.Pool.getPool(n);return console.log("useContractPoolInfo getContractPool poolInfo: ",s),s}}}function ll({handleClickRefresh:t}){var D,x;const{address:e,onboard:n}=Wn(),{currentApiPoolInfo:s,displayToken0Value:i,displayToken1Value:a,submitIsLoading:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h}=Rt(),{handleDisplayToken0ValueChange:l,handleDisplayToken1ValueChange:p,inputBoxDirection:f,currentPriceStatus:w,totalRate:b,handleSubmitAdd:g,getSecondaryModalData:m,displayToken0Balance:S,displayToken1Balance:T,isDisabled:j,submitBtnText:R}=ia(t);ni();const[M,N]=_.useState(!1),[C,L]=_.useState(!1),[O,A]=_.useState(),P=()=>{const v=m();console.log("handleOpenSecondaryModal data: ",v),A(v),L(!0)};return o.jsxs(J,{w:"100%",p:"16px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(I,{w:"100%",justify:"space-between",mb:"8px",children:[o.jsx(F,{fontSize:"md",color:"text_caption",children:"Deposit Amounts"}),o.jsx(zt,{xlinkHref:"#icon-icon_slider",onClick:()=>N(!0)})]}),o.jsxs(J,{gap:"0px",w:"100%",flexDirection:f,children:[o.jsxs(et,{position:"relative",w:"100%",children:[w==="error"||w===((D=s==null?void 0:s.displayToken0)==null?void 0:D.metadata)?o.jsx(Wi,{notHaveText:w==="error"}):null,o.jsx(Ui,{noArrow:!0,currentCoin:d,amount:i,balance:S,onAmountChange:l})]}),o.jsx(dt,{zIndex:"400",gap:"0px",h:"8px",onClick:()=>{var y,k,E;const v=c===((y=s==null?void 0:s.displayToken0)==null?void 0:y.metadata)?(k=s==null?void 0:s.displayToken1)==null?void 0:k.metadata:(E=s==null?void 0:s.displayToken0)==null?void 0:E.metadata;v&&u(v)},children:o.jsx("div",{className:"exchange liquidity-add"})}),o.jsxs(et,{position:"relative",w:"100%",children:[w==="error"||w===((x=s==null?void 0:s.displayToken1)==null?void 0:x.metadata)?o.jsx(Wi,{notHaveText:w==="error"}):null,o.jsx(Ui,{noArrow:!0,currentCoin:h,amount:a,balance:T,onAmountChange:p})]})]}),o.jsxs(I,{w:"100%",justify:"space-between",bg:"input_bg",h:"52px",p:"0 16px",borderRadius:"16px",border:"1px solid",borderColor:"border",children:[o.jsx(F,{fontSize:"md",children:"Total"}),o.jsxs(F,{fontSize:"16px",color:"text_caption",children:["$",Xe(b)]})]}),o.jsx(Gs,{w:"100%",mt:"4px",size:"lg",onClick:()=>{e?P():n()},isLoading:r,isDisabled:j,children:R}),o.jsx(Dc,{isOpen:M,onClose:()=>N(!1)}),o.jsx(Mc,{data:O,isOpen:C,onClose:()=>{L(!1)},onClick:()=>{g(),L(!1)}})]})}var ra={exports:{}},aa={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var je=_;function ul(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dl=typeof Object.is=="function"?Object.is:ul,hl=je.useState,fl=je.useEffect,pl=je.useLayoutEffect,gl=je.useDebugValue;function xl(t,e){var n=e(),s=hl({inst:{value:n,getSnapshot:e}}),i=s[0].inst,a=s[1];return pl(function(){i.value=n,i.getSnapshot=e,as(i)&&a({inst:i})},[t,n,e]),fl(function(){return as(i)&&a({inst:i}),t(function(){as(i)&&a({inst:i})})},[t]),gl(n),n}function as(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!dl(t,n)}catch{return!0}}function ml(t,e){return e()}var yl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ml:xl;aa.useSyncExternalStore=je.useSyncExternalStore!==void 0?je.useSyncExternalStore:yl;ra.exports=aa;var _l=ra.exports;const ae=()=>{},Et=ae(),os=Object,at=t=>t===Et,At=t=>typeof t=="function",ce=(t,e)=>({...t,...e}),vl=t=>At(t.then),cn=new WeakMap;let wl=0;const Ge=t=>{const e=typeof t,n=t&&t.constructor,s=n==Date;let i,a;if(os(t)===t&&!s&&n!=RegExp){if(i=cn.get(t),i)return i;if(i=++wl+"~",cn.set(t,i),n==Array){for(i="@",a=0;a<t.length;a++)i+=Ge(t[a])+",";cn.set(t,i)}if(n==os){i="#";const r=os.keys(t).sort();for(;!at(a=r.pop());)at(t[a])||(i+=a+":"+Ge(t[a])+",");cn.set(t,i)}}else i=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return i},Qt=new WeakMap,cs={},ln={},ii="undefined",Yn=typeof window!=ii,Es=typeof document!=ii,kl=()=>Yn&&typeof window.requestAnimationFrame!=ii,oa=(t,e)=>{const n=Qt.get(t);return[()=>!at(e)&&t.get(e)||cs,s=>{if(!at(e)){const i=t.get(e);e in ln||(ln[e]=i),n[5](e,ce(i,s),i||cs)}},n[6],()=>!at(e)&&e in ln?ln[e]:!at(e)&&t.get(e)||cs]};let Ms=!0;const bl=()=>Ms,[Ns,zs]=Yn&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ae,ae],Tl=()=>{const t=Es&&document.visibilityState;return at(t)||t!=="hidden"},Sl=t=>(Es&&document.addEventListener("visibilitychange",t),Ns("focus",t),()=>{Es&&document.removeEventListener("visibilitychange",t),zs("focus",t)}),jl=t=>{const e=()=>{Ms=!0,t()},n=()=>{Ms=!1};return Ns("online",e),Ns("offline",n),()=>{zs("online",e),zs("offline",n)}},Cl={isOnline:bl,isVisible:Tl},Rl={initFocus:Sl,initReconnect:jl},Xi=!oe.useId,Ke=!Yn||"Deno"in window,El=t=>kl()?window.requestAnimationFrame(t):setTimeout(t,1),ls=Ke?_.useEffect:_.useLayoutEffect,us=typeof navigator<"u"&&navigator.connection,Gi=!Ke&&us&&(["slow-2g","2g"].includes(us.effectiveType)||us.saveData),ri=t=>{if(At(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Ge(t):"",[t,e]};let Ml=0;const Ds=()=>++Ml,ca=0,la=1,ua=2,Nl=3;var Oe={__proto__:null,ERROR_REVALIDATE_EVENT:Nl,FOCUS_EVENT:ca,MUTATE_EVENT:ua,RECONNECT_EVENT:la};async function da(...t){const[e,n,s,i]=t,a=ce({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let r=a.populateCache;const u=a.rollbackOnError;let c=a.optimisticData;const d=p=>typeof u=="function"?u(p):u!==!1,h=a.throwOnError;if(At(n)){const p=n,f=[],w=e.keys();for(const b of w)!/^\$(inf|sub)\$/.test(b)&&p(e.get(b)._k)&&f.push(b);return Promise.all(f.map(l))}return l(n);async function l(p){const[f]=ri(p);if(!f)return;const[w,b]=oa(e,f),[g,m,S,T]=Qt.get(e),j=()=>{const D=g[f];return(At(a.revalidate)?a.revalidate(w().data,p):a.revalidate!==!1)&&(delete S[f],delete T[f],D&&D[0])?D[0](ua).then(()=>w().data):w().data};if(t.length<3)return j();let R=s,M;const N=Ds();m[f]=[N,0];const C=!at(c),L=w(),O=L.data,A=L._c,P=at(A)?O:A;if(C&&(c=At(c)?c(P,O):c,b({data:c,_c:P})),At(R))try{R=R(P)}catch(D){M=D}if(R&&vl(R))if(R=await R.catch(D=>{M=D}),N!==m[f][0]){if(M)throw M;return R}else M&&C&&d(M)&&(r=!0,b({data:P,_c:Et}));if(r&&!M)if(At(r)){const D=r(R,P);b({data:D,error:Et,_c:Et})}else b({data:R,error:Et,_c:Et});if(m[f][1]=Ds(),Promise.resolve(j()).then(()=>{b({_c:Et})}),M){if(h)throw M;return}return R}}const Ki=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},zl=(t,e)=>{if(!Qt.has(t)){const n=ce(Rl,e),s={},i=da.bind(Et,t);let a=ae;const r={},u=(h,l)=>{const p=r[h]||[];return r[h]=p,p.push(l),()=>p.splice(p.indexOf(l),1)},c=(h,l,p)=>{t.set(h,l);const f=r[h];if(f)for(const w of f)w(l,p)},d=()=>{if(!Qt.has(t)&&(Qt.set(t,[s,{},{},{},i,c,u]),!Ke)){const h=n.initFocus(setTimeout.bind(Et,Ki.bind(Et,s,ca))),l=n.initReconnect(setTimeout.bind(Et,Ki.bind(Et,s,la)));a=()=>{h&&h(),l&&l(),Qt.delete(t)}}};return d(),[t,i,d,a]}return[t,Qt.get(t)[4]]},Dl=(t,e,n,s,i)=>{const a=n.errorRetryCount,r=i.retryCount,u=~~((Math.random()+.5)*(1<<(r<8?r:8)))*n.errorRetryInterval;!at(a)&&r>a||setTimeout(s,u,i)},Ll=(t,e)=>Ge(t)==Ge(e),[ha,$l]=zl(new Map),Ol=ce({onLoadingSlow:ae,onSuccess:ae,onError:ae,onErrorRetry:Dl,onDiscarded:ae,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Gi?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Gi?5e3:3e3,compare:Ll,isPaused:()=>!1,cache:ha,mutate:$l,fallback:{}},Cl),Fl=(t,e)=>{const n=ce(t,e);if(e){const{use:s,fallback:i}=t,{use:a,fallback:r}=e;s&&a&&(n.use=s.concat(a)),i&&r&&(n.fallback=ce(i,r))}return n},Bl=_.createContext({}),Hl="$inf$",fa=Yn&&window.__SWR_DEVTOOLS_USE__,ql=fa?window.__SWR_DEVTOOLS_USE__:[],Vl=()=>{fa&&(window.__SWR_DEVTOOLS_REACT__=oe)},pa=t=>At(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Ul=()=>ce(Ol,_.useContext(Bl)),Wl=t=>(e,n,s)=>t(e,n&&((...a)=>{const[r]=ri(e),[,,,u]=Qt.get(ha);if(r.startsWith(Hl))return n(...a);const c=u[r];return at(c)?n(...a):(delete u[r],c)}),s),Pl=ql.concat(Wl),Yl=t=>function(...n){const s=Ul(),[i,a,r]=pa(n),u=Fl(s,r);let c=t;const{use:d}=u,h=(d||[]).concat(Pl);for(let l=h.length;l--;)c=h[l](c);return c(i,a||u.fetcher||null,u)},Al=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i>=0&&(s[i]=s[s.length-1],s.pop())}},Xl=(t,e)=>(...n)=>{const[s,i,a]=pa(n),r=(a.use||[]).concat(e);return t(s,i,{...a,use:r})};Vl();const Zi=oe.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),ds={dedupe:!0},Gl=(t,e,n)=>{const{cache:s,compare:i,suspense:a,fallbackData:r,revalidateOnMount:u,revalidateIfStale:c,refreshInterval:d,refreshWhenHidden:h,refreshWhenOffline:l,keepPreviousData:p}=n,[f,w,b,g]=Qt.get(s),[m,S]=ri(t),T=_.useRef(!1),j=_.useRef(!1),R=_.useRef(m),M=_.useRef(e),N=_.useRef(n),C=()=>N.current,L=()=>C().isVisible()&&C().isOnline(),[O,A,P,D]=oa(s,m),x=_.useRef({}).current,v=at(r)?n.fallback[m]:r,y=(G,Z)=>{for(const pt in x){const it=pt;if(it==="data"){if(!i(G[it],Z[it])&&(!at(G[it])||!i(U,Z[it])))return!1}else if(Z[it]!==G[it])return!1}return!0},k=_.useMemo(()=>{const G=!m||!e?!1:at(u)?C().isPaused()||a?!1:at(c)?!0:c:u,Z=rt=>{const ht=ce(rt);return delete ht._k,G?{isValidating:!0,isLoading:!0,...ht}:ht},pt=O(),it=D(),vt=Z(pt),q=pt===it?vt:Z(it);let K=vt;return[()=>{const rt=Z(O());return y(rt,K)?(K.data=rt.data,K.isLoading=rt.isLoading,K.isValidating=rt.isValidating,K.error=rt.error,K):(K=rt,rt)},()=>q]},[s,m]),E=_l.useSyncExternalStore(_.useCallback(G=>P(m,(Z,pt)=>{y(pt,Z)||G()}),[s,m]),k[0],k[1]),z=!T.current,$=f[m]&&f[m].length>0,B=E.data,H=at(B)?v:B,nt=E.error,Q=_.useRef(H),U=p?at(B)?Q.current:B:H,Y=$&&!at(nt)?!1:z&&!at(u)?u:C().isPaused()?!1:a?at(H)?!1:c:at(H)||c,X=!!(m&&e&&z&&Y),st=at(E.isValidating)?X:E.isValidating,ct=at(E.isLoading)?X:E.isLoading,gt=_.useCallback(async G=>{const Z=M.current;if(!m||!Z||j.current||C().isPaused())return!1;let pt,it,vt=!0;const q=G||{},K=!b[m]||!q.dedupe,rt=()=>Xi?!j.current&&m===R.current&&T.current:m===R.current,ht={isValidating:!1,isLoading:!1},qt=()=>{A(ht)},Dt=()=>{const wt=b[m];wt&&wt[1]===it&&delete b[m]},Lt={isValidating:!0};at(O().data)&&(Lt.isLoading=!0);try{if(K&&(A(Lt),n.loadingTimeout&&at(O().data)&&setTimeout(()=>{vt&&rt()&&C().onLoadingSlow(m,n)},n.loadingTimeout),b[m]=[Z(S),Ds()]),[pt,it]=b[m],pt=await pt,K&&setTimeout(Dt,n.dedupingInterval),!b[m]||b[m][1]!==it)return K&&rt()&&C().onDiscarded(m),!1;ht.error=Et;const wt=w[m];if(!at(wt)&&(it<=wt[0]||it<=wt[1]||wt[1]===0))return qt(),K&&rt()&&C().onDiscarded(m),!1;const Tt=O().data;ht.data=i(Tt,pt)?Tt:pt,K&&rt()&&C().onSuccess(pt,m,n)}catch(wt){Dt();const Tt=C(),{shouldRetryOnError:ne}=Tt;Tt.isPaused()||(ht.error=wt,K&&rt()&&(Tt.onError(wt,m,Tt),(ne===!0||At(ne)&&ne(wt))&&(!C().revalidateOnFocus||!C().revalidateOnReconnect||L())&&Tt.onErrorRetry(wt,m,Tt,Bt=>{const ye=f[m];ye&&ye[0]&&ye[0](Oe.ERROR_REVALIDATE_EVENT,Bt)},{retryCount:(q.retryCount||0)+1,dedupe:!0})))}return vt=!1,qt(),!0},[m,s]),xt=_.useCallback((...G)=>da(s,R.current,...G),[]);if(ls(()=>{M.current=e,N.current=n,at(B)||(Q.current=B)}),ls(()=>{if(!m)return;const G=gt.bind(Et,ds);let Z=0;const it=Al(m,f,(vt,q={})=>{if(vt==Oe.FOCUS_EVENT){const K=Date.now();C().revalidateOnFocus&&K>Z&&L()&&(Z=K+C().focusThrottleInterval,G())}else if(vt==Oe.RECONNECT_EVENT)C().revalidateOnReconnect&&L()&&G();else{if(vt==Oe.MUTATE_EVENT)return gt();if(vt==Oe.ERROR_REVALIDATE_EVENT)return gt(q)}});return j.current=!1,R.current=m,T.current=!0,A({_k:S}),Y&&(at(H)||Ke?G():El(G)),()=>{j.current=!0,it()}},[m]),ls(()=>{let G;function Z(){const it=At(d)?d(O().data):d;it&&G!==-1&&(G=setTimeout(pt,it))}function pt(){!O().error&&(h||C().isVisible())&&(l||C().isOnline())?gt(ds).then(Z):Z()}return Z(),()=>{G&&(clearTimeout(G),G=-1)}},[d,h,l,m]),_.useDebugValue(U),a&&at(H)&&m){if(!Xi&&Ke)throw new Error("Fallback data is required when using suspense in SSR.");M.current=e,N.current=n,j.current=!1;const G=g[m];if(!at(G)){const Z=xt(G);Zi(Z)}if(at(nt)){const Z=gt(ds);at(U)||(Z.status="fulfilled",Z.value=!0),Zi(Z)}else throw nt}return{mutate:xt,get data(){return x.data=!0,U},get error(){return x.error=!0,nt},get isValidating(){return x.isValidating=!0,st},get isLoading(){return x.isLoading=!0,ct}}},Kl=Yl(Gl),Zl=t=>(e,n,s)=>(s.revalidateOnFocus=!1,s.revalidateIfStale=!1,s.revalidateOnReconnect=!1,t(e,n,s)),Jl=Xl(Kl,Zl),Ql=8;function Ji(t,e,n,s,i,a){let r={...n},u=[];for(let c=i+(a?1:0);a?c<s.length:c>=0;a?c++:c--){const d=Number(s[c].tick),h={liquidityActive:r.liquidityActive,tick:d,liquidityNet:BigInt(s[c].liquidityNet),price0:Mt.tickIndexToPrice(d,t.decimals,e.decimals).toFixed(Ql)};a?h.liquidityActive=r.liquidityActive+BigInt(s[c].liquidityNet):!a&&r.liquidityNet!==0n&&(h.liquidityActive=r.liquidityActive-r.liquidityNet),u.push(h),r=h}return a||(u=u.reverse()),u}const Il=8,tu=(t,e)=>t!==void 0&&e?Math.floor(t/Oi[e])*Oi[e]:void 0;function eu(t){const e=Bn(Ao);qr();const n=d=>{if(console.log("getTicks args: ",d),console.log("getTicks args?.url: ",d==null?void 0:d.url),!!t)return Vr(d==null?void 0:d.url,{id:d.id})},{data:s,error:i,isLoading:a,mutate:r}=Jl({url:e,id:t},n),u=()=>{r()},c=_.useMemo(()=>{const d=[];if(console.log("ticksData data: ",s),console.log("ticksData id: ",t),s&&(s!=null&&s.ticks))return console.log("ticksData data?.ticks: ",s==null?void 0:s.ticks),s==null||s.ticks.forEach(h=>{d.push({tick:Number(h.index),liquidityNet:h.liquidity_net,liquidityGross:h.liquidity_gross,id:h.id})}),d},[s]);return{isLoading:a,error:i,data:c,handleRefresh:u}}function nu(t){const e=eu(t);return console.log("subgraphTickData: ",e),{isLoading:e.isLoading,error:e.error,ticks:e.data,handleRefresh:e.handleRefresh}}function su(t,e,n,s){const i=_.useMemo(()=>tu(t==null?void 0:t.current_tick_index,s),[t,s]),a=_.useMemo(()=>{if(t)return Mt.getInitializableTickIndex(Vn,t.tick_spacing)},[t]),r=_.useMemo(()=>{if(t)return Mt.getInitializableTickIndex(Un,t.tick_spacing)},[t]),{isLoading:u,error:c,ticks:d,handleRefresh:h}=nu(t==null?void 0:t.pool_address);return _.useMemo(()=>{if(!e||!n||i===void 0||d===void 0||!d||(d==null?void 0:d.length)===0||u||!a||!r)return{isLoading:u,error:c,activeTick:i,data:void 0,handleRefresh:h};const l=e,p=n;console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ newTicks start:");const f=d;console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ newTicks:",f),console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ activeTick:",i);const w=f.findIndex(({tick:j})=>Number(j)>i)-1;if(w<0)return{isLoading:u,error:c,activeTick:i,data:void 0,handleRefresh:h};const b=(t==null?void 0:t.liquidity)??0,g={liquidityActive:BigInt(b??0),tick:i,liquidityNet:Number(d[w].tick)===i?BigInt(d[w].liquidityNet):0n,price0:Mt.tickIndexToPrice(i,l.decimals,p.decimals).toFixed(Il)},m=Ji(l,p,g,f,w,!0),T=Ji(l,p,g,f,w,!1).concat(g).concat(m);return console.log("ðŸš€ ~ file: usePoolTickData.ts:215 ~ returnuseMemo ~ ticksProcessed:",T),{isLoading:u,error:c,activeTick:i,data:T,handleRefresh:h}},[e,n,i,t,d,u,c,a,r])}function iu({contractPoolInfo:t,currencyA:e,currencyB:n,feeAmount:s}){const{isLoading:i,error:a,data:r,handleRefresh:u}=su(t,e,n,s),c=_.useCallback(()=>{if(console.log("ðŸš€ ~ file: useDepthChartData.ts:22 ~ formatData ~ data:",r),!r||!(r!=null&&r.length))return[];const d=[];for(let h=0;h<r.length;h++){const l=r[h],p={depth:parseFloat(l.liquidityActive.toString()),price:parseFloat(l.price0)};p.depth>=0&&d.push(p)}return d},[r]);return _.useMemo(()=>({isLoading:i,error:a,formattedData:i?void 0:c(),handleRefresh:u}),[i,a,c])}function ru(t){return t}var hs=1,gn=2,Ls=3,un=4,Qi=1e-6;function au(t){return"translate("+t+",0)"}function ou(t){return"translate(0,"+t+")"}function cu(t){return e=>+t(e)}function lu(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function uu(){return!this.__axis}function ga(t,e){var n=[],s=null,i=null,a=6,r=6,u=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,d=t===hs||t===un?-1:1,h=t===un||t===gn?"x":"y",l=t===hs||t===Ls?au:ou;function p(f){var w=s??(e.ticks?e.ticks.apply(e,n):e.domain()),b=i??(e.tickFormat?e.tickFormat.apply(e,n):ru),g=Math.max(a,0)+u,m=e.range(),S=+m[0]+c,T=+m[m.length-1]+c,j=(e.bandwidth?lu:cu)(e.copy(),c),R=f.selection?f.selection():f,M=R.selectAll(".domain").data([null]),N=R.selectAll(".tick").data(w,e).order(),C=N.exit(),L=N.enter().append("g").attr("class","tick"),O=N.select("line"),A=N.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge(L),O=O.merge(L.append("line").attr("stroke","currentColor").attr(h+"2",d*a)),A=A.merge(L.append("text").attr("fill","currentColor").attr(h,d*g).attr("dy",t===hs?"0em":t===Ls?"0.71em":"0.32em")),f!==R&&(M=M.transition(f),N=N.transition(f),O=O.transition(f),A=A.transition(f),C=C.transition(f).attr("opacity",Qi).attr("transform",function(P){return isFinite(P=j(P))?l(P+c):this.getAttribute("transform")}),L.attr("opacity",Qi).attr("transform",function(P){var D=this.parentNode.__axis;return l((D&&isFinite(D=D(P))?D:j(P))+c)})),C.remove(),M.attr("d",t===un||t===gn?r?"M"+d*r+","+S+"H"+c+"V"+T+"H"+d*r:"M"+c+","+S+"V"+T:r?"M"+S+","+d*r+"V"+c+"H"+T+"V"+d*r:"M"+S+","+c+"H"+T),N.attr("opacity",1).attr("transform",function(P){return l(j(P)+c)}),O.attr(h+"2",d*a),A.attr(h,d*g).text(b),R.filter(uu).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gn?"start":t===un?"end":"middle"),R.each(function(){this.__axis=j})}return p.scale=function(f){return arguments.length?(e=f,p):e},p.ticks=function(){return n=Array.from(arguments),p},p.tickArguments=function(f){return arguments.length?(n=f==null?[]:Array.from(f),p):n.slice()},p.tickValues=function(f){return arguments.length?(s=f==null?null:Array.from(f),p):s&&s.slice()},p.tickFormat=function(f){return arguments.length?(i=f,p):i},p.tickSize=function(f){return arguments.length?(a=r=+f,p):a},p.tickSizeInner=function(f){return arguments.length?(a=+f,p):a},p.tickSizeOuter=function(f){return arguments.length?(r=+f,p):r},p.tickPadding=function(f){return arguments.length?(u=+f,p):u},p.offset=function(f){return arguments.length?(c=+f,p):c},p}function du(t){return ga(gn,t)}function xa(t){return ga(Ls,t)}var hu={value:()=>{}};function An(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new xn(n)}function xn(t){this._=t}function fu(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",i=n.indexOf(".");if(i>=0&&(s=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}xn.prototype=An.prototype={constructor:xn,on:function(t,e){var n=this._,s=fu(t+"",n),i,a=-1,r=s.length;if(arguments.length<2){for(;++a<r;)if((i=(t=s[a]).type)&&(i=pu(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<r;)if(i=(t=s[a]).type)n[i]=Ii(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ii(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new xn(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),s=0,i,a;s<i;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],s=0,i=a.length;s<i;++s)a[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],i=0,a=s.length;i<a;++i)s[i].value.apply(e,n)}};function pu(t,e){for(var n=0,s=t.length,i;n<s;++n)if((i=t[n]).name===e)return i.value}function Ii(t,e,n){for(var s=0,i=t.length;s<i;++s)if(t[s].name===e){t[s]=hu,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var $s="http://www.w3.org/1999/xhtml";const tr={svg:"http://www.w3.org/2000/svg",xhtml:$s,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),tr.hasOwnProperty(e)?{space:tr[e],local:t}:t}function gu(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===$s&&e.documentElement.namespaceURI===$s?e.createElement(t):e.createElementNS(n,t)}}function xu(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ma(t){var e=Xn(t);return(e.local?xu:gu)(e)}function mu(){}function ai(t){return t==null?mu:function(){return this.querySelector(t)}}function yu(t){typeof t!="function"&&(t=ai(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=new Array(r),c,d,h=0;h<r;++h)(c=a[h])&&(d=t.call(c,c.__data__,h,a))&&("__data__"in c&&(d.__data__=c.__data__),u[h]=d);return new Ot(s,this._parents)}function _u(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function vu(){return[]}function ya(t){return t==null?vu:function(){return this.querySelectorAll(t)}}function wu(t){return function(){return _u(t.apply(this,arguments))}}function ku(t){typeof t=="function"?t=wu(t):t=ya(t);for(var e=this._groups,n=e.length,s=[],i=[],a=0;a<n;++a)for(var r=e[a],u=r.length,c,d=0;d<u;++d)(c=r[d])&&(s.push(t.call(c,c.__data__,d,r)),i.push(c));return new Ot(s,i)}function _a(t){return function(){return this.matches(t)}}function va(t){return function(e){return e.matches(t)}}var bu=Array.prototype.find;function Tu(t){return function(){return bu.call(this.children,t)}}function Su(){return this.firstElementChild}function ju(t){return this.select(t==null?Su:Tu(typeof t=="function"?t:va(t)))}var Cu=Array.prototype.filter;function Ru(){return Array.from(this.children)}function Eu(t){return function(){return Cu.call(this.children,t)}}function Mu(t){return this.selectAll(t==null?Ru:Eu(typeof t=="function"?t:va(t)))}function Nu(t){typeof t!="function"&&(t=_a(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=[],c,d=0;d<r;++d)(c=a[d])&&t.call(c,c.__data__,d,a)&&u.push(c);return new Ot(s,this._parents)}function wa(t){return new Array(t.length)}function zu(){return new Ot(this._enter||this._groups.map(wa),this._parents)}function En(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}En.prototype={constructor:En,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Du(t){return function(){return t}}function Lu(t,e,n,s,i,a){for(var r=0,u,c=e.length,d=a.length;r<d;++r)(u=e[r])?(u.__data__=a[r],s[r]=u):n[r]=new En(t,a[r]);for(;r<c;++r)(u=e[r])&&(i[r]=u)}function $u(t,e,n,s,i,a,r){var u,c,d=new Map,h=e.length,l=a.length,p=new Array(h),f;for(u=0;u<h;++u)(c=e[u])&&(p[u]=f=r.call(c,c.__data__,u,e)+"",d.has(f)?i[u]=c:d.set(f,c));for(u=0;u<l;++u)f=r.call(t,a[u],u,a)+"",(c=d.get(f))?(s[u]=c,c.__data__=a[u],d.delete(f)):n[u]=new En(t,a[u]);for(u=0;u<h;++u)(c=e[u])&&d.get(p[u])===c&&(i[u]=c)}function Ou(t){return t.__data__}function Fu(t,e){if(!arguments.length)return Array.from(this,Ou);var n=e?$u:Lu,s=this._parents,i=this._groups;typeof t!="function"&&(t=Du(t));for(var a=i.length,r=new Array(a),u=new Array(a),c=new Array(a),d=0;d<a;++d){var h=s[d],l=i[d],p=l.length,f=Bu(t.call(h,h&&h.__data__,d,s)),w=f.length,b=u[d]=new Array(w),g=r[d]=new Array(w),m=c[d]=new Array(p);n(h,l,b,g,m,f,e);for(var S=0,T=0,j,R;S<w;++S)if(j=b[S]){for(S>=T&&(T=S+1);!(R=g[T])&&++T<w;);j._next=R||null}}return r=new Ot(r,s),r._enter=u,r._exit=c,r}function Bu(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Hu(){return new Ot(this._exit||this._groups.map(wa),this._parents)}function qu(t,e,n){var s=this.enter(),i=this,a=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),s&&i?s.merge(i).order():i}function Vu(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,i=n.length,a=s.length,r=Math.min(i,a),u=new Array(i),c=0;c<r;++c)for(var d=n[c],h=s[c],l=d.length,p=u[c]=new Array(l),f,w=0;w<l;++w)(f=d[w]||h[w])&&(p[w]=f);for(;c<i;++c)u[c]=n[c];return new Ot(u,this._parents)}function Uu(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],i=s.length-1,a=s[i],r;--i>=0;)(r=s[i])&&(a&&r.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(r,a),a=r);return this}function Wu(t){t||(t=Pu);function e(l,p){return l&&p?t(l.__data__,p.__data__):!l-!p}for(var n=this._groups,s=n.length,i=new Array(s),a=0;a<s;++a){for(var r=n[a],u=r.length,c=i[a]=new Array(u),d,h=0;h<u;++h)(d=r[h])&&(c[h]=d);c.sort(e)}return new Ot(i,this._parents).order()}function Pu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Yu(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Au(){return Array.from(this)}function Xu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],i=0,a=s.length;i<a;++i){var r=s[i];if(r)return r}return null}function Gu(){let t=0;for(const e of this)++t;return t}function Ku(){return!this.node()}function Zu(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var i=e[n],a=0,r=i.length,u;a<r;++a)(u=i[a])&&t.call(u,u.__data__,a,i);return this}function Ju(t){return function(){this.removeAttribute(t)}}function Qu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Iu(t,e){return function(){this.setAttribute(t,e)}}function td(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ed(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function nd(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function sd(t,e){var n=Xn(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?Qu:Ju:typeof e=="function"?n.local?nd:ed:n.local?td:Iu)(n,e))}function ka(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function id(t){return function(){this.style.removeProperty(t)}}function rd(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ad(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function od(t,e,n){return arguments.length>1?this.each((e==null?id:typeof e=="function"?ad:rd)(t,e,n??"")):Ce(this.node(),t)}function Ce(t,e){return t.style.getPropertyValue(e)||ka(t).getComputedStyle(t,null).getPropertyValue(e)}function cd(t){return function(){delete this[t]}}function ld(t,e){return function(){this[t]=e}}function ud(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function dd(t,e){return arguments.length>1?this.each((e==null?cd:typeof e=="function"?ud:ld)(t,e)):this.node()[t]}function ba(t){return t.trim().split(/^|\s+/)}function oi(t){return t.classList||new Ta(t)}function Ta(t){this._node=t,this._names=ba(t.getAttribute("class")||"")}Ta.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Sa(t,e){for(var n=oi(t),s=-1,i=e.length;++s<i;)n.add(e[s])}function ja(t,e){for(var n=oi(t),s=-1,i=e.length;++s<i;)n.remove(e[s])}function hd(t){return function(){Sa(this,t)}}function fd(t){return function(){ja(this,t)}}function pd(t,e){return function(){(e.apply(this,arguments)?Sa:ja)(this,t)}}function gd(t,e){var n=ba(t+"");if(arguments.length<2){for(var s=oi(this.node()),i=-1,a=n.length;++i<a;)if(!s.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?pd:e?hd:fd)(n,e))}function xd(){this.textContent=""}function md(t){return function(){this.textContent=t}}function yd(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function _d(t){return arguments.length?this.each(t==null?xd:(typeof t=="function"?yd:md)(t)):this.node().textContent}function vd(){this.innerHTML=""}function wd(t){return function(){this.innerHTML=t}}function kd(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function bd(t){return arguments.length?this.each(t==null?vd:(typeof t=="function"?kd:wd)(t)):this.node().innerHTML}function Td(){this.nextSibling&&this.parentNode.appendChild(this)}function Sd(){return this.each(Td)}function jd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Cd(){return this.each(jd)}function Rd(t){var e=typeof t=="function"?t:ma(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Ed(){return null}function Md(t,e){var n=typeof t=="function"?t:ma(t),s=e==null?Ed:typeof e=="function"?e:ai(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Nd(){var t=this.parentNode;t&&t.removeChild(this)}function zd(){return this.each(Nd)}function Dd(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ld(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function $d(t){return this.select(t?Ld:Dd)}function Od(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Fd(t){return function(e){t.call(this,e,this.__data__)}}function Bd(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function Hd(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++s]=a;++s?e.length=s:delete this.__on}}}function qd(t,e,n){return function(){var s=this.__on,i,a=Fd(e);if(s){for(var r=0,u=s.length;r<u;++r)if((i=s[r]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},s?s.push(i):this.__on=[i]}}function Vd(t,e,n){var s=Bd(t+""),i,a=s.length,r;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,d=u.length,h;c<d;++c)for(i=0,h=u[c];i<a;++i)if((r=s[i]).type===h.type&&r.name===h.name)return h.value}return}for(u=e?qd:Hd,i=0;i<a;++i)this.each(u(s[i],e,n));return this}function Ca(t,e,n){var s=ka(t),i=s.CustomEvent;typeof i=="function"?i=new i(e,n):(i=s.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Ud(t,e){return function(){return Ca(this,t,e)}}function Wd(t,e){return function(){return Ca(this,t,e.apply(this,arguments))}}function Pd(t,e){return this.each((typeof e=="function"?Wd:Ud)(t,e))}function*Yd(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],i=0,a=s.length,r;i<a;++i)(r=s[i])&&(yield r)}var Ra=[null];function Ot(t,e){this._groups=t,this._parents=e}function tn(){return new Ot([[document.documentElement]],Ra)}function Ad(){return this}Ot.prototype=tn.prototype={constructor:Ot,select:yu,selectAll:ku,selectChild:ju,selectChildren:Mu,filter:Nu,data:Fu,enter:zu,exit:Hu,join:qu,merge:Vu,selection:Ad,order:Uu,sort:Wu,call:Yu,nodes:Au,node:Xu,size:Gu,empty:Ku,each:Zu,attr:sd,style:od,property:dd,classed:gd,text:_d,html:bd,raise:Sd,lower:Cd,append:Rd,insert:Md,remove:zd,clone:$d,datum:Od,on:Vd,dispatch:Pd,[Symbol.iterator]:Yd};function yt(t){return typeof t=="string"?new Ot([[document.querySelector(t)]],[document.documentElement]):new Ot([[t]],Ra)}function Xd(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Pt(t,e){if(t=Xd(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Os={capture:!0,passive:!1};function Fs(t){t.preventDefault(),t.stopImmediatePropagation()}function Ea(t){var e=t.document.documentElement,n=yt(t).on("dragstart.drag",Fs,Os);"onselectstart"in e?n.on("selectstart.drag",Fs,Os):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ma(t,e){var n=t.document.documentElement,s=yt(t).on("dragstart.drag",null);e&&(s.on("click.drag",Fs,Os),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Re=0,He=0,Fe=0,Na=1e3,Mn,qe,Nn=0,xe=0,Gn=0,Ze=typeof performance=="object"&&performance.now?performance:Date,za=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ci(){return xe||(za(Gd),xe=Ze.now()+Gn)}function Gd(){xe=0}function zn(){this._call=this._time=this._next=null}zn.prototype=Da.prototype={constructor:zn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?ci():+n)+(e==null?0:+e),!this._next&&qe!==this&&(qe?qe._next=this:Mn=this,qe=this),this._call=t,this._time=n,Bs()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bs())}};function Da(t,e,n){var s=new zn;return s.restart(t,e,n),s}function Kd(){ci(),++Re;for(var t=Mn,e;t;)(e=xe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Re}function er(){xe=(Nn=Ze.now())+Gn,Re=He=0;try{Kd()}finally{Re=0,Jd(),xe=0}}function Zd(){var t=Ze.now(),e=t-Nn;e>Na&&(Gn-=e,Nn=t)}function Jd(){for(var t,e=Mn,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Mn=n);qe=t,Bs(s)}function Bs(t){if(!Re){He&&(He=clearTimeout(He));var e=t-xe;e>24?(t<1/0&&(He=setTimeout(er,t-Ze.now()-Gn)),Fe&&(Fe=clearInterval(Fe))):(Fe||(Nn=Ze.now(),Fe=setInterval(Zd,Na)),Re=1,za(er))}}function nr(t,e,n){var s=new zn;return e=e==null?0:+e,s.restart(i=>{s.stop(),t(i+e)},e,n),s}var Qd=An("start","end","cancel","interrupt"),Id=[],La=0,sr=1,Hs=2,mn=3,ir=4,qs=5,yn=6;function Kn(t,e,n,s,i,a){var r=t.__transition;if(!r)t.__transition={};else if(n in r)return;th(t,n,{name:e,index:s,group:i,on:Qd,tween:Id,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:La})}function li(t,e){var n=Ut(t,e);if(n.state>La)throw new Error("too late; already scheduled");return n}function Xt(t,e){var n=Ut(t,e);if(n.state>mn)throw new Error("too late; already running");return n}function Ut(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function th(t,e,n){var s=t.__transition,i;s[e]=n,n.timer=Da(a,0,n.time);function a(d){n.state=sr,n.timer.restart(r,n.delay,n.time),n.delay<=d&&r(d-n.delay)}function r(d){var h,l,p,f;if(n.state!==sr)return c();for(h in s)if(f=s[h],f.name===n.name){if(f.state===mn)return nr(r);f.state===ir?(f.state=yn,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete s[h]):+h<e&&(f.state=yn,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete s[h])}if(nr(function(){n.state===mn&&(n.state=ir,n.timer.restart(u,n.delay,n.time),u(d))}),n.state=Hs,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Hs){for(n.state=mn,i=new Array(p=n.tween.length),h=0,l=-1;h<p;++h)(f=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++l]=f);i.length=l+1}}function u(d){for(var h=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=qs,1),l=-1,p=i.length;++l<p;)i[l].call(t,h);n.state===qs&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=yn,n.timer.stop(),delete s[e];for(var d in s)return;delete t.__transition}}function Te(t,e){var n=t.__transition,s,i,a=!0,r;if(n){e=e==null?null:e+"";for(r in n){if((s=n[r]).name!==e){a=!1;continue}i=s.state>Hs&&s.state<qs,s.state=yn,s.timer.stop(),s.on.call(i?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[r]}a&&delete t.__transition}}function eh(t){return this.each(function(){Te(this,t)})}function nh(t,e){var n,s;return function(){var i=Xt(this,t),a=i.tween;if(a!==n){s=n=a;for(var r=0,u=s.length;r<u;++r)if(s[r].name===e){s=s.slice(),s.splice(r,1);break}}i.tween=s}}function sh(t,e,n){var s,i;if(typeof n!="function")throw new Error;return function(){var a=Xt(this,t),r=a.tween;if(r!==s){i=(s=r).slice();for(var u={name:e,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===e){i[c]=u;break}c===d&&i.push(u)}a.tween=i}}function ih(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=Ut(this.node(),n).tween,i=0,a=s.length,r;i<a;++i)if((r=s[i]).name===t)return r.value;return null}return this.each((e==null?nh:sh)(n,t,e))}function ui(t,e,n){var s=t._id;return t.each(function(){var i=Xt(this,s);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Ut(i,s).value[e]}}function $a(t,e){var n;return(typeof e=="number"?ue:e instanceof Fi?Bi:(n=Fi(e))?(e=n,Bi):Xo)(t,e)}function rh(t){return function(){this.removeAttribute(t)}}function ah(t){return function(){this.removeAttributeNS(t.space,t.local)}}function oh(t,e,n){var s,i=n+"",a;return function(){var r=this.getAttribute(t);return r===i?null:r===s?a:a=e(s=r,n)}}function ch(t,e,n){var s,i=n+"",a;return function(){var r=this.getAttributeNS(t.space,t.local);return r===i?null:r===s?a:a=e(s=r,n)}}function lh(t,e,n){var s,i,a;return function(){var r,u=n(this),c;return u==null?void this.removeAttribute(t):(r=this.getAttribute(t),c=u+"",r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u)))}}function uh(t,e,n){var s,i,a;return function(){var r,u=n(this),c;return u==null?void this.removeAttributeNS(t.space,t.local):(r=this.getAttributeNS(t.space,t.local),c=u+"",r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u)))}}function dh(t,e){var n=Xn(t),s=n==="transform"?qc:$a;return this.attrTween(t,typeof e=="function"?(n.local?uh:lh)(n,s,ui(this,"attr."+t,e)):e==null?(n.local?ah:rh)(n):(n.local?ch:oh)(n,s,e))}function hh(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function fh(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function ph(t,e){var n,s;function i(){var a=e.apply(this,arguments);return a!==s&&(n=(s=a)&&fh(t,a)),n}return i._value=e,i}function gh(t,e){var n,s;function i(){var a=e.apply(this,arguments);return a!==s&&(n=(s=a)&&hh(t,a)),n}return i._value=e,i}function xh(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=Xn(t);return this.tween(n,(s.local?ph:gh)(s,e))}function mh(t,e){return function(){li(this,t).delay=+e.apply(this,arguments)}}function yh(t,e){return e=+e,function(){li(this,t).delay=e}}function _h(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mh:yh)(e,t)):Ut(this.node(),e).delay}function vh(t,e){return function(){Xt(this,t).duration=+e.apply(this,arguments)}}function wh(t,e){return e=+e,function(){Xt(this,t).duration=e}}function kh(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?vh:wh)(e,t)):Ut(this.node(),e).duration}function bh(t,e){if(typeof e!="function")throw new Error;return function(){Xt(this,t).ease=e}}function Th(t){var e=this._id;return arguments.length?this.each(bh(e,t)):Ut(this.node(),e).ease}function Sh(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Xt(this,t).ease=n}}function jh(t){if(typeof t!="function")throw new Error;return this.each(Sh(this._id,t))}function Ch(t){typeof t!="function"&&(t=_a(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=[],c,d=0;d<r;++d)(c=a[d])&&t.call(c,c.__data__,d,a)&&u.push(c);return new ee(s,this._parents,this._name,this._id)}function Rh(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,i=n.length,a=Math.min(s,i),r=new Array(s),u=0;u<a;++u)for(var c=e[u],d=n[u],h=c.length,l=r[u]=new Array(h),p,f=0;f<h;++f)(p=c[f]||d[f])&&(l[f]=p);for(;u<s;++u)r[u]=e[u];return new ee(r,this._parents,this._name,this._id)}function Eh(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Mh(t,e,n){var s,i,a=Eh(e)?li:Xt;return function(){var r=a(this,t),u=r.on;u!==s&&(i=(s=u).copy()).on(e,n),r.on=i}}function Nh(t,e){var n=this._id;return arguments.length<2?Ut(this.node(),n).on.on(t):this.each(Mh(n,t,e))}function zh(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Dh(){return this.on("end.remove",zh(this._id))}function Lh(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ai(t));for(var s=this._groups,i=s.length,a=new Array(i),r=0;r<i;++r)for(var u=s[r],c=u.length,d=a[r]=new Array(c),h,l,p=0;p<c;++p)(h=u[p])&&(l=t.call(h,h.__data__,p,u))&&("__data__"in h&&(l.__data__=h.__data__),d[p]=l,Kn(d[p],e,n,p,d,Ut(h,n)));return new ee(a,this._parents,e,n)}function $h(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ya(t));for(var s=this._groups,i=s.length,a=[],r=[],u=0;u<i;++u)for(var c=s[u],d=c.length,h,l=0;l<d;++l)if(h=c[l]){for(var p=t.call(h,h.__data__,l,c),f,w=Ut(h,n),b=0,g=p.length;b<g;++b)(f=p[b])&&Kn(f,e,n,b,p,w);a.push(p),r.push(h)}return new ee(a,r,e,n)}var Oh=tn.prototype.constructor;function Fh(){return new Oh(this._groups,this._parents)}function Bh(t,e){var n,s,i;return function(){var a=Ce(this,t),r=(this.style.removeProperty(t),Ce(this,t));return a===r?null:a===n&&r===s?i:i=e(n=a,s=r)}}function Oa(t){return function(){this.style.removeProperty(t)}}function Hh(t,e,n){var s,i=n+"",a;return function(){var r=Ce(this,t);return r===i?null:r===s?a:a=e(s=r,n)}}function qh(t,e,n){var s,i,a;return function(){var r=Ce(this,t),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(t),Ce(this,t))),r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u))}}function Vh(t,e){var n,s,i,a="style."+e,r="end."+a,u;return function(){var c=Xt(this,t),d=c.on,h=c.value[a]==null?u||(u=Oa(e)):void 0;(d!==n||i!==h)&&(s=(n=d).copy()).on(r,i=h),c.on=s}}function Uh(t,e,n){var s=(t+="")=="transform"?Hc:$a;return e==null?this.styleTween(t,Bh(t,s)).on("end.style."+t,Oa(t)):typeof e=="function"?this.styleTween(t,qh(t,s,ui(this,"style."+t,e))).each(Vh(this._id,t)):this.styleTween(t,Hh(t,s,e),n).on("end.style."+t,null)}function Wh(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function Ph(t,e,n){var s,i;function a(){var r=e.apply(this,arguments);return r!==i&&(s=(i=r)&&Wh(t,r,n)),s}return a._value=e,a}function Yh(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,Ph(t,e,n??""))}function Ah(t){return function(){this.textContent=t}}function Xh(t){return function(){var e=t(this);this.textContent=e??""}}function Gh(t){return this.tween("text",typeof t=="function"?Xh(ui(this,"text",t)):Ah(t==null?"":t+""))}function Kh(t){return function(e){this.textContent=t.call(this,e)}}function Zh(t){var e,n;function s(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Kh(i)),e}return s._value=t,s}function Jh(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Zh(t))}function Qh(){for(var t=this._name,e=this._id,n=Fa(),s=this._groups,i=s.length,a=0;a<i;++a)for(var r=s[a],u=r.length,c,d=0;d<u;++d)if(c=r[d]){var h=Ut(c,e);Kn(c,t,n,d,r,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new ee(s,this._parents,t,n)}function Ih(){var t,e,n=this,s=n._id,i=n.size();return new Promise(function(a,r){var u={value:r},c={value:function(){--i===0&&a()}};n.each(function(){var d=Xt(this,s),h=d.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(c)),d.on=e}),i===0&&a()})}var tf=0;function ee(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function Fa(){return++tf}var Kt=tn.prototype;ee.prototype={constructor:ee,select:Lh,selectAll:$h,selectChild:Kt.selectChild,selectChildren:Kt.selectChildren,filter:Ch,merge:Rh,selection:Fh,transition:Qh,call:Kt.call,nodes:Kt.nodes,node:Kt.node,size:Kt.size,empty:Kt.empty,each:Kt.each,on:Nh,attr:dh,attrTween:xh,style:Uh,styleTween:Yh,text:Gh,textTween:Jh,remove:Dh,tween:ih,delay:_h,duration:kh,ease:Th,easeVarying:jh,end:Ih,[Symbol.iterator]:Kt[Symbol.iterator]};function ef(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var nf={time:null,delay:0,duration:250,ease:ef};function sf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function rf(t){var e,n;t instanceof ee?(e=t._id,t=t._name):(e=Fa(),(n=nf).time=ci(),t=t==null?null:t+"");for(var s=this._groups,i=s.length,a=0;a<i;++a)for(var r=s[a],u=r.length,c,d=0;d<u;++d)(c=r[d])&&Kn(c,t,e,d,r,n||sf(c,e));return new ee(s,this._parents,t,e)}tn.prototype.interrupt=eh;tn.prototype.transition=rf;const fs=t=>()=>t;function af(t,{sourceEvent:e,target:n,selection:s,mode:i,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:s,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function of(t){t.stopImmediatePropagation()}function ps(t){t.preventDefault(),t.stopImmediatePropagation()}var rr={name:"drag"},gs={name:"space"},_e={name:"handle"},ve={name:"center"};const{abs:ar,max:jt,min:Ct}=Math;function or(t){return[+t[0],+t[1]]}function cr(t){return[or(t[0]),or(t[1])]}var _n={name:"x",handles:["w","e"].map(Dn),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},vn={name:"y",handles:["n","s"].map(Dn),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Zt={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},lr={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},ur={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},cf={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},lf={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Dn(t){return{type:t}}function uf(t){return!t.ctrlKey&&!t.button}function df(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function hf(){return navigator.maxTouchPoints||"ontouchstart"in this}function xs(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function ff(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function pf(){return Ba(_n)}function gf(){return Ba(vn)}function Ba(t){var e=df,n=uf,s=hf,i=!0,a=An("start","brush","end"),r=6,u;function c(g){var m=g.property("__brush",b).selectAll(".overlay").data([Dn("overlay")]);m.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Zt.overlay).merge(m).each(function(){var T=xs(this).extent;yt(this).attr("x",T[0][0]).attr("y",T[0][1]).attr("width",T[1][0]-T[0][0]).attr("height",T[1][1]-T[0][1])}),g.selectAll(".selection").data([Dn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Zt.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var S=g.selectAll(".handle").data(t.handles,function(T){return T.type});S.exit().remove(),S.enter().append("rect").attr("class",function(T){return"handle handle--"+T.type}).attr("cursor",function(T){return Zt[T.type]}),g.each(d).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",p).filter(s).on("touchstart.brush",p).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(g,m,S){g.tween?g.on("start.brush",function(T){h(this,arguments).beforestart().start(T)}).on("interrupt.brush end.brush",function(T){h(this,arguments).end(T)}).tween("brush",function(){var T=this,j=T.__brush,R=h(T,arguments),M=j.selection,N=t.input(typeof m=="function"?m.apply(this,arguments):m,j.extent),C=Go(M,N);function L(O){j.selection=O===1&&N===null?null:C(O),d.call(T),R.brush()}return M!==null&&N!==null?L:L(1)}):g.each(function(){var T=this,j=arguments,R=T.__brush,M=t.input(typeof m=="function"?m.apply(T,j):m,R.extent),N=h(T,j).beforestart();Te(T),R.selection=M===null?null:M,d.call(T),N.start(S).brush(S).end(S)})},c.clear=function(g,m){c.move(g,null,m)};function d(){var g=yt(this),m=xs(this).selection;m?(g.selectAll(".selection").style("display",null).attr("x",m[0][0]).attr("y",m[0][1]).attr("width",m[1][0]-m[0][0]).attr("height",m[1][1]-m[0][1]),g.selectAll(".handle").style("display",null).attr("x",function(S){return S.type[S.type.length-1]==="e"?m[1][0]-r/2:m[0][0]-r/2}).attr("y",function(S){return S.type[0]==="s"?m[1][1]-r/2:m[0][1]-r/2}).attr("width",function(S){return S.type==="n"||S.type==="s"?m[1][0]-m[0][0]+r:r}).attr("height",function(S){return S.type==="e"||S.type==="w"?m[1][1]-m[0][1]+r:r})):g.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(g,m,S){var T=g.__brush.emitter;return T&&(!S||!T.clean)?T:new l(g,m,S)}function l(g,m,S){this.that=g,this.args=m,this.state=g.__brush,this.active=0,this.clean=S}l.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(g,m){return this.starting?(this.starting=!1,this.emit("start",g,m)):this.emit("brush",g),this},brush:function(g,m){return this.emit("brush",g,m),this},end:function(g,m){return--this.active===0&&(delete this.state.emitter,this.emit("end",g,m)),this},emit:function(g,m,S){var T=yt(this.that).datum();a.call(g,this.that,new af(g,{sourceEvent:m,target:c,selection:t.output(this.state.selection),mode:S,dispatch:a}),T)}};function p(g){if(u&&!g.touches||!n.apply(this,arguments))return;var m=this,S=g.target.__data__.type,T=(i&&g.metaKey?S="overlay":S)==="selection"?rr:i&&g.altKey?ve:_e,j=t===vn?null:cf[S],R=t===_n?null:lf[S],M=xs(m),N=M.extent,C=M.selection,L=N[0][0],O,A,P=N[0][1],D,x,v=N[1][0],y,k,E=N[1][1],z,$,B=0,H=0,nt,Q=j&&R&&i&&g.shiftKey,U,Y,X=Array.from(g.touches||[g],q=>{const K=q.identifier;return q=Pt(q,m),q.point0=q.slice(),q.identifier=K,q});Te(m);var st=h(m,arguments,!0).beforestart();if(S==="overlay"){C&&(nt=!0);const q=[X[0],X[1]||X[0]];M.selection=C=[[O=t===vn?L:Ct(q[0][0],q[1][0]),D=t===_n?P:Ct(q[0][1],q[1][1])],[y=t===vn?v:jt(q[0][0],q[1][0]),z=t===_n?E:jt(q[0][1],q[1][1])]],X.length>1&&Z(g)}else O=C[0][0],D=C[0][1],y=C[1][0],z=C[1][1];A=O,x=D,k=y,$=z;var ct=yt(m).attr("pointer-events","none"),gt=ct.selectAll(".overlay").attr("cursor",Zt[S]);if(g.touches)st.moved=G,st.ended=pt;else{var xt=yt(g.view).on("mousemove.brush",G,!0).on("mouseup.brush",pt,!0);i&&xt.on("keydown.brush",it,!0).on("keyup.brush",vt,!0),Ea(g.view)}d.call(m),st.start(g,T.name);function G(q){for(const K of q.changedTouches||[q])for(const rt of X)rt.identifier===K.identifier&&(rt.cur=Pt(K,m));if(Q&&!U&&!Y&&X.length===1){const K=X[0];ar(K.cur[0]-K[0])>ar(K.cur[1]-K[1])?Y=!0:U=!0}for(const K of X)K.cur&&(K[0]=K.cur[0],K[1]=K.cur[1]);nt=!0,ps(q),Z(q)}function Z(q){const K=X[0],rt=K.point0;var ht;switch(B=K[0]-rt[0],H=K[1]-rt[1],T){case gs:case rr:{j&&(B=jt(L-O,Ct(v-y,B)),A=O+B,k=y+B),R&&(H=jt(P-D,Ct(E-z,H)),x=D+H,$=z+H);break}case _e:{X[1]?(j&&(A=jt(L,Ct(v,X[0][0])),k=jt(L,Ct(v,X[1][0])),j=1),R&&(x=jt(P,Ct(E,X[0][1])),$=jt(P,Ct(E,X[1][1])),R=1)):(j<0?(B=jt(L-O,Ct(v-O,B)),A=O+B,k=y):j>0&&(B=jt(L-y,Ct(v-y,B)),A=O,k=y+B),R<0?(H=jt(P-D,Ct(E-D,H)),x=D+H,$=z):R>0&&(H=jt(P-z,Ct(E-z,H)),x=D,$=z+H));break}case ve:{j&&(A=jt(L,Ct(v,O-B*j)),k=jt(L,Ct(v,y+B*j))),R&&(x=jt(P,Ct(E,D-H*R)),$=jt(P,Ct(E,z+H*R)));break}}k<A&&(j*=-1,ht=O,O=y,y=ht,ht=A,A=k,k=ht,S in lr&&gt.attr("cursor",Zt[S=lr[S]])),$<x&&(R*=-1,ht=D,D=z,z=ht,ht=x,x=$,$=ht,S in ur&&gt.attr("cursor",Zt[S=ur[S]])),M.selection&&(C=M.selection),U&&(A=C[0][0],k=C[1][0]),Y&&(x=C[0][1],$=C[1][1]),(C[0][0]!==A||C[0][1]!==x||C[1][0]!==k||C[1][1]!==$)&&(M.selection=[[A,x],[k,$]],d.call(m),st.brush(q,T.name))}function pt(q){if(of(q),q.touches){if(q.touches.length)return;u&&clearTimeout(u),u=setTimeout(function(){u=null},500)}else Ma(q.view,nt),xt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);ct.attr("pointer-events","all"),gt.attr("cursor",Zt.overlay),M.selection&&(C=M.selection),ff(C)&&(M.selection=null,d.call(m)),st.end(q,T.name)}function it(q){switch(q.keyCode){case 16:{Q=j&&R;break}case 18:{T===_e&&(j&&(y=k-B*j,O=A+B*j),R&&(z=$-H*R,D=x+H*R),T=ve,Z(q));break}case 32:{(T===_e||T===ve)&&(j<0?y=k-B:j>0&&(O=A-B),R<0?z=$-H:R>0&&(D=x-H),T=gs,gt.attr("cursor",Zt.selection),Z(q));break}default:return}ps(q)}function vt(q){switch(q.keyCode){case 16:{Q&&(U=Y=Q=!1,Z(q));break}case 18:{T===ve&&(j<0?y=k:j>0&&(O=A),R<0?z=$:R>0&&(D=x),T=_e,Z(q));break}case 32:{T===gs&&(q.altKey?(j&&(y=k-B*j,O=A+B*j),R&&(z=$-H*R,D=x+H*R),T=ve):(j<0?y=k:j>0&&(O=A),R<0?z=$:R>0&&(D=x),T=_e),gt.attr("cursor",Zt[S]),Z(q));break}default:return}ps(q)}}function f(g){h(this,arguments).moved(g)}function w(g){h(this,arguments).ended(g)}function b(){var g=this.__brush||{selection:null};return g.extent=cr(e.apply(this,arguments)),g.dim=t,g}return c.extent=function(g){return arguments.length?(e=typeof g=="function"?g:fs(cr(g)),c):e},c.filter=function(g){return arguments.length?(n=typeof g=="function"?g:fs(!!g),c):n},c.touchable=function(g){return arguments.length?(s=typeof g=="function"?g:fs(!!g),c):s},c.handleSize=function(g){return arguments.length?(r=+g,c):r},c.keyModifiers=function(g){return arguments.length?(i=!!g,c):i},c.on=function(){var g=a.on.apply(a,arguments);return g===a?c:g},c}const dn=t=>()=>t;function xf(t,{sourceEvent:e,target:n,transform:s,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function It(t,e,n){this.k=t,this.x=e,this.y=n}It.prototype={constructor:It,scale:function(t){return t===1?this:new It(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new It(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zn=new It(1,0,0);It.prototype;function ms(t){t.stopImmediatePropagation()}function Be(t){t.preventDefault(),t.stopImmediatePropagation()}function mf(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function yf(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function dr(){return this.__zoom||Zn}function _f(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function vf(){return navigator.maxTouchPoints||"ontouchstart"in this}function wf(t,e,n){var s=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],r=t.invertY(e[1][1])-n[1][1];return t.translate(i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i),r>a?(a+r)/2:Math.min(0,a)||Math.max(0,r))}function Ha(){var t=mf,e=yf,n=wf,s=_f,i=vf,a=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],u=250,c=Pc,d=An("start","zoom","end"),h,l,p,f=500,w=150,b=0,g=10;function m(x){x.property("__zoom",dr).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",O).filter(i).on("touchstart.zoom",A).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(x,v,y,k){var E=x.selection?x.selection():x;E.property("__zoom",dr),x!==E?R(x,v,y,k):E.interrupt().each(function(){M(this,arguments).event(k).start().zoom(null,typeof v=="function"?v.apply(this,arguments):v).end()})},m.scaleBy=function(x,v,y,k){m.scaleTo(x,function(){var E=this.__zoom.k,z=typeof v=="function"?v.apply(this,arguments):v;return E*z},y,k)},m.scaleTo=function(x,v,y,k){m.transform(x,function(){var E=e.apply(this,arguments),z=this.__zoom,$=y==null?j(E):typeof y=="function"?y.apply(this,arguments):y,B=z.invert($),H=typeof v=="function"?v.apply(this,arguments):v;return n(T(S(z,H),$,B),E,r)},y,k)},m.translateBy=function(x,v,y,k){m.transform(x,function(){return n(this.__zoom.translate(typeof v=="function"?v.apply(this,arguments):v,typeof y=="function"?y.apply(this,arguments):y),e.apply(this,arguments),r)},null,k)},m.translateTo=function(x,v,y,k,E){m.transform(x,function(){var z=e.apply(this,arguments),$=this.__zoom,B=k==null?j(z):typeof k=="function"?k.apply(this,arguments):k;return n(Zn.translate(B[0],B[1]).scale($.k).translate(typeof v=="function"?-v.apply(this,arguments):-v,typeof y=="function"?-y.apply(this,arguments):-y),z,r)},k,E)};function S(x,v){return v=Math.max(a[0],Math.min(a[1],v)),v===x.k?x:new It(v,x.x,x.y)}function T(x,v,y){var k=v[0]-y[0]*x.k,E=v[1]-y[1]*x.k;return k===x.x&&E===x.y?x:new It(x.k,k,E)}function j(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function R(x,v,y,k){x.on("start.zoom",function(){M(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(k).end()}).tween("zoom",function(){var E=this,z=arguments,$=M(E,z).event(k),B=e.apply(E,z),H=y==null?j(B):typeof y=="function"?y.apply(E,z):y,nt=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),Q=E.__zoom,U=typeof v=="function"?v.apply(E,z):v,Y=c(Q.invert(H).concat(nt/Q.k),U.invert(H).concat(nt/U.k));return function(X){if(X===1)X=U;else{var st=Y(X),ct=nt/st[2];X=new It(ct,H[0]-st[0]*ct,H[1]-st[1]*ct)}$.zoom(null,X)}})}function M(x,v,y){return!y&&x.__zooming||new N(x,v)}function N(x,v){this.that=x,this.args=v,this.active=0,this.sourceEvent=null,this.extent=e.apply(x,v),this.taps=0}N.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,v){return this.mouse&&x!=="mouse"&&(this.mouse[1]=v.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=v.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=v.invert(this.touch1[0])),this.that.__zoom=v,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var v=yt(this.that).datum();d.call(x,this.that,new xf(x,{sourceEvent:this.sourceEvent,target:m,type:x,transform:this.that.__zoom,dispatch:d}),v)}};function C(x,...v){if(!t.apply(this,arguments))return;var y=M(this,v).event(x),k=this.__zoom,E=Math.max(a[0],Math.min(a[1],k.k*Math.pow(2,s.apply(this,arguments)))),z=Pt(x);if(y.wheel)(y.mouse[0][0]!==z[0]||y.mouse[0][1]!==z[1])&&(y.mouse[1]=k.invert(y.mouse[0]=z)),clearTimeout(y.wheel);else{if(k.k===E)return;y.mouse=[z,k.invert(z)],Te(this),y.start()}Be(x),y.wheel=setTimeout($,w),y.zoom("mouse",n(T(S(k,E),y.mouse[0],y.mouse[1]),y.extent,r));function $(){y.wheel=null,y.end()}}function L(x,...v){if(p||!t.apply(this,arguments))return;var y=x.currentTarget,k=M(this,v,!0).event(x),E=yt(x.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",nt,!0),z=Pt(x,y),$=x.clientX,B=x.clientY;Ea(x.view),ms(x),k.mouse=[z,this.__zoom.invert(z)],Te(this),k.start();function H(Q){if(Be(Q),!k.moved){var U=Q.clientX-$,Y=Q.clientY-B;k.moved=U*U+Y*Y>b}k.event(Q).zoom("mouse",n(T(k.that.__zoom,k.mouse[0]=Pt(Q,y),k.mouse[1]),k.extent,r))}function nt(Q){E.on("mousemove.zoom mouseup.zoom",null),Ma(Q.view,k.moved),Be(Q),k.event(Q).end()}}function O(x,...v){if(t.apply(this,arguments)){var y=this.__zoom,k=Pt(x.changedTouches?x.changedTouches[0]:x,this),E=y.invert(k),z=y.k*(x.shiftKey?.5:2),$=n(T(S(y,z),k,E),e.apply(this,v),r);Be(x),u>0?yt(this).transition().duration(u).call(R,$,k,x):yt(this).call(m.transform,$,k,x)}}function A(x,...v){if(t.apply(this,arguments)){var y=x.touches,k=y.length,E=M(this,v,x.changedTouches.length===k).event(x),z,$,B,H;for(ms(x),$=0;$<k;++$)B=y[$],H=Pt(B,this),H=[H,this.__zoom.invert(H),B.identifier],E.touch0?!E.touch1&&E.touch0[2]!==H[2]&&(E.touch1=H,E.taps=0):(E.touch0=H,z=!0,E.taps=1+!!h);h&&(h=clearTimeout(h)),z&&(E.taps<2&&(l=H[0],h=setTimeout(function(){h=null},f)),Te(this),E.start())}}function P(x,...v){if(this.__zooming){var y=M(this,v).event(x),k=x.changedTouches,E=k.length,z,$,B,H;for(Be(x),z=0;z<E;++z)$=k[z],B=Pt($,this),y.touch0&&y.touch0[2]===$.identifier?y.touch0[0]=B:y.touch1&&y.touch1[2]===$.identifier&&(y.touch1[0]=B);if($=y.that.__zoom,y.touch1){var nt=y.touch0[0],Q=y.touch0[1],U=y.touch1[0],Y=y.touch1[1],X=(X=U[0]-nt[0])*X+(X=U[1]-nt[1])*X,st=(st=Y[0]-Q[0])*st+(st=Y[1]-Q[1])*st;$=S($,Math.sqrt(X/st)),B=[(nt[0]+U[0])/2,(nt[1]+U[1])/2],H=[(Q[0]+Y[0])/2,(Q[1]+Y[1])/2]}else if(y.touch0)B=y.touch0[0],H=y.touch0[1];else return;y.zoom("touch",n(T($,B,H),y.extent,r))}}function D(x,...v){if(this.__zooming){var y=M(this,v).event(x),k=x.changedTouches,E=k.length,z,$;for(ms(x),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),z=0;z<E;++z)$=k[z],y.touch0&&y.touch0[2]===$.identifier?delete y.touch0:y.touch1&&y.touch1[2]===$.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&($=Pt($,this),Math.hypot(l[0]-$[0],l[1]-$[1])<g)){var B=yt(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return m.wheelDelta=function(x){return arguments.length?(s=typeof x=="function"?x:dn(+x),m):s},m.filter=function(x){return arguments.length?(t=typeof x=="function"?x:dn(!!x),m):t},m.touchable=function(x){return arguments.length?(i=typeof x=="function"?x:dn(!!x),m):i},m.extent=function(x){return arguments.length?(e=typeof x=="function"?x:dn([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),m):e},m.scaleExtent=function(x){return arguments.length?(a[0]=+x[0],a[1]=+x[1],m):[a[0],a[1]]},m.translateExtent=function(x){return arguments.length?(r[0][0]=+x[0][0],r[1][0]=+x[1][0],r[0][1]=+x[0][1],r[1][1]=+x[1][1],m):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},m.constrain=function(x){return arguments.length?(n=x,m):n},m.duration=function(x){return arguments.length?(u=+x,m):u},m.interpolate=function(x){return arguments.length?(c=x,m):c},m.on=function(){var x=d.on.apply(d,arguments);return x===d?m:x},m.clickDistance=function(x){return arguments.length?(b=(x=+x)*x,m):Math.sqrt(b)},m.tapDistance=function(x){return arguments.length?(g=+x,m):g},m}var _t=(t=>(t.LOWER="LOWER",t.UPPER="UPPER",t))(_t||{});const Ln={[ut.LOWEST]:{initialMin:.99,initialMax:1.01,min:1e-5,max:1.5},[ut.LOW]:{initialMin:.8,initialMax:1.25,min:1e-5,max:1.5},[ut.MEDIUM]:{initialMin:.5,initialMax:1.5,min:1e-5,max:20},[ut.HIGH]:{initialMin:.5,initialMax:1.5,min:1e-5,max:20}};ut.LOWEST+"",ut.LOW+"",ut.MEDIUM+"",Ln[ut.MEDIUM],ut.HIGH+"",Ln[ut.HIGH];function kf(t,e,n,s){for(var i=-1,a=t==null?0:t.length;++i<a;){var r=t[i];e(s,r,n(r),t)}return s}var bf=kf,Tf=Ko;function Sf(t,e,n,s){return Tf(t,function(i,a,r){e(s,i,n(i),r)}),s}var jf=Sf,Cf=bf,Rf=jf,Ef=Zo,Mf=Jo;function Nf(t,e){return function(n,s){var i=Mf(n)?Cf:Rf,a=e?e():{};return i(n,t,Ef(s),a)}}var zf=Nf,Df=zf,Lf=Df(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),$f=Lf;const Of=Qo($f);var Nt=function(){return Nt=Object.assign||function(e){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Nt.apply(this,arguments)};function $n(t,e,n){if(n||arguments.length===2)for(var s=0,i=e.length,a;s<i;s++)(a||!(s in e))&&(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))}var mt="-ms-",We="-moz-",ot="-webkit-",qa="comm",Jn="rule",di="decl",Ff="@import",Va="@keyframes",Bf="@layer",Ua=Math.abs,hi=String.fromCharCode,Vs=Object.assign;function Hf(t,e){return bt(t,0)^45?(((e<<2^bt(t,0))<<2^bt(t,1))<<2^bt(t,2))<<2^bt(t,3):0}function Wa(t){return t.trim()}function Jt(t,e){return(t=e.exec(t))?t[0]:t}function tt(t,e,n){return t.replace(e,n)}function wn(t,e,n){return t.indexOf(e,n)}function bt(t,e){return t.charCodeAt(e)|0}function Ee(t,e,n){return t.slice(e,n)}function Yt(t){return t.length}function Pa(t){return t.length}function Ve(t,e){return e.push(t),t}function qf(t,e){return t.map(e).join("")}function hr(t,e){return t.filter(function(n){return!Jt(n,e)})}var Qn=1,Me=1,Ya=0,Ht=0,kt=0,Le="";function In(t,e,n,s,i,a,r,u){return{value:t,root:e,parent:n,type:s,props:i,children:a,line:Qn,column:Me,length:r,return:"",siblings:u}}function se(t,e){return Vs(In("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function we(t){for(;t.root;)t=se(t.root,{children:[t]});Ve(t,t.siblings)}function Vf(){return kt}function Uf(){return kt=Ht>0?bt(Le,--Ht):0,Me--,kt===10&&(Me=1,Qn--),kt}function Vt(){return kt=Ht<Ya?bt(Le,Ht++):0,Me++,kt===10&&(Me=1,Qn++),kt}function fe(){return bt(Le,Ht)}function kn(){return Ht}function ts(t,e){return Ee(Le,t,e)}function Us(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Wf(t){return Qn=Me=1,Ya=Yt(Le=t),Ht=0,[]}function Pf(t){return Le="",t}function ys(t){return Wa(ts(Ht-1,Ws(t===91?t+2:t===40?t+1:t)))}function Yf(t){for(;(kt=fe())&&kt<33;)Vt();return Us(t)>2||Us(kt)>3?"":" "}function Af(t,e){for(;--e&&Vt()&&!(kt<48||kt>102||kt>57&&kt<65||kt>70&&kt<97););return ts(t,kn()+(e<6&&fe()==32&&Vt()==32))}function Ws(t){for(;Vt();)switch(kt){case t:return Ht;case 34:case 39:t!==34&&t!==39&&Ws(kt);break;case 40:t===41&&Ws(t);break;case 92:Vt();break}return Ht}function Xf(t,e){for(;Vt()&&t+kt!==57;)if(t+kt===84&&fe()===47)break;return"/*"+ts(e,Ht-1)+"*"+hi(t===47?t:Vt())}function Gf(t){for(;!Us(fe());)Vt();return ts(t,Ht)}function Kf(t){return Pf(bn("",null,null,null,[""],t=Wf(t),0,[0],t))}function bn(t,e,n,s,i,a,r,u,c){for(var d=0,h=0,l=r,p=0,f=0,w=0,b=1,g=1,m=1,S=0,T="",j=i,R=a,M=s,N=T;g;)switch(w=S,S=Vt()){case 40:if(w!=108&&bt(N,l-1)==58){wn(N+=tt(ys(S),"&","&\f"),"&\f",Ua(d?u[d-1]:0))!=-1&&(m=-1);break}case 34:case 39:case 91:N+=ys(S);break;case 9:case 10:case 13:case 32:N+=Yf(w);break;case 92:N+=Af(kn()-1,7);continue;case 47:switch(fe()){case 42:case 47:Ve(Zf(Xf(Vt(),kn()),e,n,c),c);break;default:N+="/"}break;case 123*b:u[d++]=Yt(N)*m;case 125*b:case 59:case 0:switch(S){case 0:case 125:g=0;case 59+h:m==-1&&(N=tt(N,/\f/g,"")),f>0&&Yt(N)-l&&Ve(f>32?pr(N+";",s,n,l-1,c):pr(tt(N," ","")+";",s,n,l-2,c),c);break;case 59:N+=";";default:if(Ve(M=fr(N,e,n,d,h,i,u,T,j=[],R=[],l,a),a),S===123)if(h===0)bn(N,e,M,M,j,a,l,u,R);else switch(p===99&&bt(N,3)===110?100:p){case 100:case 108:case 109:case 115:bn(t,M,M,s&&Ve(fr(t,M,M,0,0,i,u,T,i,j=[],l,R),R),i,R,l,u,s?j:R);break;default:bn(N,M,M,M,[""],R,0,u,R)}}d=h=f=0,b=m=1,T=N="",l=r;break;case 58:l=1+Yt(N),f=w;default:if(b<1){if(S==123)--b;else if(S==125&&b++==0&&Uf()==125)continue}switch(N+=hi(S),S*b){case 38:m=h>0?1:(N+="\f",-1);break;case 44:u[d++]=(Yt(N)-1)*m,m=1;break;case 64:fe()===45&&(N+=ys(Vt())),p=fe(),h=l=Yt(T=N+=Gf(kn())),S++;break;case 45:w===45&&Yt(N)==2&&(b=0)}}return a}function fr(t,e,n,s,i,a,r,u,c,d,h,l){for(var p=i-1,f=i===0?a:[""],w=Pa(f),b=0,g=0,m=0;b<s;++b)for(var S=0,T=Ee(t,p+1,p=Ua(g=r[b])),j=t;S<w;++S)(j=Wa(g>0?f[S]+" "+T:tt(T,/&\f/g,f[S])))&&(c[m++]=j);return In(t,e,n,i===0?Jn:u,c,d,h,l)}function Zf(t,e,n,s){return In(t,e,n,qa,hi(Vf()),Ee(t,2,-2),0,s)}function pr(t,e,n,s,i){return In(t,e,n,di,Ee(t,0,s),Ee(t,s+1,-1),s,i)}function Aa(t,e,n){switch(Hf(t,e)){case 5103:return ot+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ot+t+t;case 4789:return We+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return ot+t+We+t+mt+t+t;case 5936:switch(bt(t,e+11)){case 114:return ot+t+mt+tt(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return ot+t+mt+tt(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return ot+t+mt+tt(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return ot+t+mt+t+t;case 6165:return ot+t+mt+"flex-"+t+t;case 5187:return ot+t+tt(t,/(\w+).+(:[^]+)/,ot+"box-$1$2"+mt+"flex-$1$2")+t;case 5443:return ot+t+mt+"flex-item-"+tt(t,/flex-|-self/g,"")+(Jt(t,/flex-|baseline/)?"":mt+"grid-row-"+tt(t,/flex-|-self/g,""))+t;case 4675:return ot+t+mt+"flex-line-pack"+tt(t,/align-content|flex-|-self/g,"")+t;case 5548:return ot+t+mt+tt(t,"shrink","negative")+t;case 5292:return ot+t+mt+tt(t,"basis","preferred-size")+t;case 6060:return ot+"box-"+tt(t,"-grow","")+ot+t+mt+tt(t,"grow","positive")+t;case 4554:return ot+tt(t,/([^-])(transform)/g,"$1"+ot+"$2")+t;case 6187:return tt(tt(tt(t,/(zoom-|grab)/,ot+"$1"),/(image-set)/,ot+"$1"),t,"")+t;case 5495:case 3959:return tt(t,/(image-set\([^]*)/,ot+"$1$`$1");case 4968:return tt(tt(t,/(.+:)(flex-)?(.*)/,ot+"box-pack:$3"+mt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ot+t+t;case 4200:if(!Jt(t,/flex-|baseline/))return mt+"grid-column-align"+Ee(t,e)+t;break;case 2592:case 3360:return mt+tt(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(s,i){return e=i,Jt(s.props,/grid-\w+-end/)})?~wn(t+(n=n[e].value),"span",0)?t:mt+tt(t,"-start","")+t+mt+"grid-row-span:"+(~wn(n,"span",0)?Jt(n,/\d+/):+Jt(n,/\d+/)-+Jt(t,/\d+/))+";":mt+tt(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(s){return Jt(s.props,/grid-\w+-start/)})?t:mt+tt(tt(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return tt(t,/(.+)-inline(.+)/,ot+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yt(t)-1-e>6)switch(bt(t,e+1)){case 109:if(bt(t,e+4)!==45)break;case 102:return tt(t,/(.+:)(.+)-([^]+)/,"$1"+ot+"$2-$3$1"+We+(bt(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~wn(t,"stretch",0)?Aa(tt(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return tt(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,i,a,r,u,c,d){return mt+i+":"+a+d+(r?mt+i+"-span:"+(u?c:+c-+a)+d:"")+t});case 4949:if(bt(t,e+6)===121)return tt(t,":",":"+ot)+t;break;case 6444:switch(bt(t,bt(t,14)===45?18:11)){case 120:return tt(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+ot+(bt(t,14)===45?"inline-":"")+"box$3$1"+ot+"$2$3$1"+mt+"$2box$3")+t;case 100:return tt(t,":",":"+mt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return tt(t,"scroll-","scroll-snap-")+t}return t}function On(t,e){for(var n="",s=0;s<t.length;s++)n+=e(t[s],s,t,e)||"";return n}function Jf(t,e,n,s){switch(t.type){case Bf:if(t.children.length)break;case Ff:case di:return t.return=t.return||t.value;case qa:return"";case Va:return t.return=t.value+"{"+On(t.children,s)+"}";case Jn:if(!Yt(t.value=t.props.join(",")))return""}return Yt(n=On(t.children,s))?t.return=t.value+"{"+n+"}":""}function Qf(t){var e=Pa(t);return function(n,s,i,a){for(var r="",u=0;u<e;u++)r+=t[u](n,s,i,a)||"";return r}}function If(t){return function(e){e.root||(e=e.return)&&t(e)}}function t0(t,e,n,s){if(t.length>-1&&!t.return)switch(t.type){case di:t.return=Aa(t.value,t.length,n);return;case Va:return On([se(t,{value:tt(t.value,"@","@"+ot)})],s);case Jn:if(t.length)return qf(n=t.props,function(i){switch(Jt(i,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":we(se(t,{props:[tt(i,/:(read-\w+)/,":"+We+"$1")]})),we(se(t,{props:[i]})),Vs(t,{props:hr(n,s)});break;case"::placeholder":we(se(t,{props:[tt(i,/:(plac\w+)/,":"+ot+"input-$1")]})),we(se(t,{props:[tt(i,/:(plac\w+)/,":"+We+"$1")]})),we(se(t,{props:[tt(i,/:(plac\w+)/,mt+"input-$1")]})),we(se(t,{props:[i]})),Vs(t,{props:hr(n,s)});break}return""})}}var $t={},Ne=typeof js<"u"&&$t!==void 0&&($t.REACT_APP_SC_ATTR||$t.SC_ATTR)||"data-styled",Xa="active",Ga="data-styled-version",es="6.1.11",fi=`/*!sc*/
`,pi=typeof window<"u"&&"HTMLElement"in window,e0=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof js<"u"&&$t!==void 0&&$t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&$t.REACT_APP_SC_DISABLE_SPEEDY!==""?$t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&$t.REACT_APP_SC_DISABLE_SPEEDY:typeof js<"u"&&$t!==void 0&&$t.SC_DISABLE_SPEEDY!==void 0&&$t.SC_DISABLE_SPEEDY!==""&&$t.SC_DISABLE_SPEEDY!=="false"&&$t.SC_DISABLE_SPEEDY),ns=Object.freeze([]),ze=Object.freeze({});function n0(t,e,n){return n===void 0&&(n=ze),t.theme!==n.theme&&t.theme||e||n.theme}var Ka=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),s0=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,i0=/(^-|-$)/g;function gr(t){return t.replace(s0,"-").replace(i0,"")}var r0=/(a)(d)/gi,hn=52,xr=function(t){return String.fromCharCode(t+(t>25?39:97))};function Ps(t){var e,n="";for(e=Math.abs(t);e>hn;e=e/hn|0)n=xr(e%hn)+n;return(xr(e%hn)+n).replace(r0,"$1-$2")}var _s,Za=5381,be=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},Ja=function(t){return be(Za,t)};function a0(t){return Ps(Ja(t)>>>0)}function o0(t){return t.displayName||t.name||"Component"}function vs(t){return typeof t=="string"&&!0}var Qa=typeof Symbol=="function"&&Symbol.for,Ia=Qa?Symbol.for("react.memo"):60115,c0=Qa?Symbol.for("react.forward_ref"):60112,l0={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},u0={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},to={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d0=((_s={})[c0]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},_s[Ia]=to,_s);function mr(t){return("type"in(e=t)&&e.type.$$typeof)===Ia?to:"$$typeof"in t?d0[t.$$typeof]:l0;var e}var h0=Object.defineProperty,f0=Object.getOwnPropertyNames,yr=Object.getOwnPropertySymbols,p0=Object.getOwnPropertyDescriptor,g0=Object.getPrototypeOf,_r=Object.prototype;function eo(t,e,n){if(typeof e!="string"){if(_r){var s=g0(e);s&&s!==_r&&eo(t,s,n)}var i=f0(e);yr&&(i=i.concat(yr(e)));for(var a=mr(t),r=mr(e),u=0;u<i.length;++u){var c=i[u];if(!(c in u0||n&&n[c]||r&&c in r||a&&c in a)){var d=p0(e,c);try{h0(t,c,d)}catch{}}}}return t}function De(t){return typeof t=="function"}function gi(t){return typeof t=="object"&&"styledComponentId"in t}function de(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function vr(t,e){if(t.length===0)return"";for(var n=t[0],s=1;s<t.length;s++)n+=t[s];return n}function Je(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function Ys(t,e,n){if(n===void 0&&(n=!1),!n&&!Je(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var s=0;s<e.length;s++)t[s]=Ys(t[s],e[s]);else if(Je(e))for(var s in e)t[s]=Ys(t[s],e[s]);return t}function xi(t,e){Object.defineProperty(t,"toString",{value:e})}function en(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var x0=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,s=0;s<e;s++)n+=this.groupSizes[s];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var s=this.groupSizes,i=s.length,a=i;e>=a;)if((a<<=1)<0)throw en(16,"".concat(e));this.groupSizes=new Uint32Array(a),this.groupSizes.set(s),this.length=a;for(var r=i;r<a;r++)this.groupSizes[r]=0}for(var u=this.indexOfGroup(e+1),c=(r=0,n.length);r<c;r++)this.tag.insertRule(u,n[r])&&(this.groupSizes[e]++,u++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],s=this.indexOfGroup(e),i=s+n;this.groupSizes[e]=0;for(var a=s;a<i;a++)this.tag.deleteRule(s)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var s=this.groupSizes[e],i=this.indexOfGroup(e),a=i+s,r=i;r<a;r++)n+="".concat(this.tag.getRule(r)).concat(fi);return n},t}(),Tn=new Map,Fn=new Map,Sn=1,fn=function(t){if(Tn.has(t))return Tn.get(t);for(;Fn.has(Sn);)Sn++;var e=Sn++;return Tn.set(t,e),Fn.set(e,t),e},m0=function(t,e){Sn=e+1,Tn.set(t,e),Fn.set(e,t)},y0="style[".concat(Ne,"][").concat(Ga,'="').concat(es,'"]'),_0=new RegExp("^".concat(Ne,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),v0=function(t,e,n){for(var s,i=n.split(","),a=0,r=i.length;a<r;a++)(s=i[a])&&t.registerName(e,s)},w0=function(t,e){for(var n,s=((n=e.textContent)!==null&&n!==void 0?n:"").split(fi),i=[],a=0,r=s.length;a<r;a++){var u=s[a].trim();if(u){var c=u.match(_0);if(c){var d=0|parseInt(c[1],10),h=c[2];d!==0&&(m0(h,d),v0(t,h,c[3]),t.getTag().insertRules(d,i)),i.length=0}else i.push(u)}}};function k0(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var no=function(t){var e=document.head,n=t||e,s=document.createElement("style"),i=function(u){var c=Array.from(u.querySelectorAll("style[".concat(Ne,"]")));return c[c.length-1]}(n),a=i!==void 0?i.nextSibling:null;s.setAttribute(Ne,Xa),s.setAttribute(Ga,es);var r=k0();return r&&s.setAttribute("nonce",r),n.insertBefore(s,a),s},b0=function(){function t(e){this.element=no(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var s=document.styleSheets,i=0,a=s.length;i<a;i++){var r=s[i];if(r.ownerNode===n)return r}throw en(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),T0=function(){function t(e){this.element=no(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var s=document.createTextNode(n);return this.element.insertBefore(s,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),S0=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),wr=pi,j0={isServer:!pi,useCSSOMInjection:!e0},so=function(){function t(e,n,s){e===void 0&&(e=ze),n===void 0&&(n={});var i=this;this.options=Nt(Nt({},j0),e),this.gs=n,this.names=new Map(s),this.server=!!e.isServer,!this.server&&pi&&wr&&(wr=!1,function(a){for(var r=document.querySelectorAll(y0),u=0,c=r.length;u<c;u++){var d=r[u];d&&d.getAttribute(Ne)!==Xa&&(w0(a,d),d.parentNode&&d.parentNode.removeChild(d))}}(this)),xi(this,function(){return function(a){for(var r=a.getTag(),u=r.length,c="",d=function(l){var p=function(m){return Fn.get(m)}(l);if(p===void 0)return"continue";var f=a.names.get(p),w=r.getGroup(l);if(f===void 0||w.length===0)return"continue";var b="".concat(Ne,".g").concat(l,'[id="').concat(p,'"]'),g="";f!==void 0&&f.forEach(function(m){m.length>0&&(g+="".concat(m,","))}),c+="".concat(w).concat(b,'{content:"').concat(g,'"}').concat(fi)},h=0;h<u;h++)d(h);return c}(i)})}return t.registerId=function(e){return fn(e)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(Nt(Nt({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var s=n.useCSSOMInjection,i=n.target;return n.isServer?new S0(i):s?new b0(i):new T0(i)}(this.options),new x0(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(fn(e),this.names.has(e))this.names.get(e).add(n);else{var s=new Set;s.add(n),this.names.set(e,s)}},t.prototype.insertRules=function(e,n,s){this.registerName(e,n),this.getTag().insertRules(fn(e),s)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(fn(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),C0=/&/g,R0=/^\s*\/\/.*$/gm;function io(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(s){return"".concat(e," ").concat(s)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=io(n.children,e)),n})}function E0(t){var e,n,s,i=ze,a=i.options,r=a===void 0?ze:a,u=i.plugins,c=u===void 0?ns:u,d=function(p,f,w){return w.startsWith(n)&&w.endsWith(n)&&w.replaceAll(n,"").length>0?".".concat(e):p},h=c.slice();h.push(function(p){p.type===Jn&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(C0,n).replace(s,d))}),r.prefix&&h.push(t0),h.push(Jf);var l=function(p,f,w,b){f===void 0&&(f=""),w===void 0&&(w=""),b===void 0&&(b="&"),e=b,n=f,s=new RegExp("\\".concat(n,"\\b"),"g");var g=p.replace(R0,""),m=Kf(w||f?"".concat(w," ").concat(f," { ").concat(g," }"):g);r.namespace&&(m=io(m,r.namespace));var S=[];return On(m,Qf(h.concat(If(function(T){return S.push(T)})))),S};return l.hash=c.length?c.reduce(function(p,f){return f.name||en(15),be(p,f.name)},Za).toString():"",l}var M0=new so,As=E0(),ro=oe.createContext({shouldForwardProp:void 0,styleSheet:M0,stylis:As});ro.Consumer;oe.createContext(void 0);function kr(){return _.useContext(ro)}var N0=function(){function t(e,n){var s=this;this.inject=function(i,a){a===void 0&&(a=As);var r=s.name+a.hash;i.hasNameForId(s.id,r)||i.insertRules(s.id,r,a(s.rules,r,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,xi(this,function(){throw en(12,String(s.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=As),this.name+e.hash},t}(),z0=function(t){return t>="A"&&t<="Z"};function br(t){for(var e="",n=0;n<t.length;n++){var s=t[n];if(n===1&&s==="-"&&t[0]==="-")return t;z0(s)?e+="-"+s.toLowerCase():e+=s}return e.startsWith("ms-")?"-"+e:e}var ao=function(t){return t==null||t===!1||t===""},oo=function(t){var e,n,s=[];for(var i in t){var a=t[i];t.hasOwnProperty(i)&&!ao(a)&&(Array.isArray(a)&&a.isCss||De(a)?s.push("".concat(br(i),":"),a,";"):Je(a)?s.push.apply(s,$n($n(["".concat(i," {")],oo(a),!1),["}"],!1)):s.push("".concat(br(i),": ").concat((e=i,(n=a)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in Io||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return s};function pe(t,e,n,s){if(ao(t))return[];if(gi(t))return[".".concat(t.styledComponentId)];if(De(t)){if(!De(a=t)||a.prototype&&a.prototype.isReactComponent||!e)return[t];var i=t(e);return pe(i,e,n,s)}var a;return t instanceof N0?n?(t.inject(n,s),[t.getName(s)]):[t]:Je(t)?oo(t):Array.isArray(t)?Array.prototype.concat.apply(ns,t.map(function(r){return pe(r,e,n,s)})):[t.toString()]}function D0(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(De(n)&&!gi(n))return!1}return!0}var L0=Ja(es),$0=function(){function t(e,n,s){this.rules=e,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&D0(e),this.componentId=n,this.baseHash=be(L0,n),this.baseStyle=s,so.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,s){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=de(i,this.staticRulesId);else{var a=vr(pe(this.rules,e,n,s)),r=Ps(be(this.baseHash,a)>>>0);if(!n.hasNameForId(this.componentId,r)){var u=s(a,".".concat(r),void 0,this.componentId);n.insertRules(this.componentId,r,u)}i=de(i,r),this.staticRulesId=r}else{for(var c=be(this.baseHash,s.hash),d="",h=0;h<this.rules.length;h++){var l=this.rules[h];if(typeof l=="string")d+=l;else if(l){var p=vr(pe(l,e,n,s));c=be(c,p+h),d+=p}}if(d){var f=Ps(c>>>0);n.hasNameForId(this.componentId,f)||n.insertRules(this.componentId,f,s(d,".".concat(f),void 0,this.componentId)),i=de(i,f)}}return i},t}(),co=oe.createContext(void 0);co.Consumer;var ws={};function O0(t,e,n){var s=gi(t),i=t,a=!vs(t),r=e.attrs,u=r===void 0?ns:r,c=e.componentId,d=c===void 0?function(j,R){var M=typeof j!="string"?"sc":gr(j);ws[M]=(ws[M]||0)+1;var N="".concat(M,"-").concat(a0(es+M+ws[M]));return R?"".concat(R,"-").concat(N):N}(e.displayName,e.parentComponentId):c,h=e.displayName,l=h===void 0?function(j){return vs(j)?"styled.".concat(j):"Styled(".concat(o0(j),")")}(t):h,p=e.displayName&&e.componentId?"".concat(gr(e.displayName),"-").concat(e.componentId):e.componentId||d,f=s&&i.attrs?i.attrs.concat(u).filter(Boolean):u,w=e.shouldForwardProp;if(s&&i.shouldForwardProp){var b=i.shouldForwardProp;if(e.shouldForwardProp){var g=e.shouldForwardProp;w=function(j,R){return b(j,R)&&g(j,R)}}else w=b}var m=new $0(n,p,s?i.componentStyle:void 0);function S(j,R){return function(M,N,C){var L=M.attrs,O=M.componentStyle,A=M.defaultProps,P=M.foldedComponentIds,D=M.styledComponentId,x=M.target,v=oe.useContext(co),y=kr(),k=M.shouldForwardProp||y.shouldForwardProp,E=n0(N,v,A)||ze,z=function(U,Y,X){for(var st,ct=Nt(Nt({},Y),{className:void 0,theme:X}),gt=0;gt<U.length;gt+=1){var xt=De(st=U[gt])?st(ct):st;for(var G in xt)ct[G]=G==="className"?de(ct[G],xt[G]):G==="style"?Nt(Nt({},ct[G]),xt[G]):xt[G]}return Y.className&&(ct.className=de(ct.className,Y.className)),ct}(L,N,E),$=z.as||x,B={};for(var H in z)z[H]===void 0||H[0]==="$"||H==="as"||H==="theme"&&z.theme===E||(H==="forwardedAs"?B.as=z.forwardedAs:k&&!k(H,$)||(B[H]=z[H]));var nt=function(U,Y){var X=kr(),st=U.generateAndInjectStyles(Y,X.styleSheet,X.stylis);return st}(O,z),Q=de(P,D);return nt&&(Q+=" "+nt),z.className&&(Q+=" "+z.className),B[vs($)&&!Ka.has($)?"class":"className"]=Q,B.ref=C,_.createElement($,B)}(T,j,R)}S.displayName=l;var T=oe.forwardRef(S);return T.attrs=f,T.componentStyle=m,T.displayName=l,T.shouldForwardProp=w,T.foldedComponentIds=s?de(i.foldedComponentIds,i.styledComponentId):"",T.styledComponentId=p,T.target=s?i.target:t,Object.defineProperty(T,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(j){this._foldedDefaultProps=s?function(R){for(var M=[],N=1;N<arguments.length;N++)M[N-1]=arguments[N];for(var C=0,L=M;C<L.length;C++)Ys(R,L[C],!0);return R}({},i.defaultProps,j):j}}),xi(T,function(){return".".concat(T.styledComponentId)}),a&&eo(T,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),T}function Tr(t,e){for(var n=[t[0]],s=0,i=e.length;s<i;s+=1)n.push(e[s],t[s+1]);return n}var Sr=function(t){return Object.assign(t,{isCss:!0})};function F0(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(De(t)||Je(t))return Sr(pe(Tr(ns,$n([t],e,!0))));var s=t;return e.length===0&&s.length===1&&typeof s[0]=="string"?pe(s):Sr(pe(Tr(s,e)))}function Xs(t,e,n){if(n===void 0&&(n=ze),!e)throw en(1,e);var s=function(i){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];return t(e,n,F0.apply(void 0,$n([i],a,!1)))};return s.attrs=function(i){return Xs(t,e,Nt(Nt({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},s.withConfig=function(i){return Xs(t,e,Nt(Nt({},n),i))},s}var lo=function(t){return Xs(O0,t)},Ft=lo;Ka.forEach(function(t){Ft[t]=lo(t)});const B0=Ft.path`
  opacity: ${({opacity:t})=>t||1}};
  stroke: ${({fill:t,theme:e})=>t??e.colors.failure};
  fill: ${({fill:t,theme:e})=>t??e.colors.failure};
`,jr=({series:t,xScale:e,yScale:n,xValue:s,yValue:i,fill:a,opacity:r})=>{const u=_.useMemo(()=>{const c=e.domain(),d=t==null?void 0:t.sort((b,g)=>g.price-b.price),h=[];let l=!1;for(let b=0;b<d.length;b++){const g=d[b];h.push(g),(g==null?void 0:g.price)<(c==null?void 0:c[0])&&!l&&(h.push({price:(c==null?void 0:c[0])+Math.pow(10,-9),depth:g.depth}),l=!0)}const p=h==null?void 0:h.sort((b,g)=>b.price-g.price),f=[];let w=!1;for(let b=0;b<p.length;b++){const g=p[b];f.push(g),(g==null?void 0:g.price)>(c==null?void 0:c[1])&&!w&&(f.push({price:(c==null?void 0:c[1])-Math.pow(10,-9),depth:g.depth}),w=!0)}return Ur().curve(tc).x(b=>e(s(b))).y1(b=>n(i(b))).y0(n(0))(f.filter(b=>{const g=e(s(b));return g>0&&g<=window.innerWidth}))??void 0},[a,r,t,e,s,n,i]);return _.useMemo(()=>o.jsx(B0,{opacity:r,fill:a,d:u}),[u])},H0=Ft.g`
  line {
    display: none;
  }
  text {
    transform: translateY(5px);
    font-family: 'NotoSansMono';
  }
`,q0=({axisGenerator:t,isPosition:e})=>{const{colorMode:n}=Wr(),s=i=>{i&&yt(i).call(t).call(a=>a.selectAll(".domain").remove())};return o.jsx("g",{ref:s,style:{color:n=="light"?"#000":"#fff",opacity:(n=="light","0.5")}})},V0=({xScale:t,innerHeight:e,offset:n=0,isPosition:s=!1})=>_.useMemo(()=>o.jsx(H0,{transform:`translate(0, ${e+n})`,children:o.jsx(q0,{axisGenerator:xa(t).ticks(6),isPosition:s})}),[e,n,t]),U0=t=>{const e=_.useRef();return _.useEffect(()=>{e.current=t},[t]),e.current},Cr=t=>["M 0 0",`v ${t}`,"m 1 0","V 0","M 0 1","h 10","q 2 0, 2 2","v 22","q 0 2 -2 2","h -10","z"].join(" "),Rr=()=>["m 4 8","v 12","M 0 0","m 8 8","v 12","z"].join(" "),Er=({color:t,size:e=10,margin:n=10})=>o.jsx("polygon",{points:`0 0, ${e} ${e}, 0 ${e}`,transform:` translate(${e+n}, ${n}) rotate(45) `,fill:t,stroke:t,strokeWidth:"4",strokeLinejoin:"round"}),te={colors:{background:"var(--chakra-colors-card_bg)",secondary:"#30D4B7",leftHandle:"#30D4B7 ",rightHandle:"#6297EA"}},Mr=Ft.path`
  cursor: ew-resize;
  pointer-events: none;

  stroke-width: 3;
  stroke: ${({color:t})=>t};
  fill: ${({color:t})=>t};
`,Nr=Ft.path`
  cursor: ew-resize;
  pointer-events: none;

  stroke-width: 1.5;
  /* stroke: ${te.colors.background}; */
  // stroke: #22211f;
  stroke: #fff;
  opacity: ${te.colors.background};
`;Ft.g`
  opacity: ${({visible:t})=>t?"1":"0"};
  transition: opacity 300ms;
`;Ft.rect`
  fill: ${te.colors.secondary};
`;Ft.rect`
  fill: ${te.colors.secondary};
`;Ft.rect`
  fill: ${te.colors.secondary};
`;Ft.text`
  text-anchor: middle;
  font-size: 13px;
  /*  fill: ${te.colors.background}; */
  fill: #22211f;
`;const zr=20,Dr=2,Lr=(t,e,n)=>{const s=t.map(a=>n(a).toFixed(1)),i=e.map(a=>n(a).toFixed(1));return s.every((a,r)=>a===i[r])},W0=({id:t,xScale:e,interactive:n,brushLabelValue:s,brushExtent:i,setBrushExtent:a,innerWidth:r,innerHeight:u,westHandleColor:c,eastHandleColor:d,hideBrush:h,isSorted:l})=>{const p=_.useRef(null),f=_.useRef(null),[w,b]=_.useState(i),[g,m]=_.useState(!1),[S,T]=_.useState(!1),j=U0(i),R=_.useCallback(P=>{const{type:D,selection:x,mode:v}=P;if(!x){b(null);return}const y=x.map(e.invert);D==="end"&&!Lr(i,y,e)&&a(y,v),b(y)},[e,i,a]);_.useEffect(()=>{b(i)},[i]),_.useEffect(()=>{p.current&&(f.current=pf().extent([[Math.max(0+Dr,e(0)),0],[r-Dr,u]]).handleSize(30).filter(()=>n).on("brush end",R),f.current(yt(p.current)),j&&Lr(i,j,e)&&yt(p.current).transition().call(f.current.move,i.map(e)),yt(p.current).selectAll(".selection").attr("stroke","none").attr("fill","var(--chakra-colors-chart_brush_selection)"))},[i,R,t,u,r,n,j,e]),_.useEffect(()=>{!p.current||!f.current||f.current.move(yt(p.current),i.map(e))},[i,e]),_.useEffect(()=>{m(!0);const P=setTimeout(()=>m(!1),1500);return()=>clearTimeout(P)},[w]);const M=w&&e(w[0])>zr,N=w&&e(w[1])>r-zr,C=w&&(e(w[0])<0||e(w[1])<0),L=w&&(e(w[0])>r||e(w[1])>r),O=w&&e(w[0])>=0&&e(w[0])<=r,A=w&&e(w[1])>=0&&e(w[1])<=r;return _.useEffect(()=>{console.log("ðŸš€ ~ file: Brush.tsx:195 ~ brushExtent:",i)},[i]),_.useMemo(()=>o.jsxs(o.Fragment,{children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:`${t}-gradient-selection`,x1:"0%",y1:"100%",x2:"100%",y2:"100%",children:[o.jsx("stop",{stopColor:c}),o.jsx("stop",{stopColor:d,offset:"1"})]}),o.jsx("clipPath",{id:`${t}-brush-clip`,children:o.jsx("rect",{x:"0",y:"0",width:r,height:u})})]}),o.jsx("g",{ref:p,clipPath:`url(#${t}-brush-clip)`,onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1)}),w&&o.jsxs(o.Fragment,{children:[!h&&O?o.jsx("g",{transform:`translate(${Math.max(0,e(w[0]))}, 0), scale(${M?"-1":"1"}, 1)`,children:o.jsxs("g",{children:[o.jsx(Mr,{color:te.colors.leftHandle,d:Cr(u)}),o.jsx(Nr,{d:Rr()})]})}):null,!h&&A?o.jsx("g",{transform:`translate(${e(w[1])}, 0), scale(${N?"-1":"1"}, 1)`,children:o.jsxs("g",{children:[o.jsx(Mr,{color:te.colors.rightHandle,d:Cr(u)}),o.jsx(Nr,{d:Rr()})]})}):null,C&&o.jsx(Er,{color:c}),L&&o.jsx("g",{transform:`translate(${r}, 0) scale(-1, 1)`,children:o.jsx(Er,{color:d})})]})]}),[s,d,A,N,M,S,t,te,u,r,w,L,g,C,c,O,e])},P0=Ft.line`
  opacity: 0.7;
  stroke-width: 2;
  stroke: var(--chakra-colors-text_caption);
  fill: none;
`,Y0=({value:t,xScale:e,innerHeight:n})=>_.useMemo(()=>o.jsx(P0,{x1:e(t),y1:"0",x2:e(t),y2:n}),[t,e,n]);Ft.div`
  display: grid;
  grid-template-columns: repeat(${({count:t})=>t.toString()}, 1fr);
  grid-gap: 6px;

  position: absolute;
  top: -18px;
  right: 0;
`;const A0=Ft.rect`
  fill: transparent;
  cursor: grab;

  &:active {
    cursor: grabbing;
  }
`;function X0({svg:t,xScale:e,setZoom:n,width:s,height:i,resetBrush:a,showResetButton:r,zoomLevels:u,isPosition:c,handleClickRefresh:d}){const h=_.useRef(),[l,p,f,w]=_.useMemo(()=>[()=>t&&h.current&&yt(t).transition().call(h.current.scaleBy,1.5),()=>t&&h.current&&yt(t).transition().call(h.current.scaleBy,.5),()=>t&&h.current&&yt(t).transition().call(h.current.scaleTo,1),()=>t&&h.current&&yt(t).call(h.current.transform,Zn.translate(0,0).scale(1)).transition().call(h.current.scaleTo,.5)],[t]),g=Ss(()=>{console.log("è¿™é‡Œæµ‹è¯•æ‰“å°")},500),m=Ss(n,300),{isApp:S}=me();return _.useEffect(()=>{t&&(h.current=Ha().scaleExtent([0,1/0]).extent([[0,0],[s,i]]).on("zoom",({transform:T})=>{console.log("è¿™é‡Œè¿›æ¥äº†å¤šæ¬¡å— on zoom"),g(),m(T)}),yt(t).call(h.current))},[i,s,n,t,h,u.max,u.min]),_.useEffect(()=>{f()},[f,u]),o.jsx(dt,{w:"100%",p:"0px",align:"center",sx:{"@media screen and (max-width: 960px)":{flexDirection:"column",w:"100%",alignItems:c?"flex-start":"flex-end"}},children:o.jsxs(I,{w:"100%",justify:S?"flex-start":"flex-end",flex:"1",position:"absolute",right:"0px",top:S?"-55px":"-80px",children:[o.jsx(Pn,{handleClickRefresh:d,noBg:!0,isAutoRefresh:!0}),o.jsx(zt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomin",onClick:l}),o.jsx(zt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomout",onClick:p})]})})}const pn=t=>t.price,ks=t=>t.depth;function G0(t,e){return t==null?void 0:t.filter(n=>V(n.price).gte(e[0])&&V(n.price).lte(e[1]))}function K0({id:t="liquidityChartRangeInput",data:{series:e,current:n},ticksAtLimit:s,styles:i,dimensions:{width:a,height:r},margins:u,interactive:c=!0,brushDomain:d,brushLabels:h,onBrushDomainChange:l,handleClickRefresh:p,zoomLevels:f,showZoomButtons:w=!0,isPosition:b=!1,hideBrush:g=!1,isReverse:m=!1,isSorted:S=!0}){const T=_.useRef(null),[j,R]=_.useState(null),[M,N]=_.useMemo(()=>[r-u.top-u.bottom,a-u.left-u.right],[a,r,u]),{xScale:C,yScale:L}=_.useMemo(()=>{const P=[n*f.initialMin,n*f.initialMax];let D=P;console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ xInitialRange:",P),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ brushDomain:",d),d&&String(d==null?void 0:d[0])!=="âˆž"&&String(d==null?void 0:d[1])!=="âˆž"&&(D=[Math.min(P[0],V(d[0]).mul(.9).toNumber()),Math.max(P[1],V(d[1]).mul(1.1).toNumber())]);const x=G0(e,D),v={xScale:Cs().domain(D).range([0,N]),yScale:Cs().domain([0,Pr(x,ks)]).range([M,0])};if(j){const y=j.rescaleX(v.xScale);v.xScale.domain(y.domain())}return v},[n,f.initialMin,f.initialMax,N,e,M,j,d]);_.useEffect(()=>{console.log("Chart.tsx xScale useEffect: ",C)},[C]),_.useEffect(()=>{console.log("Chart.tsx zoom useEffect: ",j)},[j]),_.useEffect(()=>{R(null)},[f]),_.useEffect(()=>{d||l(C.domain(),void 0)},[d,l,C]);const[O,A]=_.useMemo(()=>{var v,y;const P=((v=e[0])==null?void 0:v.price)>((y=e[e.length-1])==null?void 0:y.price);let[D,x]=Of(e,k=>P?+pn(k)<n:+pn(k)>n);return x.length&&x[x.length-1]&&(x[x.length-1].price!==n&&(x=[...x,{depth:x[x.length-1].depth,price:n}]),D=[{depth:x[x.length-1].depth,price:n},...D]),[D,x]},[n,e]);return o.jsxs(J,{w:"100%",h:"100%",sx:{"@media screen and (max-width: 1000px)":{display:"block"}},children:[w&&o.jsx(X0,{svg:T.current,xScale:C,setZoom:R,width:N,height:r,resetBrush:()=>{l([n*f.initialMin,n*f.initialMax],"reset")},showResetButton:!!(s[_t.LOWER]||s[_t.UPPER]),zoomLevels:f,isPosition:b,handleClickRefresh:p}),o.jsxs("svg",{width:"100%",height:"100%",style:{overflow:"visible"},children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"green-gradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1})]}),o.jsxs("linearGradient",{id:"red-gradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1})]})]}),o.jsxs("defs",{children:[o.jsx("clipPath",{id:`${t}-chart-clip`,children:o.jsx("rect",{x:"0",y:"0",width:N,height:r})}),d&&o.jsx("mask",{id:`${t}-chart-area-mask`,children:o.jsx("rect",{fill:"red",x:C(d[0]),y:"0",width:C(d[1])-C(d[0]),height:M})})]}),o.jsxs("g",{transform:`translate(${u.left},${u.top})`,children:[o.jsxs("g",{clipPath:`url(#${t}-chart-clip)`,children:[o.jsx(jr,{series:O,xScale:C,yScale:L,xValue:pn,yValue:ks,opacity:1,fill:"var(--chakra-colors-range_chart_bg)"}),o.jsx(jr,{series:A,xScale:C,yScale:L,xValue:pn,yValue:ks,opacity:1,fill:"url(#green-gradient)"}),o.jsx(Y0,{value:n,xScale:C,innerHeight:M}),o.jsx(V0,{xScale:C,innerHeight:M,isPosition:b})]}),o.jsx(A0,{width:N,height:r,ref:T}),o.jsx(W0,{id:t,xScale:C,interactive:c,brushLabelValue:h,brushExtent:d??C.domain(),innerWidth:N,innerHeight:M,setBrushExtent:l,westHandleColor:i.brush.handle.west,eastHandleColor:i.brush.handle.east,hideBrush:g,isSorted:S})]})]})]})}const Z0=_.forwardRef(function({isSorted:e,contractPoolInfo:n,currencyA:s,currencyB:i,feeAmount:a,ticksAtLimit:r,price:u,priceLower:c,priceUpper:d,onLeftRangeInput:h,onRightRangeInput:l,onBothRangeInput:p,handleClickRefresh:f,interactive:w,zoomLevel:b,isPosition:g,hideBrush:m,isReverse:S},T){var x;const{isLoading:j,error:R,formattedData:M,handleRefresh:N}=iu({contractPoolInfo:n,currencyA:s,currencyB:i,feeAmount:a});_.useEffect(()=>{N()},[]);const C=_.useMemo(()=>{let v;return e?v=M:v=M==null?void 0:M.map(y=>{var k;return{...y,price:(k=V(1).div(y==null?void 0:y.price))==null?void 0:k.toNumber()}}),console.log("seriesData useMemo result: ",v),v},[e,M]),L=_.useCallback((v,y)=>{if(!y)return;let k=Number(v[0]);const E=Number(v[1]);k<=0&&(k=1/10**6);const z=(!r[e?_t.LOWER:_t.UPPER]||y==="handle"||y==="reset")&&k>0,$=(!r[e?_t.UPPER:_t.LOWER]||y==="reset")&&E>0&&E<1e35;if(z&&$){const B=parseFloat(k.toFixed(16)),H=parseFloat(E.toFixed(16));B>0&&H>0&&B<H&&p({leftTypedValue:V(k).toString(),rightTypedValue:V(E).toString()})}else z?h(V(k).toString()):$&&l(V(E).toString())},[e,p,h,l,r]),O=_.useMemo(()=>{const v=c==null?void 0:c.fixsUiPrice,y=d==null?void 0:d.fixsUiPrice;if(y!=="âˆž")return v&&y?[v,y]:void 0},[e,c==null?void 0:c.fixsUiPrice,d==null?void 0:d.fixsUiPrice]),A=_.useCallback((v,y)=>{if(!u)return"";if(v==="w"&&r[e?_t.LOWER:_t.UPPER])return"0";if(v==="e"&&r[e?_t.UPPER:_t.LOWER])return"âˆž";const k=(y<u?-1:1)*((Math.max(y,u)-Math.min(y,u))/u)*100;return u?`${ec(Math.abs(k)>1?".2~s":".2~f")(k)}%`:""},[e,u,r]),P=!s||!i||C===void 0&&!j,D=_.useRef(null);return _.useImperativeHandle(T,()=>({depthChartRefreshData:N})),o.jsx(J,{flex:1,gap:"14px",w:"100%",position:"relative",children:P?o.jsx(dt,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(F,{children:"Your position will appear here."})}):j||!C||!u?o.jsx(et,{h:"100%",pt:"100px",children:o.jsx(Qe,{})}):R?o.jsx(dt,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(F,{children:"Liquidity data not available."})}):C.length===0?o.jsxs(dt,{direction:"column",h:"210px",justify:"flex-end",children:[o.jsx(I,{position:"absolute",right:"0px",top:"-80px",children:o.jsx(Pn,{handleClickRefresh:f,noBg:!0,isAutoRefresh:!0})}),o.jsx(F,{mt:"20px",children:"There is no liquidity data."})]}):o.jsx(dt,{w:"100%",h:"100%",position:"relative",justify:"center",align:"center",ref:D,children:o.jsx(K0,{data:{series:C,current:u},dimensions:{width:((x=D==null?void 0:D.current)==null?void 0:x.clientWidth)||660,height:280},margins:{top:10,right:20,bottom:20,left:10},styles:{area:{selection:"var(--chakra-colors-text_caption)"},brush:{handle:{west:"#30D4B7",east:"#6297EA"}}},interactive:w&&!!(C!=null&&C.length),brushLabels:A,brushDomain:O,onBrushDomainChange:L,zoomLevels:b??Ln[a??ut.MEDIUM],ticksAtLimit:r,isPosition:g,hideBrush:m,isReverse:S,isSorted:e,handleClickRefresh:f},`${a??ut.MEDIUM}`)})})}),J0=_.forwardRef(function(e,n){const{handleClickRefresh:s}=e,{currentApiPoolInfo:i,currentContractPoolInfo:a,currentFeeTier:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h,minPriceData:l,maxPriceData:p,currentPrice:f,inversePrice:w,defaultPriceRangePercentage:b,saveMinPriceData:g,saveMaxPriceData:m,setIsShowMinMaxDist:S}=Rt(),T=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),j=_.useMemo(()=>r&&Number(r)&&(i!=null&&i.tickSpacing)?{[_t.LOWER]:r?Mt.getInitializableTickIndex(Un,i==null?void 0:i.tickSpacing):void 0,[_t.UPPER]:r?Mt.getInitializableTickIndex(Vn,i==null?void 0:i.tickSpacing):void 0}:{[_t.LOWER]:void 0,[_t.UPPER]:void 0},[r]),R=_.useMemo(()=>{var E;const v=c===((E=i==null?void 0:i.token0)==null?void 0:E.metadata),y=v?l:p==null?void 0:p.getInverseTickPrice(),k=v?p:l==null?void 0:l.getInverseTickPrice();return{[_t.LOWER]:r&&(y==null?void 0:y.tick)===j.LOWER,[_t.UPPER]:r&&(k==null?void 0:k.tick)===j.UPPER}},[i,j,l,p,r,c]),M=!0,N=_.useMemo(()=>{if(b){const v=V(1).minus(V(b).div(100)).toNumber(),y=V(1).add(V(b).div(100)).toNumber();return{initialMin:v,initialMax:y,min:1e-5,max:1.5}}},[b]),C=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),E=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;E&&z&&g(re.buildTickPriceData(v,T,E,z))}},L=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),E=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;E&&z&&m(re.buildTickPriceData(v,T,E,z))}},O=({leftTypedValue:v,rightTypedValue:y})=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v)),y!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),L(y))},A=v=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v))},P=v=>{v!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),L(v))},D=_.useMemo(()=>{var v;return c===((v=i==null?void 0:i.token0)==null?void 0:v.metadata)},[c,i]),x=_.useRef(null);return _.useImperativeHandle(n,()=>{var v;return{depthChartRefreshData:(v=x.current)==null?void 0:v.depthChartRefreshData}}),o.jsx(J,{w:"100%",h:"100%",children:o.jsx(Z0,{ref:x,isSorted:D,contractPoolInfo:a,currencyA:i==null?void 0:i.token0,currencyB:i==null?void 0:i.token1,feeAmount:r,ticksAtLimit:R,price:Number(D?f:w),priceLower:l,priceUpper:p,interactive:M,zoomLevel:N,isReverse:i==null?void 0:i.isReverse,onBothRangeInput:O,onLeftRangeInput:A,onRightRangeInput:P,handleClickRefresh:s})})}),Q0=({xScale:t,innerHeight:e,svg:n})=>{const{colorMode:s}=Wr();return _.useEffect(()=>{console.log("æ²¡èµ°åˆ°è¿™é‡Œå—AxisBottom svg: ",n);const i=xa(t).ticks(4).tickSizeOuter(0);n.select(".price-historical-x-axis").attr("transform",`translate(0, ${e})`).call(i)},[n,t]),o.jsx("g",{className:"price-historical-x-axis",style:{color:s=="light"?"#000":"#fff",opacity:(s=="light","0.5")}})},I0=({yScale:t,innerWidth:e,svg:n})=>(_.useEffect(()=>{const s=du(t).ticks(5).tickSizeOuter(0);n.select(".price-historical-y-axis").attr("transform",`translate(${e}, 0)`).call(s)},[n,t]),o.jsx("g",{className:"price-historical-y-axis"})),tp=({series:t,xScale:e,yScale:n,svg:s,innerHeight:i})=>(_.useEffect(()=>{const a=Ur().x(r=>e(r.time)).y0(i).y1(r=>n(r.price)).curve(Kr.alpha(.5));s.select(".area").datum(t).attr("d",a).attr("fill","url(#historical-gradient)").attr("z-index",-1)},[s,n,t]),o.jsx("path",{className:"area"})),ep=({series:t,xScale:e,yScale:n,svg:s})=>(_.useEffect(()=>{const i=nc().x(a=>e(a.time)).y(a=>n(a.price)).curve(Kr.alpha(.5));s.select(".line").datum(t).attr("d",i).attr("fill","none").attr("stroke","var(--chakra-colors-historical_line)").attr("stroke-width",2)},[s,n,t]),o.jsx("path",{className:"line"})),uo=Or(t=>({hoverX:null,hoverY:null,hoverTime:null,hoverPrice:null,tooltipData:null,dateType:"1D",tooltipTextXPos:null,setHoverX:e=>{t(()=>({hoverX:e}))},setHoverY:e=>{t(()=>({hoverY:e}))},setHoverTime:e=>{t(()=>({hoverTime:e}))},setHoverPrice:e=>{t(()=>({hoverPrice:e}))},setTooltipData:e=>{t(()=>({tooltipData:e}))},setDateType:e=>{t(()=>({dateType:e}))},setTooltipTextXPos:e=>{t(()=>({tooltipTextXPos:e}))}})),np=({series:t,xScale:e,yScale:n,svg:s,setHoverX:i,setHoverY:a,setTooltipData:r,setTooltipTextXPos:u})=>(_.useEffect(()=>{s.selectAll(".dot").remove(),s.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("cx",c=>e(c.time)).attr("cy",c=>n(c.price)).attr("r",3).attr("fill","rgba(255, 255, 255, 0)").attr("z-index","2")},[s,n,t]),o.jsx("g",{className:"tooptip-text"})),sp=({series:t,yScale:e,svg:n,innerWidth:s,innerHeight:i,brushExtent:a,setBrushExtent:r,isSorted:u})=>{const[c,d]=_.useState([30,50]);_.useEffect(()=>{console.log("Brush useEffect brushExtent: ",a),console.log("Brush useEffect isSorted: ",u),console.log("Brush useEffect [yScale(brushExtent[0]), yScale(brushExtent[1])]: ",[e(a[0]),e(a[1])]),d([e(a[0]),e(a[1])])},[a]),_.useEffect(()=>{const p=gf().extent([[0,0],[s+50,i]]).on("end",({selection:f,mode:w})=>{if(!f){d(null);return}const[b,g]=f==null?void 0:f.map(e.invert);console.log("Selected mode: ",w),console.log("Selected y0:",b),console.log("Selected y1:",g),r([b,g],w);const m=f.map(e.invert);console.log("Selected scaled: ",m);const S=t.filter(R=>R.price>=b&&R.price<=g);console.log("Selected data:",S);const T=e(b),j=e(g);console.log("Selected posy0:",T),console.log("Selected posy1:",j),d([T,j])});n.select(".brush").call(p).call(p.move,a.map(e)),n.selectAll(".selection").attr("stroke","none").attr("fill-opacity","0.2").attr("fill","red").attr("width",500).attr("class","selection price-historical-selection")},[n,e,s,i]);const h=_.useMemo(()=>!(!c||c[0]<0),[c]),l=_.useMemo(()=>!(!c||c[1]<0),[c]);return o.jsxs(o.Fragment,{children:[h&&o.jsxs("g",{className:"custom-top-handle",transform:`translate(0, ${c[0]})`,children:[o.jsx("line",{x1:"0",y1:"0",x2:s,y2:"0",stroke:"var(--chakra-colors-chart_handle_left)",strokeWidth:1}),o.jsxs("g",{transform:`translate(${s}, -10)`,children:[o.jsx("polygon",{points:"0,10 6,20 40,20 40,0 6,0",fill:"var(--chakra-colors-chart_handle_left)"}),o.jsxs("text",{x:"22",y:"15",fill:"#0C0B1E",fontSize:"12px",textAnchor:"middle",children:["MIN ",u]})]})]}),l&&o.jsxs("g",{className:"custom-bottom-handle",transform:`translate(0, ${c[1]})`,children:[o.jsx("line",{x1:"0",y1:"0",x2:s,y2:"0",stroke:"var(--chakra-colors-chart_handle_right)",strokeWidth:1}),o.jsxs("g",{transform:`translate(${s}, -10)`,children:[o.jsx("polygon",{points:"0,10 6,20 40,20 40,0 6,0",fill:"var(--chakra-colors-chart_handle_right)"}),o.jsx("text",{x:"22",y:"15",fill:"#0C0B1E",fontSize:"12px",textAnchor:"middle",children:"MAX"})]})]}),c&&o.jsx("rect",{width:s,height:Math.abs((c[0]<0?0:c[0])-(c[1]<0?0:c[1])),transform:`translate(0, ${c[1]<0?0:c[1]})`,fill:"var(--chakra-colors-chart_brush_selection)"}),o.jsx("g",{className:"brush"})]})},ip=({svg:t,hoverX:e,hoverY:n,innerWidth:s,innerHeight:i,tooltipData:a})=>(_.useState(null),_.useRef(),o.jsx(o.Fragment,{children:o.jsxs("g",{transform:`translate(${e}, 0)`,children:[o.jsx("line",{y1:0,y2:i,stroke:"#fff",strokeDasharray:"5, 5"}),o.jsx("line",{x1:-e,x2:s-e,y1:n,y2:n,stroke:"#fff",strokeDasharray:"5, 5"}),o.jsx("circle",{r:"4",fill:"#fff",cy:n})]})})),rp=({price:t,yScale:e,svg:n,innerWidth:s})=>o.jsxs("g",{className:"historical-currentprice-line",children:[o.jsx("line",{x1:0,y1:e(t),x2:s+30,y2:e(t),stroke:"#fff",strokeWidth:"1"}),o.jsx("circle",{cx:s-4+30,cy:e(t),r:"4",fill:"#A6DEEB"})]});function ap({svg:t,yScale:e,setZoom:n,width:s,height:i,zoomLevels:a,handleClickRefresh:r,dateType:u,setDateType:c,isApp:d}){const h=_.useRef(),[l,p,f,w]=_.useMemo(()=>[()=>t&&h.current&&t.transition().call(h.current.scaleBy,2),()=>t&&h.current&&t.transition().call(h.current.scaleBy,.5),()=>t&&h.current&&t.transition().call(h.current.scaleTo,.5),()=>t&&h.current&&t.call(h.current.transform,Zn.translate(0,0).scale(1)).transition().call(h.current.scaleTo,.5)],[t]);return _.useEffect(()=>{t&&(h.current=Ha().scaleExtent([a.min,a.max]).extent([[0,0],[s,i]]).on("zoom",({transform:b})=>n(b)).filter(()=>!(void 0).button&&!(void 0).touches),t.call(h.current))},[i,s,n,t,e,h,a,a.max,a.min]),_.useEffect(()=>{f()},[f,a]),o.jsx(dt,{children:o.jsxs(I,{w:"100%",flex:"1",justify:d?"flex-start":"flex-end",position:"absolute",right:"0px",top:d?"-55px":"-80px",children:[o.jsx(Ie,{options:["1H","1D","7D","30D"],size:"s",value:u,onChange:c}),o.jsx(Pn,{handleClickRefresh:r,noBg:!0,isAutoRefresh:!0}),o.jsx(zt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomin",onClick:l}),o.jsx(zt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomout",onClick:p})]})})}sc(t=>new Date(t.time)).center;function op({id:t="historicalChart",data:{series:e,current:n},dimensions:{width:s,height:i},margins:a,brushDomain:r,onBrushDomainChange:u,interactive:c=!0,zoomLevels:d,isSorted:h,handleClickRefresh:l,isApp:p}){const{hoverX:f,hoverY:w,hoverTime:b,hoverPrice:g,tooltipData:m,dateType:S,tooltipTextXPos:T,setHoverX:j,setHoverY:R,setHoverTime:M,setHoverPrice:N,setTooltipData:C,setDateType:L,setTooltipTextXPos:O}=uo();_.useRef(null);const[A,P]=_.useState(null),[D,x]=_.useMemo(()=>[i-a.top-a.bottom,s-a.left-a.right],[s,i,a]),[v,y]=_.useState(null);_.useEffect(()=>{if(yt){const nt=yt("#price-historical-chart");y(nt)}},[yt]),_.useEffect(()=>{console.log("èµ°åˆ°è¿™é‡Œäº†å—svg: ",v)},[v]);const{xScale:k,yScale:E}=_.useMemo(()=>{const nt=[n*.5,n*1.5];let Q=nt;console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ xInitialRange:",nt),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ brushDomain:",r),r&&String(r==null?void 0:r[0])!=="âˆž"&&String(r==null?void 0:r[1])!=="âˆž"&&(Q=[n*.5,n*1.5]),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ yRange:",Q);const U={xScale:ic().domain(Oc(e,Y=>Y.time)).range([0,x]),yScale:Cs().domain([Math.min(rc(e,Y=>Y.price)*.94,Q[0]),Math.max(Pr(e,Y=>Y.price)*1.06,Q[1])]).nice().range([D,0])};if(A){const Y=A.rescaleY(U.yScale);U.yScale.domain(Y.domain())}return U},[n,x,D,A,e]),z=_.useMemo(()=>[...e].reverse(),[e]),$=(nt,Q)=>{const U=k(nt.time),Y=E(nt.price);j(U),R(Y);const X=U>580?580:U<100?100:U;O(X),C(nt)},B=nt=>{const Q=k.invert(Pt(nt)[0]),U=new Date(Q).getTime(),Y=oc(z.map(X=>X.time),U);$(z[Y])},H=()=>{C(null),j(null),R(null)};return _.useEffect(()=>{console.log("ðŸš€ðŸš€ðŸš€ ~ file: Chart.tsx:158 ~ tooltipData:",m)},[m]),o.jsxs(J,{w:"100%",h:"100%",sx:{"@media screen and (max-width: 1000px)":{display:"block"}},position:"relative",children:[o.jsx(ap,{svg:v,yScale:E,setZoom:P,width:x,height:i,zoomLevels:d,handleClickRefresh:l,dateType:S,setDateType:L,isApp:p}),o.jsxs("svg",{id:"price-historical-chart",width:"100%",height:"100%",style:{overflow:"visible"},onMouseMove:B,onMouseOut:H,children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"historical-gradient",x1:"0",x2:"0",y1:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-historical_area_start)"}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-historical_area_end)"})]})}),v&&o.jsxs(o.Fragment,{children:[o.jsx(Q0,{xScale:k,svg:v,innerHeight:D}),o.jsx(I0,{yScale:E,svg:v,innerWidth:x}),o.jsx(ep,{svg:v,series:e,xScale:k,yScale:E}),o.jsx(tp,{svg:v,series:e,xScale:k,yScale:E,innerHeight:D}),m&&o.jsx(ip,{innerWidth:x,innerHeight:D,hoverX:f,hoverY:w,tooltipData:m,svg:v}),o.jsx(np,{svg:v,series:e,xScale:k,yScale:E,setHoverX:j,setHoverY:R,setTooltipData:C,setTooltipTextXPos:O}),o.jsx(rp,{svg:v,yScale:E,innerWidth:x,price:n}),o.jsx(sp,{svg:v,series:e,yScale:E,innerWidth:x,innerHeight:D,brushExtent:r??E.domain(),setBrushExtent:u,isSorted:h})]})]}),m&&o.jsxs(J,{pointerEvents:"none",position:"absolute",left:T-100+"px",top:w-65+"px",bg:"bg_secondary",padding:"8px",alignItems:"flex-start",zIndex:"99999",gap:"4px",borderRadius:"8px",children:[o.jsxs(F,{fontSize:"xs",children:["Date: ",ac(m==null?void 0:m.time)]}),o.jsxs(F,{fontSize:"xs",children:["Price: ",m==null?void 0:m.price]})]})]})}function cp(t,e){console.log("ðŸš€ ~ file: useHistoricalChartData.ts:8 ~ useHistoricalChartData ~ contractPoolInfo:",t);const n=_.useMemo(()=>cc[e],[e]),{historicalPriceData:s,handleRefresh:i}=lp(t==null?void 0:t.pool_address,n);_.useEffect(()=>{console.log("useHistoricalChartData historicalPriceData: ",s)},[s]);const a=_.useMemo(()=>{if(s&&s.length>0)return[s[s.length-1].time,s[0].time]},[s]);return{historicalData:s,xRange:a,isLoading:!1,error:void 0,handleRefresh:i}}function lp(t,e="day"){const n=Bn(lc),[s,i]=_.useState([]),a=async(u,c)=>{var f,w,b;const d=Se(V(new Date().getTime()).div(1e3).toString(),0),h={hour:{dateType:"5min",startTime:V(d).minus(60*60).toNumber(),endTime:d},day:{dateType:"hour",startTime:V(d).minus(60*60*24).toNumber(),endTime:d},week:{dateType:"4hour",startTime:V(d).minus(60*60*24*7).toNumber(),endTime:d},month:{dateType:"day",startTime:V(d).minus(60*60*24*30).toNumber(),endTime:d}},l=await Vr(n,{id:u,date_type:(f=h==null?void 0:h[c])==null?void 0:f.dateType,start_timestamp:(w=h==null?void 0:h[c])==null?void 0:w.startTime,end_timestamp:(b=h==null?void 0:h[c])==null?void 0:b.endTime});console.log("useHistoricalPrice getHisTorical res: ",l);const p=l==null?void 0:l.list.map(g=>({time:V(g.timestamp).mul(1e3).toNumber(),price:Number(g.price)}));if(console.log("useHistoricalPrice list: ",p),p.length===1){const g={hour:36e5,day:864e5,week:6048e5,month:2592e6};p.push({time:V(p[0].time).minus(g[c]).toNumber(),price:p[0].price})}console.log("useHistoricalPrice liståŽ: ",p),i(p||[])};return _.useEffect(()=>{t&&e&&a(t,e)},[t,e]),{historicalPriceData:s,handleRefresh:()=>{t&&e&&a(t,e)}}}var Ue=(t=>(t.LOWER="LOWER",t.UPPER="UPPER",t))(Ue||{});const up=_.forwardRef(function({isSorted:e,price:n,contractPoolInfo:s,currencyA:i,currencyB:a,feeAmount:r,interactive:u,ticksAtLimit:c,priceLower:d,priceUpper:h,onLeftRangeInput:l,onRightRangeInput:p,onBothRangeInput:f,handleClickRefresh:w,zoomLevel:b},g){var x;const{isApp:m}=me(),{dateType:S,setDateType:T}=uo(),{historicalData:j,xRange:R,isLoading:M,error:N,handleRefresh:C}=cp(s,S),L=_.useRef(null);_.useState("1D");const O=_.useMemo(()=>e?j:j==null?void 0:j.map(v=>{var y;return{...v,price:(y=V(1).div(v==null?void 0:v.price))==null?void 0:y.toNumber()}}),[e,j]);_.useEffect(()=>{console.log("PriceChart index seriesData: ",O)},[O]);const A=!i||!a||O===void 0&&!M,P=_.useCallback((v,y)=>{if(console.log("onBrushDomainChangeEnded domain: ",v),console.log("onBrushDomainChangeEnded mode: ",y),!y)return;let k=Number(v[1]);const E=Number(v[0]);k<=0&&(k=1/10**6);const z=(!c[e?Ue.LOWER:Ue.UPPER]||y==="handle"||y==="reset")&&k>0,$=(!c[e?Ue.UPPER:Ue.LOWER]||y==="reset")&&E>0&&E<1e35;if(console.log("onBrushDomainChangeEnded updateBottom: ",z),console.log("onBrushDomainChangeEnded updateTop: ",$),z&&$){const B=parseFloat(k.toFixed(16)),H=parseFloat(E.toFixed(16));console.log("onBrushDomainChangeEnded parsedLeftRangeValue: ",B),console.log("onBrushDomainChangeEnded parsedRightRangeValue: ",H),B>0&&H>0&&B<H&&f({leftTypedValue:V(k).toString(),rightTypedValue:V(E).toString()})}else z?l(V(k).toString()):$&&p(V(E).toString())},[e,f,l,p,c]),D=_.useMemo(()=>{const v=d==null?void 0:d.fixsUiPrice,y=h==null?void 0:h.fixsUiPrice;if(y!=="âˆž")return v&&y?[v,y]:void 0},[e,d==null?void 0:d.fixsUiPrice,h==null?void 0:h.fixsUiPrice]);return _.useImperativeHandle(g,()=>({depthChartRefreshData:C})),o.jsx(J,{w:"100%",h:"100%",position:"relative",children:A?o.jsx(dt,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(F,{children:"Your position will appear here."})}):M?o.jsx(et,{h:"100%",pt:"100px",children:o.jsx(Qe,{})}):N?o.jsx(dt,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(F,{children:"Liquidity data not available."})}):!O||O.length===0||!n||!R?o.jsxs(dt,{direction:"column",h:"210px",justify:"flex-end",children:[o.jsxs(I,{position:"absolute",top:m?"-55px":"-80px",right:m?"auto":"0px",left:m?"0px":"auto",children:[o.jsx(Ie,{options:["1H","1D","7D","30D"],size:"s",value:S,onChange:T}),o.jsx(Pn,{handleClickRefresh:w,noBg:!0,isAutoRefresh:!0})]}),o.jsx(F,{mt:"20px",children:"There is no historical data."})]}):o.jsx(o.Fragment,{children:o.jsx(dt,{w:"100%",h:"100%",ref:L,children:o.jsx(op,{handleClickRefresh:w,data:{series:O,current:n},dimensions:{width:((x=L==null?void 0:L.current)==null?void 0:x.clientWidth)||660,height:320},brushDomain:D,margins:{top:10,right:20,bottom:20,left:10},onBrushDomainChange:P,interactive:u&&!!(O!=null&&O.length),zoomLevels:b??Ln[r??ut.MEDIUM],isSorted:e,isApp:m})})})})}),dp=_.forwardRef(function(e,n){const{handleClickRefresh:s}=e,{currentApiPoolInfo:i,currentContractPoolInfo:a,currentFeeTier:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h,minPriceData:l,maxPriceData:p,currentPrice:f,inversePrice:w,defaultPriceRangePercentage:b,saveMinPriceData:g,saveMaxPriceData:m,setIsShowMinMaxDist:S}=Rt(),T=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),j=_.useMemo(()=>r&&Number(r)&&(i!=null&&i.tickSpacing)?{[_t.LOWER]:r?Mt.getInitializableTickIndex(Un,i==null?void 0:i.tickSpacing):void 0,[_t.UPPER]:r?Mt.getInitializableTickIndex(Vn,i==null?void 0:i.tickSpacing):void 0}:{[_t.LOWER]:void 0,[_t.UPPER]:void 0},[r]),R=_.useMemo(()=>{var E;const v=c===((E=i==null?void 0:i.token0)==null?void 0:E.metadata),y=v?l:p==null?void 0:p.getInverseTickPrice(),k=v?p:l==null?void 0:l.getInverseTickPrice();return{[_t.LOWER]:r&&(y==null?void 0:y.tick)===j.LOWER,[_t.UPPER]:r&&(k==null?void 0:k.tick)===j.UPPER}},[i,j,l,p,r,c]),M=!0,N=_.useMemo(()=>{if(b){const v=V(1).minus(V(b).div(100)).toNumber(),y=V(1).add(V(b).div(100)).toNumber();return{initialMin:v,initialMax:y,min:1e-5,max:1.5}}},[b]),C=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.symbol),E=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;E&&z&&g(re.buildTickPriceData(v,T,E,z))}},L=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),E=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;E&&z&&m(re.buildTickPriceData(v,T,E,z))}},O=({leftTypedValue:v,rightTypedValue:y})=>{console.log("PriceHistoricalChart onBothRangeInput leftTypedValue: ",v),console.log("PriceHistoricalChart onBothRangeInput rightTypedValue: ",y),v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v)),y!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),L(y))},A=v=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v))},P=v=>{v!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),L(v))},D=_.useMemo(()=>{var v;return c===((v=i==null?void 0:i.token0)==null?void 0:v.metadata)},[c,i]),x=_.useRef(null);return _.useImperativeHandle(n,()=>{var v;return{priceChartRefreshData:(v=x.current)==null?void 0:v.priceChartRefreshData}}),o.jsx(J,{w:"100%",h:"100%",children:o.jsx(up,{ref:x,isSorted:D,contractPoolInfo:a,currencyA:d,currencyB:h,feeAmount:r,ticksAtLimit:R,price:Number(D?f:w),priceLower:l,priceUpper:p,interactive:M,zoomLevel:N,onBothRangeInput:O,onLeftRangeInput:A,onRightRangeInput:P,handleClickRefresh:s})})}),hp=_.forwardRef(function({handleClickRefresh:e,rangeChartType:n,setRangeChartType:s},i){const{isApp:a}=me(),r=d=>{s(d)},u=_.useRef(null),c=_.useRef(null);return _.useImperativeHandle(i,()=>{var d,h;return{depthChartMethod:(d=u==null?void 0:u.current)==null?void 0:d.depthChartRefreshData,priceChartMethod:(h=c==null?void 0:c.current)==null?void 0:h.priceChartRefreshData}}),o.jsxs(et,{w:"100%",h:"100%",children:[o.jsxs(uc,{w:"100%",direction:a?"column":"row",justify:"space-between",mb:"10px",children:[o.jsx(et,{children:o.jsx(Ie,{options:["Liquidity","Price"],size:"s",value:n,onChange:r})}),a&&o.jsx(et,{h:"20px"}),o.jsxs(I,{gap:"24px",children:[o.jsxs(I,{gap:"4px",children:[o.jsx(et,{w:"16px",h:"2px",bg:"chart_handle_left"}),o.jsx(F,{fontSize:"xs",whiteSpace:"nowrap",children:"Min price"})]}),o.jsxs(I,{gap:"4px",children:[o.jsx(et,{w:"16px",h:"2px",bg:"chart_handle_right"}),o.jsx(F,{fontSize:"xs",whiteSpace:"nowrap",children:"Max price"})]}),o.jsxs(I,{gap:"4px",children:[o.jsx(et,{w:"16px",h:"2px",bg:"text_caption_opacity_70"}),o.jsx(F,{fontSize:"xs",whiteSpace:"nowrap",children:"Current price"})]})]})]}),n==="Liquidity"&&o.jsx(J0,{handleClickRefresh:e,ref:u}),n==="Price"&&o.jsx(dp,{handleClickRefresh:e,ref:c})]})}),fp=hp;function pp(t,e,n,s){const{setMinDistPercentange:i,setMaxDistPercentange:a}=Rt();_.useEffect(()=>{if(t!=null&&t.fixsUiPrice&&n&&(t==null?void 0:t.fixsUiPrice)!=="âˆž"&&(e==null?void 0:e.fixsUiPrice)!=="âˆž"){const r=V(t==null?void 0:t.fixsUiPrice).minus(n),u=V(e==null?void 0:e.fixsUiPrice).minus(n),c=r.equals(0)?"0":Se(r.div(n).mul(100).toString(),1),d=u.equals(0)?"0":Se(u.div(n).mul(100).toString(),1);i(String(c)),a(String(d))}},[t==null?void 0:t.fixsUiPrice,e==null?void 0:e.fixsUiPrice,n,s])}function Rp(){var mi,yi,_i,vi,wi,ki,bi,Ti,Si,ji,Ci,Ri,Ei;const t=Qs(),{windowWidth:e}=me(),{id:n,token0:s,token1:i,fee:a}=dc(),{address:r}=Wn(),{addToken0:u,addToken1:c,setAddToken0:d,setAddToken1:h,currentApiPoolInfo:l,setCurrentApiPoolInfo:p,currentContractPoolInfo:f,setCurrentContractPoolInfo:w,currentPoolPositions:b,setCurrentPrice:g,setBaseCoin:m,baseCoin:S,setCurrentApiPoolInfoIsLoading:T,setCurrentContractPoolInfoIsLoading:j,resetLiquidityState:R,currentFeeTier:M,setCurrentFeeTier:N,minPriceData:C,maxPriceData:L,saveMaxPriceData:O,saveMinPriceData:A,priceRangePercentage:P,ratio:D,setRatio:x,currentApiPoolInfoIsLoading:v,currentContractPoolInfoIsLoading:y,currentPrice:k,inversePrice:E,rangeChartType:z,setRangeChartType:$}=Rt(),{getApiPoolInfo:B}=mc(),{getContractPool:H}=cl(),{feeTierDistribution:nt,feeTierDistributionLoading:Q}=bc(u,c),{handleChangeRange:U}=ni();_.useMemo(()=>{var Gt,nn,Mi;const W=S===((Gt=l==null?void 0:l.token0)==null?void 0:Gt.metadata),lt=W?C:L==null?void 0:L.getInverseTickPrice(),ft=W?L:C==null?void 0:C.getInverseTickPrice(),St=f==null?void 0:f.current_tick_index,Wt=lt==null?void 0:lt.tick,le=ft==null?void 0:ft.tick;return{currentTick:St,lower:Wt,upper:le,metadata0:(nn=l==null?void 0:l.token0)==null?void 0:nn.metadata,metadata1:(Mi=l==null?void 0:l.token1)==null?void 0:Mi.metadata}},[l,f,C,L]);const{isImportToken:Y}=qn(),X=_.useMemo(()=>{var W;return S===((W=l==null?void 0:l.token0)==null?void 0:W.metadata)},[S,l]);pp(C,L,X?k:E,X);const[st,ct]=_.useState(!1),gt=_.useMemo(()=>{const W=[];if(l){const{displayToken0:lt,displayToken1:ft}=l;lt&&Y(lt.metadata)&&localStorage.getItem(lt.metadata)!=="true"&&W.push(lt),ft&&Y(ft.metadata)&&localStorage.getItem(ft.metadata)!=="true"&&W.push(ft)}return ct(W.length>0),W},[l]),xt=_.useRef();_.useRef(),xt.current=_.useMemo(()=>{if(n)return n;if(l!=null&&l.id)return l==null?void 0:l.id},[n,l]);const G=W=>{j(!0),H(W||xt.current).then(lt=>{console.log("fetchContractPoolInfo getContractPool res:",lt),w(lt),j(!1)})},Z=_.useRef();Z.current=_.useCallback(W=>{const lt={id:n,token0:s,token1:i,fee:a};(n||s&&i&&a)&&(T(!0),W&&(lt.id=xt.current||n||(l==null?void 0:l.id)),B(lt,W).then(ft=>{const St=xt.current||n||(l==null?void 0:l.id);(St===void 0||ft&&ft.id===St)&&(p(ft),G(ft==null?void 0:ft.id)),T(!1)}))},[n,s,i,a]),_.useEffect(()=>{Z.current()},[n,s,i,a]),_.useEffect(()=>{l&&(d((l==null?void 0:l.displayToken0)||void 0),h((l==null?void 0:l.displayToken1)||void 0))},[l]),_.useEffect(()=>{var W,lt,ft,St,Wt,le;if((l==null?void 0:l.id)===(f==null?void 0:f.pool_address)&&((W=l==null?void 0:l.token0)==null?void 0:W.decimals)!==void 0&&((lt=l==null?void 0:l.token1)==null?void 0:lt.decimals)!==void 0&&(f!=null&&f.current_sqrt_price)){console.log("ðŸš€ ~ useEffect ~ currentContractPoolInfo:",f);const Gt=Mt.sqrtPriceX64ToPrice(new Ye(f==null?void 0:f.current_sqrt_price),(ft=l==null?void 0:l.token0)==null?void 0:ft.decimals,(St=l==null?void 0:l.token1)==null?void 0:St.decimals);console.log("ðŸš€ ~ useEffect ~ price:",Gt.toString());const nn=V(1).div(Gt);console.log("ðŸš€ ~ useEffect ~ inversePrice:",nn.toString()),g(Gt.toString()),(Wt=l==null?void 0:l.displayToken0)!=null&&Wt.symbol&&!S&&m((le=l==null?void 0:l.displayToken0)==null?void 0:le.metadata)}},[l,f==null?void 0:f.pool_address]),_.useEffect(()=>{if(!(C&&L)&&f&&l){const W=Fr(String(f==null?void 0:f.fee_rate));l!=null&&l.isReverse?U(W,l==null?void 0:l.token1,l==null?void 0:l.token0,Number(f==null?void 0:f.tick_spacing),E.toString()):U(W,l==null?void 0:l.token0,l==null?void 0:l.token1,Number(f==null?void 0:f.tick_spacing),k.toString())}},[k,E]),_.useEffect(()=>{a&&N(a)},[a]);const[pt,it]=_.useState(!1),vt=W=>{var lt,ft,St,Wt,le,Gt;s===((lt=W.displayToken0)==null?void 0:lt.metadata)&&i===((ft=W.displayToken1)==null?void 0:ft.metadata)&&a===(W==null?void 0:W.feeTier)||i===((St=W.displayToken0)==null?void 0:St.metadata)&&s===((Wt=W.displayToken1)==null?void 0:Wt.metadata)&&a===(W==null?void 0:W.feeTier)||(R(),t(`/pools/liquidity/${(le=W==null?void 0:W.displayToken0)==null?void 0:le.metadata}/${(Gt=W==null?void 0:W.displayToken1)==null?void 0:Gt.metadata}/${W==null?void 0:W.feeTier}`,{replace:!0}),N(W==null?void 0:W.feeTier))},[q,K]=_.useState("Your Positions");_.useState("1D"),_.useEffect(()=>{window.scrollTo(0,0)},[]),_.useEffect(()=>{setTimeout(()=>{window.scrollTo(0,0)},50)},[window.innerHeight]);const rt=_.useRef(null),ht=()=>{var W;console.log("handleClickRefresh Force refresh",{id:n,token0:s,token1:i,fee:a,currentApiPoolInfo:l}),Z.current(!0),(W=rt==null?void 0:rt.current)==null||W.depthChartMethod()},{displayCurrentPrice:qt,displayPerText:Dt}=si(),Lt=_.useMemo(()=>{var St;const W=S===((St=l==null?void 0:l.token0)==null?void 0:St.metadata),lt=W?C:L==null?void 0:L.getInverseTickPrice(),ft=W?L:C==null?void 0:C.getInverseTickPrice();return{token0:l==null?void 0:l.token0,token1:l==null?void 0:l.token1,lowerTick:lt==null?void 0:lt.tick,upperTick:ft==null?void 0:ft.tick,sqrtPriceX96:f==null?void 0:f.current_sqrt_price,isFullRange:P===100}},[l,C==null?void 0:C.tick,L==null?void 0:L.tick,f==null?void 0:f.current_sqrt_price,P]),wt=Nc(Lt);_.useEffect(()=>{x(wt)},[wt]);const Tt=zc(C==null?void 0:C.price,L==null?void 0:L.price),{getCurrentPoolPositions:ne}=sa();_.useEffect(()=>{r&&l&&f&&(l==null?void 0:l.id)===(f==null?void 0:f.pool_address)&&q=="Your Positions"&&(console.log("Liquidity Page getCurrentPoolPositions start"),q==="Your Positions"&&ne(l,f,r))},[l,f,r,q]);const Bt=_.useMemo(()=>!l&&!v||!n&&(!s||!i||!a),[l,v,n,s,i,a]);_.useEffect(()=>()=>{R()},[]);const ye=W=>o.jsx(J,{w:"100%",gap:"16px",children:o.jsxs(J,{w:"100%",children:[o.jsx(Is,{currentTab:q,positionsNum:(b==null?void 0:b.length)||0,textList:["Your Positions","Transactions","Info"],onClick:lt=>{K(lt)}}),q=="Your Positions"?o.jsx(al,{}):q=="Transactions"?o.jsx(rl,{windowWidth:W}):o.jsx(Qc,{})]})});return o.jsxs(et,{w:"100%",children:[o.jsxs(dt,{align:"center",cursor:"pointer",onClick:()=>it(!pt),sx:{"@media screen and (max-width: 810px)":{alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(dt,{align:"center",children:[o.jsx(Js,{w:"40px",coinAIconUrl:(mi=l==null?void 0:l.displayToken0)==null?void 0:mi.image,coinBIconUrl:(yi=l==null?void 0:l.displayToken1)==null?void 0:yi.image,variant:"border",showATag:Bt?!1:Y(((_i=l==null?void 0:l.displayToken0)==null?void 0:_i.metadata)||""),showBTag:Bt?!1:Y(((vi=l==null?void 0:l.displayToken1)==null?void 0:vi.metadata)||"")}),o.jsxs(F,{fontSize:"xl",color:"text_caption",ml:"4px",children:[(wi=l==null?void 0:l.displayToken0)==null?void 0:wi.symbol,"-",(ki=l==null?void 0:l.displayToken1)==null?void 0:ki.symbol]})]}),o.jsxs(dt,{w:"160px",h:"28px",border:"1px solid ",borderColor:"border",align:"center",ml:"20px",justify:"center",alignItems:"center",borderRadius:"8px",_hover:{bg:"bg_secondary",svg:{fill:"var(--chakra-colors-primary)"}},sx:{"@media screen and (max-width: 810px)":{w:"100%",ml:"0",mt:"12px"}},children:[o.jsx(F,{color:"primary",mr:"4px",children:"Change Pool"}),o.jsx(zt,{xlinkHref:"#icon-icon_open",variant:"gray"})]})]}),!Bt&&o.jsxs(o.Fragment,{children:[o.jsxs(I,{mt:"12px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column"}},children:[o.jsx(et,{sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:o.jsx(Ic,{w:"100%",feeTierDistribution:nt,feeTierDistributionLoading:Q,current:M,onClick:W=>{var lt,ft,St,Wt;W&&(W==null?void 0:W.value)===M||(W.title=="Not created"?t(`/pools/create/${(lt=l==null?void 0:l.displayToken0)==null?void 0:lt.metadata}/${(ft=l==null?void 0:l.displayToken1)==null?void 0:ft.metadata}/${W==null?void 0:W.value}`):(R(),t(`/pools/liquidity/${(St=l==null?void 0:l.displayToken0)==null?void 0:St.metadata}/${(Wt=l==null?void 0:l.displayToken1)==null?void 0:Wt.metadata}/${W.value}`)))}})}),o.jsxs(I,{align:"center",sx:{"@media screen and (max-width: 810px)":{w:"100%",mt:"-4px"}},children:[o.jsx($r,{name:(bi=l==null?void 0:l.displayToken0)==null?void 0:bi.symbol,address:(Ti=l==null?void 0:l.displayToken0)==null?void 0:Ti.metadata}),o.jsx($r,{name:(Si=l==null?void 0:l.displayToken1)==null?void 0:Si.symbol,address:(ji=l==null?void 0:l.displayToken1)==null?void 0:ji.metadata})]})]}),o.jsxs(I,{gap:"60px",mt:"16px",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",gap:"8px",mt:"12px",flexDirection:"column"}},children:[o.jsxs(J,{gap:"4px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},children:[o.jsx(F,{fontSize:"xs",children:"APR(24h)"}),o.jsx(Lc,{info:l,h5FontSize:"12px",children:o.jsx(F,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"xs"}},children:hc(V(l==null?void 0:l.totalApr).mul(100).toString())})})]}),o.jsx(bs,{text:"TVL(Total Value Locked)",value:he((Ci=l==null?void 0:l.pureTvlUSD)==null?void 0:Ci.now,2)}),o.jsx(bs,{text:"Volume(24h)",value:he((Ri=l==null?void 0:l.volUSD)==null?void 0:Ri.day,2)}),o.jsx(bs,{text:"Fees(24h)",value:he((Ei=l==null?void 0:l.feesUSD)==null?void 0:Ei.day,2)})]}),o.jsxs(I,{w:"100%",gap:"16px",mt:"40px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column"}},children:[o.jsxs(J,{w:"60%",gap:"16px",minW:"580px",sx:{"@media screen and (max-width: 810px)":{minW:"unset",w:"100%"}},children:[o.jsxs(I,{w:"100%",sx:{"@media screen and (max-width: 810px)":{display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(J,{w:"100%",align:"flex-start",gap:"4px",children:[o.jsx(F,{fontSize:"xs",children:"Current Price"}),o.jsxs(dt,{children:[o.jsx(F,{fontSize:"md",color:"text_caption",children:qt}),o.jsx(F,{fontSize:"md",ml:"8px",children:Dt})]})]}),o.jsx(I,{sx:{"@media screen and (max-width: 810px)":{w:"100%",justifyContent:"space-between"}}})]}),o.jsx(et,{h:"332px",w:"100%",mt:"0px",userSelect:"none",children:o.jsx(fp,{handleClickRefresh:ht,ref:rt,rangeChartType:z,setRangeChartType:$})}),o.jsxs(J,{w:"100%",m:"12px 0",children:[o.jsxs(I,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{mt:"60px",display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(dt,{align:"center",children:[o.jsx(F,{children:"Deposit Ratio"}),o.jsx(Rn,{label:"The Deposit Ratio indicates the proportion of token1 and token2 required to be deposited for the selected range.","aria-label":"Ratio",placement:e>810?"right":"bottom",children:o.jsx("button",{children:o.jsx(zt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsxs(I,{align:"center",gap:"12px",children:[o.jsxs(F,{color:"text_caption",children:[u==null?void 0:u.symbol," ",(u==null?void 0:u.metadata)&&(D==null?void 0:D[u==null?void 0:u.metadata]),"%"]}),o.jsx(et,{w:"100px",children:o.jsx(fc,{value:u!=null&&u.metadata&&(D==null?void 0:D[u==null?void 0:u.metadata])!=="--"?Number(D==null?void 0:D[u==null?void 0:u.metadata]):0})}),o.jsxs(F,{color:"text_caption",children:[c==null?void 0:c.symbol," ",(c==null?void 0:c.metadata)&&(D==null?void 0:D[c==null?void 0:c.metadata]),"%"]})]})]}),o.jsxs(I,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{mt:"12px",display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(dt,{align:"center",children:[o.jsx(F,{children:"Concentrated Liquidity Multiplier"}),o.jsx(Rn,{label:"Provide liquidity within a fixed price range, maximizing the efficiency of the capital locked.The Concentrated Liquidity Multiplier calculates the capital efficiency gains of a concentrated liquidity position relative to allocating capital across the entire price curve.","aria-label":"Multiplier",placement:e>810?"right":"bottom",children:o.jsx("button",{children:o.jsx(zt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsx(I,{align:"center",gap:"12px",children:o.jsx(F,{color:"text_caption",children:Tt})})]})]}),e>810&&ye(e)]}),o.jsxs(J,{w:"40%",minW:"380px",maxW:"440px",gap:"16px",sx:{"@media screen and (max-width: 810px)":{w:"100%",maxW:"unset",minW:"unset"}},children:[o.jsx(sl,{}),o.jsx(ll,{handleClickRefresh:ht}),e<=810&&ye(e)]})]}),o.jsx(pc,{isOpen:st,onClose:()=>{ct(!1),t("/pools/pool")},onContinue:function(){ct(!1)},tokens:gt})]}),Bt&&o.jsx(et,{mt:"20px",children:o.jsx(ge,{type:"nodata",text:"Pool not found",h:"330px"})}),o.jsx(tl,{isOpen:pt,onChange:vt,onClose:()=>it(!1)})]})}function $r(t){const{getExplorerUrl:e}=Hn(),{name:n,address:s}=t;return o.jsxs(dt,{w:"100%",bg:"bg_secondary",align:"center",p:"8px 12px",borderRadius:"8px",justifyContent:"center",children:[o.jsx(F,{fontSize:"xs",color:"text_caption",children:n}),o.jsx(jn,{href:e(s),target:"_blank",variant:"link",fontSize:"xs",color:"primary",ml:"8px",children:Pe(s)})]})}function bs(t){const{text:e,value:n}=t;return o.jsxs(J,{gap:"4px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},children:[o.jsx(F,{fontSize:"xs",children:e}),o.jsx(F,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"xs"}},children:n})]})}export{Rp as default};
