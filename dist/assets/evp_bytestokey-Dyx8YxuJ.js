import{s as B}from"./safe-buffer-B7h8REzA.js";import{m as c}from"./md5.js-FaoCCiYs.js";var t=B.Buffer,h=c;function u(o,f,v,i){if(t.isBuffer(o)||(o=t.from(o,"binary")),f&&(t.isBuffer(f)||(f=t.from(f,"binary")),f.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=v/8,y=t.alloc(a),l=t.alloc(i||0),r=t.alloc(0);a>0||i>0;){var n=new h;n.update(r),n.update(o),f&&n.update(f),r=n.digest();var e=0;if(a>0){var g=y.length-a;e=Math.min(a,r.length),r.copy(y,g,0,e),a-=e}if(e<r.length&&i>0){var p=l.length-i,m=Math.min(i,r.length-e);r.copy(l,p,e,e+m),i-=m}}return r.fill(0),{key:y,iv:l}}var E=u;export{E as e};
