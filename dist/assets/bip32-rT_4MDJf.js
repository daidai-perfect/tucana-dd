import{B as d}from"./vite-plugin-node-polyfills-2b3IylRN.js";import{b as T}from"./create-hash-B2etqZ4B.js";import{b as U}from"./create-hmac--QaKJlMo.js";import{b as N}from"./bs58check-DBgRgCjV.js";import{j as H}from"./tiny-secp256k1-DFomSNDX.js";import{t as S}from"./typeforce-Dson3yfq.js";import{w as x}from"./wif-Bj2Vat9l.js";var u={},p={},y={};Object.defineProperty(y,"__esModule",{value:!0});const b=T,A=U;function D(i){const e=b("sha256").update(i).digest();try{return b("rmd160").update(e).digest()}catch{return b("ripemd160").update(e).digest()}}y.hash160=D;function F(i,e){return A("sha512",i).update(e).digest()}y.hmacSHA512=F;Object.defineProperty(p,"__esModule",{value:!0});const _=y,P=N,c=H,o=S,M=x,w=o.BufferN(32),R=o.compile({wif:o.UInt8,bip32:{public:o.UInt32,private:o.UInt32}}),v={messagePrefix:`Bitcoin Signed Message:
`,bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},E=2147483648,C=Math.pow(2,31)-1;function j(i){return o.String(i)&&i.match(/^(m\/)?(\d+'?\/)*\d+'?$/)!==null}function k(i){return o.UInt32(i)&&i<=C}class K{constructor(e,t,r,n,s=0,h=0,f=0){this.__D=e,this.__Q=t,this.chainCode=r,this.network=n,this.__DEPTH=s,this.__INDEX=h,this.__PARENT_FINGERPRINT=f,o(R,n),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return this.__Q===void 0&&(this.__Q=c.pointFromScalar(this.__D,!0)),this.__Q}get privateKey(){return this.__D}get identifier(){return _.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return this.__D===void 0}neutered(){return l(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const e=this.network,t=this.isNeutered()?e.bip32.public:e.bip32.private,r=d.allocUnsafe(78);return r.writeUInt32BE(t,0),r.writeUInt8(this.depth,4),r.writeUInt32BE(this.parentFingerprint,5),r.writeUInt32BE(this.index,9),this.chainCode.copy(r,13),this.isNeutered()?this.publicKey.copy(r,45):(r.writeUInt8(0,45),this.privateKey.copy(r,46)),P.encode(r)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return M.encode(this.network.wif,this.privateKey,!0)}derive(e){o(o.UInt32,e);const t=e>=E,r=d.allocUnsafe(37);if(t){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");r[0]=0,this.privateKey.copy(r,1),r.writeUInt32BE(e,33)}else this.publicKey.copy(r,0),r.writeUInt32BE(e,33);const n=_.hmacSHA512(this.chainCode,r),s=n.slice(0,32),h=n.slice(32);if(!c.isPrivate(s))return this.derive(e+1);let f;if(this.isNeutered()){const a=c.pointAddScalar(this.publicKey,s,!0);if(a===null)return this.derive(e+1);f=l(a,h,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}else{const a=c.privateAdd(this.privateKey,s);if(a==null)return this.derive(e+1);f=g(a,h,this.network,this.depth+1,e,this.fingerprint.readUInt32BE(0))}return f}deriveHardened(e){return o(k,e),this.derive(e+E)}derivePath(e){o(j,e);let t=e.split("/");if(t[0]==="m"){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce((r,n)=>{let s;return n.slice(-1)==="'"?(s=parseInt(n.slice(0,-1),10),r.deriveHardened(s)):(s=parseInt(n,10),r.derive(s))},this)}sign(e,t){if(!this.privateKey)throw new Error("Missing private key");if(t===void 0&&(t=this.lowR),t===!1)return c.sign(e,this.privateKey);{let r=c.sign(e,this.privateKey);const n=d.alloc(32,0);let s=0;for(;r[0]>127;)s++,n.writeUIntLE(s,0,6),r=c.signWithEntropy(e,this.privateKey,n);return r}}verify(e,t){return c.verify(e,this.publicKey,t)}}function L(i,e){const t=P.decode(i);if(t.length!==78)throw new TypeError("Invalid buffer length");e=e||v;const r=t.readUInt32BE(0);if(r!==e.bip32.private&&r!==e.bip32.public)throw new TypeError("Invalid network version");const n=t[4],s=t.readUInt32BE(5);if(n===0&&s!==0)throw new TypeError("Invalid parent fingerprint");const h=t.readUInt32BE(9);if(n===0&&h!==0)throw new TypeError("Invalid index");const f=t.slice(13,45);let a;if(r===e.bip32.private){if(t.readUInt8(45)!==0)throw new TypeError("Invalid private key");const I=t.slice(46,78);a=g(I,f,e,n,h,s)}else{const I=t.slice(45,78);a=l(I,f,e,n,h,s)}return a}p.fromBase58=L;function B(i,e,t){return g(i,e,t)}p.fromPrivateKey=B;function g(i,e,t,r,n,s){if(o({privateKey:w,chainCode:w},{privateKey:i,chainCode:e}),t=t||v,!c.isPrivate(i))throw new TypeError("Private key not in range [1, n)");return new K(i,void 0,e,t,r,n,s)}function O(i,e,t){return l(i,e,t)}p.fromPublicKey=O;function l(i,e,t,r,n,s){if(o({publicKey:o.BufferN(33),chainCode:w},{publicKey:i,chainCode:e}),t=t||v,!c.isPoint(i))throw new TypeError("Point is not on the curve");return new K(void 0,i,e,t,r,n,s)}function $(i,e){if(o(o.Buffer,i),i.length<16)throw new TypeError("Seed should be at least 128 bits");if(i.length>64)throw new TypeError("Seed should be at most 512 bits");e=e||v;const t=_.hmacSHA512(d.from("Bitcoin seed","utf8"),i),r=t.slice(0,32),n=t.slice(32);return B(r,n,e)}p.fromSeed=$;Object.defineProperty(u,"__esModule",{value:!0});var m=p;u.fromSeed=m.fromSeed;u.fromBase58=m.fromBase58;u.fromPublicKey=m.fromPublicKey;u.fromPrivateKey=m.fromPrivateKey;export{u as s};
