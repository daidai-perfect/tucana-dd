import{j as o,y as uo,v as Qe,l as Bn,aA as ho,r as _,aB as Dr,t as q,aC as $r,o as me,V as J,F as ut,q as tt,R as Ie,N as ge,T as B,ak as he,H as Q,B as Xs,aD as Pe,aE as Ts,I as Lt,f as ke,aF as Hn,D as Ks,J as ie,K as Ye,aG as Ri,a8 as qn,S as Ae,aH as jn,w as Ge,aI as Se,aJ as lt,aK as sn,an as fo,ao as po,ap as go,aq as xo,M as mo,a as yo,b as _o,c as vo,d as wo,e as ko,aL as bo,aw as To,p as Zs,O as Js,aM as re,i as Cn,G as Nt,aN as Vn,aO as Un,aP as So,aQ as jo,a0 as Wn,al as Or,U as Co,W as Ro,Y as Ei,Z as ss,_ as Eo,s as Mo,aR as No,aj as Rn,aS as zo,aT as Lo,aU as Do,aV as $o,aW as Mi,aX as is,aY as Oo,a9 as Fo,aa as Bo,ab as Ho,ac as Ni,ad as rn,af as qo,ag as an,aZ as Vo,a_ as Uo,a$ as oe,b0 as zi,b1 as Wo,n as Fr,b2 as Po,b3 as Ss,b4 as Yo,a2 as Br,b5 as Ao,b6 as Go,b7 as Xo,b8 as Ko,Q as Zo,L as Jo,b9 as Qo,ba as Io}from"./index-BYAy_kcu.js";import{R as Qs,u as tc,P as ec,a as nc}from"./RectangularTab-CsU23vU6.js";import{R as Hr,Y as qr,X as Vr,A as sc,a as ic}from"./AreaChart-D1YRMXBh.js";import{B as rc}from"./BarChart-DdRvUhxY.js";import{e as Li,i as ue,T as Ur,B as ac,R as oc,c as Di,a as $i,b as cc,d as lc,_ as uc,f as dc,g as hc,h as Wr,s as fc,l as js,m as Pr,j as pc,k as gc,t as xc,n as mc}from"./generateCategoricalChart-I9mjujD2.js";import{u as Yr}from"./useRate-BuUI-FCM.js";import{g as Is,a as yc}from"./apiDataProcessing-DLoWrS-f.js";import{a as Oi,u as Cs,T as Fi,S as _c}from"./useDebounce-BWXlWUVv.js";import{a as $e,b as vc,T as Bi,u as wc}from"./useSearchPools-Dl0n3KuZ.js";import{u as kc,P as bc}from"./useSelectRange-D57P-jVr.js";import{u as Tc,a as Sc,b as jc,P as Cc,c as Rc,d as Ec,e as Mc}from"./PositionIncreaseModal-CRrOWR38.js";import{u as Hi}from"./useGetBalance-Dmjm76Tx.js";import{T as qi}from"./TableCardH5-CR61ty53.js";import{L as Vi}from"./LockMask-CNIjKUgL.js";import{A as Nc}from"./AprTooltip-J51qABB5.js";import{R as Pn}from"./RefreshIcon-BALk4t8Q.js";function Ar(){return o.jsx(uo,{h:"120px",children:o.jsx(Qe,{size:"lg"})})}function Ui(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function ti(t,e){this._context=t,this._k=(1-e)/6}ti.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ui(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ui(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(s){return new ti(s,e)}return n.tension=function(s){return t(+s)},n})(0);function zc(t,e,n){var s=t._x1,i=t._y1,a=t._x2,r=t._y2;if(t._l01_a>Li){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);s=(s*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>Li){var d=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,h=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*d+t._x1*t._l23_2a-e*t._l12_2a)/h,r=(r*d+t._y1*t._l23_2a-n*t._l12_2a)/h}t._context.bezierCurveTo(s,i,a,r,t._x2,t._y2)}function Gr(t,e){this._context=t,this._alpha=e}Gr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,s=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+s*s,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:zc(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Xr=function t(e){function n(s){return e?new Gr(s,e):new ti(s,0)}return n.alpha=function(s){return t(+s)},n}(.5);function Lc(t,e){let n,s;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=s=i):(n>i&&(n=i),s<i&&(s=i)));else{let i=-1;for(let a of t)(a=e(a,++i,t))!=null&&(n===void 0?a>=a&&(n=s=a):(n>a&&(n=a),s<a&&(s=a)))}return[n,s]}var Wi=180/Math.PI,Rs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Kr(t,e,n,s,i,a){var r,u,c;return(r=Math.sqrt(t*t+e*e))&&(t/=r,e/=r),(c=t*n+e*s)&&(n-=t*c,s-=e*c),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,c/=u),t*s<e*n&&(t=-t,e=-e,c=-c,r=-r),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Wi,skewX:Math.atan(c)*Wi,scaleX:r,scaleY:u}}var on;function Dc(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Rs:Kr(e.a,e.b,e.c,e.d,e.e,e.f)}function $c(t){return t==null||(on||(on=document.createElementNS("http://www.w3.org/2000/svg","g")),on.setAttribute("transform",t),!(t=on.transform.baseVal.consolidate()))?Rs:(t=t.matrix,Kr(t.a,t.b,t.c,t.d,t.e,t.f))}function Zr(t,e,n,s){function i(d){return d.length?d.pop()+" ":""}function a(d,h,l,p,f,w){if(d!==l||h!==p){var b=f.push("translate(",null,e,null,n);w.push({i:b-4,x:ue(d,l)},{i:b-2,x:ue(h,p)})}else(l||p)&&f.push("translate("+l+e+p+n)}function r(d,h,l,p){d!==h?(d-h>180?h+=360:h-d>180&&(d+=360),p.push({i:l.push(i(l)+"rotate(",null,s)-2,x:ue(d,h)})):h&&l.push(i(l)+"rotate("+h+s)}function u(d,h,l,p){d!==h?p.push({i:l.push(i(l)+"skewX(",null,s)-2,x:ue(d,h)}):h&&l.push(i(l)+"skewX("+h+s)}function c(d,h,l,p,f,w){if(d!==l||h!==p){var b=f.push(i(f)+"scale(",null,",",null,")");w.push({i:b-4,x:ue(d,l)},{i:b-2,x:ue(h,p)})}else(l!==1||p!==1)&&f.push(i(f)+"scale("+l+","+p+")")}return function(d,h){var l=[],p=[];return d=t(d),h=t(h),a(d.translateX,d.translateY,h.translateX,h.translateY,l,p),r(d.rotate,h.rotate,l,p),u(d.skewX,h.skewX,l,p),c(d.scaleX,d.scaleY,h.scaleX,h.scaleY,l,p),d=h=null,function(f){for(var w=-1,b=p.length,g;++w<b;)l[(g=p[w]).i]=g.x(f);return l.join("")}}}var Oc=Zr(Dc,"px, ","px)","deg)"),Fc=Zr($c,", ",")",")"),Bc=1e-12;function Pi(t){return((t=Math.exp(t))+1/t)/2}function Hc(t){return((t=Math.exp(t))-1/t)/2}function qc(t){return((t=Math.exp(2*t))-1)/(t+1)}const Vc=function t(e,n,s){function i(a,r){var u=a[0],c=a[1],d=a[2],h=r[0],l=r[1],p=r[2],f=h-u,w=l-c,b=f*f+w*w,g,m;if(b<Bc)m=Math.log(p/d)/e,g=function(N){return[u+N*f,c+N*w,d*Math.exp(e*N*m)]};else{var S=Math.sqrt(b),T=(p*p-d*d+s*b)/(2*d*n*S),j=(p*p-d*d-s*b)/(2*p*n*S),E=Math.log(Math.sqrt(T*T+1)-T),M=Math.log(Math.sqrt(j*j+1)-j);m=(M-E)/e,g=function(N){var C=N*m,$=Pi(E),H=d/(n*S)*($*qc(e*C+E)-Hc(E));return[u+H*f,c+H*w,d*$/Pi(e*C+E)]}}return g.duration=m*1e3*e/Math.SQRT2,g}return i.rho=function(a){var r=Math.max(.001,+a),u=r*r,c=u*u;return t(r,u,c)},i}(Math.SQRT2,2,4);function Jr(){const t=Bn(ho),[e,n]=_.useState([]),[s,i]=_.useState(!0);return{loading:s,dataList:e,getHistogramData:async r=>{i(!0);try{const u=new URLSearchParams;u.append("date_type",String(r.date_type)),u.append("histogram_type",String(r.histogram_type)),u.append("limit",String(r.limit)),r.pool_address&&u.append("id",String(r.pool_address));const d=await(await fetch(`${t}?${u.toString()}`)).json();console.log("getHistogramData: ",d);const h=[];d&&d.data&&d.data.list&&d.data.list.forEach(l=>{h.push({name:"Page A",time:l.date,uv:0,pv:l.num,amt:0})}),console.log("getHistogramData list: ",h),n(h),i(!1)}catch(u){console.log(u,"getHistogramData"),i(!1)}}}}const Uc=Dr(t=>({displayToken0Value:"",displayToken1Value:"",addToken0:void 0,addToken1:void 0,currentFeeTier:"",currentApiPoolInfo:null,currentContractPoolInfo:null,currentPrice:"",inversePrice:"",baseCoin:"",currentApiPoolInfoIsLoading:!0,currentContractPoolInfoIsLoading:!0,priceRangePercentage:0,defaultPriceRangePercentage:0,minPriceData:void 0,maxPriceData:void 0,precomputationInfo:void 0,ratio:{},submitIsLoading:!1,setSubmitIsLoading:e=>{t(()=>({submitIsLoading:e}))},setRatio:e=>{t(()=>({ratio:e}))},setDisplayToken0Value:e=>{t(()=>({displayToken0Value:e}))},setDisplayToken1Value:e=>{t(()=>({displayToken1Value:e}))},setAddToken0:e=>{t(()=>({addToken0:e}))},setAddToken1:e=>{t(()=>({addToken1:e}))},setCurrentFeeTier:e=>{const n=$r(e);t(()=>({currentFeeTier:e,priceRangePercentage:n,defaultPriceRangePercentage:n}))},setCurrentApiPoolInfo:e=>{t(()=>({currentApiPoolInfo:e}))},setCurrentContractPoolInfo:e=>{t(()=>({currentContractPoolInfo:e}))},setCurrentPrice:e=>{t(()=>({currentPrice:e,inversePrice:q(1).div(e).toString()}))},setBaseCoin:e=>{t(()=>({baseCoin:e}))},setCurrentApiPoolInfoIsLoading:e=>{t(()=>({currentApiPoolInfoIsLoading:e}))},setCurrentContractPoolInfoIsLoading:e=>{t(()=>({currentContractPoolInfoIsLoading:e}))},setPriceRangePercentage:e=>{t(()=>({priceRangePercentage:e}))},saveMinPriceData:e=>{t(()=>({minPriceData:e}))},saveMaxPriceData:e=>{t(()=>({maxPriceData:e}))},setPrecomputationInfo:e=>{t(()=>({precomputationInfo:e}))},currentPoolPositions:[],setCurrentPoolPositions:e=>{t(()=>({currentPoolPositions:e}))},currentPoolPositionsIsLoading:!0,setCurrentPoolPositionsIsLoading:e=>{t(()=>({currentPoolPositionsIsLoading:e}))},isShowMinMaxDist:!1,setIsShowMinMaxDist:e=>{t(()=>({isShowMinMaxDist:e}))},minDistPercentange:"",maxDistPercentange:"",setMinDistPercentange:e=>{t(()=>({minDistPercentange:e}))},setMaxDistPercentange:e=>{t(()=>({maxDistPercentange:e}))},resetLiquidityState:()=>{t(()=>({displayToken0Value:"",displayToken1Value:"",addToken0:void 0,addToken1:void 0,currentApiPoolInfo:null,currentContractPoolInfo:null,currentPrice:"",inversePrice:"",baseCoin:"",currentApiPoolInfoIsLoading:!0,currentContractPoolInfoIsLoading:!0,minPrice:"",maxPrice:"",lowerTick:"",upperTick:"",priceRangePercentage:0,defaultPriceRangePercentage:0,minPriceData:void 0,maxPriceData:void 0,precomputationInfo:void 0,ratio:{},submitIsLoading:!1,currentPoolPositionsIsLoading:!0,currentPoolPositions:[],isShowMinMaxDist:!1}))}})),Rt=Uc,Qr=t=>{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=t.getUTCFullYear(),s=e[t.getUTCMonth()],i=t.getUTCDate();return`${s} ${i}, ${n} (UTC)`};function Wc(){const{currentApiPoolInfo:t}=Rt(),[e,n]=_.useState("Volume"),[s,i]=_.useState("1D"),a=_.useMemo(()=>{if(t)return console.log({radioValue:s,currentTab:e}),{date_type:s=="1D"?"day":s=="7D"?"week":"month",histogram_type:e==="Volume"?"vol":"pure_tvl",limit:s=="1D"?40:s=="7D"?30:20,pool_address:t.address}},[t,s,e]),r=d=>{console.log("handleRadioChange value: ",d),i(d)},u=()=>o.jsx(ut,{h:"20px",children:o.jsx(Ie,{options:["1D","7D","30D"],size:"s",value:s,onChange:r})}),{windowWidth:c}=me();return o.jsxs(J,{w:"100%",align:"flex-start",gap:"0",borderRadius:"12px",children:[o.jsxs(ut,{w:"100%",align:"center",justify:"space-between",children:[o.jsx(tt,{children:o.jsx(Qs,{w:"90px",h:"28px",p:"4px",borderRadius:"4px",currentTab:e,textList:["Volume","Liquidity"],onClick:d=>{n(d)}})}),c>810&&u()]}),e==="Volume"&&o.jsx(Pc,{requestParams:a,RadioCardGroupNode:u()}),e==="Liquidity"&&o.jsx(Yc,{requestParams:a,RadioCardGroupNode:u()})]})}function Ir(t){const{windowWidth:e}=me(),{label:n,value:s,time:i,RadioCardGroupNode:a}=t;return o.jsxs(tt,{children:[o.jsx(ut,{w:"100%",justify:"space-between",mt:"12px",children:o.jsxs(J,{gap:"0",align:"flex-start",children:[o.jsx(B,{fontSize:"xs",children:n}),o.jsx(B,{fontSize:"2xl",color:"text_caption",children:he(s,2)})]})}),o.jsx(B,{w:"100%",mb:"12px",fontSize:"xs",children:i}),e<=810&&o.jsx(tt,{mb:"20px",children:a})]})}function Pc(t){const{requestParams:e,RadioCardGroupNode:n}=t,{loading:s,dataList:i,getHistogramData:a}=Jr(),r=_.useMemo(()=>i.slice().reverse(),[i]);_.useEffect(()=>{e&&a(e)},[e]);const[u,c]=_.useState(null),d=w=>{if(w&&w.activePayload&&w.activePayload.length){const b=w.activePayload[0];c(b.payload)}},h=()=>{},l=_.useMemo(()=>u?Qr(new Date(u.time)):"",[u]);_.useEffect(()=>{r.length>0?c(r[0]):c(null)},[r]);const p=(r==null?void 0:r.length)>0?Math.floor(Math.min(...r.map(w=>w.pv))):0,f=Math.ceil(Math.max(...r.map(w=>w.pv)));return o.jsxs(tt,{width:"100%",children:[o.jsx(Ir,{label:"Trading Volume (24H)",value:(u==null?void 0:u.pv)||"0",time:l,RadioCardGroupNode:n}),s?o.jsx(J,{p:"20px 0px 70px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(Qe,{})}):(r==null?void 0:r.length)==0?o.jsx(J,{p:"40px 0px 50px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(ge,{type:"nodata",noBg:!0,text:"No token data yet"})}):o.jsx(Hr,{width:"100%",height:200,children:o.jsxs(rc,{data:r,barSize:5,barCategoryGap:120,onMouseEnter:d,onMouseMove:d,onMouseLeave:h,margin:{top:8,right:8,left:8,bottom:0},children:[o.jsx(Ur,{cursor:{stroke:"var(--chakra-colors-primary)",strokeWidth:10,strokeDasharray:"3 2"},content:o.jsx(ea,{type:"Volume"})}),o.jsx(ac,{dataKey:"pv",fill:"var(--chakra-colors-primary)",className:"custom-bar"}),o.jsx(qr,{domain:[p,f],hide:!0}),o.jsx(Vr,{scale:"point",dataKey:"time",reversed:!0,tickLine:!1,tick:ta,interval:(r==null?void 0:r.length)<10?0:parseInt(String((r==null?void 0:r.length)/6))}),u&&o.jsx(oc,{x:u.time,stroke:"var(--chakra-colors-chart_tooltip_line)",strokeDasharray:"3 3"})]})})]})}function Yc(t){const{requestParams:e,RadioCardGroupNode:n}=t,{loading:s,dataList:i,getHistogramData:a}=Jr(),r=_.useMemo(()=>i.reverse(),[i]),u=(r==null?void 0:r.length)>0?Math.floor(Math.min(...r.map(w=>w.pv))):0,c=Math.ceil(Math.max(...r.map(w=>w.pv)));_.useEffect(()=>{e&&a(e)},[e]);const[d,h]=_.useState(null),l=w=>{if(w&&w.activePayload&&w.activePayload.length){const b=w.activePayload[0];h(b.payload)}},p=()=>{},f=_.useMemo(()=>d?Qr(new Date(d.time)):"",[d]);return _.useEffect(()=>{r.length>0?h(r[0]):h(null)},[r]),o.jsxs(tt,{width:"100%",children:[o.jsx(Ir,{label:"Liquidity",value:(d==null?void 0:d.pv)||"0",time:f,RadioCardGroupNode:n}),s?o.jsx(J,{p:"20px 0px 70px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(Qe,{})}):(r==null?void 0:r.length)==0?o.jsx(J,{p:"40px 0px 50px",h:"178px",justifyContent:"center",sx:{"@media screen and (max-width: 810px)":{h:"200px"}},children:o.jsx(ge,{type:"nodata",noBg:!0,text:"No token data yet"})}):o.jsx(Hr,{width:"100%",height:200,children:o.jsxs(sc,{data:r,syncId:"Liquidity",onMouseEnter:l,onMouseMove:l,onMouseLeave:p,margin:{top:8,right:8,left:8,bottom:0},children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-primary)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-primary)",stopOpacity:0})]}),o.jsxs("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-primary)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-primary)",stopOpacity:0})]})]}),o.jsx(Vr,{dataKey:"time",reversed:!0,tickLine:!1,tick:ta,interval:(r==null?void 0:r.length)<10?0:parseInt(String((r==null?void 0:r.length)/6))}),o.jsx(qr,{domain:[u,c],hide:!0}),o.jsx(Ur,{cursor:{stroke:"var(--chakra-colors-primary)",strokeWidth:1,strokeDasharray:"3 2"},content:o.jsx(ea,{type:"Liquidity"})}),o.jsx(ic,{type:"monotone",dataKey:"pv",stroke:"var(--chakra-colors-primary)",fill:"url(#colorUv)"})]})})]})}const ta=t=>{const{x:e,y:n,payload:s,type:i}=t,a=new Date(s.value);["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][a.getUTCDay()];const u=Number(a.getUTCDate())>=10?`${a.getUTCDate()}`:`0${a.getUTCDate()}`;return o.jsx("g",{transform:`translate(${e},${n})`,children:o.jsx("text",{x:0,y:0,dy:i=="totalValue"?12:18,textAnchor:"middle",fill:"var(--chakra-colors-text_paragraph)",fontSize:12,children:u})})},ea=t=>null;function Ac(){const{currentApiPoolInfo:t,currentFeeTier:e}=Rt(),{getExplorerUrl:n}=Hn(),{windowWidth:s}=me();return o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(B,{children:"Pool Info"}),o.jsxs(Q,{justify:"space-between",h:"80px",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"8px",p:"12px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",h:"unset"}},children:[o.jsxs(ut,{w:"100%",align:"center",justify:"space-between",flexDirection:"column",sx:{"@media screen and (max-width: 810px)":{flexDirection:"row"}},children:[o.jsx(B,{fontSize:"xs",children:"Pool Address"}),o.jsxs(ut,{alignItems:"center",children:[o.jsx(Xs,{variant:"link",fontSize:"12px",children:Pe(t==null?void 0:t.address)}),o.jsx(tt,{m:"0 4px",children:o.jsx(Ts,{text:t==null?void 0:t.address})}),o.jsx(Lt,{xlinkHref:"#icon-icon_lead",cursor:"pointer",transform:"rotate(-45deg)",onClick:()=>{window.open(n(t==null?void 0:t.address),"_blank")}})]})]}),o.jsx(ke,{text:"Tick Spacing",textFontSize:"12px",valueFontSize:"12px",value:t==null?void 0:t.tickSpacing,isColumn:!(s<=810)}),o.jsx(ke,{text:"Fee Tier",textFontSize:"12px",valueFontSize:"12px",value:Is(e),isColumn:!(s<=810)})]})]})}function Gc(t,e,n){const{tucanaSpotSDK:s}=Ks(),[i,a]=_.useState(["0","0"]),[r,u]=_.useState(["0","0"]),c=Oi(e,i[0],2,!0),d=Oi(n,i[1],2,!0);return _.useEffect(()=>{t&&e&&n?s.Pool.getPoolTokenAmounts(t).then(h=>{console.log("------------------",h,n,e),a([ie(new Ye(h[0]),e.decimals).toString(),ie(new Ye(h[1]),n.decimals).toString()])}):a(["0","0"])},[t]),_.useEffect(()=>{try{if(t&&e&&n){const h=q(c).add(d);if(h.eq("0"))u(["--","--"]);else{const l=q(c).div(h).mul(100),p=q(100).sub(l);l.lessThanOrEqualTo(.01)?u(["<0.01","99.99"]):p.lessThanOrEqualTo(.01)?u(["99.99","<0.01"]):u([l.toFixed(2,Ri.ROUND_DOWN),p.toFixed(2,Ri.ROUND_UP)])}}else u(["--","--"])}catch{u(["--","--"])}},[c,d]),{tokenAmounts:i,tokenRatios:r,amount0Rate:c,amount1Rate:d}}function Xc(){var c,d,h,l,p,f,w,b,g,m,S,T;const{getExplorerUrl:t}=Hn(),{currentApiPoolInfo:e}=Rt(),{tokenAmounts:n,tokenRatios:s,amount0Rate:i,amount1Rate:a}=Gc(e==null?void 0:e.address,e==null?void 0:e.token0,e==null?void 0:e.token1),{isImportToken:r}=qn(),u=(e==null?void 0:e.isReverse)||!1;return o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(B,{children:"Pool Composition"}),o.jsxs(Q,{justify:"space-between",w:"100%",h:"132px",align:"center",border:"1px solid",borderColor:"border",borderRadius:"8px",p:"12px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",h:"unset"}},children:[o.jsxs(J,{w:"50%",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[o.jsxs(Q,{w:"100%",align:"center",justify:"space-between",children:[o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{children:o.jsx(Ae,{imageUrl:(c=e==null?void 0:e.displayToken0)==null?void 0:c.image,w:"20px",h:"20px",showTag:r((d=e==null?void 0:e.displayToken0)==null?void 0:d.metadata),showTagWidth:"12px",showTagHeight:"12px"})}),o.jsx(B,{fontSize:"xs",children:(h=e==null?void 0:e.displayToken0)==null?void 0:h.symbol})]}),o.jsxs(Q,{alignItems:"center",children:[o.jsx(jn,{href:t((l=e==null?void 0:e.displayToken0)==null?void 0:l.metadata,"accounts"),fontSize:"xs",target:"_blank",children:Pe((p=e==null?void 0:e.displayToken0)==null?void 0:p.metadata)}),o.jsx(Ts,{text:((f=e==null?void 0:e.displayToken0)==null?void 0:f.metadata)||""})]})]}),o.jsx(B,{}),o.jsx(ke,{text:"Amount",textFontSize:"12px",valueFontSize:"12px",value:Ge(n[u?1:0]).toString()}),o.jsx(B,{w:"100%",align:"right",fontSize:"xs",mt:"-12px",children:`${he(u?a:i,2)}`}),o.jsx(ke,{text:"Token Ratio",textFontSize:"12px",valueFontSize:"12px",value:`${s[u?1:0]}%`})]}),o.jsx(tt,{w:"1px",h:"92px",bg:"border",m:"0 24px",sx:{"@media screen and (max-width: 810px)":{w:"100%",h:"1px",m:"12px 24px"}}}),o.jsxs(J,{w:"50%",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[o.jsxs(Q,{w:"100%",align:"center",justify:"space-between",children:[o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{children:o.jsx(Ae,{imageUrl:(w=e==null?void 0:e.displayToken1)==null?void 0:w.image,w:"20px",h:"20px",showTag:r((b=e==null?void 0:e.displayToken1)==null?void 0:b.metadata),showTagWidth:"12px",showTagHeight:"12px"})}),o.jsx(B,{fontSize:"xs",children:(g=e==null?void 0:e.displayToken1)==null?void 0:g.symbol})]}),o.jsxs(Q,{alignItems:"center",children:[o.jsx(jn,{href:t((m=e==null?void 0:e.displayToken1)==null?void 0:m.metadata,"accounts"),fontSize:"xs",target:"_blank",children:Pe((S=e==null?void 0:e.displayToken1)==null?void 0:S.metadata)}),o.jsx(Ts,{text:((T=e==null?void 0:e.displayToken1)==null?void 0:T.metadata)||"0"})]})]}),o.jsx(B,{}),o.jsx(ke,{text:"Amount",textFontSize:"12px",valueFontSize:"12px",value:Ge(n[u?0:1]).toString()}),o.jsx(B,{w:"100%",align:"right",fontSize:"xs",mt:"-12px",children:`${he(u?i:a,2)}`}),o.jsx(ke,{text:"Token Ratio",textFontSize:"12px",valueFontSize:"12px",value:`${s[u?0:1]}%`})]})]})]})}function Kc(){const{currentApiPoolInfo:t}=Rt(),{getRate:e}=Yr(),n=_.useMemo(()=>{var i;if(t){const a=(i=t==null?void 0:t.rewarderApr)==null?void 0:i.reduce((r,u)=>q(r).add(u.apr).toNumber(),0);return Se(q(a).mul(100).toNumber(),2)}return 0},[t]),s=_.useMemo(()=>{var a;const i=[];return(a=t==null?void 0:t.rewarderUSD)==null||a.forEach(r=>{if(q(r==null?void 0:r.amountSecond).gt(0)){const u=yc(r==null?void 0:r.amountSecond),c=e(u,r.metadata);i.push({...r,dayAmount:u,dayAmountRate:c})}}),i},[t]);return o.jsxs(J,{w:"100%",p:"16px",justifyContent:"center",gap:"24px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(J,{w:"100%",gap:"24px",children:[o.jsx(Ac,{}),o.jsx(Xc,{})]}),o.jsxs(J,{w:"100%",align:"flex-start",children:[o.jsx(Wc,{}),(s==null?void 0:s.length)>0&&o.jsxs(tt,{w:"100%",mt:"8px",children:[o.jsx(B,{children:"Rewards"}),o.jsxs(Q,{p:"20px",m:"12px 0",gap:"36px",align:"center",w:"100%",border:"1px solid",borderColor:"border",borderRadius:"8px",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",gap:"16px"}},children:[o.jsxs(ut,{children:[o.jsx(B,{mr:"8px",fontSize:"md",children:"APR"}),o.jsxs(B,{color:"primary",fontSize:"md",children:[n,"%"]})]}),o.jsx(J,{align:"flex-start",children:s==null?void 0:s.map(i=>o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{children:o.jsx(Ae,{imageUrl:i==null?void 0:i.image,w:"20px",h:"20px"})}),o.jsxs(B,{fontSize:"xs",color:"text_caption",display:"inline-block",children:[i==null?void 0:i.dayAmount,o.jsxs(B,{fontSize:"xs",display:"inline-block",children:["Â ($",i==null?void 0:i.dayAmountRate,")Â "]}),i==null?void 0:i.symbol," per day"]})]}))})]})]})]})]})}function Zc(t){const{w:e,current:n,feeTierDistribution:s,feeTierDistributionLoading:i,onClick:a}=t,[r,u]=_.useState(!1),c=()=>{u(!0)},d=()=>{u(!1)},h=_.useMemo(()=>[{title:(s==null?void 0:s[lt.LOWEST])!==-1?`${sn(s==null?void 0:s[lt.LOWEST],2)}% seclect`:"Not created",content:"Best for very stable pairs",percent:"0.01%",canCreate:(s==null?void 0:s[lt.LOWEST])===-1,value:lt.LOWEST},{title:(s==null?void 0:s[lt.LOW])!==-1?`${sn(s==null?void 0:s[lt.LOW],2)}% seclect`:"Not created",content:"Best for stable pairs",percent:"0.05%",canCreate:(s==null?void 0:s[lt.LOW])===-1,value:lt.LOW},{title:(s==null?void 0:s[lt.MEDIUM])!==-1?`${sn(s==null?void 0:s[lt.MEDIUM],2)}% seclect`:"Not created",content:"Best for most pairs",percent:"0.25%",canCreate:(s==null?void 0:s[lt.MEDIUM])===-1,value:lt.MEDIUM},{title:(s==null?void 0:s[lt.HIGH])!==-1?`${sn(s==null?void 0:s[lt.HIGH],2)}% seclect`:"Not created",content:"Best for exotic pairs",percent:"1%",canCreate:(s==null?void 0:s[lt.HIGH])===-1,value:lt.HIGH}],[s]),l=p=>{console.log("SelectFeeTier item: ",p),a(p)};return o.jsx(tt,{pb:"8px",onClick:()=>u(!r),onMouseLeave:d,onMouseEnter:c,children:o.jsx(fo,{isOpen:r,onClose:d,children:({isOpen:p})=>o.jsxs(o.Fragment,{children:[o.jsx(po,{w:e||"",p:"8px 12px",isActive:r,as:Xs,bg:"bg_secondary",h:"34px",borderRadius:"8px",sx:{_hover:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}},_active:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}}},children:o.jsxs(ut,{w:e||"",align:"center",justifyContent:"center",children:[o.jsxs(B,{color:"text_caption",mr:"4px",fontSize:"xs",children:[n&&Is(n)," fee tier"]}),o.jsx(Lt,{xlinkHref:"#icon-icon_open",variant:"gray",transition:"transform 0.5s",transform:r?"rotate(180deg)":"rotate(0deg)"})]})}),o.jsx(go,{p:"4px",opacity:"1",children:h.map(f=>o.jsx(xo,{p:"8px 12px",bg:f.value==n?"primary_10":"",borderRadius:"8px",sx:{_hover:{bg:"primary_10"}},onClick:()=>{u(!1),l(f)},children:o.jsxs(ut,{w:"100%",align:"center",justifyContent:"space-between",children:[o.jsxs(J,{gap:"0",align:"flex-start",children:[o.jsx(B,{color:"primary",fontSize:"xs",children:f.title}),o.jsx(B,{fontSize:"xs",children:f.content})]}),o.jsx(B,{color:f.value==n?"primary":"text_caption",ml:"12px",children:f.percent})]})},f.value))})]})})})}function Jc(t){const{isOpen:e,onClose:n,onChange:s}=t,[i,a]=_.useState("");return _.useEffect(()=>{e||a("")},[e]),o.jsxs(mo,{isOpen:e,onClose:n,isCentered:!0,children:[o.jsx(yo,{}),o.jsxs(_o,{children:[o.jsx(vo,{children:"Select Pool"}),o.jsx(wo,{}),o.jsxs(ko,{pb:"16px",w:"100%",minH:"400px",maxH:"calc(100vh - 40px)",children:[o.jsx(bo,{searchText:i,placeholder:"Search by token or pool address",onChange:r=>{a(r)}}),o.jsx(tt,{mt:"20px",w:"100%",h:"1px",bg:"border"}),o.jsx(Qc,{searchText:i,onChange:r=>{s(r),n()}})]})]})]})}function Qc(t){const{onChange:e,searchText:n}=t,[s,i]=_.useState($e.OfficialPools),{filterPoolList:a}=vc(n,s),r=_.useMemo(()=>a.sort((c,d)=>{var h,l;return q(((h=d.volUSD)==null?void 0:h.day)||"0").sub(((l=c.volUSD)==null?void 0:l.day)||"0").toNumber()}),[a]),u=_.useMemo(()=>s===$e.AllPools,[s]);return o.jsxs(tt,{w:"100%",pt:"20px",minHeight:"300px",maxH:"calc(100vh - 180px)",overflowY:"scroll",children:[o.jsxs(Q,{justifyContent:"space-between",children:[o.jsx(B,{children:"Pool"}),o.jsxs(ut,{alignItems:"center",children:[o.jsx(To,{checked:u,onClick:()=>{s===$e.AllPools?i($e.OfficialPools):i($e.AllPools)}}),o.jsx(B,{ml:"14px",color:u?"primary":"text_paragraph",children:"Display All Pools"})]})]}),a.length===0&&o.jsx(tt,{mt:"40px",children:o.jsx(ge,{type:"nodata",background:"transparent",h:"80px",text:"No pool found"})}),r.map((c,d)=>o.jsxs(tt,{children:[o.jsx(Ic,{pool:c,onChange:e},d),d!==a.length-1&&o.jsx(tt,{w:"100%",h:"1px",bg:"border"})]}))]})}function Ic(t){var i,a,r,u,c,d;const{onChange:e,pool:n}=t,{isImportToken:s}=qn();return o.jsxs(Q,{w:"100%",h:"65px",justifyContent:"space-between",cursor:"pointer",_hover:{opacity:"0.8"},onClick:()=>e(n),children:[o.jsxs(Q,{gap:"10px",alignItems:"center",children:[o.jsx(tt,{children:o.jsx(Zs,{w:"40px",coinAIconUrl:(i=n==null?void 0:n.displayToken0)==null?void 0:i.image,coinBIconUrl:(a=n==null?void 0:n.displayToken1)==null?void 0:a.image,variant:"border",showATag:s((r=n==null?void 0:n.displayToken0)==null?void 0:r.metadata),showBTag:s((u=n==null?void 0:n.displayToken1)==null?void 0:u.metadata)})}),o.jsxs(B,{color:"text_caption",fontSize:"md",children:[(c=n==null?void 0:n.displayToken0)==null?void 0:c.symbol," - ",(d=n==null?void 0:n.displayToken1)==null?void 0:d.symbol]})]}),o.jsx(B,{mt:"4px",p:"0px 8px",color:"primary",fontSize:"xs",minW:"52px",h:"16px",lineHeight:"16px",borderRadius:"8px",bg:"bg_secondary",textAlign:"center",children:Is(n==null?void 0:n.feeTier)})]})}function ei(){Js();const{setBaseCoin:t,baseCoin:e,addToken0:n,addToken1:s,currentPrice:i,currentContractPoolInfo:a,currentApiPoolInfo:r,currentFeeTier:u,minPriceData:c,maxPriceData:d,saveMinPriceData:h,saveMaxPriceData:l,defaultPriceRangePercentage:p,priceRangePercentage:f,setPriceRangePercentage:w,isShowMinMaxDist:b,setIsShowMinMaxDist:g}=Rt(),m=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),S=_.useMemo(()=>n||(r==null?void 0:r.token0),[n,r]),T=_.useMemo(()=>s||(r==null?void 0:r.token1),[s,r]),j=(x,v,y,k,R)=>{const z=v,D=y;z&&D&&k?x===100?(h(re.buildMinTickPriceData(k,z,D)),l(re.buildMaxTickPriceData(k,z,D))):(h(re.buildTickPriceData(q(R).mul(q(1).minus(q(x).div(100))).toString(),k,z,D)),l(re.buildTickPriceData(q(R).mul(q(1).add(q(x).div(100))).toString(),k,z,D))):(h(void 0),l(void 0))},E=x=>{h(x)},M=x=>{l(x)},{isFullRange:N,handleMinPriceClick:C,handleMaxPriceClick:$,onInputPriceChange:H}=kc({minPriceData:c,maxPriceData:d,saveMinPriceData:h,saveMaxPriceData:l,token0:S,token1:T,tickSpacing:m});return{minPriceData:c,maxPriceData:d,handleBaseCoinChange:x=>{var v;try{const y=r==null?void 0:r.token0,k=r==null?void 0:r.token1,R=a==null?void 0:a.tick_spacing;t(x),x!==e&&y&&k&&c&&d&&(E(d.getInverseTickPrice()),M(c.getInverseTickPrice()));const z=x===((v=r==null?void 0:r.token0)==null?void 0:v.symbol)}catch(y){console.log("handleBaseCoinChange error: ",y)}},handleMinPriceClick:C,handleMaxPriceClick:$,isFullRange:N,handleChangeRange:j,handleChangeMinPrice:E,handleChangeMaxPrice:M,handleInputPriceChange:(x,v,y)=>{console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ price:",x),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ isMin:",v),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputPriceChange ~ isInputComplete:",y),H(x,v,y),g(!0)},handleInputBlur:(x,v,y)=>{console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ price:",x),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ isMin:",v),console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ isInputComplete:",y);let k=x;x===""&&(console.log("ðŸš€ ~ file: useLiquiditySelectRange.ts:96 ~ handleInputBlur ~ price is empty:"),v?k=q(i).mul(q(1).minus(q(p).div(100))).toString():k=q(i).mul(q(1).add(q(p).div(100))).toString()),H(k,v,y),g(!0)}}}function ni(){const{baseCoin:t,currentApiPoolInfo:e,currentPrice:n,inversePrice:s}=Rt(),i=_.useMemo(()=>{var r,u;return t&&e?(console.log("displayCurrentPrice baseCoin: ",t),console.log("displayCurrentPrice currentApiPoolInfo?.token0?.symbol: ",(r=e==null?void 0:e.token0)==null?void 0:r.symbol),t===((u=e==null?void 0:e.token0)==null?void 0:u.metadata)?Cn(n):Cn(s)):""},[t,n,s,e]),a=_.useMemo(()=>{var r;return t&&e?t===((r=e==null?void 0:e.token0)==null?void 0:r.metadata)?`${e==null?void 0:e.token1.symbol} per ${e==null?void 0:e.token0.symbol}`:`${e==null?void 0:e.token0.symbol} per ${e==null?void 0:e.token1.symbol}`:""},[t,n,s,e]);return{displayCurrentPrice:i,displayPerText:a}}function na(){const{tucanaSpotSDK:t}=Ks(),{getRate:e}=Yr(),{setCurrentPoolPositions:n,setCurrentPoolPositionsIsLoading:s}=Rt();return{getCurrentPoolPositions:async(a,r,u)=>{try{s(!0);const c=[],d=await t.Position.getPositionList(u,r?[r.position_collection]:[]);d==null||d.forEach(h=>{var l,p,f,w;if((h==null?void 0:h.pool_address)===(a==null?void 0:a.id)){const b=h.tick_lower_index===Nt.getInitializableTickIndex(Vn,r.tick_spacing)?"0":Nt.tickIndexToPrice(h.tick_lower_index,(l=a==null?void 0:a.token0)==null?void 0:l.decimals,(p=a==null?void 0:a.token1)==null?void 0:p.decimals).toString(),g=h.tick_upper_index===Nt.getInitializableTickIndex(Un,r.tick_spacing)?"âˆž":Nt.tickIndexToPrice(h.tick_upper_index,(f=a==null?void 0:a.token0)==null?void 0:f.decimals,(w=a==null?void 0:a.token1)==null?void 0:w.decimals).toString(),m=a!=null&&a.isReverse?g==="âˆž"?"0":q(1).div(g).toString():b,S=a!=null&&a.isReverse?b==="0"?"âˆž":q(1).div(b).toString():g,T=So(r==null?void 0:r.current_tick_index,h.tick_lower_index,h.tick_upper_index),j=jo(h.liquidity,r.current_sqrt_price,h==null?void 0:h.tick_lower_index,h==null?void 0:h.tick_upper_index),E=ie(j==null?void 0:j.coinA,a.token0.decimals),M=ie(j==null?void 0:j.coinB,a.token1.decimals),N=E?e(E,a==null?void 0:a.token0.metadata,6,!0):"0",C=M?e(M,a==null?void 0:a.token1.metadata,6,!0):"0",$=N!=="--"&&C!=="--"?q(N).add(C).toString():"--";c.push({posId:h==null?void 0:h.id,displayToken0:a.displayToken0,displayToken1:a==null?void 0:a.displayToken1,token0:a==null?void 0:a.token0,token1:a==null?void 0:a.token1,minPrice:Cn(m),maxPrice:Cn(S),status:T,liquidityRate:$,coinAmount0:E,coinAmount1:M,coinAmount0Rate:N,coinAmount1Rate:C,...h})}}),console.log("useGetCurrentPoolPositions getPositions positionList: ",c),n(c),s(!1)}catch(c){s(!1),n([]),console.log("useGetCurrentPoolPositions getPositions Error: ",c)}}}}function sa(t){var et;Wn();const{getAddLiquidityPaylod:e}=Or(),{signAndExecuteTransaction:n}=Co(),{slippage:s}=Ro();Ei();const{addToken0:i,addToken1:a,currentApiPoolInfo:r,currentContractPoolInfo:u,baseCoin:c,displayToken0Value:d,displayToken1Value:h,setDisplayToken0Value:l,setDisplayToken1Value:p,minPriceData:f,maxPriceData:w,precomputationInfo:b,setPrecomputationInfo:g,currentFeeTier:m,ratio:S,submitIsLoading:T,setSubmitIsLoading:j}=Rt();na();const{fetchTokenBalances:E}=Ei(),M=_.useMemo(()=>{var xt,G,Z;const Y=c===((xt=r==null?void 0:r.token0)==null?void 0:xt.metadata);console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:52 ~ currentPriceStatusParams ~ direct:",Y);const K=Y?f:w==null?void 0:w.getInverseTickPrice();console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:54 ~ currentPriceStatusParams ~ minPriceTickData:",K);const A=Y?w:f==null?void 0:f.getInverseTickPrice();console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:56 ~ currentPriceStatusParams ~ maxPriceTickData:",A);const st=u==null?void 0:u.current_tick_index;console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:58 ~ currentPriceStatusParams ~ currentTick:",st);const rt=K==null?void 0:K.tick,pt=A==null?void 0:A.tick;return{currentTick:st,lower:rt,upper:pt,metadata0:(G=r==null?void 0:r.token0)==null?void 0:G.metadata,metadata1:(Z=r==null?void 0:r.token1)==null?void 0:Z.metadata}},[r,u,f==null?void 0:f.fixsUiPrice,w==null?void 0:w.fixsUiPrice]),N=Tc(M);_.useEffect(()=>{console.log("useLiquidityDeposit currentPriceStatus: ",N)},[N]);const C=Hi(r==null?void 0:r.displayToken0),$=Hi(r==null?void 0:r.displayToken1),{isDisabled:H,submitBtnText:P}=Sc(T,i,a,N,d,h,C,$),{displayPerText:W,displayCurrentPrice:L}=ni(),[x,v]=_.useState(),y=_.useMemo(()=>{var Y;return c===((Y=r==null?void 0:r.displayToken0)==null?void 0:Y.metadata)?"column":"column-reverse"},[c,(et=r==null?void 0:r.displayToken0)==null?void 0:et.metadata]),R=Cs((Y,K)=>{var X,ot,ht,Ht,Et,Dt,wt,bt,Xt;const A=c===((X=r==null?void 0:r.token0)==null?void 0:X.metadata),st=((ot=r==null?void 0:r.token0)==null?void 0:ot.metadata)===((ht=r==null?void 0:r.displayToken0)==null?void 0:ht.metadata),rt=A?f:w==null?void 0:w.getInverseTickPrice(),pt=A?w:f==null?void 0:f.getInverseTickPrice(),xt=rt==null?void 0:rt.tick,G=pt==null?void 0:pt.tick,Z=u==null?void 0:u.current_sqrt_price,gt=(K==null?void 0:K.metadata)===((Ht=r==null?void 0:r.token0)==null?void 0:Ht.metadata),nt=(K==null?void 0:K.metadata)===((Et=r==null?void 0:r.displayToken0)==null?void 0:Et.metadata),vt=ss(Y,K==null?void 0:K.decimals);if(console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:110 ~ preAdd ~ value:",Y),console.log("ðŸš€ ~ file: useLiquidityDeposit.ts:110 ~ preAdd ~ amount:",vt.toString()),!vt||q(vt.toString()).equals(0)){nt?p(""):l("");return}if(xt===void 0||G===void 0||!Z)return;const V=Nt.sqrtPriceX64ToTickIndex(new Ye(Z));if(q(V).gte(xt)&&q(V).lt(G)){const Ut=No.estLiquidityAndcoinAmountFromOneAmounts(xt,G,vt,gt,!0,0,new Ye(Z));g(Ut),nt?p(st?ie(Ut.coinAmountB,(Dt=r==null?void 0:r.token1)==null?void 0:Dt.decimals):ie(Ut.coinAmountA,(wt=r==null?void 0:r.token0)==null?void 0:wt.decimals)):l(st?ie(Ut.coinAmountA,(bt=r==null?void 0:r.token0)==null?void 0:bt.decimals):ie(Ut.coinAmountB,(Xt=r==null?void 0:r.token1)==null?void 0:Xt.decimals))}else g(void 0),q(V).lt(xt)?st?p(""):l(""):st?l(""):p("")},500),z=Y=>{l(Y),v(r==null?void 0:r.displayToken0),R(Y,r==null?void 0:r.displayToken0)},D=Y=>{p(Y),v(r==null?void 0:r.displayToken1),R(Y,r==null?void 0:r.displayToken1)};_.useEffect(()=>{var Y;x&&(d||h)&&R((x==null?void 0:x.metadata)===((Y=r==null?void 0:r.displayToken0)==null?void 0:Y.metadata)?d:h,x)},[w==null?void 0:w.fixsUiPrice,f==null?void 0:f.fixsUiPrice,x==null?void 0:x.metadata]);const O=jc(r==null?void 0:r.displayToken0,r==null?void 0:r.displayToken1,d,h);return{handleDisplayToken0ValueChange:z,handleDisplayToken1ValueChange:D,inputBoxDirection:y,currentPriceStatus:N,fixedToken:x,totalRate:O,getSecondaryModalData:()=>{var K,A;return{token0:i,token1:a,amount0:((K=r==null?void 0:r.displayToken0)==null?void 0:K.metadata)===(i==null?void 0:i.metadata)?d:h,amount1:((A=r==null?void 0:r.displayToken0)==null?void 0:A.metadata)===(i==null?void 0:i.metadata)?h:d,fee:q(m).div(Math.pow(10,4)).toString(),ratio:S,totalRate:O,minPrice:f==null?void 0:f.fixsUiPrice,maxPrice:w==null?void 0:w.fixsUiPrice,displayPerText:W,displayCurrentPrice:L,currentPriceStatus:N}},handleSubmitAdd:async()=>{var Y,K,A,st,rt,pt,xt,G,Z,gt;j(!0);try{const nt=(x==null?void 0:x.metadata)===((Y=r==null?void 0:r.token0)==null?void 0:Y.metadata),vt=c===((K=r==null?void 0:r.token0)==null?void 0:K.metadata),V=vt?f:w==null?void 0:w.getInverseTickPrice(),X=vt?w:f==null?void 0:f.getInverseTickPrice(),ot=((A=r==null?void 0:r.displayToken0)==null?void 0:A.metadata)===((st=r==null?void 0:r.token0)==null?void 0:st.metadata);let ht="0",Ht="0";if(b)ht=b!=null&&b.fix_amount_a?(rt=b==null?void 0:b.coinAmountA)==null?void 0:rt.toString():q((pt=b==null?void 0:b.coinAmountA)==null?void 0:pt.toString()).mul(q(1).add(s)).toString(),Ht=b!=null&&b.fix_amount_a?q((G=b==null?void 0:b.coinAmountB)==null?void 0:G.toString()).mul(q(1).add(s)).toString():(xt=b==null?void 0:b.coinAmountB)==null?void 0:xt.toString();else{const Et=ss(d,(Z=r==null?void 0:r.displayToken0)==null?void 0:Z.decimals).toString(),Dt=ss(h,(gt=r==null?void 0:r.displayToken1)==null?void 0:gt.decimals).toString(),wt=ot?Et:Dt,bt=ot?Dt:Et;ht=wt,Ht=bt}if(r!=null&&r.id&&(V==null?void 0:V.tick)!==void 0&&(X==null?void 0:X.tick)!==void 0){const Et={pool_id:r==null?void 0:r.id,tick_lower:V==null?void 0:V.tick,tick_upper:X==null?void 0:X.tick,fix_amount_a:nt,offer_amount_a:String(Se(ht,0)),offer_amount_b:String(Se(Ht,0))};console.log("handleSubmitAdd slippage: ",s),console.log("handleSubmitAdd params: ",Et);const Dt=e(Et);console.log("handleSubmitAdd payload: ",Dt);const wt=await n([Dt],{action:Eo.Add,description:"Add Liquidity",coinA:{...r==null?void 0:r.displayToken0,amount:d},coinB:{...r==null?void 0:r.displayToken1,amount:h}});j(!1),console.log("handleSubmitAdd response: ",wt),l(""),p(""),await Mo(3e3),t&&t(),E()}}catch(nt){console.log("handleSubmitAdd error: ",nt),j(!1)}},displayToken0Balance:C,displayToken1Balance:$,isDisabled:H,submitBtnText:P}}function tl(){const{currentFeeTier:t,addToken0:e,addToken1:n,currentApiPoolInfo:s,currentContractPoolInfo:i,currentPrice:a,inversePrice:r,setBaseCoin:u,baseCoin:c,priceRangePercentage:d,setPriceRangePercentage:h,isShowMinMaxDist:l,setIsShowMinMaxDist:p,minDistPercentange:f,maxDistPercentange:w}=Rt(),{minPriceData:b,maxPriceData:g,handleMinPriceClick:m,handleMaxPriceClick:S,isFullRange:T,handleChangeRange:j,handleInputPriceChange:E,handleInputBlur:M,handleBaseCoinChange:N,handleChangeMinPrice:C,handleChangeMaxPrice:$}=ei(),{currentPriceStatus:H}=sa(),{displayPerText:P}=ni(),[W,L]=_.useState(""),x=k=>{console.log("handleRadioChange value: ",k),L(k),k==="0.1%"&&h(.1),k==="0.5%"&&h(.5),k==="1%"&&h(1),k==="5%"&&h(5),k==="10%"&&h(10),k==="20%"&&h(20),k==="50%"&&h(50),k==="Full Range"&&h(100),p(!1)},v=_.useMemo(()=>{var k,R,z,D,O,F;return(k=s==null?void 0:s.displayToken0)!=null&&k.symbol&&((R=s==null?void 0:s.displayToken1)!=null&&R.symbol)?[{key:(z=s==null?void 0:s.displayToken0)==null?void 0:z.metadata,label:(D=s==null?void 0:s.displayToken0)==null?void 0:D.symbol},{key:(O=s==null?void 0:s.displayToken1)==null?void 0:O.metadata,label:(F=s==null?void 0:s.displayToken1)==null?void 0:F.symbol}]:[]},[s]),y=k=>{h(k),p(!1)};return _.useEffect(()=>{var k;switch(d){case .1:L("0.1%");break;case .5:L("0.5%");break;case 1:L("1%");break;case 5:L("5%");break;case 10:L("10%");break;case 20:L("20%");break;case 50:L("50%");break;case 100:L("Full Range");break;default:L("")}if(s!=null&&s.token0&&(s!=null&&s.token1)&&a&&(i!=null&&i.tick_spacing)){const R=c===((k=s==null?void 0:s.token0)==null?void 0:k.metadata);j(d,R?s==null?void 0:s.token0:s==null?void 0:s.token1,R?s==null?void 0:s.token1:s==null?void 0:s.token0,i==null?void 0:i.tick_spacing,R?a:r)}},[d]),_.useMemo(()=>{var k;if(c&&c===((k=s==null?void 0:s.token0)==null?void 0:k.metadata))return!0},[c,s]),o.jsxs(J,{w:"100%",gap:"16px",p:"16px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(Q,{w:"100%",justify:"space-between",children:[o.jsx(B,{fontSize:"md",color:"text_caption",children:"Select Range"}),o.jsx(tt,{w:"140px",children:o.jsx(Qs,{w:"62px",h:"28px",p:"4px",borderRadius:"4px",currentTab:c,textList:v,onClick:N})})]}),o.jsx(bc,{direction:"column",unit:P,min_price:(b==null?void 0:b.uiPrice)||"",max_price:(g==null?void 0:g.uiPrice)||"",handleMinPriceActoin:k=>{m(k),p(!0)},handleMaxPriceActoin:k=>{S(k),p(!0)},onInputPriceChange:E,onInputPriceBlur:M,isFullRange:T}),H==="error"&&o.jsx(tt,{w:"100%",zIndex:100,children:o.jsx(B,{color:"error",fontSize:"12px",children:"The max price should be higher than min price."})}),o.jsxs(J,{w:"100%",justifyContent:"flex-start",children:[o.jsxs(Q,{w:"100%",align:"center",gap:"4px",children:[o.jsx(B,{children:"Range Size"}),o.jsx(Rn,{label:"The Range Size measures the percentage difference between the range selected Min and Max bounds and the current price.","aria-label":"Range Size",placement:"right",sx:{"@media screen and (max-width: 810px)":{w:"200px"}},children:o.jsx("button",{children:o.jsx(Lt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsxs(zo,{"aria-label":"slider-ex-1",value:l?0:d,min:0,max:100,onChange:y,children:[o.jsx(Lo,{children:o.jsx(Do,{})}),o.jsx($o,{})]})]}),o.jsxs(Q,{w:"100%",align:l?"flex-end":"center",justifyContent:"space-between",sx:{"@media screen and (max-width: 1150px)":{display:"flex",flexDirection:"column",alignItems:"flex-start"}},children:[!l&&W==="Full Range"?o.jsx(B,{fontSize:"md",color:"text_caption",lineHeight:"1",sx:{"@media screen and (max-width: 810px)":{fontSize:"sm"}},children:"Full Range"}):l?o.jsxs(Q,{align:"center",children:[o.jsxs(J,{gap:"0",children:[o.jsx(B,{fontSize:"xs",children:"Min"}),o.jsxs(B,{fontSize:"md",color:"text_caption",lineHeight:"1",children:[Mi(f),"%"]})]}),o.jsx(B,{color:"text_caption",pt:"8px",fontSize:"md",lineHeight:"1",children:"/"}),o.jsxs(J,{gap:"0",children:[o.jsx(B,{fontSize:"xs",children:"Max"}),o.jsxs(B,{fontSize:"md",color:"text_caption",lineHeight:"1",children:[Mi(w),"%"]})]})]}):o.jsxs(B,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"sm"}},children:["Â±",d,"%"]}),is&&is[t]&&o.jsx(Ie,{h:"32px",options:is[t]||[],value:l?"-1":W,onChange:x})]})]})}function el(){const t=Bn(Oo),[e,n]=_.useState([]),[s,i]=_.useState(!0),[a,r]=_.useState(0);return{loading:s,dataList:e,fetchHistoryData:async c=>{i(!0);try{const d=new Date().getTime(),h=new URLSearchParams;h.append("timestamp",String(d)),h.append("id",String(c.pool_address)),h.append("limit",String(c.limit)),h.append("offset",String(c.offset)),c.event_type&&h.append("event_type",String(c.event_type));const p=await(await fetch(`${t}?${h.toString()}`)).json();if(console.log("fetchHistoryData: ",p),p&&p.data&&p.data.list){const f=p.data.list;f.forEach(w=>{w.eventType==="burn_event"&&(w.eventType="Remove Liquidity"),w.eventType==="mint_event"&&(w.eventType="Add Liquidity"),w.eventType==="swap_event"&&(w.eventType="Swap")}),r(Number(p.data.total)),n(f)}else n([]),r(0);i(!1)}catch(d){console.log(d,"fetchHistoryData"),i(!1)}},total:a}}const rs=10;function nl(t){const{windowWidth:e}=t,{currentApiPoolInfo:n}=Rt(),{fetchHistoryData:s,loading:i,dataList:a,total:r}=el(),[u,c]=_.useState(1),{getExplorerUrl:d}=Hn();_.useEffect(()=>{n&&h(1)},[n==null?void 0:n.address]);const h=g=>{c(g),s({limit:rs,pool_address:n==null?void 0:n.address,offset:(g-1)*rs})};if(i&&u===1&&r===0)return o.jsx(Ar,{});const l=g=>o.jsx(B,{color:"text_caption",fontSize:"xs",children:g==null?void 0:g.eventType}),p=g=>{let m=[];n!=null&&n.isReverse&&g.eventType!=="Swap"?m=g.items.slice().reverse():m=g==null?void 0:g.items;const S=m[0],T=m[1];return o.jsxs(J,{gap:"0px",align:"flex-end",children:[o.jsxs(Q,{children:[o.jsx(Ae,{w:"20px",h:"20px",imageUrl:S==null?void 0:S.image}),o.jsx(B,{fontSize:"xs",color:"text_caption",children:Ge(S==null?void 0:S.amount)}),o.jsx(B,{fontSize:"xs",children:S==null?void 0:S.symbol})]}),(g==null?void 0:g.eventType)==="Swap"&&o.jsx(tt,{mt:"-6px",children:o.jsx(Lt,{xlinkHref:"#icon-icon_down",variant:"graygray"})}),(g==null?void 0:g.eventType)==="Add Liquidity"&&o.jsx(tt,{mt:"-6px",children:o.jsx(Lt,{xlinkHref:"#icon-icon_increase",variant:"graygray"})}),(g==null?void 0:g.eventType)==="Remove Liquidity"&&o.jsx(tt,{mt:"-6px",children:o.jsx(Lt,{xlinkHref:"#icon-icon_reduce4",variant:"graygray"})}),o.jsxs(Q,{mt:"-4px",children:[o.jsx(Ae,{w:"20px",h:"20px",imageUrl:T==null?void 0:T.image}),o.jsx(B,{fontSize:"xs",color:"text_caption",children:Ge(T==null?void 0:T.amount)}),o.jsx(B,{fontSize:"xs",children:T==null?void 0:T.symbol})]}),o.jsx(B,{})]})},f=g=>o.jsx(ut,{justifyContent:"flex-end",children:o.jsx(jn,{href:d(g==null?void 0:g.tx,"tx"),variant:"link",color:"primary",fontSize:"xs",target:"_blank",children:Pe(g==null?void 0:g.tx)})}),w=g=>o.jsx(B,{fontSize:"xs",textAlign:"right",children:Uo(Date.parse(g==null?void 0:g.blockTime))}),b=g=>[{leftText:"Recent event",right:l(g)},{leftText:"Amounts",right:p(g),rowListAlign:"flex-start"},{leftText:"Transactions",right:f(g)},{leftText:"Time",right:w(g)}];return o.jsxs(J,{w:"100%",justifyContent:"center",gap:"0px",bg:"card_bg",backdropFilter:"blur(10px)",p:"8px",borderRadius:"12px",children:[o.jsx(Fo,{w:"100%",children:e<=810?o.jsx(J,{w:"100%",children:i?[{},{},{}].map((g,m)=>o.jsx(J,{w:"100%",children:o.jsx(qi,{isLoading:i})},m)):a==null?void 0:a.map((g,m)=>o.jsx(J,{w:"100%",children:o.jsx(qi,{isLoading:i,rowList:b(g)})},g==null?void 0:g.tx))}):(a==null?void 0:a.length)>0&&o.jsxs(Bo,{size:"sm",variant:"striped",children:[o.jsx(Ho,{children:o.jsxs(Ni,{children:[o.jsx(rn,{children:o.jsx(B,{fontWeight:"200",children:"Recent event"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(B,{fontWeight:"200",children:"Amounts"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(B,{fontWeight:"200",children:"Transactions"})}),o.jsx(rn,{textAlign:"right",children:o.jsx(B,{fontWeight:"200",children:"Time"})})]})}),o.jsx(qo,{children:a.map((g,m)=>o.jsxs(Ni,{sx:{td:{background:m%2===0?"button_ghost_bg !important":"transparent",border:"none",_first:{borderRadius:"8px 0 0 8px"},_last:{borderRadius:"0px 8px 8px 0px"}}},children:[o.jsxs(an,{children:[" ",l(g)," "]}),o.jsx(an,{children:p(g)}),o.jsx(an,{children:f(g)}),o.jsx(an,{children:w(g)})]},g==null?void 0:g.tx))})]})}),a.length===0&&o.jsx(ge,{type:"nodata"}),r<10?null:o.jsx(tt,{m:"20px 0",children:o.jsx(Vo,{total:r,size:rs,currentPage:u,onChange:g=>{console.log({current:g}),h(g)}})})]})}function sl(){const{address:t,onboard:e}=Wn(),{currentPoolPositionsIsLoading:n,currentPoolPositions:s}=Rt();return o.jsxs(o.Fragment,{children:[!t&&o.jsx(ge,{type:"nowallet",onboard:e}),t&&!n&&(s==null?void 0:s.length)===0&&o.jsx(ge,{type:"nodata",text:"You have no liquidity positions"}),t&&n&&o.jsx(Ar,{}),t&&!n&&(s==null?void 0:s.length)>0&&o.jsx(J,{w:"100%",justifyContent:"center",gap:"8px",children:s==null?void 0:s.map(i=>o.jsx(il,{info:i},`current-pool-positions-${i==null?void 0:i.posId}`))})]})}function il(t){var r,u,c,d,h,l,p,f,w,b,g,m;const e=Js(),{setCurrentPositionTab:n}=tc(),{info:s}=t,{isImportToken:i}=qn(),a=(s==null?void 0:s.displayToken0.metadata)!==(s==null?void 0:s.token0.metadata);return o.jsxs(J,{w:"100%",align:"flex-start",bg:"card_bg",backdropFilter:"blur(10px)",borderRadius:"16px",p:"20px",position:"relative",onClick:()=>{n("increase"),e(`/position/${s==null?void 0:s.pool_address}/${s==null?void 0:s.posId}`)},children:[o.jsx(tt,{position:"absolute",top:"0",right:"0",children:o.jsx(ec,{borderRadius:"0px  16px",status:s==null?void 0:s.status,isActive:(s==null?void 0:s.status)==="Active"})}),o.jsxs(Q,{children:[o.jsx(Zs,{w:"32px",coinAIconUrl:(r=s.displayToken0)==null?void 0:r.image,coinBIconUrl:(u=s.displayToken1)==null?void 0:u.image,variant:"border",p:"4px",showATag:i((c=s.displayToken0)==null?void 0:c.metadata),showBTag:i((d=s.displayToken1)==null?void 0:d.metadata)}),o.jsxs(B,{color:"Text_caption",children:[(h=s==null?void 0:s.displayToken0)==null?void 0:h.symbol,"-",(l=s==null?void 0:s.displayToken1)==null?void 0:l.symbol," LPï¼ˆ#",s==null?void 0:s.position_index,")"]})]}),o.jsxs(Q,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{flexDirection:"column",alignItems:"flex-start"}},children:[o.jsx(Cc,{minPrice:s==null?void 0:s.minPrice,maxPrice:s==null?void 0:s.maxPrice,baseSymbol:(p=s==null?void 0:s.token0)==null?void 0:p.symbol,quoteSymbol:(f=s==null?void 0:s.token1)==null?void 0:f.symbol}),o.jsxs(ut,{align:"center",gap:"10px",sx:{"@media screen and (max-width: 810px)":{w:"100%",justifyContent:"space-between"}},children:[o.jsx(B,{fontSize:"xs",children:"Liquidtity"}),o.jsx(Rn,{label:o.jsxs(J,{gap:"12px",p:"4px 0",minW:"280px",flexDirection:a?"column-reverse":"column",children:[o.jsx(Bi,{icon:((w=s==null?void 0:s.token0)==null?void 0:w.image)||"",amount:(s==null?void 0:s.coinAmount0)||"0",amountValue:(s==null?void 0:s.coinAmount0Rate)||"--",symbol:((b=s==null?void 0:s.token0)==null?void 0:b.symbol)||""}),o.jsx(Bi,{icon:((g=s==null?void 0:s.token1)==null?void 0:g.image)||"",amount:(s==null?void 0:s.coinAmount1)||"0",amountValue:(s==null?void 0:s.coinAmount1Rate)||"--",symbol:((m=s==null?void 0:s.token1)==null?void 0:m.symbol)||""})]}),"aria-label":"LiquidityRate",children:o.jsx("button",{children:o.jsx(B,{color:"text_caption",textDecoration:"underline dotted",dangerouslySetInnerHTML:{__html:`${he(s==null?void 0:s.liquidityRate,2)}`}})})})]})]})]})}function rl(){const{tucanaSpotSDK:t}=Ks();return{getContractPool:async n=>{if(!n)return null;const s=await t.Pool.getPool(n);return console.log("useContractPoolInfo getContractPool poolInfo: ",s),s}}}function al({handleClickRefresh:t}){var L,x;const{address:e,onboard:n}=Wn(),{currentApiPoolInfo:s,displayToken0Value:i,displayToken1Value:a,submitIsLoading:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h}=Rt(),{handleDisplayToken0ValueChange:l,handleDisplayToken1ValueChange:p,inputBoxDirection:f,currentPriceStatus:w,totalRate:b,handleSubmitAdd:g,getSecondaryModalData:m,displayToken0Balance:S,displayToken1Balance:T,isDisabled:j,submitBtnText:E}=sa(t);ei();const[M,N]=_.useState(!1),[C,$]=_.useState(!1),[H,P]=_.useState(),W=()=>{const v=m();console.log("handleOpenSecondaryModal data: ",v),P(v),$(!0)};return o.jsxs(J,{w:"100%",p:"16px",bg:"card_bg",borderRadius:"16px",backdropFilter:"blur(10px)",children:[o.jsxs(Q,{w:"100%",justify:"space-between",mb:"8px",children:[o.jsx(B,{fontSize:"md",color:"text_caption",children:"Deposit Amounts"}),o.jsx(Lt,{xlinkHref:"#icon-icon_slider",onClick:()=>N(!0)})]}),o.jsxs(J,{gap:"0px",w:"100%",flexDirection:f,children:[o.jsxs(tt,{position:"relative",w:"100%",children:[w==="error"||w===((L=s==null?void 0:s.displayToken0)==null?void 0:L.metadata)?o.jsx(Vi,{notHaveText:w==="error"}):null,o.jsx(Fi,{noArrow:!0,currentCoin:d,amount:i,balance:S,onAmountChange:l})]}),o.jsx(ut,{zIndex:"400",gap:"0px",h:"8px",onClick:()=>{var y,k,R;const v=c===((y=s==null?void 0:s.displayToken0)==null?void 0:y.metadata)?(k=s==null?void 0:s.displayToken1)==null?void 0:k.metadata:(R=s==null?void 0:s.displayToken0)==null?void 0:R.metadata;v&&u(v)},children:o.jsx("div",{className:"exchange liquidity-add"})}),o.jsxs(tt,{position:"relative",w:"100%",children:[w==="error"||w===((x=s==null?void 0:s.displayToken1)==null?void 0:x.metadata)?o.jsx(Vi,{notHaveText:w==="error"}):null,o.jsx(Fi,{noArrow:!0,currentCoin:h,amount:a,balance:T,onAmountChange:p})]})]}),o.jsxs(Q,{w:"100%",justify:"space-between",bg:"input_bg",h:"52px",p:"0 16px",borderRadius:"16px",border:"1px solid",borderColor:"border",children:[o.jsx(B,{fontSize:"md",children:"Total"}),o.jsxs(B,{fontSize:"16px",color:"text_caption",children:["$",Ge(b)]})]}),o.jsx(Xs,{w:"100%",mt:"4px",size:"lg",onClick:()=>{e?W():n()},isLoading:r,isDisabled:j,children:E}),o.jsx(_c,{isOpen:M,onClose:()=>N(!1)}),o.jsx(Rc,{data:H,isOpen:C,onClose:()=>{$(!1)},onClick:()=>{g(),$(!1)}})]})}var ia={exports:{}},ra={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var je=_;function ol(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var cl=typeof Object.is=="function"?Object.is:ol,ll=je.useState,ul=je.useEffect,dl=je.useLayoutEffect,hl=je.useDebugValue;function fl(t,e){var n=e(),s=ll({inst:{value:n,getSnapshot:e}}),i=s[0].inst,a=s[1];return dl(function(){i.value=n,i.getSnapshot=e,as(i)&&a({inst:i})},[t,n,e]),ul(function(){return as(i)&&a({inst:i}),t(function(){as(i)&&a({inst:i})})},[t]),hl(n),n}function as(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!cl(t,n)}catch{return!0}}function pl(t,e){return e()}var gl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?pl:fl;ra.useSyncExternalStore=je.useSyncExternalStore!==void 0?je.useSyncExternalStore:gl;ia.exports=ra;var xl=ia.exports;const ae=()=>{},Mt=ae(),os=Object,it=t=>t===Mt,At=t=>typeof t=="function",ce=(t,e)=>({...t,...e}),ml=t=>At(t.then),cn=new WeakMap;let yl=0;const Xe=t=>{const e=typeof t,n=t&&t.constructor,s=n==Date;let i,a;if(os(t)===t&&!s&&n!=RegExp){if(i=cn.get(t),i)return i;if(i=++yl+"~",cn.set(t,i),n==Array){for(i="@",a=0;a<t.length;a++)i+=Xe(t[a])+",";cn.set(t,i)}if(n==os){i="#";const r=os.keys(t).sort();for(;!it(a=r.pop());)it(t[a])||(i+=a+":"+Xe(t[a])+",");cn.set(t,i)}}else i=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return i},It=new WeakMap,cs={},ln={},si="undefined",Yn=typeof window!=si,Es=typeof document!=si,_l=()=>Yn&&typeof window.requestAnimationFrame!=si,aa=(t,e)=>{const n=It.get(t);return[()=>!it(e)&&t.get(e)||cs,s=>{if(!it(e)){const i=t.get(e);e in ln||(ln[e]=i),n[5](e,ce(i,s),i||cs)}},n[6],()=>!it(e)&&e in ln?ln[e]:!it(e)&&t.get(e)||cs]};let Ms=!0;const vl=()=>Ms,[Ns,zs]=Yn&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ae,ae],wl=()=>{const t=Es&&document.visibilityState;return it(t)||t!=="hidden"},kl=t=>(Es&&document.addEventListener("visibilitychange",t),Ns("focus",t),()=>{Es&&document.removeEventListener("visibilitychange",t),zs("focus",t)}),bl=t=>{const e=()=>{Ms=!0,t()},n=()=>{Ms=!1};return Ns("online",e),Ns("offline",n),()=>{zs("online",e),zs("offline",n)}},Tl={isOnline:vl,isVisible:wl},Sl={initFocus:kl,initReconnect:bl},Yi=!oe.useId,Ke=!Yn||"Deno"in window,jl=t=>_l()?window.requestAnimationFrame(t):setTimeout(t,1),ls=Ke?_.useEffect:_.useLayoutEffect,us=typeof navigator<"u"&&navigator.connection,Ai=!Ke&&us&&(["slow-2g","2g"].includes(us.effectiveType)||us.saveData),ii=t=>{if(At(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Xe(t):"",[t,e]};let Cl=0;const Ls=()=>++Cl,oa=0,ca=1,la=2,Rl=3;var Oe={__proto__:null,ERROR_REVALIDATE_EVENT:Rl,FOCUS_EVENT:oa,MUTATE_EVENT:la,RECONNECT_EVENT:ca};async function ua(...t){const[e,n,s,i]=t,a=ce({populateCache:!0,throwOnError:!0},typeof i=="boolean"?{revalidate:i}:i||{});let r=a.populateCache;const u=a.rollbackOnError;let c=a.optimisticData;const d=p=>typeof u=="function"?u(p):u!==!1,h=a.throwOnError;if(At(n)){const p=n,f=[],w=e.keys();for(const b of w)!/^\$(inf|sub)\$/.test(b)&&p(e.get(b)._k)&&f.push(b);return Promise.all(f.map(l))}return l(n);async function l(p){const[f]=ii(p);if(!f)return;const[w,b]=aa(e,f),[g,m,S,T]=It.get(e),j=()=>{const L=g[f];return(At(a.revalidate)?a.revalidate(w().data,p):a.revalidate!==!1)&&(delete S[f],delete T[f],L&&L[0])?L[0](la).then(()=>w().data):w().data};if(t.length<3)return j();let E=s,M;const N=Ls();m[f]=[N,0];const C=!it(c),$=w(),H=$.data,P=$._c,W=it(P)?H:P;if(C&&(c=At(c)?c(W,H):c,b({data:c,_c:W})),At(E))try{E=E(W)}catch(L){M=L}if(E&&ml(E))if(E=await E.catch(L=>{M=L}),N!==m[f][0]){if(M)throw M;return E}else M&&C&&d(M)&&(r=!0,b({data:W,_c:Mt}));if(r&&!M)if(At(r)){const L=r(E,W);b({data:L,error:Mt,_c:Mt})}else b({data:E,error:Mt,_c:Mt});if(m[f][1]=Ls(),Promise.resolve(j()).then(()=>{b({_c:Mt})}),M){if(h)throw M;return}return E}}const Gi=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},El=(t,e)=>{if(!It.has(t)){const n=ce(Sl,e),s={},i=ua.bind(Mt,t);let a=ae;const r={},u=(h,l)=>{const p=r[h]||[];return r[h]=p,p.push(l),()=>p.splice(p.indexOf(l),1)},c=(h,l,p)=>{t.set(h,l);const f=r[h];if(f)for(const w of f)w(l,p)},d=()=>{if(!It.has(t)&&(It.set(t,[s,{},{},{},i,c,u]),!Ke)){const h=n.initFocus(setTimeout.bind(Mt,Gi.bind(Mt,s,oa))),l=n.initReconnect(setTimeout.bind(Mt,Gi.bind(Mt,s,ca)));a=()=>{h&&h(),l&&l(),It.delete(t)}}};return d(),[t,i,d,a]}return[t,It.get(t)[4]]},Ml=(t,e,n,s,i)=>{const a=n.errorRetryCount,r=i.retryCount,u=~~((Math.random()+.5)*(1<<(r<8?r:8)))*n.errorRetryInterval;!it(a)&&r>a||setTimeout(s,u,i)},Nl=(t,e)=>Xe(t)==Xe(e),[da,zl]=El(new Map),Ll=ce({onLoadingSlow:ae,onSuccess:ae,onError:ae,onErrorRetry:Ml,onDiscarded:ae,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Ai?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Ai?5e3:3e3,compare:Nl,isPaused:()=>!1,cache:da,mutate:zl,fallback:{}},Tl),Dl=(t,e)=>{const n=ce(t,e);if(e){const{use:s,fallback:i}=t,{use:a,fallback:r}=e;s&&a&&(n.use=s.concat(a)),i&&r&&(n.fallback=ce(i,r))}return n},$l=_.createContext({}),Ol="$inf$",ha=Yn&&window.__SWR_DEVTOOLS_USE__,Fl=ha?window.__SWR_DEVTOOLS_USE__:[],Bl=()=>{ha&&(window.__SWR_DEVTOOLS_REACT__=oe)},fa=t=>At(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],Hl=()=>ce(Ll,_.useContext($l)),ql=t=>(e,n,s)=>t(e,n&&((...a)=>{const[r]=ii(e),[,,,u]=It.get(da);if(r.startsWith(Ol))return n(...a);const c=u[r];return it(c)?n(...a):(delete u[r],c)}),s),Vl=Fl.concat(ql),Ul=t=>function(...n){const s=Hl(),[i,a,r]=fa(n),u=Dl(s,r);let c=t;const{use:d}=u,h=(d||[]).concat(Vl);for(let l=h.length;l--;)c=h[l](c);return c(i,a||u.fetcher||null,u)},Wl=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const i=s.indexOf(n);i>=0&&(s[i]=s[s.length-1],s.pop())}},Pl=(t,e)=>(...n)=>{const[s,i,a]=fa(n),r=(a.use||[]).concat(e);return t(s,i,{...a,use:r})};Bl();const Xi=oe.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),ds={dedupe:!0},Yl=(t,e,n)=>{const{cache:s,compare:i,suspense:a,fallbackData:r,revalidateOnMount:u,revalidateIfStale:c,refreshInterval:d,refreshWhenHidden:h,refreshWhenOffline:l,keepPreviousData:p}=n,[f,w,b,g]=It.get(s),[m,S]=ii(t),T=_.useRef(!1),j=_.useRef(!1),E=_.useRef(m),M=_.useRef(e),N=_.useRef(n),C=()=>N.current,$=()=>C().isVisible()&&C().isOnline(),[H,P,W,L]=aa(s,m),x=_.useRef({}).current,v=it(r)?n.fallback[m]:r,y=(G,Z)=>{for(const gt in x){const nt=gt;if(nt==="data"){if(!i(G[nt],Z[nt])&&(!it(G[nt])||!i(Y,Z[nt])))return!1}else if(Z[nt]!==G[nt])return!1}return!0},k=_.useMemo(()=>{const G=!m||!e?!1:it(u)?C().isPaused()||a?!1:it(c)?!0:c:u,Z=ot=>{const ht=ce(ot);return delete ht._k,G?{isValidating:!0,isLoading:!0,...ht}:ht},gt=H(),nt=L(),vt=Z(gt),V=gt===nt?vt:Z(nt);let X=vt;return[()=>{const ot=Z(H());return y(ot,X)?(X.data=ot.data,X.isLoading=ot.isLoading,X.isValidating=ot.isValidating,X.error=ot.error,X):(X=ot,ot)},()=>V]},[s,m]),R=xl.useSyncExternalStore(_.useCallback(G=>W(m,(Z,gt)=>{y(gt,Z)||G()}),[s,m]),k[0],k[1]),z=!T.current,D=f[m]&&f[m].length>0,O=R.data,F=it(O)?v:O,ft=R.error,et=_.useRef(F),Y=p?it(O)?et.current:O:F,K=D&&!it(ft)?!1:z&&!it(u)?u:C().isPaused()?!1:a?it(F)?!1:c:it(F)||c,A=!!(m&&e&&z&&K),st=it(R.isValidating)?A:R.isValidating,rt=it(R.isLoading)?A:R.isLoading,pt=_.useCallback(async G=>{const Z=M.current;if(!m||!Z||j.current||C().isPaused())return!1;let gt,nt,vt=!0;const V=G||{},X=!b[m]||!V.dedupe,ot=()=>Yi?!j.current&&m===E.current&&T.current:m===E.current,ht={isValidating:!1,isLoading:!1},Ht=()=>{P(ht)},Et=()=>{const wt=b[m];wt&&wt[1]===nt&&delete b[m]},Dt={isValidating:!0};it(H().data)&&(Dt.isLoading=!0);try{if(X&&(P(Dt),n.loadingTimeout&&it(H().data)&&setTimeout(()=>{vt&&ot()&&C().onLoadingSlow(m,n)},n.loadingTimeout),b[m]=[Z(S),Ls()]),[gt,nt]=b[m],gt=await gt,X&&setTimeout(Et,n.dedupingInterval),!b[m]||b[m][1]!==nt)return X&&ot()&&C().onDiscarded(m),!1;ht.error=Mt;const wt=w[m];if(!it(wt)&&(nt<=wt[0]||nt<=wt[1]||wt[1]===0))return Ht(),X&&ot()&&C().onDiscarded(m),!1;const bt=H().data;ht.data=i(bt,gt)?bt:gt,X&&ot()&&C().onSuccess(gt,m,n)}catch(wt){Et();const bt=C(),{shouldRetryOnError:Xt}=bt;bt.isPaused()||(ht.error=wt,X&&ot()&&(bt.onError(wt,m,bt),(Xt===!0||At(Xt)&&Xt(wt))&&(!C().revalidateOnFocus||!C().revalidateOnReconnect||$())&&bt.onErrorRetry(wt,m,bt,Ut=>{const ye=f[m];ye&&ye[0]&&ye[0](Oe.ERROR_REVALIDATE_EVENT,Ut)},{retryCount:(V.retryCount||0)+1,dedupe:!0})))}return vt=!1,Ht(),!0},[m,s]),xt=_.useCallback((...G)=>ua(s,E.current,...G),[]);if(ls(()=>{M.current=e,N.current=n,it(O)||(et.current=O)}),ls(()=>{if(!m)return;const G=pt.bind(Mt,ds);let Z=0;const nt=Wl(m,f,(vt,V={})=>{if(vt==Oe.FOCUS_EVENT){const X=Date.now();C().revalidateOnFocus&&X>Z&&$()&&(Z=X+C().focusThrottleInterval,G())}else if(vt==Oe.RECONNECT_EVENT)C().revalidateOnReconnect&&$()&&G();else{if(vt==Oe.MUTATE_EVENT)return pt();if(vt==Oe.ERROR_REVALIDATE_EVENT)return pt(V)}});return j.current=!1,E.current=m,T.current=!0,P({_k:S}),K&&(it(F)||Ke?G():jl(G)),()=>{j.current=!0,nt()}},[m]),ls(()=>{let G;function Z(){const nt=At(d)?d(H().data):d;nt&&G!==-1&&(G=setTimeout(gt,nt))}function gt(){!H().error&&(h||C().isVisible())&&(l||C().isOnline())?pt(ds).then(Z):Z()}return Z(),()=>{G&&(clearTimeout(G),G=-1)}},[d,h,l,m]),_.useDebugValue(Y),a&&it(F)&&m){if(!Yi&&Ke)throw new Error("Fallback data is required when using suspense in SSR.");M.current=e,N.current=n,j.current=!1;const G=g[m];if(!it(G)){const Z=xt(G);Xi(Z)}if(it(ft)){const Z=pt(ds);it(Y)||(Z.status="fulfilled",Z.value=!0),Xi(Z)}else throw ft}return{mutate:xt,get data(){return x.data=!0,Y},get error(){return x.error=!0,ft},get isValidating(){return x.isValidating=!0,st},get isLoading(){return x.isLoading=!0,rt}}},Al=Ul(Yl),Gl=t=>(e,n,s)=>(s.revalidateOnFocus=!1,s.revalidateIfStale=!1,s.revalidateOnReconnect=!1,t(e,n,s)),Xl=Pl(Al,Gl),Kl=8;function Ki(t,e,n,s,i,a){let r={...n},u=[];for(let c=i+(a?1:0);a?c<s.length:c>=0;a?c++:c--){const d=Number(s[c].tick),h={liquidityActive:r.liquidityActive,tick:d,liquidityNet:BigInt(s[c].liquidityNet),price0:Nt.tickIndexToPrice(d,t.decimals,e.decimals).toFixed(Kl)};a?h.liquidityActive=r.liquidityActive+BigInt(s[c].liquidityNet):!a&&r.liquidityNet!==0n&&(h.liquidityActive=r.liquidityActive-r.liquidityNet),u.push(h),r=h}return a||(u=u.reverse()),u}const Zl=8,Jl=(t,e)=>t!==void 0&&e?Math.floor(t/zi[e])*zi[e]:void 0;function Ql(t){const e=Bn(Wo);Or();const n=d=>{if(console.log("getTicks args: ",d),console.log("getTicks args?.url: ",d==null?void 0:d.url),!!t)return Fr(d==null?void 0:d.url,{id:d.id})},{data:s,error:i,isLoading:a,mutate:r}=Xl({url:e,id:t},n),u=()=>{r()},c=_.useMemo(()=>{const d=[];if(console.log("ticksData data: ",s),console.log("ticksData id: ",t),s&&(s!=null&&s.ticks))return console.log("ticksData data?.ticks: ",s==null?void 0:s.ticks),s==null||s.ticks.forEach(h=>{d.push({tick:Number(h.index),liquidityNet:h.liquidity_net,liquidityGross:h.liquidity_gross,id:h.id})}),d},[s]);return{isLoading:a,error:i,data:c,handleRefresh:u}}function Il(t){const e=Ql(t);return console.log("subgraphTickData: ",e),{isLoading:e.isLoading,error:e.error,ticks:e.data,handleRefresh:e.handleRefresh}}function tu(t,e,n,s){const i=_.useMemo(()=>Jl(t==null?void 0:t.current_tick_index,s),[t,s]),a=_.useMemo(()=>{if(t)return Nt.getInitializableTickIndex(Vn,t.tick_spacing)},[t]),r=_.useMemo(()=>{if(t)return Nt.getInitializableTickIndex(Un,t.tick_spacing)},[t]),{isLoading:u,error:c,ticks:d,handleRefresh:h}=Il(t==null?void 0:t.pool_address);return _.useMemo(()=>{if(!e||!n||i===void 0||d===void 0||!d||(d==null?void 0:d.length)===0||u||!a||!r)return{isLoading:u,error:c,activeTick:i,data:void 0,handleRefresh:h};const l=e,p=n;console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ newTicks start:");const f=d;console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ newTicks:",f),console.log("ðŸš€ ~ file: usePoolTickData.ts:177 ~ returnuseMemo ~ activeTick:",i);const w=f.findIndex(({tick:j})=>Number(j)>i)-1;if(w<0)return{isLoading:u,error:c,activeTick:i,data:void 0,handleRefresh:h};const b=(t==null?void 0:t.liquidity)??0,g={liquidityActive:BigInt(b??0),tick:i,liquidityNet:Number(d[w].tick)===i?BigInt(d[w].liquidityNet):0n,price0:Nt.tickIndexToPrice(i,l.decimals,p.decimals).toFixed(Zl)},m=Ki(l,p,g,f,w,!0),T=Ki(l,p,g,f,w,!1).concat(g).concat(m);return console.log("ðŸš€ ~ file: usePoolTickData.ts:215 ~ returnuseMemo ~ ticksProcessed:",T),{isLoading:u,error:c,activeTick:i,data:T,handleRefresh:h}},[e,n,i,t,d,u,c,a,r])}function eu({contractPoolInfo:t,currencyA:e,currencyB:n,feeAmount:s}){const{isLoading:i,error:a,data:r,handleRefresh:u}=tu(t,e,n,s),c=_.useCallback(()=>{if(console.log("ðŸš€ ~ file: useDepthChartData.ts:22 ~ formatData ~ data:",r),!r||!(r!=null&&r.length))return[];const d=[];for(let h=0;h<r.length;h++){const l=r[h],p={depth:parseFloat(l.liquidityActive.toString()),price:parseFloat(l.price0)};p.depth>=0&&d.push(p)}return d},[r]);return _.useMemo(()=>({isLoading:i,error:a,formattedData:i?void 0:c(),handleRefresh:u}),[i,a,c])}function nu(t){return t}var hs=1,gn=2,Ds=3,un=4,Zi=1e-6;function su(t){return"translate("+t+",0)"}function iu(t){return"translate(0,"+t+")"}function ru(t){return e=>+t(e)}function au(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function ou(){return!this.__axis}function pa(t,e){var n=[],s=null,i=null,a=6,r=6,u=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,d=t===hs||t===un?-1:1,h=t===un||t===gn?"x":"y",l=t===hs||t===Ds?su:iu;function p(f){var w=s??(e.ticks?e.ticks.apply(e,n):e.domain()),b=i??(e.tickFormat?e.tickFormat.apply(e,n):nu),g=Math.max(a,0)+u,m=e.range(),S=+m[0]+c,T=+m[m.length-1]+c,j=(e.bandwidth?au:ru)(e.copy(),c),E=f.selection?f.selection():f,M=E.selectAll(".domain").data([null]),N=E.selectAll(".tick").data(w,e).order(),C=N.exit(),$=N.enter().append("g").attr("class","tick"),H=N.select("line"),P=N.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),N=N.merge($),H=H.merge($.append("line").attr("stroke","currentColor").attr(h+"2",d*a)),P=P.merge($.append("text").attr("fill","currentColor").attr(h,d*g).attr("dy",t===hs?"0em":t===Ds?"0.71em":"0.32em")),f!==E&&(M=M.transition(f),N=N.transition(f),H=H.transition(f),P=P.transition(f),C=C.transition(f).attr("opacity",Zi).attr("transform",function(W){return isFinite(W=j(W))?l(W+c):this.getAttribute("transform")}),$.attr("opacity",Zi).attr("transform",function(W){var L=this.parentNode.__axis;return l((L&&isFinite(L=L(W))?L:j(W))+c)})),C.remove(),M.attr("d",t===un||t===gn?r?"M"+d*r+","+S+"H"+c+"V"+T+"H"+d*r:"M"+c+","+S+"V"+T:r?"M"+S+","+d*r+"V"+c+"H"+T+"V"+d*r:"M"+S+","+c+"H"+T),N.attr("opacity",1).attr("transform",function(W){return l(j(W)+c)}),H.attr(h+"2",d*a),P.attr(h,d*g).text(b),E.filter(ou).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gn?"start":t===un?"end":"middle"),E.each(function(){this.__axis=j})}return p.scale=function(f){return arguments.length?(e=f,p):e},p.ticks=function(){return n=Array.from(arguments),p},p.tickArguments=function(f){return arguments.length?(n=f==null?[]:Array.from(f),p):n.slice()},p.tickValues=function(f){return arguments.length?(s=f==null?null:Array.from(f),p):s&&s.slice()},p.tickFormat=function(f){return arguments.length?(i=f,p):i},p.tickSize=function(f){return arguments.length?(a=r=+f,p):a},p.tickSizeInner=function(f){return arguments.length?(a=+f,p):a},p.tickSizeOuter=function(f){return arguments.length?(r=+f,p):r},p.tickPadding=function(f){return arguments.length?(u=+f,p):u},p.offset=function(f){return arguments.length?(c=+f,p):c},p}function cu(t){return pa(gn,t)}function ga(t){return pa(Ds,t)}var lu={value:()=>{}};function An(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new xn(n)}function xn(t){this._=t}function uu(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",i=n.indexOf(".");if(i>=0&&(s=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}xn.prototype=An.prototype={constructor:xn,on:function(t,e){var n=this._,s=uu(t+"",n),i,a=-1,r=s.length;if(arguments.length<2){for(;++a<r;)if((i=(t=s[a]).type)&&(i=du(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<r;)if(i=(t=s[a]).type)n[i]=Ji(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Ji(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new xn(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),s=0,i,a;s<i;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],s=0,i=a.length;s<i;++s)a[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],i=0,a=s.length;i<a;++i)s[i].value.apply(e,n)}};function du(t,e){for(var n=0,s=t.length,i;n<s;++n)if((i=t[n]).name===e)return i.value}function Ji(t,e,n){for(var s=0,i=t.length;s<i;++s)if(t[s].name===e){t[s]=lu,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var $s="http://www.w3.org/1999/xhtml";const Qi={svg:"http://www.w3.org/2000/svg",xhtml:$s,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Gn(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Qi.hasOwnProperty(e)?{space:Qi[e],local:t}:t}function hu(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===$s&&e.documentElement.namespaceURI===$s?e.createElement(t):e.createElementNS(n,t)}}function fu(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xa(t){var e=Gn(t);return(e.local?fu:hu)(e)}function pu(){}function ri(t){return t==null?pu:function(){return this.querySelector(t)}}function gu(t){typeof t!="function"&&(t=ri(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=new Array(r),c,d,h=0;h<r;++h)(c=a[h])&&(d=t.call(c,c.__data__,h,a))&&("__data__"in c&&(d.__data__=c.__data__),u[h]=d);return new Ot(s,this._parents)}function xu(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function mu(){return[]}function ma(t){return t==null?mu:function(){return this.querySelectorAll(t)}}function yu(t){return function(){return xu(t.apply(this,arguments))}}function _u(t){typeof t=="function"?t=yu(t):t=ma(t);for(var e=this._groups,n=e.length,s=[],i=[],a=0;a<n;++a)for(var r=e[a],u=r.length,c,d=0;d<u;++d)(c=r[d])&&(s.push(t.call(c,c.__data__,d,r)),i.push(c));return new Ot(s,i)}function ya(t){return function(){return this.matches(t)}}function _a(t){return function(e){return e.matches(t)}}var vu=Array.prototype.find;function wu(t){return function(){return vu.call(this.children,t)}}function ku(){return this.firstElementChild}function bu(t){return this.select(t==null?ku:wu(typeof t=="function"?t:_a(t)))}var Tu=Array.prototype.filter;function Su(){return Array.from(this.children)}function ju(t){return function(){return Tu.call(this.children,t)}}function Cu(t){return this.selectAll(t==null?Su:ju(typeof t=="function"?t:_a(t)))}function Ru(t){typeof t!="function"&&(t=ya(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=[],c,d=0;d<r;++d)(c=a[d])&&t.call(c,c.__data__,d,a)&&u.push(c);return new Ot(s,this._parents)}function va(t){return new Array(t.length)}function Eu(){return new Ot(this._enter||this._groups.map(va),this._parents)}function En(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}En.prototype={constructor:En,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Mu(t){return function(){return t}}function Nu(t,e,n,s,i,a){for(var r=0,u,c=e.length,d=a.length;r<d;++r)(u=e[r])?(u.__data__=a[r],s[r]=u):n[r]=new En(t,a[r]);for(;r<c;++r)(u=e[r])&&(i[r]=u)}function zu(t,e,n,s,i,a,r){var u,c,d=new Map,h=e.length,l=a.length,p=new Array(h),f;for(u=0;u<h;++u)(c=e[u])&&(p[u]=f=r.call(c,c.__data__,u,e)+"",d.has(f)?i[u]=c:d.set(f,c));for(u=0;u<l;++u)f=r.call(t,a[u],u,a)+"",(c=d.get(f))?(s[u]=c,c.__data__=a[u],d.delete(f)):n[u]=new En(t,a[u]);for(u=0;u<h;++u)(c=e[u])&&d.get(p[u])===c&&(i[u]=c)}function Lu(t){return t.__data__}function Du(t,e){if(!arguments.length)return Array.from(this,Lu);var n=e?zu:Nu,s=this._parents,i=this._groups;typeof t!="function"&&(t=Mu(t));for(var a=i.length,r=new Array(a),u=new Array(a),c=new Array(a),d=0;d<a;++d){var h=s[d],l=i[d],p=l.length,f=$u(t.call(h,h&&h.__data__,d,s)),w=f.length,b=u[d]=new Array(w),g=r[d]=new Array(w),m=c[d]=new Array(p);n(h,l,b,g,m,f,e);for(var S=0,T=0,j,E;S<w;++S)if(j=b[S]){for(S>=T&&(T=S+1);!(E=g[T])&&++T<w;);j._next=E||null}}return r=new Ot(r,s),r._enter=u,r._exit=c,r}function $u(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ou(){return new Ot(this._exit||this._groups.map(va),this._parents)}function Fu(t,e,n){var s=this.enter(),i=this,a=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?a.remove():n(a),s&&i?s.merge(i).order():i}function Bu(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,i=n.length,a=s.length,r=Math.min(i,a),u=new Array(i),c=0;c<r;++c)for(var d=n[c],h=s[c],l=d.length,p=u[c]=new Array(l),f,w=0;w<l;++w)(f=d[w]||h[w])&&(p[w]=f);for(;c<i;++c)u[c]=n[c];return new Ot(u,this._parents)}function Hu(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],i=s.length-1,a=s[i],r;--i>=0;)(r=s[i])&&(a&&r.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(r,a),a=r);return this}function qu(t){t||(t=Vu);function e(l,p){return l&&p?t(l.__data__,p.__data__):!l-!p}for(var n=this._groups,s=n.length,i=new Array(s),a=0;a<s;++a){for(var r=n[a],u=r.length,c=i[a]=new Array(u),d,h=0;h<u;++h)(d=r[h])&&(c[h]=d);c.sort(e)}return new Ot(i,this._parents).order()}function Vu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Uu(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Wu(){return Array.from(this)}function Pu(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],i=0,a=s.length;i<a;++i){var r=s[i];if(r)return r}return null}function Yu(){let t=0;for(const e of this)++t;return t}function Au(){return!this.node()}function Gu(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var i=e[n],a=0,r=i.length,u;a<r;++a)(u=i[a])&&t.call(u,u.__data__,a,i);return this}function Xu(t){return function(){this.removeAttribute(t)}}function Ku(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Zu(t,e){return function(){this.setAttribute(t,e)}}function Ju(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Qu(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Iu(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function td(t,e){var n=Gn(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?Ku:Xu:typeof e=="function"?n.local?Iu:Qu:n.local?Ju:Zu)(n,e))}function wa(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ed(t){return function(){this.style.removeProperty(t)}}function nd(t,e,n){return function(){this.style.setProperty(t,e,n)}}function sd(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function id(t,e,n){return arguments.length>1?this.each((e==null?ed:typeof e=="function"?sd:nd)(t,e,n??"")):Ce(this.node(),t)}function Ce(t,e){return t.style.getPropertyValue(e)||wa(t).getComputedStyle(t,null).getPropertyValue(e)}function rd(t){return function(){delete this[t]}}function ad(t,e){return function(){this[t]=e}}function od(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function cd(t,e){return arguments.length>1?this.each((e==null?rd:typeof e=="function"?od:ad)(t,e)):this.node()[t]}function ka(t){return t.trim().split(/^|\s+/)}function ai(t){return t.classList||new ba(t)}function ba(t){this._node=t,this._names=ka(t.getAttribute("class")||"")}ba.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ta(t,e){for(var n=ai(t),s=-1,i=e.length;++s<i;)n.add(e[s])}function Sa(t,e){for(var n=ai(t),s=-1,i=e.length;++s<i;)n.remove(e[s])}function ld(t){return function(){Ta(this,t)}}function ud(t){return function(){Sa(this,t)}}function dd(t,e){return function(){(e.apply(this,arguments)?Ta:Sa)(this,t)}}function hd(t,e){var n=ka(t+"");if(arguments.length<2){for(var s=ai(this.node()),i=-1,a=n.length;++i<a;)if(!s.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?dd:e?ld:ud)(n,e))}function fd(){this.textContent=""}function pd(t){return function(){this.textContent=t}}function gd(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function xd(t){return arguments.length?this.each(t==null?fd:(typeof t=="function"?gd:pd)(t)):this.node().textContent}function md(){this.innerHTML=""}function yd(t){return function(){this.innerHTML=t}}function _d(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function vd(t){return arguments.length?this.each(t==null?md:(typeof t=="function"?_d:yd)(t)):this.node().innerHTML}function wd(){this.nextSibling&&this.parentNode.appendChild(this)}function kd(){return this.each(wd)}function bd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Td(){return this.each(bd)}function Sd(t){var e=typeof t=="function"?t:xa(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function jd(){return null}function Cd(t,e){var n=typeof t=="function"?t:xa(t),s=e==null?jd:typeof e=="function"?e:ri(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Rd(){var t=this.parentNode;t&&t.removeChild(this)}function Ed(){return this.each(Rd)}function Md(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Nd(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function zd(t){return this.select(t?Nd:Md)}function Ld(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Dd(t){return function(e){t.call(this,e,this.__data__)}}function $d(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function Od(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,i=e.length,a;n<i;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++s]=a;++s?e.length=s:delete this.__on}}}function Fd(t,e,n){return function(){var s=this.__on,i,a=Dd(e);if(s){for(var r=0,u=s.length;r<u;++r)if((i=s[r]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=e;return}}this.addEventListener(t.type,a,n),i={type:t.type,name:t.name,value:e,listener:a,options:n},s?s.push(i):this.__on=[i]}}function Bd(t,e,n){var s=$d(t+""),i,a=s.length,r;if(arguments.length<2){var u=this.node().__on;if(u){for(var c=0,d=u.length,h;c<d;++c)for(i=0,h=u[c];i<a;++i)if((r=s[i]).type===h.type&&r.name===h.name)return h.value}return}for(u=e?Fd:Od,i=0;i<a;++i)this.each(u(s[i],e,n));return this}function ja(t,e,n){var s=wa(t),i=s.CustomEvent;typeof i=="function"?i=new i(e,n):(i=s.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Hd(t,e){return function(){return ja(this,t,e)}}function qd(t,e){return function(){return ja(this,t,e.apply(this,arguments))}}function Vd(t,e){return this.each((typeof e=="function"?qd:Hd)(t,e))}function*Ud(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],i=0,a=s.length,r;i<a;++i)(r=s[i])&&(yield r)}var Ca=[null];function Ot(t,e){this._groups=t,this._parents=e}function tn(){return new Ot([[document.documentElement]],Ca)}function Wd(){return this}Ot.prototype=tn.prototype={constructor:Ot,select:gu,selectAll:_u,selectChild:bu,selectChildren:Cu,filter:Ru,data:Du,enter:Eu,exit:Ou,join:Fu,merge:Bu,selection:Wd,order:Hu,sort:qu,call:Uu,nodes:Wu,node:Pu,size:Yu,empty:Au,each:Gu,attr:td,style:id,property:cd,classed:hd,text:xd,html:vd,raise:kd,lower:Td,append:Sd,insert:Cd,remove:Ed,clone:zd,datum:Ld,on:Bd,dispatch:Vd,[Symbol.iterator]:Ud};function yt(t){return typeof t=="string"?new Ot([[document.querySelector(t)]],[document.documentElement]):new Ot([[t]],Ca)}function Pd(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Pt(t,e){if(t=Pd(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(e.getScreenCTM().inverse()),[s.x,s.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Os={capture:!0,passive:!1};function Fs(t){t.preventDefault(),t.stopImmediatePropagation()}function Ra(t){var e=t.document.documentElement,n=yt(t).on("dragstart.drag",Fs,Os);"onselectstart"in e?n.on("selectstart.drag",Fs,Os):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ea(t,e){var n=t.document.documentElement,s=yt(t).on("dragstart.drag",null);e&&(s.on("click.drag",Fs,Os),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Re=0,He=0,Fe=0,Ma=1e3,Mn,qe,Nn=0,xe=0,Xn=0,Ze=typeof performance=="object"&&performance.now?performance:Date,Na=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function oi(){return xe||(Na(Yd),xe=Ze.now()+Xn)}function Yd(){xe=0}function zn(){this._call=this._time=this._next=null}zn.prototype=za.prototype={constructor:zn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?oi():+n)+(e==null?0:+e),!this._next&&qe!==this&&(qe?qe._next=this:Mn=this,qe=this),this._call=t,this._time=n,Bs()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bs())}};function za(t,e,n){var s=new zn;return s.restart(t,e,n),s}function Ad(){oi(),++Re;for(var t=Mn,e;t;)(e=xe-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Re}function Ii(){xe=(Nn=Ze.now())+Xn,Re=He=0;try{Ad()}finally{Re=0,Xd(),xe=0}}function Gd(){var t=Ze.now(),e=t-Nn;e>Ma&&(Xn-=e,Nn=t)}function Xd(){for(var t,e=Mn,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Mn=n);qe=t,Bs(s)}function Bs(t){if(!Re){He&&(He=clearTimeout(He));var e=t-xe;e>24?(t<1/0&&(He=setTimeout(Ii,t-Ze.now()-Xn)),Fe&&(Fe=clearInterval(Fe))):(Fe||(Nn=Ze.now(),Fe=setInterval(Gd,Ma)),Re=1,Na(Ii))}}function tr(t,e,n){var s=new zn;return e=e==null?0:+e,s.restart(i=>{s.stop(),t(i+e)},e,n),s}var Kd=An("start","end","cancel","interrupt"),Zd=[],La=0,er=1,Hs=2,mn=3,nr=4,qs=5,yn=6;function Kn(t,e,n,s,i,a){var r=t.__transition;if(!r)t.__transition={};else if(n in r)return;Jd(t,n,{name:e,index:s,group:i,on:Kd,tween:Zd,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:La})}function ci(t,e){var n=Vt(t,e);if(n.state>La)throw new Error("too late; already scheduled");return n}function Gt(t,e){var n=Vt(t,e);if(n.state>mn)throw new Error("too late; already running");return n}function Vt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Jd(t,e,n){var s=t.__transition,i;s[e]=n,n.timer=za(a,0,n.time);function a(d){n.state=er,n.timer.restart(r,n.delay,n.time),n.delay<=d&&r(d-n.delay)}function r(d){var h,l,p,f;if(n.state!==er)return c();for(h in s)if(f=s[h],f.name===n.name){if(f.state===mn)return tr(r);f.state===nr?(f.state=yn,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete s[h]):+h<e&&(f.state=yn,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete s[h])}if(tr(function(){n.state===mn&&(n.state=nr,n.timer.restart(u,n.delay,n.time),u(d))}),n.state=Hs,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Hs){for(n.state=mn,i=new Array(p=n.tween.length),h=0,l=-1;h<p;++h)(f=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++l]=f);i.length=l+1}}function u(d){for(var h=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=qs,1),l=-1,p=i.length;++l<p;)i[l].call(t,h);n.state===qs&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=yn,n.timer.stop(),delete s[e];for(var d in s)return;delete t.__transition}}function Te(t,e){var n=t.__transition,s,i,a=!0,r;if(n){e=e==null?null:e+"";for(r in n){if((s=n[r]).name!==e){a=!1;continue}i=s.state>Hs&&s.state<qs,s.state=yn,s.timer.stop(),s.on.call(i?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[r]}a&&delete t.__transition}}function Qd(t){return this.each(function(){Te(this,t)})}function Id(t,e){var n,s;return function(){var i=Gt(this,t),a=i.tween;if(a!==n){s=n=a;for(var r=0,u=s.length;r<u;++r)if(s[r].name===e){s=s.slice(),s.splice(r,1);break}}i.tween=s}}function th(t,e,n){var s,i;if(typeof n!="function")throw new Error;return function(){var a=Gt(this,t),r=a.tween;if(r!==s){i=(s=r).slice();for(var u={name:e,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===e){i[c]=u;break}c===d&&i.push(u)}a.tween=i}}function eh(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=Vt(this.node(),n).tween,i=0,a=s.length,r;i<a;++i)if((r=s[i]).name===t)return r.value;return null}return this.each((e==null?Id:th)(n,t,e))}function li(t,e,n){var s=t._id;return t.each(function(){var i=Gt(this,s);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Vt(i,s).value[e]}}function Da(t,e){var n;return(typeof e=="number"?ue:e instanceof Di?$i:(n=Di(e))?(e=n,$i):cc)(t,e)}function nh(t){return function(){this.removeAttribute(t)}}function sh(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ih(t,e,n){var s,i=n+"",a;return function(){var r=this.getAttribute(t);return r===i?null:r===s?a:a=e(s=r,n)}}function rh(t,e,n){var s,i=n+"",a;return function(){var r=this.getAttributeNS(t.space,t.local);return r===i?null:r===s?a:a=e(s=r,n)}}function ah(t,e,n){var s,i,a;return function(){var r,u=n(this),c;return u==null?void this.removeAttribute(t):(r=this.getAttribute(t),c=u+"",r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u)))}}function oh(t,e,n){var s,i,a;return function(){var r,u=n(this),c;return u==null?void this.removeAttributeNS(t.space,t.local):(r=this.getAttributeNS(t.space,t.local),c=u+"",r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u)))}}function ch(t,e){var n=Gn(t),s=n==="transform"?Fc:Da;return this.attrTween(t,typeof e=="function"?(n.local?oh:ah)(n,s,li(this,"attr."+t,e)):e==null?(n.local?sh:nh)(n):(n.local?rh:ih)(n,s,e))}function lh(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function uh(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function dh(t,e){var n,s;function i(){var a=e.apply(this,arguments);return a!==s&&(n=(s=a)&&uh(t,a)),n}return i._value=e,i}function hh(t,e){var n,s;function i(){var a=e.apply(this,arguments);return a!==s&&(n=(s=a)&&lh(t,a)),n}return i._value=e,i}function fh(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=Gn(t);return this.tween(n,(s.local?dh:hh)(s,e))}function ph(t,e){return function(){ci(this,t).delay=+e.apply(this,arguments)}}function gh(t,e){return e=+e,function(){ci(this,t).delay=e}}function xh(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ph:gh)(e,t)):Vt(this.node(),e).delay}function mh(t,e){return function(){Gt(this,t).duration=+e.apply(this,arguments)}}function yh(t,e){return e=+e,function(){Gt(this,t).duration=e}}function _h(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mh:yh)(e,t)):Vt(this.node(),e).duration}function vh(t,e){if(typeof e!="function")throw new Error;return function(){Gt(this,t).ease=e}}function wh(t){var e=this._id;return arguments.length?this.each(vh(e,t)):Vt(this.node(),e).ease}function kh(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Gt(this,t).ease=n}}function bh(t){if(typeof t!="function")throw new Error;return this.each(kh(this._id,t))}function Th(t){typeof t!="function"&&(t=ya(t));for(var e=this._groups,n=e.length,s=new Array(n),i=0;i<n;++i)for(var a=e[i],r=a.length,u=s[i]=[],c,d=0;d<r;++d)(c=a[d])&&t.call(c,c.__data__,d,a)&&u.push(c);return new ne(s,this._parents,this._name,this._id)}function Sh(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,i=n.length,a=Math.min(s,i),r=new Array(s),u=0;u<a;++u)for(var c=e[u],d=n[u],h=c.length,l=r[u]=new Array(h),p,f=0;f<h;++f)(p=c[f]||d[f])&&(l[f]=p);for(;u<s;++u)r[u]=e[u];return new ne(r,this._parents,this._name,this._id)}function jh(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Ch(t,e,n){var s,i,a=jh(e)?ci:Gt;return function(){var r=a(this,t),u=r.on;u!==s&&(i=(s=u).copy()).on(e,n),r.on=i}}function Rh(t,e){var n=this._id;return arguments.length<2?Vt(this.node(),n).on.on(t):this.each(Ch(n,t,e))}function Eh(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Mh(){return this.on("end.remove",Eh(this._id))}function Nh(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ri(t));for(var s=this._groups,i=s.length,a=new Array(i),r=0;r<i;++r)for(var u=s[r],c=u.length,d=a[r]=new Array(c),h,l,p=0;p<c;++p)(h=u[p])&&(l=t.call(h,h.__data__,p,u))&&("__data__"in h&&(l.__data__=h.__data__),d[p]=l,Kn(d[p],e,n,p,d,Vt(h,n)));return new ne(a,this._parents,e,n)}function zh(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ma(t));for(var s=this._groups,i=s.length,a=[],r=[],u=0;u<i;++u)for(var c=s[u],d=c.length,h,l=0;l<d;++l)if(h=c[l]){for(var p=t.call(h,h.__data__,l,c),f,w=Vt(h,n),b=0,g=p.length;b<g;++b)(f=p[b])&&Kn(f,e,n,b,p,w);a.push(p),r.push(h)}return new ne(a,r,e,n)}var Lh=tn.prototype.constructor;function Dh(){return new Lh(this._groups,this._parents)}function $h(t,e){var n,s,i;return function(){var a=Ce(this,t),r=(this.style.removeProperty(t),Ce(this,t));return a===r?null:a===n&&r===s?i:i=e(n=a,s=r)}}function $a(t){return function(){this.style.removeProperty(t)}}function Oh(t,e,n){var s,i=n+"",a;return function(){var r=Ce(this,t);return r===i?null:r===s?a:a=e(s=r,n)}}function Fh(t,e,n){var s,i,a;return function(){var r=Ce(this,t),u=n(this),c=u+"";return u==null&&(c=u=(this.style.removeProperty(t),Ce(this,t))),r===c?null:r===s&&c===i?a:(i=c,a=e(s=r,u))}}function Bh(t,e){var n,s,i,a="style."+e,r="end."+a,u;return function(){var c=Gt(this,t),d=c.on,h=c.value[a]==null?u||(u=$a(e)):void 0;(d!==n||i!==h)&&(s=(n=d).copy()).on(r,i=h),c.on=s}}function Hh(t,e,n){var s=(t+="")=="transform"?Oc:Da;return e==null?this.styleTween(t,$h(t,s)).on("end.style."+t,$a(t)):typeof e=="function"?this.styleTween(t,Fh(t,s,li(this,"style."+t,e))).each(Bh(this._id,t)):this.styleTween(t,Oh(t,s,e),n).on("end.style."+t,null)}function qh(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function Vh(t,e,n){var s,i;function a(){var r=e.apply(this,arguments);return r!==i&&(s=(i=r)&&qh(t,r,n)),s}return a._value=e,a}function Uh(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,Vh(t,e,n??""))}function Wh(t){return function(){this.textContent=t}}function Ph(t){return function(){var e=t(this);this.textContent=e??""}}function Yh(t){return this.tween("text",typeof t=="function"?Ph(li(this,"text",t)):Wh(t==null?"":t+""))}function Ah(t){return function(e){this.textContent=t.call(this,e)}}function Gh(t){var e,n;function s(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ah(i)),e}return s._value=t,s}function Xh(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Gh(t))}function Kh(){for(var t=this._name,e=this._id,n=Oa(),s=this._groups,i=s.length,a=0;a<i;++a)for(var r=s[a],u=r.length,c,d=0;d<u;++d)if(c=r[d]){var h=Vt(c,e);Kn(c,t,n,d,r,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new ne(s,this._parents,t,n)}function Zh(){var t,e,n=this,s=n._id,i=n.size();return new Promise(function(a,r){var u={value:r},c={value:function(){--i===0&&a()}};n.each(function(){var d=Gt(this,s),h=d.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(u),e._.interrupt.push(u),e._.end.push(c)),d.on=e}),i===0&&a()})}var Jh=0;function ne(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function Oa(){return++Jh}var Zt=tn.prototype;ne.prototype={constructor:ne,select:Nh,selectAll:zh,selectChild:Zt.selectChild,selectChildren:Zt.selectChildren,filter:Th,merge:Sh,selection:Dh,transition:Kh,call:Zt.call,nodes:Zt.nodes,node:Zt.node,size:Zt.size,empty:Zt.empty,each:Zt.each,on:Rh,attr:ch,attrTween:fh,style:Hh,styleTween:Uh,text:Yh,textTween:Xh,remove:Mh,tween:eh,delay:xh,duration:_h,ease:wh,easeVarying:bh,end:Zh,[Symbol.iterator]:Zt[Symbol.iterator]};function Qh(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Ih={time:null,delay:0,duration:250,ease:Qh};function tf(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function ef(t){var e,n;t instanceof ne?(e=t._id,t=t._name):(e=Oa(),(n=Ih).time=oi(),t=t==null?null:t+"");for(var s=this._groups,i=s.length,a=0;a<i;++a)for(var r=s[a],u=r.length,c,d=0;d<u;++d)(c=r[d])&&Kn(c,t,e,d,r,n||tf(c,e));return new ne(s,this._parents,t,e)}tn.prototype.interrupt=Qd;tn.prototype.transition=ef;const fs=t=>()=>t;function nf(t,{sourceEvent:e,target:n,selection:s,mode:i,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:s,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:a}})}function sf(t){t.stopImmediatePropagation()}function ps(t){t.preventDefault(),t.stopImmediatePropagation()}var sr={name:"drag"},gs={name:"space"},_e={name:"handle"},ve={name:"center"};const{abs:ir,max:jt,min:Ct}=Math;function rr(t){return[+t[0],+t[1]]}function ar(t){return[rr(t[0]),rr(t[1])]}var _n={name:"x",handles:["w","e"].map(Ln),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},vn={name:"y",handles:["n","s"].map(Ln),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Jt={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},or={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},cr={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},rf={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},af={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ln(t){return{type:t}}function of(t){return!t.ctrlKey&&!t.button}function cf(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function lf(){return navigator.maxTouchPoints||"ontouchstart"in this}function xs(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function uf(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function df(){return Fa(_n)}function hf(){return Fa(vn)}function Fa(t){var e=cf,n=of,s=lf,i=!0,a=An("start","brush","end"),r=6,u;function c(g){var m=g.property("__brush",b).selectAll(".overlay").data([Ln("overlay")]);m.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Jt.overlay).merge(m).each(function(){var T=xs(this).extent;yt(this).attr("x",T[0][0]).attr("y",T[0][1]).attr("width",T[1][0]-T[0][0]).attr("height",T[1][1]-T[0][1])}),g.selectAll(".selection").data([Ln("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Jt.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var S=g.selectAll(".handle").data(t.handles,function(T){return T.type});S.exit().remove(),S.enter().append("rect").attr("class",function(T){return"handle handle--"+T.type}).attr("cursor",function(T){return Jt[T.type]}),g.each(d).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",p).filter(s).on("touchstart.brush",p).on("touchmove.brush",f).on("touchend.brush touchcancel.brush",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(g,m,S){g.tween?g.on("start.brush",function(T){h(this,arguments).beforestart().start(T)}).on("interrupt.brush end.brush",function(T){h(this,arguments).end(T)}).tween("brush",function(){var T=this,j=T.__brush,E=h(T,arguments),M=j.selection,N=t.input(typeof m=="function"?m.apply(this,arguments):m,j.extent),C=lc(M,N);function $(H){j.selection=H===1&&N===null?null:C(H),d.call(T),E.brush()}return M!==null&&N!==null?$:$(1)}):g.each(function(){var T=this,j=arguments,E=T.__brush,M=t.input(typeof m=="function"?m.apply(T,j):m,E.extent),N=h(T,j).beforestart();Te(T),E.selection=M===null?null:M,d.call(T),N.start(S).brush(S).end(S)})},c.clear=function(g,m){c.move(g,null,m)};function d(){var g=yt(this),m=xs(this).selection;m?(g.selectAll(".selection").style("display",null).attr("x",m[0][0]).attr("y",m[0][1]).attr("width",m[1][0]-m[0][0]).attr("height",m[1][1]-m[0][1]),g.selectAll(".handle").style("display",null).attr("x",function(S){return S.type[S.type.length-1]==="e"?m[1][0]-r/2:m[0][0]-r/2}).attr("y",function(S){return S.type[0]==="s"?m[1][1]-r/2:m[0][1]-r/2}).attr("width",function(S){return S.type==="n"||S.type==="s"?m[1][0]-m[0][0]+r:r}).attr("height",function(S){return S.type==="e"||S.type==="w"?m[1][1]-m[0][1]+r:r})):g.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(g,m,S){var T=g.__brush.emitter;return T&&(!S||!T.clean)?T:new l(g,m,S)}function l(g,m,S){this.that=g,this.args=m,this.state=g.__brush,this.active=0,this.clean=S}l.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(g,m){return this.starting?(this.starting=!1,this.emit("start",g,m)):this.emit("brush",g),this},brush:function(g,m){return this.emit("brush",g,m),this},end:function(g,m){return--this.active===0&&(delete this.state.emitter,this.emit("end",g,m)),this},emit:function(g,m,S){var T=yt(this.that).datum();a.call(g,this.that,new nf(g,{sourceEvent:m,target:c,selection:t.output(this.state.selection),mode:S,dispatch:a}),T)}};function p(g){if(u&&!g.touches||!n.apply(this,arguments))return;var m=this,S=g.target.__data__.type,T=(i&&g.metaKey?S="overlay":S)==="selection"?sr:i&&g.altKey?ve:_e,j=t===vn?null:rf[S],E=t===_n?null:af[S],M=xs(m),N=M.extent,C=M.selection,$=N[0][0],H,P,W=N[0][1],L,x,v=N[1][0],y,k,R=N[1][1],z,D,O=0,F=0,ft,et=j&&E&&i&&g.shiftKey,Y,K,A=Array.from(g.touches||[g],V=>{const X=V.identifier;return V=Pt(V,m),V.point0=V.slice(),V.identifier=X,V});Te(m);var st=h(m,arguments,!0).beforestart();if(S==="overlay"){C&&(ft=!0);const V=[A[0],A[1]||A[0]];M.selection=C=[[H=t===vn?$:Ct(V[0][0],V[1][0]),L=t===_n?W:Ct(V[0][1],V[1][1])],[y=t===vn?v:jt(V[0][0],V[1][0]),z=t===_n?R:jt(V[0][1],V[1][1])]],A.length>1&&Z(g)}else H=C[0][0],L=C[0][1],y=C[1][0],z=C[1][1];P=H,x=L,k=y,D=z;var rt=yt(m).attr("pointer-events","none"),pt=rt.selectAll(".overlay").attr("cursor",Jt[S]);if(g.touches)st.moved=G,st.ended=gt;else{var xt=yt(g.view).on("mousemove.brush",G,!0).on("mouseup.brush",gt,!0);i&&xt.on("keydown.brush",nt,!0).on("keyup.brush",vt,!0),Ra(g.view)}d.call(m),st.start(g,T.name);function G(V){for(const X of V.changedTouches||[V])for(const ot of A)ot.identifier===X.identifier&&(ot.cur=Pt(X,m));if(et&&!Y&&!K&&A.length===1){const X=A[0];ir(X.cur[0]-X[0])>ir(X.cur[1]-X[1])?K=!0:Y=!0}for(const X of A)X.cur&&(X[0]=X.cur[0],X[1]=X.cur[1]);ft=!0,ps(V),Z(V)}function Z(V){const X=A[0],ot=X.point0;var ht;switch(O=X[0]-ot[0],F=X[1]-ot[1],T){case gs:case sr:{j&&(O=jt($-H,Ct(v-y,O)),P=H+O,k=y+O),E&&(F=jt(W-L,Ct(R-z,F)),x=L+F,D=z+F);break}case _e:{A[1]?(j&&(P=jt($,Ct(v,A[0][0])),k=jt($,Ct(v,A[1][0])),j=1),E&&(x=jt(W,Ct(R,A[0][1])),D=jt(W,Ct(R,A[1][1])),E=1)):(j<0?(O=jt($-H,Ct(v-H,O)),P=H+O,k=y):j>0&&(O=jt($-y,Ct(v-y,O)),P=H,k=y+O),E<0?(F=jt(W-L,Ct(R-L,F)),x=L+F,D=z):E>0&&(F=jt(W-z,Ct(R-z,F)),x=L,D=z+F));break}case ve:{j&&(P=jt($,Ct(v,H-O*j)),k=jt($,Ct(v,y+O*j))),E&&(x=jt(W,Ct(R,L-F*E)),D=jt(W,Ct(R,z+F*E)));break}}k<P&&(j*=-1,ht=H,H=y,y=ht,ht=P,P=k,k=ht,S in or&&pt.attr("cursor",Jt[S=or[S]])),D<x&&(E*=-1,ht=L,L=z,z=ht,ht=x,x=D,D=ht,S in cr&&pt.attr("cursor",Jt[S=cr[S]])),M.selection&&(C=M.selection),Y&&(P=C[0][0],k=C[1][0]),K&&(x=C[0][1],D=C[1][1]),(C[0][0]!==P||C[0][1]!==x||C[1][0]!==k||C[1][1]!==D)&&(M.selection=[[P,x],[k,D]],d.call(m),st.brush(V,T.name))}function gt(V){if(sf(V),V.touches){if(V.touches.length)return;u&&clearTimeout(u),u=setTimeout(function(){u=null},500)}else Ea(V.view,ft),xt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);rt.attr("pointer-events","all"),pt.attr("cursor",Jt.overlay),M.selection&&(C=M.selection),uf(C)&&(M.selection=null,d.call(m)),st.end(V,T.name)}function nt(V){switch(V.keyCode){case 16:{et=j&&E;break}case 18:{T===_e&&(j&&(y=k-O*j,H=P+O*j),E&&(z=D-F*E,L=x+F*E),T=ve,Z(V));break}case 32:{(T===_e||T===ve)&&(j<0?y=k-O:j>0&&(H=P-O),E<0?z=D-F:E>0&&(L=x-F),T=gs,pt.attr("cursor",Jt.selection),Z(V));break}default:return}ps(V)}function vt(V){switch(V.keyCode){case 16:{et&&(Y=K=et=!1,Z(V));break}case 18:{T===ve&&(j<0?y=k:j>0&&(H=P),E<0?z=D:E>0&&(L=x),T=_e,Z(V));break}case 32:{T===gs&&(V.altKey?(j&&(y=k-O*j,H=P+O*j),E&&(z=D-F*E,L=x+F*E),T=ve):(j<0?y=k:j>0&&(H=P),E<0?z=D:E>0&&(L=x),T=_e),pt.attr("cursor",Jt[S]),Z(V));break}default:return}ps(V)}}function f(g){h(this,arguments).moved(g)}function w(g){h(this,arguments).ended(g)}function b(){var g=this.__brush||{selection:null};return g.extent=ar(e.apply(this,arguments)),g.dim=t,g}return c.extent=function(g){return arguments.length?(e=typeof g=="function"?g:fs(ar(g)),c):e},c.filter=function(g){return arguments.length?(n=typeof g=="function"?g:fs(!!g),c):n},c.touchable=function(g){return arguments.length?(s=typeof g=="function"?g:fs(!!g),c):s},c.handleSize=function(g){return arguments.length?(r=+g,c):r},c.keyModifiers=function(g){return arguments.length?(i=!!g,c):i},c.on=function(){var g=a.on.apply(a,arguments);return g===a?c:g},c}const dn=t=>()=>t;function ff(t,{sourceEvent:e,target:n,transform:s,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function te(t,e,n){this.k=t,this.x=e,this.y=n}te.prototype={constructor:te,scale:function(t){return t===1?this:new te(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new te(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Zn=new te(1,0,0);te.prototype;function ms(t){t.stopImmediatePropagation()}function Be(t){t.preventDefault(),t.stopImmediatePropagation()}function pf(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function gf(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function lr(){return this.__zoom||Zn}function xf(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function mf(){return navigator.maxTouchPoints||"ontouchstart"in this}function yf(t,e,n){var s=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],r=t.invertY(e[1][1])-n[1][1];return t.translate(i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i),r>a?(a+r)/2:Math.min(0,a)||Math.max(0,r))}function Ba(){var t=pf,e=gf,n=yf,s=xf,i=mf,a=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],u=250,c=Vc,d=An("start","zoom","end"),h,l,p,f=500,w=150,b=0,g=10;function m(x){x.property("__zoom",lr).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",H).filter(i).on("touchstart.zoom",P).on("touchmove.zoom",W).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(x,v,y,k){var R=x.selection?x.selection():x;R.property("__zoom",lr),x!==R?E(x,v,y,k):R.interrupt().each(function(){M(this,arguments).event(k).start().zoom(null,typeof v=="function"?v.apply(this,arguments):v).end()})},m.scaleBy=function(x,v,y,k){m.scaleTo(x,function(){var R=this.__zoom.k,z=typeof v=="function"?v.apply(this,arguments):v;return R*z},y,k)},m.scaleTo=function(x,v,y,k){m.transform(x,function(){var R=e.apply(this,arguments),z=this.__zoom,D=y==null?j(R):typeof y=="function"?y.apply(this,arguments):y,O=z.invert(D),F=typeof v=="function"?v.apply(this,arguments):v;return n(T(S(z,F),D,O),R,r)},y,k)},m.translateBy=function(x,v,y,k){m.transform(x,function(){return n(this.__zoom.translate(typeof v=="function"?v.apply(this,arguments):v,typeof y=="function"?y.apply(this,arguments):y),e.apply(this,arguments),r)},null,k)},m.translateTo=function(x,v,y,k,R){m.transform(x,function(){var z=e.apply(this,arguments),D=this.__zoom,O=k==null?j(z):typeof k=="function"?k.apply(this,arguments):k;return n(Zn.translate(O[0],O[1]).scale(D.k).translate(typeof v=="function"?-v.apply(this,arguments):-v,typeof y=="function"?-y.apply(this,arguments):-y),z,r)},k,R)};function S(x,v){return v=Math.max(a[0],Math.min(a[1],v)),v===x.k?x:new te(v,x.x,x.y)}function T(x,v,y){var k=v[0]-y[0]*x.k,R=v[1]-y[1]*x.k;return k===x.x&&R===x.y?x:new te(x.k,k,R)}function j(x){return[(+x[0][0]+ +x[1][0])/2,(+x[0][1]+ +x[1][1])/2]}function E(x,v,y,k){x.on("start.zoom",function(){M(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(k).end()}).tween("zoom",function(){var R=this,z=arguments,D=M(R,z).event(k),O=e.apply(R,z),F=y==null?j(O):typeof y=="function"?y.apply(R,z):y,ft=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),et=R.__zoom,Y=typeof v=="function"?v.apply(R,z):v,K=c(et.invert(F).concat(ft/et.k),Y.invert(F).concat(ft/Y.k));return function(A){if(A===1)A=Y;else{var st=K(A),rt=ft/st[2];A=new te(rt,F[0]-st[0]*rt,F[1]-st[1]*rt)}D.zoom(null,A)}})}function M(x,v,y){return!y&&x.__zooming||new N(x,v)}function N(x,v){this.that=x,this.args=v,this.active=0,this.sourceEvent=null,this.extent=e.apply(x,v),this.taps=0}N.prototype={event:function(x){return x&&(this.sourceEvent=x),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(x,v){return this.mouse&&x!=="mouse"&&(this.mouse[1]=v.invert(this.mouse[0])),this.touch0&&x!=="touch"&&(this.touch0[1]=v.invert(this.touch0[0])),this.touch1&&x!=="touch"&&(this.touch1[1]=v.invert(this.touch1[0])),this.that.__zoom=v,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(x){var v=yt(this.that).datum();d.call(x,this.that,new ff(x,{sourceEvent:this.sourceEvent,target:m,type:x,transform:this.that.__zoom,dispatch:d}),v)}};function C(x,...v){if(!t.apply(this,arguments))return;var y=M(this,v).event(x),k=this.__zoom,R=Math.max(a[0],Math.min(a[1],k.k*Math.pow(2,s.apply(this,arguments)))),z=Pt(x);if(y.wheel)(y.mouse[0][0]!==z[0]||y.mouse[0][1]!==z[1])&&(y.mouse[1]=k.invert(y.mouse[0]=z)),clearTimeout(y.wheel);else{if(k.k===R)return;y.mouse=[z,k.invert(z)],Te(this),y.start()}Be(x),y.wheel=setTimeout(D,w),y.zoom("mouse",n(T(S(k,R),y.mouse[0],y.mouse[1]),y.extent,r));function D(){y.wheel=null,y.end()}}function $(x,...v){if(p||!t.apply(this,arguments))return;var y=x.currentTarget,k=M(this,v,!0).event(x),R=yt(x.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",ft,!0),z=Pt(x,y),D=x.clientX,O=x.clientY;Ra(x.view),ms(x),k.mouse=[z,this.__zoom.invert(z)],Te(this),k.start();function F(et){if(Be(et),!k.moved){var Y=et.clientX-D,K=et.clientY-O;k.moved=Y*Y+K*K>b}k.event(et).zoom("mouse",n(T(k.that.__zoom,k.mouse[0]=Pt(et,y),k.mouse[1]),k.extent,r))}function ft(et){R.on("mousemove.zoom mouseup.zoom",null),Ea(et.view,k.moved),Be(et),k.event(et).end()}}function H(x,...v){if(t.apply(this,arguments)){var y=this.__zoom,k=Pt(x.changedTouches?x.changedTouches[0]:x,this),R=y.invert(k),z=y.k*(x.shiftKey?.5:2),D=n(T(S(y,z),k,R),e.apply(this,v),r);Be(x),u>0?yt(this).transition().duration(u).call(E,D,k,x):yt(this).call(m.transform,D,k,x)}}function P(x,...v){if(t.apply(this,arguments)){var y=x.touches,k=y.length,R=M(this,v,x.changedTouches.length===k).event(x),z,D,O,F;for(ms(x),D=0;D<k;++D)O=y[D],F=Pt(O,this),F=[F,this.__zoom.invert(F),O.identifier],R.touch0?!R.touch1&&R.touch0[2]!==F[2]&&(R.touch1=F,R.taps=0):(R.touch0=F,z=!0,R.taps=1+!!h);h&&(h=clearTimeout(h)),z&&(R.taps<2&&(l=F[0],h=setTimeout(function(){h=null},f)),Te(this),R.start())}}function W(x,...v){if(this.__zooming){var y=M(this,v).event(x),k=x.changedTouches,R=k.length,z,D,O,F;for(Be(x),z=0;z<R;++z)D=k[z],O=Pt(D,this),y.touch0&&y.touch0[2]===D.identifier?y.touch0[0]=O:y.touch1&&y.touch1[2]===D.identifier&&(y.touch1[0]=O);if(D=y.that.__zoom,y.touch1){var ft=y.touch0[0],et=y.touch0[1],Y=y.touch1[0],K=y.touch1[1],A=(A=Y[0]-ft[0])*A+(A=Y[1]-ft[1])*A,st=(st=K[0]-et[0])*st+(st=K[1]-et[1])*st;D=S(D,Math.sqrt(A/st)),O=[(ft[0]+Y[0])/2,(ft[1]+Y[1])/2],F=[(et[0]+K[0])/2,(et[1]+K[1])/2]}else if(y.touch0)O=y.touch0[0],F=y.touch0[1];else return;y.zoom("touch",n(T(D,O,F),y.extent,r))}}function L(x,...v){if(this.__zooming){var y=M(this,v).event(x),k=x.changedTouches,R=k.length,z,D;for(ms(x),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),z=0;z<R;++z)D=k[z],y.touch0&&y.touch0[2]===D.identifier?delete y.touch0:y.touch1&&y.touch1[2]===D.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(D=Pt(D,this),Math.hypot(l[0]-D[0],l[1]-D[1])<g)){var O=yt(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return m.wheelDelta=function(x){return arguments.length?(s=typeof x=="function"?x:dn(+x),m):s},m.filter=function(x){return arguments.length?(t=typeof x=="function"?x:dn(!!x),m):t},m.touchable=function(x){return arguments.length?(i=typeof x=="function"?x:dn(!!x),m):i},m.extent=function(x){return arguments.length?(e=typeof x=="function"?x:dn([[+x[0][0],+x[0][1]],[+x[1][0],+x[1][1]]]),m):e},m.scaleExtent=function(x){return arguments.length?(a[0]=+x[0],a[1]=+x[1],m):[a[0],a[1]]},m.translateExtent=function(x){return arguments.length?(r[0][0]=+x[0][0],r[1][0]=+x[1][0],r[0][1]=+x[0][1],r[1][1]=+x[1][1],m):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},m.constrain=function(x){return arguments.length?(n=x,m):n},m.duration=function(x){return arguments.length?(u=+x,m):u},m.interpolate=function(x){return arguments.length?(c=x,m):c},m.on=function(){var x=d.on.apply(d,arguments);return x===d?m:x},m.clickDistance=function(x){return arguments.length?(b=(x=+x)*x,m):Math.sqrt(b)},m.tapDistance=function(x){return arguments.length?(g=+x,m):g},m}var _t=(t=>(t.LOWER="LOWER",t.UPPER="UPPER",t))(_t||{});const Dn={[lt.LOWEST]:{initialMin:.99,initialMax:1.01,min:1e-5,max:1.5},[lt.LOW]:{initialMin:.8,initialMax:1.25,min:1e-5,max:1.5},[lt.MEDIUM]:{initialMin:.5,initialMax:1.5,min:1e-5,max:20},[lt.HIGH]:{initialMin:.5,initialMax:1.5,min:1e-5,max:20}};lt.LOWEST+"",lt.LOW+"",lt.MEDIUM+"",Dn[lt.MEDIUM],lt.HIGH+"",Dn[lt.HIGH];function _f(t,e,n,s){for(var i=-1,a=t==null?0:t.length;++i<a;){var r=t[i];e(s,r,n(r),t)}return s}var vf=_f,wf=uc;function kf(t,e,n,s){return wf(t,function(i,a,r){e(s,i,n(i),r)}),s}var bf=kf,Tf=vf,Sf=bf,jf=dc,Cf=hc;function Rf(t,e){return function(n,s){var i=Cf(n)?Tf:Sf,a=e?e():{};return i(n,t,jf(s),a)}}var Ef=Rf,Mf=Ef,Nf=Mf(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),zf=Nf;const Lf=Po(zf);var zt=function(){return zt=Object.assign||function(e){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},zt.apply(this,arguments)};function $n(t,e,n){if(n||arguments.length===2)for(var s=0,i=e.length,a;s<i;s++)(a||!(s in e))&&(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))}var mt="-ms-",We="-moz-",at="-webkit-",Ha="comm",Jn="rule",ui="decl",Df="@import",qa="@keyframes",$f="@layer",Va=Math.abs,di=String.fromCharCode,Vs=Object.assign;function Of(t,e){return Tt(t,0)^45?(((e<<2^Tt(t,0))<<2^Tt(t,1))<<2^Tt(t,2))<<2^Tt(t,3):0}function Ua(t){return t.trim()}function Qt(t,e){return(t=e.exec(t))?t[0]:t}function I(t,e,n){return t.replace(e,n)}function wn(t,e,n){return t.indexOf(e,n)}function Tt(t,e){return t.charCodeAt(e)|0}function Ee(t,e,n){return t.slice(e,n)}function Yt(t){return t.length}function Wa(t){return t.length}function Ve(t,e){return e.push(t),t}function Ff(t,e){return t.map(e).join("")}function ur(t,e){return t.filter(function(n){return!Qt(n,e)})}var Qn=1,Me=1,Pa=0,Bt=0,kt=0,De="";function In(t,e,n,s,i,a,r,u){return{value:t,root:e,parent:n,type:s,props:i,children:a,line:Qn,column:Me,length:r,return:"",siblings:u}}function se(t,e){return Vs(In("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function we(t){for(;t.root;)t=se(t.root,{children:[t]});Ve(t,t.siblings)}function Bf(){return kt}function Hf(){return kt=Bt>0?Tt(De,--Bt):0,Me--,kt===10&&(Me=1,Qn--),kt}function qt(){return kt=Bt<Pa?Tt(De,Bt++):0,Me++,kt===10&&(Me=1,Qn++),kt}function fe(){return Tt(De,Bt)}function kn(){return Bt}function ts(t,e){return Ee(De,t,e)}function Us(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function qf(t){return Qn=Me=1,Pa=Yt(De=t),Bt=0,[]}function Vf(t){return De="",t}function ys(t){return Ua(ts(Bt-1,Ws(t===91?t+2:t===40?t+1:t)))}function Uf(t){for(;(kt=fe())&&kt<33;)qt();return Us(t)>2||Us(kt)>3?"":" "}function Wf(t,e){for(;--e&&qt()&&!(kt<48||kt>102||kt>57&&kt<65||kt>70&&kt<97););return ts(t,kn()+(e<6&&fe()==32&&qt()==32))}function Ws(t){for(;qt();)switch(kt){case t:return Bt;case 34:case 39:t!==34&&t!==39&&Ws(kt);break;case 40:t===41&&Ws(t);break;case 92:qt();break}return Bt}function Pf(t,e){for(;qt()&&t+kt!==57;)if(t+kt===84&&fe()===47)break;return"/*"+ts(e,Bt-1)+"*"+di(t===47?t:qt())}function Yf(t){for(;!Us(fe());)qt();return ts(t,Bt)}function Af(t){return Vf(bn("",null,null,null,[""],t=qf(t),0,[0],t))}function bn(t,e,n,s,i,a,r,u,c){for(var d=0,h=0,l=r,p=0,f=0,w=0,b=1,g=1,m=1,S=0,T="",j=i,E=a,M=s,N=T;g;)switch(w=S,S=qt()){case 40:if(w!=108&&Tt(N,l-1)==58){wn(N+=I(ys(S),"&","&\f"),"&\f",Va(d?u[d-1]:0))!=-1&&(m=-1);break}case 34:case 39:case 91:N+=ys(S);break;case 9:case 10:case 13:case 32:N+=Uf(w);break;case 92:N+=Wf(kn()-1,7);continue;case 47:switch(fe()){case 42:case 47:Ve(Gf(Pf(qt(),kn()),e,n,c),c);break;default:N+="/"}break;case 123*b:u[d++]=Yt(N)*m;case 125*b:case 59:case 0:switch(S){case 0:case 125:g=0;case 59+h:m==-1&&(N=I(N,/\f/g,"")),f>0&&Yt(N)-l&&Ve(f>32?hr(N+";",s,n,l-1,c):hr(I(N," ","")+";",s,n,l-2,c),c);break;case 59:N+=";";default:if(Ve(M=dr(N,e,n,d,h,i,u,T,j=[],E=[],l,a),a),S===123)if(h===0)bn(N,e,M,M,j,a,l,u,E);else switch(p===99&&Tt(N,3)===110?100:p){case 100:case 108:case 109:case 115:bn(t,M,M,s&&Ve(dr(t,M,M,0,0,i,u,T,i,j=[],l,E),E),i,E,l,u,s?j:E);break;default:bn(N,M,M,M,[""],E,0,u,E)}}d=h=f=0,b=m=1,T=N="",l=r;break;case 58:l=1+Yt(N),f=w;default:if(b<1){if(S==123)--b;else if(S==125&&b++==0&&Hf()==125)continue}switch(N+=di(S),S*b){case 38:m=h>0?1:(N+="\f",-1);break;case 44:u[d++]=(Yt(N)-1)*m,m=1;break;case 64:fe()===45&&(N+=ys(qt())),p=fe(),h=l=Yt(T=N+=Yf(kn())),S++;break;case 45:w===45&&Yt(N)==2&&(b=0)}}return a}function dr(t,e,n,s,i,a,r,u,c,d,h,l){for(var p=i-1,f=i===0?a:[""],w=Wa(f),b=0,g=0,m=0;b<s;++b)for(var S=0,T=Ee(t,p+1,p=Va(g=r[b])),j=t;S<w;++S)(j=Ua(g>0?f[S]+" "+T:I(T,/&\f/g,f[S])))&&(c[m++]=j);return In(t,e,n,i===0?Jn:u,c,d,h,l)}function Gf(t,e,n,s){return In(t,e,n,Ha,di(Bf()),Ee(t,2,-2),0,s)}function hr(t,e,n,s,i){return In(t,e,n,ui,Ee(t,0,s),Ee(t,s+1,-1),s,i)}function Ya(t,e,n){switch(Of(t,e)){case 5103:return at+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return at+t+t;case 4789:return We+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return at+t+We+t+mt+t+t;case 5936:switch(Tt(t,e+11)){case 114:return at+t+mt+I(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return at+t+mt+I(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return at+t+mt+I(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return at+t+mt+t+t;case 6165:return at+t+mt+"flex-"+t+t;case 5187:return at+t+I(t,/(\w+).+(:[^]+)/,at+"box-$1$2"+mt+"flex-$1$2")+t;case 5443:return at+t+mt+"flex-item-"+I(t,/flex-|-self/g,"")+(Qt(t,/flex-|baseline/)?"":mt+"grid-row-"+I(t,/flex-|-self/g,""))+t;case 4675:return at+t+mt+"flex-line-pack"+I(t,/align-content|flex-|-self/g,"")+t;case 5548:return at+t+mt+I(t,"shrink","negative")+t;case 5292:return at+t+mt+I(t,"basis","preferred-size")+t;case 6060:return at+"box-"+I(t,"-grow","")+at+t+mt+I(t,"grow","positive")+t;case 4554:return at+I(t,/([^-])(transform)/g,"$1"+at+"$2")+t;case 6187:return I(I(I(t,/(zoom-|grab)/,at+"$1"),/(image-set)/,at+"$1"),t,"")+t;case 5495:case 3959:return I(t,/(image-set\([^]*)/,at+"$1$`$1");case 4968:return I(I(t,/(.+:)(flex-)?(.*)/,at+"box-pack:$3"+mt+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+at+t+t;case 4200:if(!Qt(t,/flex-|baseline/))return mt+"grid-column-align"+Ee(t,e)+t;break;case 2592:case 3360:return mt+I(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(s,i){return e=i,Qt(s.props,/grid-\w+-end/)})?~wn(t+(n=n[e].value),"span",0)?t:mt+I(t,"-start","")+t+mt+"grid-row-span:"+(~wn(n,"span",0)?Qt(n,/\d+/):+Qt(n,/\d+/)-+Qt(t,/\d+/))+";":mt+I(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(s){return Qt(s.props,/grid-\w+-start/)})?t:mt+I(I(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return I(t,/(.+)-inline(.+)/,at+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yt(t)-1-e>6)switch(Tt(t,e+1)){case 109:if(Tt(t,e+4)!==45)break;case 102:return I(t,/(.+:)(.+)-([^]+)/,"$1"+at+"$2-$3$1"+We+(Tt(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~wn(t,"stretch",0)?Ya(I(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return I(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,i,a,r,u,c,d){return mt+i+":"+a+d+(r?mt+i+"-span:"+(u?c:+c-+a)+d:"")+t});case 4949:if(Tt(t,e+6)===121)return I(t,":",":"+at)+t;break;case 6444:switch(Tt(t,Tt(t,14)===45?18:11)){case 120:return I(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+at+(Tt(t,14)===45?"inline-":"")+"box$3$1"+at+"$2$3$1"+mt+"$2box$3")+t;case 100:return I(t,":",":"+mt)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return I(t,"scroll-","scroll-snap-")+t}return t}function On(t,e){for(var n="",s=0;s<t.length;s++)n+=e(t[s],s,t,e)||"";return n}function Xf(t,e,n,s){switch(t.type){case $f:if(t.children.length)break;case Df:case ui:return t.return=t.return||t.value;case Ha:return"";case qa:return t.return=t.value+"{"+On(t.children,s)+"}";case Jn:if(!Yt(t.value=t.props.join(",")))return""}return Yt(n=On(t.children,s))?t.return=t.value+"{"+n+"}":""}function Kf(t){var e=Wa(t);return function(n,s,i,a){for(var r="",u=0;u<e;u++)r+=t[u](n,s,i,a)||"";return r}}function Zf(t){return function(e){e.root||(e=e.return)&&t(e)}}function Jf(t,e,n,s){if(t.length>-1&&!t.return)switch(t.type){case ui:t.return=Ya(t.value,t.length,n);return;case qa:return On([se(t,{value:I(t.value,"@","@"+at)})],s);case Jn:if(t.length)return Ff(n=t.props,function(i){switch(Qt(i,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":we(se(t,{props:[I(i,/:(read-\w+)/,":"+We+"$1")]})),we(se(t,{props:[i]})),Vs(t,{props:ur(n,s)});break;case"::placeholder":we(se(t,{props:[I(i,/:(plac\w+)/,":"+at+"input-$1")]})),we(se(t,{props:[I(i,/:(plac\w+)/,":"+We+"$1")]})),we(se(t,{props:[I(i,/:(plac\w+)/,mt+"input-$1")]})),we(se(t,{props:[i]})),Vs(t,{props:ur(n,s)});break}return""})}}var $t={},Ne=typeof Ss<"u"&&$t!==void 0&&($t.REACT_APP_SC_ATTR||$t.SC_ATTR)||"data-styled",Aa="active",Ga="data-styled-version",es="6.1.11",hi=`/*!sc*/
`,fi=typeof window<"u"&&"HTMLElement"in window,Qf=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof Ss<"u"&&$t!==void 0&&$t.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&$t.REACT_APP_SC_DISABLE_SPEEDY!==""?$t.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&$t.REACT_APP_SC_DISABLE_SPEEDY:typeof Ss<"u"&&$t!==void 0&&$t.SC_DISABLE_SPEEDY!==void 0&&$t.SC_DISABLE_SPEEDY!==""&&$t.SC_DISABLE_SPEEDY!=="false"&&$t.SC_DISABLE_SPEEDY),ns=Object.freeze([]),ze=Object.freeze({});function If(t,e,n){return n===void 0&&(n=ze),t.theme!==n.theme&&t.theme||e||n.theme}var Xa=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),t0=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,e0=/(^-|-$)/g;function fr(t){return t.replace(t0,"-").replace(e0,"")}var n0=/(a)(d)/gi,hn=52,pr=function(t){return String.fromCharCode(t+(t>25?39:97))};function Ps(t){var e,n="";for(e=Math.abs(t);e>hn;e=e/hn|0)n=pr(e%hn)+n;return(pr(e%hn)+n).replace(n0,"$1-$2")}var _s,Ka=5381,be=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},Za=function(t){return be(Ka,t)};function s0(t){return Ps(Za(t)>>>0)}function i0(t){return t.displayName||t.name||"Component"}function vs(t){return typeof t=="string"&&!0}var Ja=typeof Symbol=="function"&&Symbol.for,Qa=Ja?Symbol.for("react.memo"):60115,r0=Ja?Symbol.for("react.forward_ref"):60112,a0={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o0={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Ia={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},c0=((_s={})[r0]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},_s[Qa]=Ia,_s);function gr(t){return("type"in(e=t)&&e.type.$$typeof)===Qa?Ia:"$$typeof"in t?c0[t.$$typeof]:a0;var e}var l0=Object.defineProperty,u0=Object.getOwnPropertyNames,xr=Object.getOwnPropertySymbols,d0=Object.getOwnPropertyDescriptor,h0=Object.getPrototypeOf,mr=Object.prototype;function to(t,e,n){if(typeof e!="string"){if(mr){var s=h0(e);s&&s!==mr&&to(t,s,n)}var i=u0(e);xr&&(i=i.concat(xr(e)));for(var a=gr(t),r=gr(e),u=0;u<i.length;++u){var c=i[u];if(!(c in o0||n&&n[c]||r&&c in r||a&&c in a)){var d=d0(e,c);try{l0(t,c,d)}catch{}}}}return t}function Le(t){return typeof t=="function"}function pi(t){return typeof t=="object"&&"styledComponentId"in t}function de(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function yr(t,e){if(t.length===0)return"";for(var n=t[0],s=1;s<t.length;s++)n+=t[s];return n}function Je(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function Ys(t,e,n){if(n===void 0&&(n=!1),!n&&!Je(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var s=0;s<e.length;s++)t[s]=Ys(t[s],e[s]);else if(Je(e))for(var s in e)t[s]=Ys(t[s],e[s]);return t}function gi(t,e){Object.defineProperty(t,"toString",{value:e})}function en(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var f0=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,s=0;s<e;s++)n+=this.groupSizes[s];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var s=this.groupSizes,i=s.length,a=i;e>=a;)if((a<<=1)<0)throw en(16,"".concat(e));this.groupSizes=new Uint32Array(a),this.groupSizes.set(s),this.length=a;for(var r=i;r<a;r++)this.groupSizes[r]=0}for(var u=this.indexOfGroup(e+1),c=(r=0,n.length);r<c;r++)this.tag.insertRule(u,n[r])&&(this.groupSizes[e]++,u++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],s=this.indexOfGroup(e),i=s+n;this.groupSizes[e]=0;for(var a=s;a<i;a++)this.tag.deleteRule(s)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var s=this.groupSizes[e],i=this.indexOfGroup(e),a=i+s,r=i;r<a;r++)n+="".concat(this.tag.getRule(r)).concat(hi);return n},t}(),Tn=new Map,Fn=new Map,Sn=1,fn=function(t){if(Tn.has(t))return Tn.get(t);for(;Fn.has(Sn);)Sn++;var e=Sn++;return Tn.set(t,e),Fn.set(e,t),e},p0=function(t,e){Sn=e+1,Tn.set(t,e),Fn.set(e,t)},g0="style[".concat(Ne,"][").concat(Ga,'="').concat(es,'"]'),x0=new RegExp("^".concat(Ne,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),m0=function(t,e,n){for(var s,i=n.split(","),a=0,r=i.length;a<r;a++)(s=i[a])&&t.registerName(e,s)},y0=function(t,e){for(var n,s=((n=e.textContent)!==null&&n!==void 0?n:"").split(hi),i=[],a=0,r=s.length;a<r;a++){var u=s[a].trim();if(u){var c=u.match(x0);if(c){var d=0|parseInt(c[1],10),h=c[2];d!==0&&(p0(h,d),m0(t,h,c[3]),t.getTag().insertRules(d,i)),i.length=0}else i.push(u)}}};function _0(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var eo=function(t){var e=document.head,n=t||e,s=document.createElement("style"),i=function(u){var c=Array.from(u.querySelectorAll("style[".concat(Ne,"]")));return c[c.length-1]}(n),a=i!==void 0?i.nextSibling:null;s.setAttribute(Ne,Aa),s.setAttribute(Ga,es);var r=_0();return r&&s.setAttribute("nonce",r),n.insertBefore(s,a),s},v0=function(){function t(e){this.element=eo(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var s=document.styleSheets,i=0,a=s.length;i<a;i++){var r=s[i];if(r.ownerNode===n)return r}throw en(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),w0=function(){function t(e){this.element=eo(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var s=document.createTextNode(n);return this.element.insertBefore(s,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),k0=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),_r=fi,b0={isServer:!fi,useCSSOMInjection:!Qf},no=function(){function t(e,n,s){e===void 0&&(e=ze),n===void 0&&(n={});var i=this;this.options=zt(zt({},b0),e),this.gs=n,this.names=new Map(s),this.server=!!e.isServer,!this.server&&fi&&_r&&(_r=!1,function(a){for(var r=document.querySelectorAll(g0),u=0,c=r.length;u<c;u++){var d=r[u];d&&d.getAttribute(Ne)!==Aa&&(y0(a,d),d.parentNode&&d.parentNode.removeChild(d))}}(this)),gi(this,function(){return function(a){for(var r=a.getTag(),u=r.length,c="",d=function(l){var p=function(m){return Fn.get(m)}(l);if(p===void 0)return"continue";var f=a.names.get(p),w=r.getGroup(l);if(f===void 0||w.length===0)return"continue";var b="".concat(Ne,".g").concat(l,'[id="').concat(p,'"]'),g="";f!==void 0&&f.forEach(function(m){m.length>0&&(g+="".concat(m,","))}),c+="".concat(w).concat(b,'{content:"').concat(g,'"}').concat(hi)},h=0;h<u;h++)d(h);return c}(i)})}return t.registerId=function(e){return fn(e)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(zt(zt({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var s=n.useCSSOMInjection,i=n.target;return n.isServer?new k0(i):s?new v0(i):new w0(i)}(this.options),new f0(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(fn(e),this.names.has(e))this.names.get(e).add(n);else{var s=new Set;s.add(n),this.names.set(e,s)}},t.prototype.insertRules=function(e,n,s){this.registerName(e,n),this.getTag().insertRules(fn(e),s)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(fn(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),T0=/&/g,S0=/^\s*\/\/.*$/gm;function so(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(s){return"".concat(e," ").concat(s)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=so(n.children,e)),n})}function j0(t){var e,n,s,i=ze,a=i.options,r=a===void 0?ze:a,u=i.plugins,c=u===void 0?ns:u,d=function(p,f,w){return w.startsWith(n)&&w.endsWith(n)&&w.replaceAll(n,"").length>0?".".concat(e):p},h=c.slice();h.push(function(p){p.type===Jn&&p.value.includes("&")&&(p.props[0]=p.props[0].replace(T0,n).replace(s,d))}),r.prefix&&h.push(Jf),h.push(Xf);var l=function(p,f,w,b){f===void 0&&(f=""),w===void 0&&(w=""),b===void 0&&(b="&"),e=b,n=f,s=new RegExp("\\".concat(n,"\\b"),"g");var g=p.replace(S0,""),m=Af(w||f?"".concat(w," ").concat(f," { ").concat(g," }"):g);r.namespace&&(m=so(m,r.namespace));var S=[];return On(m,Kf(h.concat(Zf(function(T){return S.push(T)})))),S};return l.hash=c.length?c.reduce(function(p,f){return f.name||en(15),be(p,f.name)},Ka).toString():"",l}var C0=new no,As=j0(),io=oe.createContext({shouldForwardProp:void 0,styleSheet:C0,stylis:As});io.Consumer;oe.createContext(void 0);function vr(){return _.useContext(io)}var R0=function(){function t(e,n){var s=this;this.inject=function(i,a){a===void 0&&(a=As);var r=s.name+a.hash;i.hasNameForId(s.id,r)||i.insertRules(s.id,r,a(s.rules,r,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,gi(this,function(){throw en(12,String(s.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=As),this.name+e.hash},t}(),E0=function(t){return t>="A"&&t<="Z"};function wr(t){for(var e="",n=0;n<t.length;n++){var s=t[n];if(n===1&&s==="-"&&t[0]==="-")return t;E0(s)?e+="-"+s.toLowerCase():e+=s}return e.startsWith("ms-")?"-"+e:e}var ro=function(t){return t==null||t===!1||t===""},ao=function(t){var e,n,s=[];for(var i in t){var a=t[i];t.hasOwnProperty(i)&&!ro(a)&&(Array.isArray(a)&&a.isCss||Le(a)?s.push("".concat(wr(i),":"),a,";"):Je(a)?s.push.apply(s,$n($n(["".concat(i," {")],ao(a),!1),["}"],!1)):s.push("".concat(wr(i),": ").concat((e=i,(n=a)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in Yo||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return s};function pe(t,e,n,s){if(ro(t))return[];if(pi(t))return[".".concat(t.styledComponentId)];if(Le(t)){if(!Le(a=t)||a.prototype&&a.prototype.isReactComponent||!e)return[t];var i=t(e);return pe(i,e,n,s)}var a;return t instanceof R0?n?(t.inject(n,s),[t.getName(s)]):[t]:Je(t)?ao(t):Array.isArray(t)?Array.prototype.concat.apply(ns,t.map(function(r){return pe(r,e,n,s)})):[t.toString()]}function M0(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Le(n)&&!pi(n))return!1}return!0}var N0=Za(es),z0=function(){function t(e,n,s){this.rules=e,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&M0(e),this.componentId=n,this.baseHash=be(N0,n),this.baseStyle=s,no.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,s){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=de(i,this.staticRulesId);else{var a=yr(pe(this.rules,e,n,s)),r=Ps(be(this.baseHash,a)>>>0);if(!n.hasNameForId(this.componentId,r)){var u=s(a,".".concat(r),void 0,this.componentId);n.insertRules(this.componentId,r,u)}i=de(i,r),this.staticRulesId=r}else{for(var c=be(this.baseHash,s.hash),d="",h=0;h<this.rules.length;h++){var l=this.rules[h];if(typeof l=="string")d+=l;else if(l){var p=yr(pe(l,e,n,s));c=be(c,p+h),d+=p}}if(d){var f=Ps(c>>>0);n.hasNameForId(this.componentId,f)||n.insertRules(this.componentId,f,s(d,".".concat(f),void 0,this.componentId)),i=de(i,f)}}return i},t}(),oo=oe.createContext(void 0);oo.Consumer;var ws={};function L0(t,e,n){var s=pi(t),i=t,a=!vs(t),r=e.attrs,u=r===void 0?ns:r,c=e.componentId,d=c===void 0?function(j,E){var M=typeof j!="string"?"sc":fr(j);ws[M]=(ws[M]||0)+1;var N="".concat(M,"-").concat(s0(es+M+ws[M]));return E?"".concat(E,"-").concat(N):N}(e.displayName,e.parentComponentId):c,h=e.displayName,l=h===void 0?function(j){return vs(j)?"styled.".concat(j):"Styled(".concat(i0(j),")")}(t):h,p=e.displayName&&e.componentId?"".concat(fr(e.displayName),"-").concat(e.componentId):e.componentId||d,f=s&&i.attrs?i.attrs.concat(u).filter(Boolean):u,w=e.shouldForwardProp;if(s&&i.shouldForwardProp){var b=i.shouldForwardProp;if(e.shouldForwardProp){var g=e.shouldForwardProp;w=function(j,E){return b(j,E)&&g(j,E)}}else w=b}var m=new z0(n,p,s?i.componentStyle:void 0);function S(j,E){return function(M,N,C){var $=M.attrs,H=M.componentStyle,P=M.defaultProps,W=M.foldedComponentIds,L=M.styledComponentId,x=M.target,v=oe.useContext(oo),y=vr(),k=M.shouldForwardProp||y.shouldForwardProp,R=If(N,v,P)||ze,z=function(Y,K,A){for(var st,rt=zt(zt({},K),{className:void 0,theme:A}),pt=0;pt<Y.length;pt+=1){var xt=Le(st=Y[pt])?st(rt):st;for(var G in xt)rt[G]=G==="className"?de(rt[G],xt[G]):G==="style"?zt(zt({},rt[G]),xt[G]):xt[G]}return K.className&&(rt.className=de(rt.className,K.className)),rt}($,N,R),D=z.as||x,O={};for(var F in z)z[F]===void 0||F[0]==="$"||F==="as"||F==="theme"&&z.theme===R||(F==="forwardedAs"?O.as=z.forwardedAs:k&&!k(F,D)||(O[F]=z[F]));var ft=function(Y,K){var A=vr(),st=Y.generateAndInjectStyles(K,A.styleSheet,A.stylis);return st}(H,z),et=de(W,L);return ft&&(et+=" "+ft),z.className&&(et+=" "+z.className),O[vs(D)&&!Xa.has(D)?"class":"className"]=et,O.ref=C,_.createElement(D,O)}(T,j,E)}S.displayName=l;var T=oe.forwardRef(S);return T.attrs=f,T.componentStyle=m,T.displayName=l,T.shouldForwardProp=w,T.foldedComponentIds=s?de(i.foldedComponentIds,i.styledComponentId):"",T.styledComponentId=p,T.target=s?i.target:t,Object.defineProperty(T,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(j){this._foldedDefaultProps=s?function(E){for(var M=[],N=1;N<arguments.length;N++)M[N-1]=arguments[N];for(var C=0,$=M;C<$.length;C++)Ys(E,$[C],!0);return E}({},i.defaultProps,j):j}}),gi(T,function(){return".".concat(T.styledComponentId)}),a&&to(T,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),T}function kr(t,e){for(var n=[t[0]],s=0,i=e.length;s<i;s+=1)n.push(e[s],t[s+1]);return n}var br=function(t){return Object.assign(t,{isCss:!0})};function D0(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Le(t)||Je(t))return br(pe(kr(ns,$n([t],e,!0))));var s=t;return e.length===0&&s.length===1&&typeof s[0]=="string"?pe(s):br(pe(kr(s,e)))}function Gs(t,e,n){if(n===void 0&&(n=ze),!e)throw en(1,e);var s=function(i){for(var a=[],r=1;r<arguments.length;r++)a[r-1]=arguments[r];return t(e,n,D0.apply(void 0,$n([i],a,!1)))};return s.attrs=function(i){return Gs(t,e,zt(zt({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},s.withConfig=function(i){return Gs(t,e,zt(zt({},n),i))},s}var co=function(t){return Gs(L0,t)},Ft=co;Xa.forEach(function(t){Ft[t]=co(t)});const $0=Ft.path`
  opacity: ${({opacity:t})=>t||1}};
  stroke: ${({fill:t,theme:e})=>t??e.colors.failure};
  fill: ${({fill:t,theme:e})=>t??e.colors.failure};
`,Tr=({series:t,xScale:e,yScale:n,xValue:s,yValue:i,fill:a,opacity:r})=>{const u=_.useMemo(()=>{const c=e.domain(),d=t==null?void 0:t.sort((b,g)=>g.price-b.price),h=[];let l=!1;for(let b=0;b<d.length;b++){const g=d[b];h.push(g),(g==null?void 0:g.price)<(c==null?void 0:c[0])&&!l&&(h.push({price:(c==null?void 0:c[0])+Math.pow(10,-9),depth:g.depth}),l=!0)}const p=h==null?void 0:h.sort((b,g)=>b.price-g.price),f=[];let w=!1;for(let b=0;b<p.length;b++){const g=p[b];f.push(g),(g==null?void 0:g.price)>(c==null?void 0:c[1])&&!w&&(f.push({price:(c==null?void 0:c[1])-Math.pow(10,-9),depth:g.depth}),w=!0)}return Wr().curve(fc).x(b=>e(s(b))).y1(b=>n(i(b))).y0(n(0))(f.filter(b=>{const g=e(s(b));return g>0&&g<=window.innerWidth}))??void 0},[a,r,t,e,s,n,i]);return _.useMemo(()=>o.jsx($0,{opacity:r,fill:a,d:u}),[u])},O0=Ft.g`
  line {
    display: none;
  }
  text {
    transform: translateY(5px);
    font-family: 'NotoSansMono';
  }
`,F0=({axisGenerator:t,isPosition:e})=>{const{colorMode:n}=Br(),s=i=>{i&&yt(i).call(t).call(a=>a.selectAll(".domain").remove())};return o.jsx("g",{ref:s,style:{color:n=="light"?"#000":"#fff",opacity:(n=="light","0.5")}})},B0=({xScale:t,innerHeight:e,offset:n=0,isPosition:s=!1})=>_.useMemo(()=>o.jsx(O0,{transform:`translate(0, ${e+n})`,children:o.jsx(F0,{axisGenerator:ga(t).ticks(6),isPosition:s})}),[e,n,t]),H0=t=>{const e=_.useRef();return _.useEffect(()=>{e.current=t},[t]),e.current},Sr=t=>["M 0 0",`v ${t}`,"m 1 0","V 0","M 0 1","h 10","q 2 0, 2 2","v 22","q 0 2 -2 2","h -10","z"].join(" "),jr=()=>["m 4 8","v 12","M 0 0","m 8 8","v 12","z"].join(" "),Cr=({color:t,size:e=10,margin:n=10})=>o.jsx("polygon",{points:`0 0, ${e} ${e}, 0 ${e}`,transform:` translate(${e+n}, ${n}) rotate(45) `,fill:t,stroke:t,strokeWidth:"4",strokeLinejoin:"round"}),ee={colors:{background:"var(--chakra-colors-card_bg)",secondary:"#30D4B7",leftHandle:"#30D4B7 ",rightHandle:"#6297EA"}},Rr=Ft.path`
  cursor: ew-resize;
  pointer-events: none;

  stroke-width: 3;
  stroke: ${({color:t})=>t};
  fill: ${({color:t})=>t};
`,Er=Ft.path`
  cursor: ew-resize;
  pointer-events: none;

  stroke-width: 1.5;
  /* stroke: ${ee.colors.background}; */
  // stroke: #22211f;
  stroke: #fff;
  opacity: ${ee.colors.background};
`;Ft.g`
  opacity: ${({visible:t})=>t?"1":"0"};
  transition: opacity 300ms;
`;Ft.rect`
  fill: ${ee.colors.secondary};
`;Ft.rect`
  fill: ${ee.colors.secondary};
`;Ft.rect`
  fill: ${ee.colors.secondary};
`;Ft.text`
  text-anchor: middle;
  font-size: 13px;
  /*  fill: ${ee.colors.background}; */
  fill: #22211f;
`;const Mr=20,Nr=2,zr=(t,e,n)=>{const s=t.map(a=>n(a).toFixed(1)),i=e.map(a=>n(a).toFixed(1));return s.every((a,r)=>a===i[r])},q0=({id:t,xScale:e,interactive:n,brushLabelValue:s,brushExtent:i,setBrushExtent:a,innerWidth:r,innerHeight:u,westHandleColor:c,eastHandleColor:d,hideBrush:h,isSorted:l})=>{const p=_.useRef(null),f=_.useRef(null),[w,b]=_.useState(i),[g,m]=_.useState(!1),[S,T]=_.useState(!1),j=H0(i),E=_.useCallback(W=>{const{type:L,selection:x,mode:v}=W;if(!x){b(null);return}const y=x.map(e.invert);L==="end"&&!zr(i,y,e)&&a(y,v),b(y)},[e,i,a]);_.useEffect(()=>{b(i)},[i]),_.useEffect(()=>{p.current&&(f.current=df().extent([[Math.max(0+Nr,e(0)),0],[r-Nr,u]]).handleSize(30).filter(()=>n).on("brush end",E),f.current(yt(p.current)),j&&zr(i,j,e)&&yt(p.current).transition().call(f.current.move,i.map(e)),yt(p.current).selectAll(".selection").attr("stroke","none").attr("fill","var(--chakra-colors-chart_brush_selection)"))},[i,E,t,u,r,n,j,e]),_.useEffect(()=>{!p.current||!f.current||f.current.move(yt(p.current),i.map(e))},[i,e]),_.useEffect(()=>{m(!0);const W=setTimeout(()=>m(!1),1500);return()=>clearTimeout(W)},[w]);const M=w&&e(w[0])>Mr,N=w&&e(w[1])>r-Mr,C=w&&(e(w[0])<0||e(w[1])<0),$=w&&(e(w[0])>r||e(w[1])>r),H=w&&e(w[0])>=0&&e(w[0])<=r,P=w&&e(w[1])>=0&&e(w[1])<=r;return _.useEffect(()=>{console.log("ðŸš€ ~ file: Brush.tsx:195 ~ brushExtent:",i)},[i]),_.useMemo(()=>o.jsxs(o.Fragment,{children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:`${t}-gradient-selection`,x1:"0%",y1:"100%",x2:"100%",y2:"100%",children:[o.jsx("stop",{stopColor:c}),o.jsx("stop",{stopColor:d,offset:"1"})]}),o.jsx("clipPath",{id:`${t}-brush-clip`,children:o.jsx("rect",{x:"0",y:"0",width:r,height:u})})]}),o.jsx("g",{ref:p,clipPath:`url(#${t}-brush-clip)`,onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1)}),w&&o.jsxs(o.Fragment,{children:[!h&&H?o.jsx("g",{transform:`translate(${Math.max(0,e(w[0]))}, 0), scale(${M?"-1":"1"}, 1)`,children:o.jsxs("g",{children:[o.jsx(Rr,{color:ee.colors.leftHandle,d:Sr(u)}),o.jsx(Er,{d:jr()})]})}):null,!h&&P?o.jsx("g",{transform:`translate(${e(w[1])}, 0), scale(${N?"-1":"1"}, 1)`,children:o.jsxs("g",{children:[o.jsx(Rr,{color:ee.colors.rightHandle,d:Sr(u)}),o.jsx(Er,{d:jr()})]})}):null,C&&o.jsx(Cr,{color:c}),$&&o.jsx("g",{transform:`translate(${r}, 0) scale(-1, 1)`,children:o.jsx(Cr,{color:d})})]})]}),[s,d,P,N,M,S,t,ee,u,r,w,$,g,C,c,H,e])},V0=Ft.line`
  opacity: 0.7;
  stroke-width: 2;
  stroke: var(--chakra-colors-text_caption);
  fill: none;
`,U0=({value:t,xScale:e,innerHeight:n})=>_.useMemo(()=>o.jsx(V0,{x1:e(t),y1:"0",x2:e(t),y2:n}),[t,e,n]);Ft.div`
  display: grid;
  grid-template-columns: repeat(${({count:t})=>t.toString()}, 1fr);
  grid-gap: 6px;

  position: absolute;
  top: -18px;
  right: 0;
`;const W0=Ft.rect`
  fill: transparent;
  cursor: grab;

  &:active {
    cursor: grabbing;
  }
`;function P0({svg:t,xScale:e,setZoom:n,width:s,height:i,resetBrush:a,showResetButton:r,zoomLevels:u,isPosition:c,handleClickRefresh:d}){const h=_.useRef(),[l,p,f,w]=_.useMemo(()=>[()=>t&&h.current&&yt(t).transition().call(h.current.scaleBy,1.5),()=>t&&h.current&&yt(t).transition().call(h.current.scaleBy,.5),()=>t&&h.current&&yt(t).transition().call(h.current.scaleTo,1),()=>t&&h.current&&yt(t).call(h.current.transform,Zn.translate(0,0).scale(1)).transition().call(h.current.scaleTo,.5)],[t]),g=Cs(()=>{console.log("è¿™é‡Œæµ‹è¯•æ‰“å°")},500),m=Cs(n,300),{isApp:S}=me();return _.useEffect(()=>{t&&(h.current=Ba().scaleExtent([0,1/0]).extent([[0,0],[s,i]]).on("zoom",({transform:T})=>{console.log("è¿™é‡Œè¿›æ¥äº†å¤šæ¬¡å— on zoom"),g(),m(T)}),yt(t).call(h.current))},[i,s,n,t,h,u.max,u.min]),_.useEffect(()=>{f()},[f,u]),o.jsx(ut,{w:"100%",p:"0px",align:"center",sx:{"@media screen and (max-width: 960px)":{flexDirection:"column",w:"100%",alignItems:c?"flex-start":"flex-end"}},children:o.jsxs(Q,{w:"100%",justify:S?"flex-start":"flex-end",flex:"1",position:"absolute",right:"0px",top:S?"-55px":"-80px",children:[o.jsx(Pn,{handleClickRefresh:d,noBg:!0,isAutoRefresh:!0}),o.jsx(Lt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomin",onClick:l}),o.jsx(Lt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomout",onClick:p})]})})}const pn=t=>t.price,ks=t=>t.depth;function Y0(t,e){return t==null?void 0:t.filter(n=>q(n.price).gte(e[0])&&q(n.price).lte(e[1]))}function A0({id:t="liquidityChartRangeInput",data:{series:e,current:n},ticksAtLimit:s,styles:i,dimensions:{width:a,height:r},margins:u,interactive:c=!0,brushDomain:d,brushLabels:h,onBrushDomainChange:l,handleClickRefresh:p,zoomLevels:f,showZoomButtons:w=!0,isPosition:b=!1,hideBrush:g=!1,isReverse:m=!1,isSorted:S=!0}){const T=_.useRef(null),[j,E]=_.useState(null),[M,N]=_.useMemo(()=>[r-u.top-u.bottom,a-u.left-u.right],[a,r,u]),{xScale:C,yScale:$}=_.useMemo(()=>{const W=[n*f.initialMin,n*f.initialMax];let L=W;console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ xInitialRange:",W),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ brushDomain:",d),d&&String(d==null?void 0:d[0])!=="âˆž"&&String(d==null?void 0:d[1])!=="âˆž"&&(L=[Math.min(W[0],q(d[0]).mul(.9).toNumber()),Math.max(W[1],q(d[1]).mul(1.1).toNumber())]);const x=Y0(e,L),v={xScale:js().domain(L).range([0,N]),yScale:js().domain([0,Pr(x,ks)]).range([M,0])};if(j){const y=j.rescaleX(v.xScale);v.xScale.domain(y.domain())}return v},[n,f.initialMin,f.initialMax,N,e,M,j,d]);_.useEffect(()=>{console.log("Chart.tsx xScale useEffect: ",C)},[C]),_.useEffect(()=>{console.log("Chart.tsx zoom useEffect: ",j)},[j]),_.useEffect(()=>{E(null)},[f]),_.useEffect(()=>{d||l(C.domain(),void 0)},[d,l,C]);const[H,P]=_.useMemo(()=>{var v,y;const W=((v=e[0])==null?void 0:v.price)>((y=e[e.length-1])==null?void 0:y.price);let[L,x]=Lf(e,k=>W?+pn(k)<n:+pn(k)>n);return x.length&&x[x.length-1]&&(x[x.length-1].price!==n&&(x=[...x,{depth:x[x.length-1].depth,price:n}]),L=[{depth:x[x.length-1].depth,price:n},...L]),[L,x]},[n,e]);return o.jsxs(J,{w:"100%",h:"100%",sx:{"@media screen and (max-width: 1000px)":{display:"block"}},children:[w&&o.jsx(P0,{svg:T.current,xScale:C,setZoom:E,width:N,height:r,resetBrush:()=>{l([n*f.initialMin,n*f.initialMax],"reset")},showResetButton:!!(s[_t.LOWER]||s[_t.UPPER]),zoomLevels:f,isPosition:b,handleClickRefresh:p}),o.jsxs("svg",{width:"100%",height:"100%",style:{overflow:"visible"},children:[o.jsxs("defs",{children:[o.jsxs("linearGradient",{id:"green-gradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1})]}),o.jsxs("linearGradient",{id:"red-gradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"5%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-range_chart_bg)",stopOpacity:1})]})]}),o.jsxs("defs",{children:[o.jsx("clipPath",{id:`${t}-chart-clip`,children:o.jsx("rect",{x:"0",y:"0",width:N,height:r})}),d&&o.jsx("mask",{id:`${t}-chart-area-mask`,children:o.jsx("rect",{fill:"red",x:C(d[0]),y:"0",width:C(d[1])-C(d[0]),height:M})})]}),o.jsxs("g",{transform:`translate(${u.left},${u.top})`,children:[o.jsxs("g",{clipPath:`url(#${t}-chart-clip)`,children:[o.jsx(Tr,{series:H,xScale:C,yScale:$,xValue:pn,yValue:ks,opacity:1,fill:"var(--chakra-colors-range_chart_bg)"}),o.jsx(Tr,{series:P,xScale:C,yScale:$,xValue:pn,yValue:ks,opacity:1,fill:"url(#green-gradient)"}),o.jsx(U0,{value:n,xScale:C,innerHeight:M}),o.jsx(B0,{xScale:C,innerHeight:M,isPosition:b})]}),o.jsx(W0,{width:N,height:r,ref:T}),o.jsx(q0,{id:t,xScale:C,interactive:c,brushLabelValue:h,brushExtent:d??C.domain(),innerWidth:N,innerHeight:M,setBrushExtent:l,westHandleColor:i.brush.handle.west,eastHandleColor:i.brush.handle.east,hideBrush:g,isSorted:S})]})]})]})}const G0=_.forwardRef(function({isSorted:e,contractPoolInfo:n,currencyA:s,currencyB:i,feeAmount:a,ticksAtLimit:r,price:u,priceLower:c,priceUpper:d,onLeftRangeInput:h,onRightRangeInput:l,onBothRangeInput:p,handleClickRefresh:f,interactive:w,zoomLevel:b,isPosition:g,hideBrush:m,isReverse:S},T){var x;const{isLoading:j,error:E,formattedData:M,handleRefresh:N}=eu({contractPoolInfo:n,currencyA:s,currencyB:i,feeAmount:a});_.useEffect(()=>{N()},[]);const C=_.useMemo(()=>{let v;return e?v=M:v=M==null?void 0:M.map(y=>{var k;return{...y,price:(k=q(1).div(y==null?void 0:y.price))==null?void 0:k.toNumber()}}),console.log("seriesData useMemo result: ",v),v},[e,M]),$=_.useCallback((v,y)=>{if(!y)return;let k=Number(v[0]);const R=Number(v[1]);k<=0&&(k=1/10**6);const z=(!r[e?_t.LOWER:_t.UPPER]||y==="handle"||y==="reset")&&k>0,D=(!r[e?_t.UPPER:_t.LOWER]||y==="reset")&&R>0&&R<1e35;if(z&&D){const O=parseFloat(k.toFixed(16)),F=parseFloat(R.toFixed(16));O>0&&F>0&&O<F&&p({leftTypedValue:q(k).toString(),rightTypedValue:q(R).toString()})}else z?h(q(k).toString()):D&&l(q(R).toString())},[e,p,h,l,r]),H=_.useMemo(()=>{const v=c==null?void 0:c.fixsUiPrice,y=d==null?void 0:d.fixsUiPrice;if(y!=="âˆž")return v&&y?[v,y]:void 0},[e,c==null?void 0:c.fixsUiPrice,d==null?void 0:d.fixsUiPrice]),P=_.useCallback((v,y)=>{if(!u)return"";if(v==="w"&&r[e?_t.LOWER:_t.UPPER])return"0";if(v==="e"&&r[e?_t.UPPER:_t.LOWER])return"âˆž";const k=(y<u?-1:1)*((Math.max(y,u)-Math.min(y,u))/u)*100;return u?`${pc(Math.abs(k)>1?".2~s":".2~f")(k)}%`:""},[e,u,r]),W=!s||!i||C===void 0&&!j,L=_.useRef(null);return _.useImperativeHandle(T,()=>({depthChartRefreshData:N})),o.jsx(J,{flex:1,gap:"14px",w:"100%",position:"relative",children:W?o.jsx(ut,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(B,{children:"Your position will appear here."})}):j||!C||!u?o.jsx(tt,{h:"100%",pt:"100px",children:o.jsx(Qe,{})}):E?o.jsx(ut,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(B,{children:"Liquidity data not available."})}):C.length===0?o.jsxs(ut,{direction:"column",h:"210px",justify:"flex-end",children:[o.jsx(Q,{position:"absolute",right:"0px",top:"-80px",children:o.jsx(Pn,{handleClickRefresh:f,noBg:!0,isAutoRefresh:!0})}),o.jsx(B,{mt:"20px",children:"There is no liquidity data."})]}):o.jsx(ut,{w:"100%",h:"100%",position:"relative",justify:"center",align:"center",ref:L,children:o.jsx(A0,{data:{series:C,current:u},dimensions:{width:((x=L==null?void 0:L.current)==null?void 0:x.clientWidth)||660,height:280},margins:{top:10,right:20,bottom:20,left:10},styles:{area:{selection:"var(--chakra-colors-text_caption)"},brush:{handle:{west:"#30D4B7",east:"#6297EA"}}},interactive:w&&!!(C!=null&&C.length),brushLabels:P,brushDomain:H,onBrushDomainChange:$,zoomLevels:b??Dn[a??lt.MEDIUM],ticksAtLimit:r,isPosition:g,hideBrush:m,isReverse:S,isSorted:e,handleClickRefresh:f},`${a??lt.MEDIUM}`)})})}),X0=_.forwardRef(function(e,n){const{handleClickRefresh:s}=e,{currentApiPoolInfo:i,currentContractPoolInfo:a,currentFeeTier:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h,minPriceData:l,maxPriceData:p,currentPrice:f,inversePrice:w,defaultPriceRangePercentage:b,saveMinPriceData:g,saveMaxPriceData:m,setIsShowMinMaxDist:S}=Rt(),T=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),j=_.useMemo(()=>r&&Number(r)&&(i!=null&&i.tickSpacing)?{[_t.LOWER]:r?Nt.getInitializableTickIndex(Un,i==null?void 0:i.tickSpacing):void 0,[_t.UPPER]:r?Nt.getInitializableTickIndex(Vn,i==null?void 0:i.tickSpacing):void 0}:{[_t.LOWER]:void 0,[_t.UPPER]:void 0},[r]),E=_.useMemo(()=>{var R;const v=c===((R=i==null?void 0:i.token0)==null?void 0:R.metadata),y=v?l:p==null?void 0:p.getInverseTickPrice(),k=v?p:l==null?void 0:l.getInverseTickPrice();return{[_t.LOWER]:r&&(y==null?void 0:y.tick)===j.LOWER,[_t.UPPER]:r&&(k==null?void 0:k.tick)===j.UPPER}},[i,j,l,p,r,c]),M=!0,N=_.useMemo(()=>{if(b){const v=q(1).minus(q(b).div(100)).toNumber(),y=q(1).add(q(b).div(100)).toNumber();return{initialMin:v,initialMax:y,min:1e-5,max:1.5}}},[b]),C=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),R=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;R&&z&&g(re.buildTickPriceData(v,T,R,z))}},$=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),R=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;R&&z&&m(re.buildTickPriceData(v,T,R,z))}},H=({leftTypedValue:v,rightTypedValue:y})=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v)),y!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),$(y))},P=v=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v))},W=v=>{v!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),$(v))},L=_.useMemo(()=>{var v;return c===((v=i==null?void 0:i.token0)==null?void 0:v.metadata)},[c,i]),x=_.useRef(null);return _.useImperativeHandle(n,()=>{var v;return{depthChartRefreshData:(v=x.current)==null?void 0:v.depthChartRefreshData}}),o.jsx(J,{w:"100%",h:"100%",children:o.jsx(G0,{ref:x,isSorted:L,contractPoolInfo:a,currencyA:i==null?void 0:i.token0,currencyB:i==null?void 0:i.token1,feeAmount:r,ticksAtLimit:E,price:Number(L?f:w),priceLower:l,priceUpper:p,interactive:M,zoomLevel:N,isReverse:i==null?void 0:i.isReverse,onBothRangeInput:H,onLeftRangeInput:P,onRightRangeInput:W,handleClickRefresh:s})})}),K0=({xScale:t,innerHeight:e,svg:n})=>{const{colorMode:s}=Br();return _.useEffect(()=>{console.log("æ²¡èµ°åˆ°è¿™é‡Œå—AxisBottom svg: ",n);const i=ga(t).ticks(4).tickSizeOuter(0);n.select(".price-historical-x-axis").attr("transform",`translate(0, ${e})`).call(i)},[n,t]),o.jsx("g",{className:"price-historical-x-axis",style:{color:s=="light"?"#000":"#fff",opacity:(s=="light","0.5")}})},Z0=({yScale:t,innerWidth:e,svg:n})=>(_.useEffect(()=>{const s=cu(t).ticks(5).tickSizeOuter(0);n.select(".price-historical-y-axis").attr("transform",`translate(${e}, 0)`).call(s)},[n,t]),o.jsx("g",{className:"price-historical-y-axis"})),J0=({series:t,xScale:e,yScale:n,svg:s,innerHeight:i})=>(_.useEffect(()=>{const a=Wr().x(r=>e(r.time)).y0(i).y1(r=>n(r.price)).curve(Xr.alpha(.5));s.select(".area").datum(t).attr("d",a).attr("fill","url(#historical-gradient)").attr("z-index",-1)},[s,n,t]),o.jsx("path",{className:"area"})),Q0=({series:t,xScale:e,yScale:n,svg:s})=>(_.useEffect(()=>{const i=gc().x(a=>e(a.time)).y(a=>n(a.price)).curve(Xr.alpha(.5));s.select(".line").datum(t).attr("d",i).attr("fill","none").attr("stroke","var(--chakra-colors-historical_line)").attr("stroke-width",2)},[s,n,t]),o.jsx("path",{className:"line"})),lo=Dr(t=>({hoverX:null,hoverY:null,hoverTime:null,hoverPrice:null,tooltipData:null,dateType:"1D",tooltipTextXPos:null,setHoverX:e=>{t(()=>({hoverX:e}))},setHoverY:e=>{t(()=>({hoverY:e}))},setHoverTime:e=>{t(()=>({hoverTime:e}))},setHoverPrice:e=>{t(()=>({hoverPrice:e}))},setTooltipData:e=>{t(()=>({tooltipData:e}))},setDateType:e=>{t(()=>({dateType:e}))},setTooltipTextXPos:e=>{t(()=>({tooltipTextXPos:e}))}})),I0=({series:t,xScale:e,yScale:n,svg:s,setHoverX:i,setHoverY:a,setTooltipData:r,setTooltipTextXPos:u})=>(_.useEffect(()=>{s.selectAll(".dot").remove(),s.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("cx",c=>e(c.time)).attr("cy",c=>n(c.price)).attr("r",3).attr("fill","rgba(255, 255, 255, 0)").attr("z-index","2").on("mouseover",(c,d)=>{const h=Pt(c),l=e(d.time),p=n(d.price);console.log("circle hover circlePosX: ",l),console.log("circle hover circlePosY: ",p),console.log("circle hover pos: ",h),u(h[0]>580?580:h[0]<100?100:h[0]),i(h[0]),a(h[1]),r(d)}).on("mouseout",()=>{console.log("circle hover mouseout: "),r(null),i(null),a(null)})},[s,n,t]),o.jsx("g",{className:"tooptip-text"})),tp=({series:t,yScale:e,svg:n,innerWidth:s,innerHeight:i,brushExtent:a,setBrushExtent:r,isSorted:u})=>{const[c,d]=_.useState([30,50]);_.useEffect(()=>{console.log("Brush useEffect brushExtent: ",a),console.log("Brush useEffect isSorted: ",u),console.log("Brush useEffect [yScale(brushExtent[0]), yScale(brushExtent[1])]: ",[e(a[0]),e(a[1])]),d([e(a[0]),e(a[1])])},[a]),_.useEffect(()=>{const p=hf().extent([[0,0],[s+50,i]]).on("end",({selection:f,mode:w})=>{if(!f){d(null);return}const[b,g]=f==null?void 0:f.map(e.invert);console.log("Selected mode: ",w),console.log("Selected y0:",b),console.log("Selected y1:",g),r([b,g],w);const m=f.map(e.invert);console.log("Selected scaled: ",m);const S=t.filter(E=>E.price>=b&&E.price<=g);console.log("Selected data:",S);const T=e(b),j=e(g);console.log("Selected posy0:",T),console.log("Selected posy1:",j),d([T,j])});n.select(".brush").call(p).call(p.move,a.map(e)),n.selectAll(".selection").attr("stroke","none").attr("fill-opacity","0.2").attr("fill","red").attr("width",500).attr("class","selection price-historical-selection")},[n,e,s,i]);const h=_.useMemo(()=>!(!c||c[0]<0),[c]),l=_.useMemo(()=>!(!c||c[1]<0),[c]);return o.jsxs(o.Fragment,{children:[h&&o.jsxs("g",{className:"custom-top-handle",transform:`translate(0, ${c[0]})`,children:[o.jsx("line",{x1:"0",y1:"0",x2:s,y2:"0",stroke:"var(--chakra-colors-chart_handle_left)",strokeWidth:1}),o.jsxs("g",{transform:`translate(${s}, -10)`,children:[o.jsx("polygon",{points:"0,10 6,20 40,20 40,0 6,0",fill:"var(--chakra-colors-chart_handle_left)"}),o.jsxs("text",{x:"22",y:"15",fill:"#0C0B1E",fontSize:"12px",textAnchor:"middle",children:["MIN ",u]})]})]}),l&&o.jsxs("g",{className:"custom-bottom-handle",transform:`translate(0, ${c[1]})`,children:[o.jsx("line",{x1:"0",y1:"0",x2:s,y2:"0",stroke:"var(--chakra-colors-chart_handle_right)",strokeWidth:1}),o.jsxs("g",{transform:`translate(${s}, -10)`,children:[o.jsx("polygon",{points:"0,10 6,20 40,20 40,0 6,0",fill:"var(--chakra-colors-chart_handle_right)"}),o.jsx("text",{x:"22",y:"15",fill:"#0C0B1E",fontSize:"12px",textAnchor:"middle",children:"MAX"})]})]}),c&&o.jsx("rect",{width:s,height:Math.abs((c[0]<0?0:c[0])-(c[1]<0?0:c[1])),transform:`translate(0, ${c[1]<0?0:c[1]})`,fill:"var(--chakra-colors-chart_brush_selection)"}),o.jsx("g",{className:"brush"})]})},ep=({svg:t,hoverX:e,hoverY:n,innerWidth:s,innerHeight:i,tooltipData:a})=>(_.useState(null),_.useRef(),o.jsx(o.Fragment,{children:o.jsxs("g",{transform:`translate(${e}, 0)`,children:[o.jsx("line",{y1:0,y2:i,stroke:"#fff",strokeDasharray:"5, 5"}),o.jsx("line",{x1:-e,x2:s-e,y1:n,y2:n,stroke:"#fff",strokeDasharray:"5, 5"}),o.jsx("circle",{r:"4",fill:"#fff",cy:n})]})})),np=({price:t,yScale:e,svg:n,innerWidth:s})=>o.jsxs("g",{className:"historical-currentprice-line",children:[o.jsx("line",{x1:0,y1:e(t),x2:s+30,y2:e(t),stroke:"#fff",strokeWidth:"1"}),o.jsx("circle",{cx:s-4+30,cy:e(t),r:"4",fill:"#A6DEEB"})]});function sp({svg:t,yScale:e,setZoom:n,width:s,height:i,zoomLevels:a,handleClickRefresh:r,dateType:u,setDateType:c,isApp:d}){const h=_.useRef(),[l,p,f,w]=_.useMemo(()=>[()=>t&&h.current&&t.transition().call(h.current.scaleBy,2),()=>t&&h.current&&t.transition().call(h.current.scaleBy,.5),()=>t&&h.current&&t.transition().call(h.current.scaleTo,.5),()=>t&&h.current&&t.call(h.current.transform,Zn.translate(0,0).scale(1)).transition().call(h.current.scaleTo,.5)],[t]);return _.useEffect(()=>{t&&(h.current=Ba().scaleExtent([a.min,a.max]).extent([[0,0],[s,i]]).on("zoom",({transform:b})=>n(b)).filter(()=>!(void 0).button&&!(void 0).touches),t.call(h.current))},[i,s,n,t,e,h,a,a.max,a.min]),_.useEffect(()=>{f()},[f,a]),o.jsx(ut,{children:o.jsxs(Q,{w:"100%",flex:"1",justify:d?"flex-start":"flex-end",position:"absolute",right:"0px",top:d?"-55px":"-80px",children:[o.jsx(Ie,{options:["1H","1D","7D","30D"],size:"s",value:u,onChange:c}),o.jsx(Pn,{handleClickRefresh:r,noBg:!0,isAutoRefresh:!0}),o.jsx(Lt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomin",onClick:l}),o.jsx(Lt,{svgW:"24px",svgH:"24px",boxW:"24px",boxH:"24px",xlinkHref:"#icon-icon_zoomout",onClick:p})]})})}function ip({id:t="historicalChart",data:{series:e,current:n},dimensions:{width:s,height:i},margins:a,brushDomain:r,onBrushDomainChange:u,interactive:c=!0,zoomLevels:d,isSorted:h,handleClickRefresh:l,isApp:p}){const{hoverX:f,hoverY:w,hoverTime:b,hoverPrice:g,tooltipData:m,dateType:S,tooltipTextXPos:T,setHoverX:j,setHoverY:E,setHoverTime:M,setHoverPrice:N,setTooltipData:C,setDateType:$,setTooltipTextXPos:H}=lo();_.useRef(null);const[P,W]=_.useState(null),[L,x]=_.useMemo(()=>[i-a.top-a.bottom,s-a.left-a.right],[s,i,a]),[v,y]=_.useState(null);_.useEffect(()=>{if(yt){const z=yt("#price-historical-chart");y(z)}},[yt]),_.useEffect(()=>{console.log("èµ°åˆ°è¿™é‡Œäº†å—svg: ",v)},[v]);const{xScale:k,yScale:R}=_.useMemo(()=>{const z=[n*.5,n*1.5];let D=z;console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ xInitialRange:",z),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ brushDomain:",r),r&&String(r==null?void 0:r[0])!=="âˆž"&&String(r==null?void 0:r[1])!=="âˆž"&&(D=[n*.5,n*1.5]),console.log("ðŸš€ ~ file: Chart.tsx:56 ~ const{xScale,yScale}=useMemo ~ yRange:",D);const O={xScale:xc().domain(Lc(e,F=>F.time)).range([0,x]),yScale:js().domain([Math.min(mc(e,F=>F.price)*.94,D[0]),Math.max(Pr(e,F=>F.price)*1.06,D[1])]).nice().range([L,0])};if(P){const F=P.rescaleY(O.yScale);O.yScale.domain(F.domain())}return O},[n,x,L,P,e]);return o.jsxs(J,{w:"100%",h:"100%",sx:{"@media screen and (max-width: 1000px)":{display:"block"}},position:"relative",children:[o.jsx(sp,{svg:v,yScale:R,setZoom:W,width:x,height:i,zoomLevels:d,handleClickRefresh:l,dateType:S,setDateType:$,isApp:p}),o.jsxs("svg",{id:"price-historical-chart",width:"100%",height:"100%",style:{overflow:"visible"},children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"historical-gradient",x1:"0",x2:"0",y1:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:"var(--chakra-colors-historical_area_start)"}),o.jsx("stop",{offset:"100%",stopColor:"var(--chakra-colors-historical_area_end)"})]})}),v&&o.jsxs(o.Fragment,{children:[o.jsx(K0,{xScale:k,svg:v,innerHeight:L}),o.jsx(Z0,{yScale:R,svg:v,innerWidth:x}),o.jsx(Q0,{svg:v,series:e,xScale:k,yScale:R}),o.jsx(J0,{svg:v,series:e,xScale:k,yScale:R,innerHeight:L}),m&&o.jsx(ep,{innerWidth:x,innerHeight:L,hoverX:f,hoverY:w,tooltipData:m,svg:v}),o.jsx(I0,{svg:v,series:e,xScale:k,yScale:R,setHoverX:j,setHoverY:E,setTooltipData:C,setTooltipTextXPos:H}),o.jsx(np,{svg:v,yScale:R,innerWidth:x,price:n}),o.jsx(tp,{svg:v,series:e,yScale:R,innerWidth:x,innerHeight:L,brushExtent:r??R.domain(),setBrushExtent:u,isSorted:h})]})]}),m&&o.jsxs(J,{position:"absolute",left:T-100+"px",top:w-65+"px",bg:"bg_secondary",padding:"8px",alignItems:"flex-start",zIndex:"99999",gap:"4px",borderRadius:"8px",children:[o.jsxs(B,{fontSize:"xs",children:["Date: ",Ao(m==null?void 0:m.time)]}),o.jsxs(B,{fontSize:"xs",children:["Price: ",m==null?void 0:m.price]})]})]})}function rp(t,e){console.log("ðŸš€ ~ file: useHistoricalChartData.ts:8 ~ useHistoricalChartData ~ contractPoolInfo:",t);const n=_.useMemo(()=>Go[e],[e]),{historicalPriceData:s,handleRefresh:i}=ap(t==null?void 0:t.pool_address,n);_.useEffect(()=>{console.log("useHistoricalChartData historicalPriceData: ",s)},[s]);const a=_.useMemo(()=>{if(s&&s.length>0)return[s[s.length-1].time,s[0].time]},[s]);return{historicalData:s,xRange:a,isLoading:!1,error:void 0,handleRefresh:i}}function ap(t,e="day"){const n=Bn(Xo),[s,i]=_.useState([]),a=async(u,c)=>{var f,w,b;const d=Se(q(new Date().getTime()).div(1e3).toString(),0),h={hour:{dateType:"5min",startTime:q(d).minus(60*60).toNumber(),endTime:d},day:{dateType:"hour",startTime:q(d).minus(60*60*24).toNumber(),endTime:d},week:{dateType:"4hour",startTime:q(d).minus(60*60*24*7).toNumber(),endTime:d},month:{dateType:"day",startTime:q(d).minus(60*60*24*30).toNumber(),endTime:d}},l=await Fr(n,{id:u,date_type:(f=h==null?void 0:h[c])==null?void 0:f.dateType,start_timestamp:(w=h==null?void 0:h[c])==null?void 0:w.startTime,end_timestamp:(b=h==null?void 0:h[c])==null?void 0:b.endTime});console.log("useHistoricalPrice getHisTorical res: ",l);const p=l==null?void 0:l.list.map(g=>({time:q(g.timestamp).mul(1e3).toNumber(),price:Number(g.price)}));if(console.log("useHistoricalPrice list: ",p),p.length===1){const g={hour:36e5,day:864e5,week:6048e5,month:2592e6};p.push({time:q(p[0].time).minus(g[c]).toNumber(),price:p[0].price})}console.log("useHistoricalPrice liståŽ: ",p),i(p||[])};return _.useEffect(()=>{t&&e&&a(t,e)},[t,e]),{historicalPriceData:s,handleRefresh:()=>{t&&e&&a(t,e)}}}var Ue=(t=>(t.LOWER="LOWER",t.UPPER="UPPER",t))(Ue||{});const op=_.forwardRef(function({isSorted:e,price:n,contractPoolInfo:s,currencyA:i,currencyB:a,feeAmount:r,interactive:u,ticksAtLimit:c,priceLower:d,priceUpper:h,onLeftRangeInput:l,onRightRangeInput:p,onBothRangeInput:f,handleClickRefresh:w,zoomLevel:b},g){var x;const{isApp:m}=me(),{dateType:S,setDateType:T}=lo(),{historicalData:j,xRange:E,isLoading:M,error:N,handleRefresh:C}=rp(s,S),$=_.useRef(null);_.useState("1D");const H=_.useMemo(()=>e?j:j==null?void 0:j.map(v=>{var y;return{...v,price:(y=q(1).div(v==null?void 0:v.price))==null?void 0:y.toNumber()}}),[e,j]);_.useEffect(()=>{console.log("PriceChart index seriesData: ",H)},[H]);const P=!i||!a||H===void 0&&!M,W=_.useCallback((v,y)=>{if(console.log("onBrushDomainChangeEnded domain: ",v),console.log("onBrushDomainChangeEnded mode: ",y),!y)return;let k=Number(v[1]);const R=Number(v[0]);k<=0&&(k=1/10**6);const z=(!c[e?Ue.LOWER:Ue.UPPER]||y==="handle"||y==="reset")&&k>0,D=(!c[e?Ue.UPPER:Ue.LOWER]||y==="reset")&&R>0&&R<1e35;if(console.log("onBrushDomainChangeEnded updateBottom: ",z),console.log("onBrushDomainChangeEnded updateTop: ",D),z&&D){const O=parseFloat(k.toFixed(16)),F=parseFloat(R.toFixed(16));console.log("onBrushDomainChangeEnded parsedLeftRangeValue: ",O),console.log("onBrushDomainChangeEnded parsedRightRangeValue: ",F),O>0&&F>0&&O<F&&f({leftTypedValue:q(k).toString(),rightTypedValue:q(R).toString()})}else z?l(q(k).toString()):D&&p(q(R).toString())},[e,f,l,p,c]),L=_.useMemo(()=>{const v=d==null?void 0:d.fixsUiPrice,y=h==null?void 0:h.fixsUiPrice;if(y!=="âˆž")return v&&y?[v,y]:void 0},[e,d==null?void 0:d.fixsUiPrice,h==null?void 0:h.fixsUiPrice]);return _.useImperativeHandle(g,()=>({depthChartRefreshData:C})),o.jsx(J,{w:"100%",h:"100%",position:"relative",children:P?o.jsx(ut,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(B,{children:"Your position will appear here."})}):M?o.jsx(tt,{h:"100%",pt:"100px",children:o.jsx(Qe,{})}):N?o.jsx(ut,{direction:"column",h:"150px",justify:"flex-end",children:o.jsx(B,{children:"Liquidity data not available."})}):!H||H.length===0||!n||!E?o.jsxs(ut,{direction:"column",h:"210px",justify:"flex-end",children:[o.jsxs(Q,{position:"absolute",top:m?"-55px":"-80px",right:m?"auto":"0px",left:m?"0px":"auto",children:[o.jsx(Ie,{options:["1H","1D","7D","30D"],size:"s",value:S,onChange:T}),o.jsx(Pn,{handleClickRefresh:w,noBg:!0,isAutoRefresh:!0})]}),o.jsx(B,{mt:"20px",children:"There is no historical data."})]}):o.jsx(o.Fragment,{children:o.jsx(ut,{w:"100%",h:"100%",ref:$,children:o.jsx(ip,{handleClickRefresh:w,data:{series:H,current:n},dimensions:{width:((x=$==null?void 0:$.current)==null?void 0:x.clientWidth)||660,height:320},brushDomain:L,margins:{top:10,right:20,bottom:20,left:10},onBrushDomainChange:W,interactive:u&&!!(H!=null&&H.length),zoomLevels:b??Dn[r??lt.MEDIUM],isSorted:e,isApp:m})})})})}),cp=_.forwardRef(function(e,n){const{handleClickRefresh:s}=e,{currentApiPoolInfo:i,currentContractPoolInfo:a,currentFeeTier:r,setBaseCoin:u,baseCoin:c,addToken0:d,addToken1:h,minPriceData:l,maxPriceData:p,currentPrice:f,inversePrice:w,defaultPriceRangePercentage:b,saveMinPriceData:g,saveMaxPriceData:m,setIsShowMinMaxDist:S}=Rt(),T=_.useMemo(()=>a==null?void 0:a.tick_spacing,[a]),j=_.useMemo(()=>r&&Number(r)&&(i!=null&&i.tickSpacing)?{[_t.LOWER]:r?Nt.getInitializableTickIndex(Un,i==null?void 0:i.tickSpacing):void 0,[_t.UPPER]:r?Nt.getInitializableTickIndex(Vn,i==null?void 0:i.tickSpacing):void 0}:{[_t.LOWER]:void 0,[_t.UPPER]:void 0},[r]),E=_.useMemo(()=>{var R;const v=c===((R=i==null?void 0:i.token0)==null?void 0:R.metadata),y=v?l:p==null?void 0:p.getInverseTickPrice(),k=v?p:l==null?void 0:l.getInverseTickPrice();return{[_t.LOWER]:r&&(y==null?void 0:y.tick)===j.LOWER,[_t.UPPER]:r&&(k==null?void 0:k.tick)===j.UPPER}},[i,j,l,p,r,c]),M=!0,N=_.useMemo(()=>{if(b){const v=q(1).minus(q(b).div(100)).toNumber(),y=q(1).add(q(b).div(100)).toNumber();return{initialMin:v,initialMax:y,min:1e-5,max:1.5}}},[b]),C=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.symbol),R=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;R&&z&&g(re.buildTickPriceData(v,T,R,z))}},$=v=>{var y;if(T&&v!=="âˆž"){const k=c===((y=i==null?void 0:i.token0)==null?void 0:y.metadata),R=k?i==null?void 0:i.token0:i==null?void 0:i.token1,z=k?i==null?void 0:i.token1:i==null?void 0:i.token0;R&&z&&m(re.buildTickPriceData(v,T,R,z))}},H=({leftTypedValue:v,rightTypedValue:y})=>{console.log("PriceHistoricalChart onBothRangeInput leftTypedValue: ",v),console.log("PriceHistoricalChart onBothRangeInput rightTypedValue: ",y),v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v)),y!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),$(y))},P=v=>{v!==(l==null?void 0:l.fixsUiPrice)&&(S(!0),C(v))},W=v=>{v!==(p==null?void 0:p.fixsUiPrice)&&(S(!0),$(v))},L=_.useMemo(()=>{var v;return c===((v=i==null?void 0:i.token0)==null?void 0:v.metadata)},[c,i]),x=_.useRef(null);return _.useImperativeHandle(n,()=>{var v;return{priceChartRefreshData:(v=x.current)==null?void 0:v.priceChartRefreshData}}),o.jsx(J,{w:"100%",h:"100%",children:o.jsx(op,{ref:x,isSorted:L,contractPoolInfo:a,currencyA:d,currencyB:h,feeAmount:r,ticksAtLimit:E,price:Number(L?f:w),priceLower:l,priceUpper:p,interactive:M,zoomLevel:N,onBothRangeInput:H,onLeftRangeInput:P,onRightRangeInput:W,handleClickRefresh:s})})}),lp=_.forwardRef(function({handleClickRefresh:e},n){const[s,i]=_.useState("Liquidity"),{isApp:a}=me(),r=d=>{i(d)},u=_.useRef(null),c=_.useRef(null);return _.useImperativeHandle(n,()=>{var d,h;return{depthChartMethod:(d=u==null?void 0:u.current)==null?void 0:d.depthChartRefreshData,priceChartMethod:(h=c==null?void 0:c.current)==null?void 0:h.priceChartRefreshData}}),o.jsxs(tt,{w:"100%",h:"100%",children:[o.jsxs(Ko,{w:"100%",direction:a?"column":"row",justify:"space-between",mb:"10px",children:[o.jsx(tt,{children:o.jsx(Ie,{options:["Liquidity","Price"],size:"s",value:s,onChange:r})}),a&&o.jsx(tt,{h:"20px"}),o.jsxs(Q,{gap:"24px",children:[o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{w:"16px",h:"2px",bg:"chart_handle_left"}),o.jsx(B,{fontSize:"xs",whiteSpace:"nowrap",children:"Min price"})]}),o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{w:"16px",h:"2px",bg:"chart_handle_right"}),o.jsx(B,{fontSize:"xs",whiteSpace:"nowrap",children:"Max price"})]}),o.jsxs(Q,{gap:"4px",children:[o.jsx(tt,{w:"16px",h:"2px",bg:"text_caption_opacity_70"}),o.jsx(B,{fontSize:"xs",whiteSpace:"nowrap",children:"Current price"})]})]})]}),s==="Liquidity"&&o.jsx(X0,{handleClickRefresh:e,ref:u}),s==="Price"&&o.jsx(cp,{handleClickRefresh:e,ref:c})]})}),up=lp;function dp(t,e,n,s){const{setMinDistPercentange:i,setMaxDistPercentange:a}=Rt();_.useEffect(()=>{if(t!=null&&t.fixsUiPrice&&n&&(t==null?void 0:t.fixsUiPrice)!=="âˆž"&&(e==null?void 0:e.fixsUiPrice)!=="âˆž"){const r=q(t==null?void 0:t.fixsUiPrice).minus(n),u=q(e==null?void 0:e.fixsUiPrice).minus(n),c=r.equals(0)?"0":Se(r.div(n).mul(100).toString(),1),d=u.equals(0)?"0":Se(u.div(n).mul(100).toString(),1);i(String(c)),a(String(d))}},[t==null?void 0:t.fixsUiPrice,e==null?void 0:e.fixsUiPrice,n,s])}function Rp(){var Ut,ye,xi,mi,yi,_i,vi,wi,ki,bi,Ti,Si,ji;const t=Js(),{windowWidth:e}=me(),{id:n,token0:s,token1:i,fee:a}=Zo(),{address:r}=Wn(),{addToken0:u,addToken1:c,setAddToken0:d,setAddToken1:h,currentApiPoolInfo:l,setCurrentApiPoolInfo:p,currentContractPoolInfo:f,setCurrentContractPoolInfo:w,currentPoolPositions:b,setCurrentPrice:g,setBaseCoin:m,baseCoin:S,setCurrentApiPoolInfoIsLoading:T,setCurrentContractPoolInfoIsLoading:j,resetLiquidityState:E,currentFeeTier:M,setCurrentFeeTier:N,minPriceData:C,maxPriceData:$,saveMaxPriceData:H,saveMinPriceData:P,priceRangePercentage:W,ratio:L,setRatio:x,currentApiPoolInfoIsLoading:v,currentContractPoolInfoIsLoading:y,currentPrice:k,inversePrice:R}=Rt(),{getApiPoolInfo:z}=nc(),{getContractPool:D}=rl(),{feeTierDistribution:O,feeTierDistributionLoading:F}=wc(u,c),{handleChangeRange:ft}=ei();_.useMemo(()=>{var Kt,nn,Ci;const U=S===((Kt=l==null?void 0:l.token0)==null?void 0:Kt.metadata),ct=U?C:$==null?void 0:$.getInverseTickPrice(),dt=U?$:C==null?void 0:C.getInverseTickPrice(),St=f==null?void 0:f.current_tick_index,Wt=ct==null?void 0:ct.tick,le=dt==null?void 0:dt.tick;return{currentTick:St,lower:Wt,upper:le,metadata0:(nn=l==null?void 0:l.token0)==null?void 0:nn.metadata,metadata1:(Ci=l==null?void 0:l.token1)==null?void 0:Ci.metadata}},[l,f,C,$]);const{isImportToken:et}=qn(),Y=_.useMemo(()=>{var U;return S===((U=l==null?void 0:l.token0)==null?void 0:U.metadata)},[S,l]);dp(C,$,Y?k:R,Y);const[K,A]=_.useState(!1),st=_.useMemo(()=>{const U=[];if(l){const{displayToken0:ct,displayToken1:dt}=l;ct&&et(ct.metadata)&&localStorage.getItem(ct.metadata)!=="true"&&U.push(ct),dt&&et(dt.metadata)&&localStorage.getItem(dt.metadata)!=="true"&&U.push(dt)}return A(U.length>0),U},[l]),rt=_.useRef();_.useRef(),rt.current=_.useMemo(()=>{if(n)return n;if(l!=null&&l.id)return l==null?void 0:l.id},[n,l]);const pt=U=>{j(!0),D(U||rt.current).then(ct=>{console.log("fetchContractPoolInfo getContractPool res:",ct),w(ct),j(!1)})},xt=_.useRef();xt.current=_.useCallback(U=>{const ct={id:n,token0:s,token1:i,fee:a};(n||s&&i&&a)&&(T(!0),U&&(ct.id=rt.current||n||(l==null?void 0:l.id)),z(ct,U).then(dt=>{const St=rt.current||n||(l==null?void 0:l.id);(St===void 0||dt&&dt.id===St)&&(p(dt),pt(dt==null?void 0:dt.id)),T(!1)}))},[n,s,i,a]),_.useEffect(()=>{xt.current()},[n,s,i,a]),_.useEffect(()=>{l&&(d((l==null?void 0:l.displayToken0)||void 0),h((l==null?void 0:l.displayToken1)||void 0))},[l]),_.useEffect(()=>{var U,ct,dt,St,Wt,le;if((l==null?void 0:l.id)===(f==null?void 0:f.pool_address)&&((U=l==null?void 0:l.token0)==null?void 0:U.decimals)!==void 0&&((ct=l==null?void 0:l.token1)==null?void 0:ct.decimals)!==void 0&&(f!=null&&f.current_sqrt_price)){console.log("ðŸš€ ~ useEffect ~ currentContractPoolInfo:",f);const Kt=Nt.sqrtPriceX64ToPrice(new Ye(f==null?void 0:f.current_sqrt_price),(dt=l==null?void 0:l.token0)==null?void 0:dt.decimals,(St=l==null?void 0:l.token1)==null?void 0:St.decimals);console.log("ðŸš€ ~ useEffect ~ price:",Kt.toString());const nn=q(1).div(Kt);console.log("ðŸš€ ~ useEffect ~ inversePrice:",nn.toString()),g(Kt.toString()),(Wt=l==null?void 0:l.displayToken0)!=null&&Wt.symbol&&!S&&m((le=l==null?void 0:l.displayToken0)==null?void 0:le.metadata)}},[l,f==null?void 0:f.pool_address]),_.useEffect(()=>{if(!(C&&$)&&f&&l){const U=$r(String(f==null?void 0:f.fee_rate));l!=null&&l.isReverse?ft(U,l==null?void 0:l.token1,l==null?void 0:l.token0,Number(f==null?void 0:f.tick_spacing),R.toString()):ft(U,l==null?void 0:l.token0,l==null?void 0:l.token1,Number(f==null?void 0:f.tick_spacing),k.toString())}},[k,R]),_.useEffect(()=>{a&&N(a)},[a]);const[G,Z]=_.useState(!1),gt=U=>{var ct,dt,St,Wt,le,Kt;s===((ct=U.displayToken0)==null?void 0:ct.metadata)&&i===((dt=U.displayToken1)==null?void 0:dt.metadata)&&a===(U==null?void 0:U.feeTier)||i===((St=U.displayToken0)==null?void 0:St.metadata)&&s===((Wt=U.displayToken1)==null?void 0:Wt.metadata)&&a===(U==null?void 0:U.feeTier)||(E(),t(`/pools/liquidity/${(le=U==null?void 0:U.displayToken0)==null?void 0:le.metadata}/${(Kt=U==null?void 0:U.displayToken1)==null?void 0:Kt.metadata}/${U==null?void 0:U.feeTier}`,{replace:!0}),N(U==null?void 0:U.feeTier))},[nt,vt]=_.useState("Your Positions");_.useState("1D"),_.useEffect(()=>{window.scrollTo(0,0)},[]),_.useEffect(()=>{setTimeout(()=>{window.scrollTo(0,0)},50)},[window.innerHeight]);const V=_.useRef(null),X=()=>{var U;console.log("handleClickRefresh Force refresh",{id:n,token0:s,token1:i,fee:a,currentApiPoolInfo:l}),xt.current(!0),(U=V==null?void 0:V.current)==null||U.depthChartMethod()},{displayCurrentPrice:ot,displayPerText:ht}=ni(),Ht=_.useMemo(()=>{var St;const U=S===((St=l==null?void 0:l.token0)==null?void 0:St.metadata),ct=U?C:$==null?void 0:$.getInverseTickPrice(),dt=U?$:C==null?void 0:C.getInverseTickPrice();return{token0:l==null?void 0:l.token0,token1:l==null?void 0:l.token1,lowerTick:ct==null?void 0:ct.tick,upperTick:dt==null?void 0:dt.tick,sqrtPriceX96:f==null?void 0:f.current_sqrt_price,isFullRange:W===100}},[l,C==null?void 0:C.tick,$==null?void 0:$.tick,f==null?void 0:f.current_sqrt_price,W]),Et=Ec(Ht);_.useEffect(()=>{x(Et)},[Et]);const Dt=Mc(C==null?void 0:C.price,$==null?void 0:$.price),{getCurrentPoolPositions:wt}=na();_.useEffect(()=>{r&&l&&f&&(l==null?void 0:l.id)===(f==null?void 0:f.pool_address)&&nt=="Your Positions"&&(console.log("Liquidity Page getCurrentPoolPositions start"),nt==="Your Positions"&&wt(l,f,r))},[l,f,r,nt]);const bt=_.useMemo(()=>!l&&!v||!n&&(!s||!i||!a),[l,v,n,s,i,a]);_.useEffect(()=>()=>{E()},[]);const Xt=U=>o.jsx(J,{w:"100%",gap:"16px",children:o.jsxs(J,{w:"100%",children:[o.jsx(Qs,{currentTab:nt,positionsNum:(b==null?void 0:b.length)||0,textList:["Your Positions","Transactions","Info"],onClick:ct=>{vt(ct)}}),nt=="Your Positions"?o.jsx(sl,{}):nt=="Transactions"?o.jsx(nl,{windowWidth:U}):o.jsx(Kc,{})]})});return o.jsxs(tt,{w:"100%",children:[o.jsxs(ut,{align:"center",cursor:"pointer",onClick:()=>Z(!G),sx:{"@media screen and (max-width: 810px)":{alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(ut,{align:"center",children:[o.jsx(Zs,{w:"40px",coinAIconUrl:(Ut=l==null?void 0:l.displayToken0)==null?void 0:Ut.image,coinBIconUrl:(ye=l==null?void 0:l.displayToken1)==null?void 0:ye.image,variant:"border",showATag:bt?!1:et(((xi=l==null?void 0:l.displayToken0)==null?void 0:xi.metadata)||""),showBTag:bt?!1:et(((mi=l==null?void 0:l.displayToken1)==null?void 0:mi.metadata)||"")}),o.jsxs(B,{fontSize:"xl",color:"text_caption",ml:"4px",children:[(yi=l==null?void 0:l.displayToken0)==null?void 0:yi.symbol,"-",(_i=l==null?void 0:l.displayToken1)==null?void 0:_i.symbol]})]}),o.jsxs(ut,{w:"160px",h:"28px",border:"1px solid ",borderColor:"border",align:"center",ml:"20px",justify:"center",alignItems:"center",borderRadius:"8px",_hover:{bg:"bg_secondary",svg:{fill:"var(--chakra-colors-primary)"}},sx:{"@media screen and (max-width: 810px)":{w:"100%",ml:"0",mt:"12px"}},children:[o.jsx(B,{color:"primary",mr:"4px",children:"Change Pool"}),o.jsx(Lt,{xlinkHref:"#icon-icon_open",variant:"gray"})]})]}),!bt&&o.jsxs(o.Fragment,{children:[o.jsxs(Q,{mt:"12px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column"}},children:[o.jsx(tt,{sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:o.jsx(Zc,{w:"100%",feeTierDistribution:O,feeTierDistributionLoading:F,current:M,onClick:U=>{var ct,dt,St,Wt;U&&(U==null?void 0:U.value)===M||(U.title=="Not created"?t(`/pools/create/${(ct=l==null?void 0:l.displayToken0)==null?void 0:ct.metadata}/${(dt=l==null?void 0:l.displayToken1)==null?void 0:dt.metadata}/${U==null?void 0:U.value}`):(E(),t(`/pools/liquidity/${(St=l==null?void 0:l.displayToken0)==null?void 0:St.metadata}/${(Wt=l==null?void 0:l.displayToken1)==null?void 0:Wt.metadata}/${U.value}`)))}})}),o.jsxs(Q,{align:"center",sx:{"@media screen and (max-width: 810px)":{w:"100%",mt:"-4px"}},children:[o.jsx(Lr,{name:(vi=l==null?void 0:l.displayToken0)==null?void 0:vi.symbol,address:(wi=l==null?void 0:l.displayToken0)==null?void 0:wi.metadata}),o.jsx(Lr,{name:(ki=l==null?void 0:l.displayToken1)==null?void 0:ki.symbol,address:(bi=l==null?void 0:l.displayToken1)==null?void 0:bi.metadata})]})]}),o.jsxs(Q,{gap:"60px",mt:"16px",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",gap:"8px",mt:"12px",flexDirection:"column"}},children:[o.jsxs(J,{gap:"4px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},children:[o.jsx(B,{fontSize:"xs",children:"APR(24h)"}),o.jsx(Nc,{info:l,h5FontSize:"12px",children:o.jsx(B,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"xs"}},children:Jo(q(l==null?void 0:l.totalApr).mul(100).toString())})})]}),o.jsx(bs,{text:"TVL(Total Value Locked)",value:he((Ti=l==null?void 0:l.pureTvlUSD)==null?void 0:Ti.now,2)}),o.jsx(bs,{text:"Volume(24h)",value:he((Si=l==null?void 0:l.volUSD)==null?void 0:Si.day,2)}),o.jsx(bs,{text:"Fees(24h)",value:he((ji=l==null?void 0:l.feesUSD)==null?void 0:ji.day,2)})]}),o.jsxs(Q,{w:"100%",gap:"16px",mt:"40px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column"}},children:[o.jsxs(J,{w:"60%",gap:"16px",minW:"580px",sx:{"@media screen and (max-width: 810px)":{minW:"unset",w:"100%"}},children:[o.jsxs(Q,{w:"100%",sx:{"@media screen and (max-width: 810px)":{display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(J,{w:"100%",align:"flex-start",gap:"4px",children:[o.jsx(B,{fontSize:"xs",children:"Current Price"}),o.jsxs(ut,{children:[o.jsx(B,{fontSize:"md",color:"text_caption",children:ot}),o.jsx(B,{fontSize:"md",ml:"8px",children:ht})]})]}),o.jsx(Q,{sx:{"@media screen and (max-width: 810px)":{w:"100%",justifyContent:"space-between"}}})]}),o.jsx(tt,{h:"332px",w:"100%",mt:"0px",userSelect:"none",children:o.jsx(up,{handleClickRefresh:X,ref:V})}),o.jsxs(J,{w:"100%",m:"12px 0",children:[o.jsxs(Q,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{mt:"60px",display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(ut,{align:"center",children:[o.jsx(B,{children:"Deposit Ratio"}),o.jsx(Rn,{label:"The Deposit Ratio indicates the proportion of token1 and token2 required to be deposited for the selected range.","aria-label":"Ratio",placement:e>810?"right":"bottom",children:o.jsx("button",{children:o.jsx(Lt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsxs(Q,{align:"center",gap:"12px",children:[o.jsxs(B,{color:"text_caption",children:[u==null?void 0:u.symbol," ",(u==null?void 0:u.metadata)&&(L==null?void 0:L[u==null?void 0:u.metadata]),"%"]}),o.jsx(tt,{w:"100px",children:o.jsx(Qo,{value:u!=null&&u.metadata&&(L==null?void 0:L[u==null?void 0:u.metadata])!=="--"?Number(L==null?void 0:L[u==null?void 0:u.metadata]):0})}),o.jsxs(B,{color:"text_caption",children:[c==null?void 0:c.symbol," ",(c==null?void 0:c.metadata)&&(L==null?void 0:L[c==null?void 0:c.metadata]),"%"]})]})]}),o.jsxs(Q,{w:"100%",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{mt:"12px",display:"flex",alignItems:"flex-start",flexDirection:"column"}},children:[o.jsxs(ut,{align:"center",children:[o.jsx(B,{children:"Concentrated Liquidity Multiplier"}),o.jsx(Rn,{label:"Provide liquidity within a fixed price range, maximizing the efficiency of the capital locked.The Concentrated Liquidity Multiplier calculates the capital efficiency gains of a concentrated liquidity position relative to allocating capital across the entire price curve.","aria-label":"Multiplier",placement:e>810?"right":"bottom",children:o.jsx("button",{children:o.jsx(Lt,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})})]}),o.jsx(Q,{align:"center",gap:"12px",children:o.jsx(B,{color:"text_caption",children:Dt})})]})]}),e>810&&Xt(e)]}),o.jsxs(J,{w:"40%",minW:"380px",maxW:"440px",gap:"16px",sx:{"@media screen and (max-width: 810px)":{w:"100%",maxW:"unset",minW:"unset"}},children:[o.jsx(tl,{}),o.jsx(al,{handleClickRefresh:X}),e<=810&&Xt(e)]})]}),o.jsx(Io,{isOpen:K,onClose:()=>{A(!1),t("/pools/pool")},onContinue:function(){A(!1)},tokens:st})]}),bt&&o.jsx(tt,{mt:"20px",children:o.jsx(ge,{type:"nodata",text:"Pool not found",h:"330px"})}),o.jsx(Jc,{isOpen:G,onChange:gt,onClose:()=>Z(!1)})]})}function Lr(t){const{getExplorerUrl:e}=Hn(),{name:n,address:s}=t;return o.jsxs(ut,{w:"100%",bg:"bg_secondary",align:"center",p:"8px 12px",borderRadius:"8px",justifyContent:"center",children:[o.jsx(B,{fontSize:"xs",color:"text_caption",children:n}),o.jsx(jn,{href:e(s),target:"_blank",variant:"link",fontSize:"xs",color:"primary",ml:"8px",children:Pe(s)})]})}function bs(t){const{text:e,value:n}=t;return o.jsxs(J,{gap:"4px",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},children:[o.jsx(B,{fontSize:"xs",children:e}),o.jsx(B,{fontSize:"md",color:"text_caption",sx:{"@media screen and (max-width: 810px)":{fontSize:"xs"}},children:n})]})}export{Rp as default};
