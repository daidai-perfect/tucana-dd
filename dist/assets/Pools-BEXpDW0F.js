import{a2 as ln,j as e,a3 as cn,a4 as dn,a5 as xn,a6 as pn,a7 as un,V as z,q as R,F as D,a1 as hn,T as j,r as u,O as Ae,a8 as Ue,E as ie,o as _e,a9 as qe,aa as Ge,ab as Qe,ac as je,ad as q,$ as Te,ae as Xe,af as Je,ag as G,N as Pe,v as gn,ah as Ce,ai as T,aj as ke,I as te,H as Q,p as Ke,ak as ae,L as fn,t as W,B as le,S as jn,al as Cn,U as Tn,_ as wn,s as bn,X as Oe,a0 as Ze,am as $e,an as en,ao as nn,ap as sn,aq as yn,ar as me,y as Sn,as as Pn,at as kn,au as Ln,av as vn,aw as He,Q as An,ax as _n,ay as Rn,az as Be}from"./index-BYAy_kcu.js";import{R as Dn}from"./RefreshIcon-BALk4t8Q.js";import{H as tn,u as En}from"./useStatsData-C5Di-4Ip.js";import{T as Le}from"./TableCardH5-CR61ty53.js";import{g as on,a as In}from"./apiDataProcessing-DLoWrS-f.js";import{L as pe}from"./TopPools-DpM7n9mt.js";import{A as Fn}from"./AprTooltip-J51qABB5.js";import{u as Re,P as Nn,R as Vn}from"./RectangularTab-CsU23vU6.js";import{u as zn,a as $n,b as Ie,c as rn}from"./useClaim-j67FSVRW.js";import{T as Me,P as mn,u as Hn,a as Z,b as Bn}from"./useSearchPools-Dl0n3KuZ.js";import"./BackButton-B3ML0JS6.js";import"./useRate-BuUI-FCM.js";import"./useGetTokenInfo-6qTv5kIt.js";function Mn(l){const{showTag:d=!1}=l,{colorMode:i}=ln();return e.jsx(e.Fragment,{children:d&&e.jsx(cn,{src:i=="dark"?dn:xn,fallbackSrc:i=="dark"?pn:un,w:"20px",h:"20px"})})}function Wn(l){const{textList:d,onChange:i,currentTab:t}=l;return e.jsx(z,{gap:"0",children:d==null?void 0:d.map(r=>e.jsx(R,{h:"64px",lineHeight:"64px",borderRadius:"12px 0px 0px 12px",w:t==r.text?"205px":"180px",ml:t==r.text?"0px":"25px",fontSize:t==r.text?"md":"sm",bg:t==r.text?"primary":"card_bg",pl:t==r.text?"30px":"20px",color:t==r.text?"input_bg":"text_paragraph",cursor:"pointer",onClick:()=>{i(r.text)},sx:{_hover:{color:t==r.text?"input_bg":"primary"},"@media screen and (max-width: 1100px)":{w:t==r.text?"180px":"155px"},"@media screen and (max-width: 950px)":{w:t==r.text?"170px":"145px",pl:t==r.text?"22px":"12px"}},children:r.text},r.text))})}function ve(l){const{text:d,value:i,fontWeight:t,height:r,isLoading:a}=l;return e.jsxs(z,{justifyContent:"center",gap:"4px",children:[!i||a?e.jsx(D,{height:r||"",align:"center",children:e.jsx(hn,{})}):e.jsx(j,{color:"primary",fontSize:"2xl",fontWeight:t||"400",children:i}),e.jsx(j,{fontSize:"xs",children:d})]})}var Ee=new Map,Se=new WeakMap,We=0,Yn=void 0;function Un(l){return l?(Se.has(l)||(We+=1,Se.set(l,We.toString())),Se.get(l)):"0"}function qn(l){return Object.keys(l).sort().filter(d=>l[d]!==void 0).map(d=>`${d}_${d==="root"?Un(l.root):l[d]}`).toString()}function Gn(l){const d=qn(l);let i=Ee.get(d);if(!i){const t=new Map;let r;const a=new IntersectionObserver(x=>{x.forEach(o=>{var g;const L=o.isIntersecting&&r.some(h=>o.intersectionRatio>=h);l.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=L),(g=t.get(o.target))==null||g.forEach(h=>{h(L,o)})})},l);r=a.thresholds||(Array.isArray(l.threshold)?l.threshold:[l.threshold||0]),i={id:d,observer:a,elements:t},Ee.set(d,i)}return i}function Qn(l,d,i={},t=Yn){if(typeof window.IntersectionObserver>"u"&&t!==void 0){const g=l.getBoundingClientRect();return d(t,{isIntersecting:t,target:l,intersectionRatio:typeof i.threshold=="number"?i.threshold:0,time:0,boundingClientRect:g,intersectionRect:g,rootBounds:g}),()=>{}}const{id:r,observer:a,elements:x}=Gn(i),o=x.get(l)||[];return x.has(l)||x.set(l,o),o.push(d),a.observe(l),function(){o.splice(o.indexOf(d),1),o.length===0&&(x.delete(l),a.unobserve(l)),x.size===0&&(a.disconnect(),Ee.delete(r))}}function Xn({threshold:l,delay:d,trackVisibility:i,rootMargin:t,root:r,triggerOnce:a,skip:x,initialInView:o,fallbackInView:g,onChange:L}={}){var h;const[c,b]=u.useState(null),w=u.useRef(),[C,y]=u.useState({inView:!!o,entry:void 0});w.current=L,u.useEffect(()=>{if(x||!c)return;let A;return A=Qn(c,(E,F)=>{y({inView:E,entry:F}),w.current&&w.current(E,F),F.isIntersecting&&a&&A&&(A(),A=void 0)},{root:r,rootMargin:t,threshold:l,trackVisibility:i,delay:d},g),()=>{A&&A()}},[Array.isArray(l)?l.toString():l,c,r,t,a,x,i,g,d]);const k=(h=C.entry)==null?void 0:h.target,P=u.useRef();!c&&k&&!a&&!x&&P.current!==k&&(P.current=k,y({inView:!!o,entry:void 0}));const f=[b,C.inView,C.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}function Jn(l){const d=Ae(),{isImportToken:i}=Ue(),{filterPoolList:t,currOrderBy:r,handleSortChange:a,lordMoreLoading:x,hasNextPage:o,loadNextPage:g}=l,{poolListIsLoading:L}=ie(),[h,c]=Xn({triggerOnce:!1});u.useEffect(()=>{!L&&!x&&o&&c&&g()},[c]),u.useEffect(()=>{console.log("PoolList filterPoolList: ",t)},[t]);const[b,w]=u.useState("desc"),[C,y]=u.useState("-vol"),k=(n,S)=>{if(n===r)return"asc";if(r===S)return"desc"},P=[{label:"Liquidity",value:"pure_tvl"},{label:"Volume (24H)",value:"vol"},{label:"APR (24H)",value:"apr"}],f=n=>{console.log("ðŸš€ ~ h5SortingFieldClick ~ value:",C,n),C!=n&&(y("-"+n),w("desc"),a("-"+n))},A=n=>{console.log("ðŸš€ ~ h5SortClick ~ value:",n,n.split("-"),n.includes("-")),y(n.includes("-")?n.split("-")[1]:"-"+n),w(n.includes("-")?"asc":"desc"),a(n.includes("-")?n.split("-")[1]:"-"+n)},E=()=>e.jsx(j,{fontSize:"xs",children:"Pool"}),F=()=>e.jsx(j,{fontSize:"xs",children:"Pool Rewards"}),J=()=>e.jsx(j,{fontSize:"xs",children:"Action"}),B=()=>e.jsxs(D,{align:"center",justifyContent:"flex-end",children:[e.jsx(j,{fontSize:"xs",children:"Liquidity"}),e.jsx(R,{sx:{"@media screen and (max-width: 810px)":{display:"none"}},children:e.jsx(Ce,{value:k(T.TVL,T.TVL_DESC),onClick:()=>{a(r===T.TVL_DESC?T.TVL:T.TVL_DESC)}})})]}),$=()=>e.jsxs(D,{align:"center",justifyContent:"flex-end",children:[e.jsx(j,{fontSize:"xs",children:"Volume (24H)"}),e.jsx(R,{sx:{"@media screen and (max-width: 810px)":{display:"none"}},children:e.jsx(Ce,{value:k(T.VOL,T.VOL_DESC),onClick:()=>{a(r===T.VOL_DESC?T.VOL:T.VOL_DESC)}})})]}),H=()=>e.jsxs(D,{align:"center",justifyContent:"flex-end",children:[e.jsx(j,{fontSize:"xs",children:"APR"}),e.jsx(ke,{label:"Estimated according to trading activity in the past 24 hours","aria-label":"A tooltip",placement:"right",sx:{"@media screen and (max-width: 810px)":{w:"245px"}},children:e.jsx("button",{children:e.jsx(te,{xlinkHref:"#icon-icon_tips",variant:"grayprimary"})})}),e.jsx(R,{sx:{"@media screen and (max-width: 810px)":{display:"none"}},children:e.jsx(Ce,{value:k(T.APR,T.APR_DESC),onClick:()=>{a(r===T.APR_DESC?T.APR:T.APR_DESC)}})})]}),Y=n=>{var S,_,m,de,X,re,ne,se;return e.jsxs(Q,{gap:"0px",children:[e.jsx(R,{children:e.jsx(Ke,{w:"40px",coinAIconUrl:(S=n==null?void 0:n.displayToken0)==null?void 0:S.image,coinBIconUrl:(_=n==null?void 0:n.displayToken1)==null?void 0:_.image,showATag:i(((m=n==null?void 0:n.displayToken0)==null?void 0:m.metadata)||""),showBTag:i(((de=n==null?void 0:n.displayToken1)==null?void 0:de.metadata)||""),variant:"border"})}),e.jsxs(z,{gap:"0px",ml:"8px",align:"flex-start",children:[e.jsxs(Q,{children:[e.jsxs(j,{color:"text_caption",fontSize:"md",children:[(X=n==null?void 0:n.displayToken0)==null?void 0:X.symbol," - ",(re=n==null?void 0:n.displayToken1)==null?void 0:re.symbol]}),e.jsx(ke,{label:e.jsx(j,{fontSize:"xs",children:"The pool includes tokens that are not on the frequently traded token list. Please verify the token addresses of the tokens and do your own research before interacting with this pool."}),"aria-label":"Triangle",children:e.jsx("button",{children:e.jsx(Mn,{showTag:i(((ne=n==null?void 0:n.displayToken0)==null?void 0:ne.metadata)||"")||i(((se=n==null?void 0:n.displayToken1)==null?void 0:se.metadata)||"")})})})]}),e.jsx(j,{mt:"4px",p:"0px 8px",color:"primary",fontSize:"xs",minW:"52px",textAlign:"center",h:"16px",lineHeight:"16px",borderRadius:"8px",bg:"bg_secondary",children:on(n==null?void 0:n.feeTier)})]})]})},ce=n=>{var S;return e.jsx(j,{color:"text_caption",children:ae((S=n==null?void 0:n.pureTvlUSD)==null?void 0:S.now,2)})},ee=n=>{var S;return e.jsx(j,{color:"text_caption",children:ae((S=n==null?void 0:n.volUSD)==null?void 0:S.day,2)})},N=n=>{var S;return e.jsx(D,{align:"center",justifyContent:"flex-end",children:(n==null?void 0:n.showFarming)&&((S=n==null?void 0:n.rewarderUSD)==null?void 0:S.map((_,m)=>e.jsx(R,{ml:"4px",children:e.jsx(ke,{label:`${In(_==null?void 0:_.amountSecond)} ${_==null?void 0:_.symbol}/day`,"aria-label":"Rewarder amount day",placement:"top",children:e.jsx("button",{children:e.jsx(jn,{w:"20px",h:"20px",imageUrl:_==null?void 0:_.image})})})},`poolsListRwarderUSD_${m}`)))})},K=n=>e.jsx(Q,{justifyContent:"flex-end",children:e.jsx(Fn,{info:n,children:e.jsx(j,{color:"text_caption",fontSize:"sm",children:fn(n.totalApr?W(n.totalApr).mul(100).toString():void 0)})})}),oe=n=>e.jsx(le,{w:"80px",h:"32px",fontSize:"sm",variant:"ghost",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},onClick:()=>{var S,_;return d(`/pools/liquidity/${(S=n==null?void 0:n.displayToken0)==null?void 0:S.metadata}/${(_=n==null?void 0:n.displayToken1)==null?void 0:_.metadata}/${n==null?void 0:n.feeTier}`)},children:"Add"}),ue=n=>[{left:B(),right:ce(n)},{left:$(),right:ee(n)},{left:F(),right:N(n),rowListNotShow:!(n!=null&&n.showFarming&&(n!=null&&n.rewarderUSD))},{left:H(),right:K(n)}],{windowWidth:he}=_e();return e.jsxs(z,{w:"100%",children:[e.jsx(qe,{w:"100%",children:he<=810?e.jsxs(z,{w:"100%",children:[e.jsx(R,{mt:"8px",w:"100%",children:e.jsx(tn,{sortingRule:b,sortingField:C,onSortingFieldClick:n=>f(n),onSortClick:n=>A(n),list:P,isPool:!0})}),L?[{},{},{}].map((n,S)=>e.jsx(z,{w:"100%",children:e.jsx(Le,{LoadingFirstTd:pe(),isLoading:L})},S)):t==null?void 0:t.map((n,S)=>e.jsx(z,{w:"100%",children:e.jsx(Le,{LoadingFirstTd:pe(),isLoading:L,tokensSymbol:Y(n),rowList:ue(n),btntNode:oe(n)})},n==null?void 0:n.id))]}):e.jsxs(Ge,{size:"sm",children:[e.jsxs(Qe,{children:[e.jsxs(je,{children:[e.jsxs(q,{children:[" ",E()]}),e.jsx(q,{isNumeric:!0,children:B()}),e.jsx(q,{isNumeric:!0,children:$()}),Te.env!=="testnet"&&e.jsx(q,{isNumeric:!0,textAlign:"right",children:F()}),e.jsx(q,{isNumeric:!0,children:H()}),e.jsxs(q,{children:[" ",J()]})]}),e.jsx(je,{h:"4px"})]}),L?e.jsx(Xe,{tableList:[{},{},{}],tdList:[{},{},{},{},{}],firstTd:pe()}):e.jsx(Je,{children:t.map((n,S)=>e.jsxs(je,{h:"72px",cursor:"pointer",onClick:()=>{var _,m;return d(`/pools/liquidity/${(_=n==null?void 0:n.displayToken0)==null?void 0:_.metadata}/${(m=n==null?void 0:n.displayToken1)==null?void 0:m.metadata}/${n==null?void 0:n.feeTier}`)},children:[e.jsx(G,{minW:"200px",children:Y(n)}),e.jsx(G,{isNumeric:!0,textAlign:"right",children:ce(n)}),e.jsx(G,{isNumeric:!0,textAlign:"right",children:ee(n)}),Te.env!=="testnet"&&e.jsx(G,{isNumeric:!0,children:N(n)}),e.jsx(G,{isNumeric:!0,textAlign:"right",children:K(n)}),e.jsx(G,{isNumeric:!0,children:oe(n)})]},`poolListTr_${S}`))})]})}),!L&&(!t||(t==null?void 0:t.length)===0)&&e.jsx(Pe,{type:"nodata",text:"No pool found"}),e.jsx("div",{ref:h,style:{height:"0.01px"}}),x&&e.jsx(gn,{})]})}function Kn(){const{getPositionRewards:l}=zn(),{getPositionFee:d}=$n();ie(),Ie();const{getCollectRewardsPaylod:i,getCollectFeePaylod:t}=Cn(),{signAndExecuteTransaction:r}=Tn(),{positionList:a,positionFeeObj:x,posRewardsObj:o,claimAllSubmitLoading:g,positionListLoading:L,setClaimAllSubmitLoading:h}=Re(),{hasFeeAmount:c,hassRewardAmount:b}=rn(),w=async()=>{h(!0);try{if((a==null?void 0:a.length)>0){const y=[];console.log("handleSubmitClaimAll positionList: ",a),a.forEach(P=>{if(b(P==null?void 0:P.posId)){const f=i({pid:P==null?void 0:P.posId});y.push(f)}if(c(P==null?void 0:P.posId)){const f=t({pid:P==null?void 0:P.posId});y.push(f)}}),console.log("handleSubmitClaimAll msgs: ",y);const k=await r(y,{action:wn.Claim,description:"Claim all yield"});console.log("handleSubmitClaimAll response: ",k),h(!1),await bn(2e3),l(a),d(a)}}catch(y){console.log("handleSubmitClaimAll error: ",y),h(!1)}},C=u.useMemo(()=>{if(g||L||(a==null?void 0:a.length)===0)return!0;if(x){const y=Object.values(x);if(y&&(y!=null&&y.find(k=>W(k==null?void 0:k.fee0).gt(0)||W(k==null?void 0:k.fee1).gt(0))))return!1}if(o){const y=Object.values(o);if(y==null?void 0:y.find(P=>{const f=P==null?void 0:P.rewards;if(f&&(f!=null&&f.find(A=>W(A.amount).gt(0))))return!0}))return!1}return!0},[g,a,x,o]);return{handleSubmitClaimAll:w,isDisabledClaimAllBtn:C}}function On(){const l=Oe(),[d,i]=u.useState("");return{addressChange:u.useMemo(()=>d!==l?(i(l),!0):(i(l),!1),[l]),address:l}}function Zn(l){const{onboard:d}=Ze(),{filterList:i}=l,t=Ae(),{address:r,addressChange:a}=On(),{isImportToken:x}=Ue(),{poolList:o,poolsObj:g}=ie(),{getPositionListData:L,resetPositionListData:h}=Ie(),{positionList:c,positionFeeObj:b,posRewardsObj:w,totalRewards:C,totalPositionFee:y,totalLiquidityPrice:k,liquidityPriceObj:P,positionListLoading:f,claimAllSubmitLoading:A,claimFeeAndRewardsSubmitLoading:E,setCurrentPositionTab:F,positionFeeLoading:J,positionRewardsLoading:B,positionLiquidityPriceLoading:$}=Re();u.useEffect(()=>{(o==null?void 0:o.length)>0&&r?(a&&h(),L(o)):h(),console.log(o,"poolList")},[o,r]),u.useEffect(()=>()=>{h()},[]);const H=u.useMemo(()=>y==="--"||C==="--"?"--":W(y||"0").add(C||"0").toString(),[y,C]),Y=u.useCallback(s=>P&&P[s]||void 0,[P]),[ce,ee]=u.useState("desc"),[N,K]=u.useState(T.TVL_DESC),oe=(s,p)=>{if(s===N)return"asc";if(N===p)return"desc"},ue=[{label:"Liquidity",value:"pure_tvl"},{label:"Pending Yield",value:"Yield"}],he=s=>{N!=s&&(K("-"+s),ee("desc"))},n=s=>{K(s.includes("-")?s.split("-")[1]:"-"+s),ee(s.includes("-")?"asc":"desc")},S=u.useMemo(()=>(i.sort((s,p)=>{if(N===T.TVL||N===T.TVL_DESC){const V=Y(s.posId),I=Y(p.posId),U=!(V!=null&&V.total)||(V==null?void 0:V.total)==="--"?"0":V==null?void 0:V.total,M=!(I!=null&&I.total)||(I==null?void 0:I.total)==="--"?"0":I==null?void 0:I.total;return N===T.TVL_DESC?W(M).sub(U).toNumber():W(U).sub(M).toNumber()}if(N===T.Yield||N===T.Yield_DESC){const V=b==null?void 0:b[s.posId],I=w==null?void 0:w[s.posId],U=W((V==null?void 0:V.total)||"0").add((I==null?void 0:I.total)||"0").toString(),M=b==null?void 0:b[p.posId],xe=w==null?void 0:w[p.posId],ye=W((M==null?void 0:M.total)||"0").add((xe==null?void 0:xe.total)||"0").toString(),Ve=U==="--"?"0":U,ze=ye==="--"?"0":ye;return N===T.Yield_DESC?W(ze).sub(Ve).toNumber():W(Ve).sub(ze).toNumber()}return 1}),i),[i,P,N]),{handleSubmitClaimAll:_,isDisabledClaimAllBtn:m}=Kn(),{handleSubmitClaimClick:de}=rn(),X=s=>{const p=Y(s.posId);return e.jsx(Nn,{status:p==null?void 0:p.status,isActive:(p==null?void 0:p.status)==="Active"})},re=()=>e.jsx(j,{fontSize:"xs",children:"Position"}),ne=()=>e.jsx(j,{fontSize:"xs",children:"Price Range"}),se=()=>e.jsxs(D,{align:"center",justifyContent:"flex-end",children:[e.jsx(j,{fontSize:"xs",children:"Liquidity"}),e.jsx(R,{sx:{"@media screen and (max-width: 810px)":{display:"none"}},children:r&&(c==null?void 0:c.length)>0&&e.jsx(Ce,{value:oe(T.TVL,T.TVL_DESC),onClick:()=>{K(N===T.TVL_DESC?T.TVL:T.TVL_DESC)}})})]}),O=()=>e.jsxs(D,{align:"center",justifyContent:"flex-end",children:[e.jsx(j,{fontSize:"xs",children:"Pending Yield"}),e.jsx(R,{sx:{"@media screen and (max-width: 810px)":{display:"none"}},children:r&&(c==null?void 0:c.length)>0&&e.jsx(Ce,{value:oe(T.Yield,T.Yield_DESC),onClick:()=>{K(N===T.Yield_DESC?T.Yield:T.Yield_DESC)}})})]}),we=()=>e.jsx(j,{fontSize:"xs",children:"Actions"}),ge=s=>{var p,V,I,U,M;return e.jsxs(Q,{gap:"0px",children:[e.jsx(R,{children:e.jsx(Ke,{w:"40px",coinAIconUrl:(p=s==null?void 0:s.displayToken0)==null?void 0:p.image,coinBIconUrl:(V=s==null?void 0:s.displayToken1)==null?void 0:V.image,variant:"border",showATag:x((I=s==null?void 0:s.displayToken0)==null?void 0:I.metadata),showBTag:x((U=s==null?void 0:s.displayToken1)==null?void 0:U.metadata)})}),e.jsxs(z,{gap:"0px",ml:"8px",align:"flex-start",children:[e.jsxs(j,{color:"text_caption",children:[s==null?void 0:s.displayToken0.symbol,"-",(M=s==null?void 0:s.displayToken1)==null?void 0:M.symbol," LPï¼ˆ#",s==null?void 0:s.position_index,"ï¼‰"]}),e.jsx(j,{mt:"4px",p:"0px 8px",color:"primary",fontSize:"xs",minW:"52px",textAlign:"center",h:"16px",lineHeight:"16px",borderRadius:"8px",bg:"bg_secondary",children:on(s==null?void 0:s.feeTier)})]})]})},fe=s=>e.jsxs(D,{align:"center",justifyContent:"flex-end",sx:{"@media screen and (max-width: 810px)":{alignItems:"flex-end",flexDirection:"column-reverse"}},children:[e.jsxs(D,{flexWrap:"wrap",align:"center",justifyContent:"flex-end",mr:"8px",sx:{"@media screen and (max-width: 810px)":{mr:"0",lineHeight:"16px"}},children:[e.jsx(j,{color:"text_caption",whiteSpace:"wrap",lineHeight:"1",children:s==null?void 0:s.minPrice}),"Â ",e.jsx(te,{xlinkHref:"#icon-icon_range"}),"Â ",e.jsx(j,{color:"text_caption",whiteSpace:"wrap",lineHeight:"1",children:s==null?void 0:s.maxPrice})]}),De>810&&X(s)]}),v=s=>e.jsxs(e.Fragment,{children:[" ",X(s)]}),be=s=>{var I,U,M,xe;const p=Y(s==null?void 0:s.posId),V=(s==null?void 0:s.displayToken0.metadata)!==(s==null?void 0:s.token0.metadata);return e.jsx(ke,{label:e.jsxs(z,{gap:"12px",p:"4px 0",minW:"240px",flexDirection:V?"column-reverse":"column",children:[e.jsx(Me,{icon:((I=p==null?void 0:p.token0)==null?void 0:I.image)||"",amount:(p==null?void 0:p.coinAmount0)||"0",amountValue:(p==null?void 0:p.coinAmount0Rate)||"--",symbol:((U=p==null?void 0:p.token0)==null?void 0:U.symbol)||""}),e.jsx(Me,{icon:((M=p==null?void 0:p.token1)==null?void 0:M.image)||"",amount:(p==null?void 0:p.coinAmount1)||"0",amountValue:(p==null?void 0:p.coinAmount1Rate)||"--",symbol:((xe=p==null?void 0:p.token1)==null?void 0:xe.symbol)||""})]}),"aria-label":"Liquidity",children:e.jsx("button",{onClick:ye=>{$e(ye)},children:e.jsx(j,{color:"text_caption",textDecoration:"underline dotted",dangerouslySetInnerHTML:{__html:`${ae(p==null?void 0:p.total,2)}`}})})})},Fe=s=>e.jsx(mn,{isReverse:(s==null?void 0:s.displayToken0.metadata)!==(s==null?void 0:s.token0.metadata),claimLoading:E,feeObj:b==null?void 0:b[s.posId],rewardsObj:w==null?void 0:w[s.posId],showFarming:s.showFarming,handleClaimClick:function(){de(s)}}),Ne=s=>e.jsxs(D,{sx:{"@media screen and (max-width: 810px)":{justifyContent:"space-between",w:"100%"}},children:[e.jsx(le,{w:"80px",h:"32px",fontSize:"sm",variant:"ghost",onClick:()=>{F("increase"),t(`/position/${s==null?void 0:s.pool_address}/${s==null?void 0:s.posId}`)},sx:{"@media screen and (max-width: 810px)":{w:"48%"}},children:"Add"}),e.jsx(le,{w:"80px",h:"32px",fontSize:"sm",variant:"ghost",ml:"8px",onClick:p=>{$e(p),F("remove"),t(`/position/${s==null?void 0:s.pool_address}/${s==null?void 0:s.posId}`)},sx:{"@media screen and (max-width: 810px)":{w:"48%"}},children:"Remove"})]}),an=s=>[{leftText:"Status",right:v(s)},{left:ne(),right:fe(s)},{left:se(),right:be(s)},{left:O(),right:Fe(s)}],{windowWidth:De}=_e();return e.jsxs(z,{w:"100%",children:[r&&e.jsxs(D,{w:"100%",h:"100px",align:"center",justifyContent:"space-around",borderRadius:"20px",bg:"card_bg",backdropFilter:"blur(10px)",mb:"20px",sx:{"@media screen and (max-width: 810px)":{h:"unset",flexDirection:"column",p:"16px 0",mb:"0px"}},children:[e.jsx(ve,{text:"Total Position Value",value:ae(k,2),isLoading:$||f,height:"36px"}),De<=810&&e.jsx(R,{h:"12px"}),e.jsxs(D,{align:"center",children:[e.jsx(ve,{text:"Pending Yield",value:ae(H,2),isLoading:J||B||f,height:"36px"}),e.jsx(le,{w:"80px",h:"28px",borderRadius:"8px",ml:"24px",fontSize:"xs",isLoading:A,isDisabled:m||J||B||f,onClick:_,children:"Claim All"})]})]}),e.jsx(qe,{w:"100%",children:De<=810?e.jsxs(z,{w:"100%",children:[e.jsx(R,{mt:"8px",w:"100%",children:e.jsx(tn,{sortingRule:ce,sortingField:N,onSortingFieldClick:s=>he(s),onSortClick:s=>n(s),list:ue,isPool:!0})}),f?[{},{},{}].map((s,p)=>e.jsx(z,{w:"100%",children:e.jsx(Le,{LoadingFirstTd:pe(),isLoading:f})},p)):c==null?void 0:c.map((s,p)=>e.jsx(z,{w:"100%",children:e.jsx(Le,{LoadingFirstTd:pe(),isLoading:f,tokensSymbol:ge(s),rowList:an(s),btntNode:Ne(s)})},s==null?void 0:s.posId))]}):e.jsxs(Ge,{size:"sm",children:[e.jsx(Qe,{children:e.jsxs(je,{children:[e.jsx(q,{children:re()}),e.jsx(q,{textAlign:"right",children:ne()}),e.jsx(q,{textAlign:"right",isNumeric:!0,children:se()}),e.jsx(q,{textAlign:"right",children:O()}),e.jsx(q,{children:we()})]})}),f?e.jsx(Xe,{tableList:[{},{},{}],tdList:[{},{},{},{}],firstTd:pe()}):e.jsx(Je,{children:S==null?void 0:S.map((s,p)=>e.jsxs(je,{h:"72px",cursor:"pointer",onClick:()=>{F("increase"),t(`/position/${s==null?void 0:s.pool_address}/${s==null?void 0:s.posId}`)},children:[e.jsx(G,{minW:"200px",children:ge(s)}),e.jsx(G,{children:fe(s)}),e.jsx(G,{isNumeric:!0,textAlign:"right",children:be(s)}),e.jsx(G,{children:Fe(s)}),e.jsxs(G,{isNumeric:!0,children:[" ",Ne(s)]})]},s.posId))})]})}),!f&&!r?e.jsx(Pe,{type:"nowallet",onboard:d}):null,!f&&r&&(c==null?void 0:c.length)===0?e.jsx(Pe,{type:"nodata",text:"You have no liquidity positions"}):null,!f&&r&&(c==null?void 0:c.length)>0&&i.length===0?e.jsx(Pe,{type:"nodata",text:"No position found"}):null]})}function es(l){const{setSelectTab:d}=ie(),{w:i,h:t,bg:r,current:a,poolsCurrentTab:x,list:o,onClick:g}=l,L=h=>{g(h)};return e.jsx(en,{children:({isOpen:h})=>e.jsxs(e.Fragment,{children:[e.jsx(nn,{p:"0 12px",isActive:h,as:le,bg:"bg_secondary",borderRadius:"16px",w:i,h:t,backdropFilter:"blur(10px)",sx:{_hover:{opacity:"0.8"},_active:{bg:"bg_secondary"}},children:e.jsxs(D,{align:"center",justifyContent:"space-between",children:[e.jsx(j,{color:"text_caption",children:x==="Create a Pool"?(a==null?void 0:a.display)||"Select":a==null?void 0:a.display}),e.jsx(te,{xlinkHref:"#icon-icon_open",variant:"gray",transition:"transform 0.5s",transform:h?"rotate(180deg)":"rotate(0deg)"})]})}),e.jsx(sn,{p:"4px",opacity:"1",w:i,bg:r||"select_token_bg",children:o.map(c=>e.jsx(yn,{w:"100%",h:"32px",bg:c.fee==(a==null?void 0:a.fee)?"primary_10":"",borderRadius:"12px",sx:{_hover:{bg:x==="Add liquidity"&&c.text=="Not Created"||x==="Create a Pool"&&c.text=="Created"?"none":"primary_10",p:{color:x==="Add liquidity"&&c.text=="Not Created"||x==="Create a Pool"&&c.text=="Created"?"none":"primary"}}},onClick:x==="Add liquidity"&&c.text=="Not Created"||x==="Create a Pool"&&c.text=="Created"?()=>{d("Create a Pool"),L(c)}:()=>{L(c)},children:e.jsxs(D,{w:"100%",align:"center",justifyContent:"space-between",children:[e.jsx(j,{color:c.fee==(a==null?void 0:a.fee)?"primary":"",children:c.display}),x==="Add liquidity"&&c.text=="Not Created"||x==="Create a Pool"&&c.text=="Created"?e.jsx(j,{fontSize:"xs",color:c.fee==(a==null?void 0:a.fee)?"primary":"",children:c.text}):null]})},c.fee))})]})})}function ns(l){const{setSelectTab:d,selectTab:i,selectTabTokenA:t,selectTabTokenB:r,setSelectTabTokenA:a,setSelectTabTokenB:x}=ie(),{currentFee:o,changeFee:g}=l,{tokenA:L,tokenB:h}=Te.liquidity,c=Ae(),[b,w]=u.useState(!1),{feeTierDistribution:C,feeTierDistributionLoading:y}=Hn(t,r);u.useEffect(()=>{a(L),x(h)},[]),u.useEffect(()=>{C&&C[o==null?void 0:o.fee]>=0?(i=="Create a Pool"&&d("Add liquidity"),w(!0)):w(!1)},[o,C]),u.useEffect(()=>{var E,F,J;if(console.log("SelectBlock feeTierDistribution11: ",C),C&&i=="Add liquidity"){const B=Object.entries(C).map(([$,H])=>({lable:$,value:H})).sort(($,H)=>H.value-$.value);if(((E=B[0])==null?void 0:E.value)>=0){const $={fee:(F=B[0])==null?void 0:F.lable,display:((J=B[0])==null?void 0:J.lable)/1e4+"%",text:"Created"};g($)}else g(null)}},[C,i]);const k=u.useMemo(()=>[{fee:"100",display:"0.01%",text:C[100]<0?"Not Created":"Created"},{fee:"500",display:"0.05%",text:C[500]<0?"Not Created":"Created"},{fee:"2500",display:"0.25%",text:C[2500]<0?"Not Created":"Created"},{fee:"10000",display:"1%",text:C[1e4]<0?"Not Created":"Created"}],[C]),P=E=>{E.metadata===(r==null?void 0:r.metadata)&&x(void 0),a(E)},f=E=>{E.metadata===(t==null?void 0:t.metadata)&&a(void 0),x(E)},{windowWidth:A}=_e();return e.jsxs(Q,{gap:"28px",p:"0 40px",w:"862px",h:"128px",borderRadius:"0 20px 20px 0",bg:"card_bg",backdropFilter:"blur(10px)",justify:"space-between",sx:{"@media screen and (max-width: 1100px)":{w:"730px",gap:"16px",p:"0 20px"},"@media screen and (max-width: 950px)":{w:"600px"},"@media screen and (max-width: 810px)":{w:"100%",display:"flex",flexDirection:"column",borderRadius:"16px",mt:"8px",h:"276px",p:"12px"}},children:[e.jsxs(z,{align:"flex-start",justify:"center",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[e.jsx(j,{children:"Select a token"}),e.jsx(me,{select_bg:"bg_secondary",current:t,onChange:P,fontSize:"14px",w:A<=810?"100%":A<=950?"130px":A<=1100?"200px":"220px",h:"32px",borderRadius:"16px",p:"12px 4px",gap:"8px"})]}),e.jsxs(z,{align:"flex-start",justify:"center",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[e.jsx(j,{children:"Select a token"}),e.jsx(me,{select_bg:"bg_secondary",current:r,onChange:f,w:A<=810?"100%":A<=950?"130px":A<=1100?"200px":"220px",h:"32px",fontSize:"14px",borderRadius:"16px",p:"12px 4px",gap:"8px"})]}),e.jsxs(z,{align:"flex-start",justify:"center",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[e.jsx(j,{children:"Fee tier"}),e.jsx(es,{w:A<=810?"100%":"96px",h:"32px",poolsCurrentTab:i,current:o,list:k,onClick:E=>{console.log("SelectBlock feeTier change item: ",E),g(E)}})]}),e.jsx(D,{align:"center",cursor:"pointer",onClick:()=>{b&&i==="Create a Pool"||i==="Add liquidity"?c(`/pools/liquidity/${t==null?void 0:t.metadata}/${r==null?void 0:r.metadata}/${o==null?void 0:o.fee}`):(console.log(`/pools/create/${t==null?void 0:t.metadata}/${r==null?void 0:r.metadata}/${o==null?void 0:o.fee}`),c(`/pools/create/${t==null?void 0:t.metadata}/${r==null?void 0:r.metadata}/${o==null?void 0:o.fee}`))},children:e.jsxs(le,{isDisabled:!t||!r||!o||b&&i==="Create a Pool",variant:"link",textDecoration:"unset !important",color:"primary",sx:{"@media screen and (max-width: 950px)":{fontSize:"sm"}},children:[b&&i==="Create a Pool"||i==="Add liquidity"?"Add liquidity":"Create a Pool",e.jsx(te,{xlinkHref:"#icon-icon_arrow"})]})})]})}const ss=l=>{const{isOpen:d,setIsOpen:i,searchText:t,onChange:r,placeholder:a}=l;return e.jsx(Q,{alignItems:"center",position:"relative",w:"100%",children:d&&e.jsx(Sn,{w:"100%",children:e.jsxs(Q,{w:"100%",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(Pn,{w:"100%",children:[e.jsx(kn,{justifyContent:"center",children:e.jsx(te,{mt:"8px",xlinkHref:"#icon-icon_search",marginLeft:"10px"})}),e.jsx(Ln,{h:"35px",w:"100%",pl:"34px",pr:"32px",placeholder:a,variant:"outline",fontSize:"12px",borderRadius:"8px",value:t,onChange:x=>{r(x.target.value)}})]}),t?e.jsx(R,{position:"absolute",right:"10px",onClick:()=>r(""),children:e.jsx(te,{xlinkHref:"#icon-icon_closure",variant:"gray"})}):null]})})})},Ye=ss;function ts(l){const{searchText:d}=l,i=Oe(),{positionList:t}=Re();return{filterPositionList:u.useMemo(()=>{const a=d.trim().toLowerCase();return i.length===0?[]:a.length===0?t:t.filter(x=>{const o=x.token0.symbol.toLowerCase(),g=x.token1.symbol.toLowerCase(),L=x.posId.toLowerCase(),h=o.includes(a)||g.includes(a)||a.length>10&&L.includes(a);if(h)return h;const c=vn(a);let b,w;return c.length>0&&(b=c[0]),c.length===2&&(w=c[1]),b&&w?o.includes(b)&&g.includes(w)||o.includes(w)&&g.includes(b):b?o.includes(b)||g.includes(b):!1})},[t,d,i])}}function os(l){const{currType:d,onFilterChange:i}=l,[t,r]=u.useState(!1),a=g=>{i(g),r(!1)},x=d===Z.OnlyRewards,o=d===Z.AllPools;return e.jsxs(en,{isOpen:t,onClose:()=>{r(!1)},children:[e.jsx(nn,{p:"0 12px 0 16px ",isActive:t,as:le,bg:"bg_secondary",h:"34px",borderRadius:"8px",onClick:()=>{r(!0)},sx:{_hover:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}},_active:{bg:"card_bg",p:{color:"primary"},svg:{fill:"primary"}}},children:e.jsxs(D,{align:"center",justifyContent:"space-between",children:[e.jsx(j,{color:"text_caption",children:"Filters"}),e.jsx(te,{xlinkHref:"#icon-icon_open",variant:"gray",transition:"transform 0.5s",transform:t?"rotate(180deg)":"rotate(0deg)"})]})}),e.jsx(sn,{p:"4px 16px 16px",opacity:"1",children:e.jsxs(R,{children:[e.jsxs(D,{mt:"12px",alignItems:"center",children:[e.jsx(He,{checked:x,onClick:()=>{d===Z.OnlyRewards?a(Z.OfficialPools):a(Z.OnlyRewards)}}),e.jsx(j,{ml:"24px",color:x?"primary":"text_paragraph",children:"Mining rewards only"})]}),e.jsxs(D,{mt:"12px",alignItems:"center",children:[e.jsx(He,{checked:o,onClick:()=>{d===Z.AllPools?a(Z.OfficialPools):a(Z.AllPools)}}),e.jsx(j,{ml:"24px",color:o?"primary":"text_paragraph",children:"Display All Pools"})]})]})})]})}function rs(l,d,i=20){const{poolListIsLoading:t}=ie(),{filterPoolList:r}=Bn(l,d),[a,x]=u.useState([]),[o,g]=u.useState(0),[L,h]=u.useState(!1);u.useEffect(()=>{if(t){h(!1),g(0);return}h(!1),g(0)},[t,l,d]),u.useEffect(()=>{if(t)return;const C=o*i,y=C+i;if(r.length<=C)o===0&&x([]);else{const k=r.slice(C,y);console.log("usePagePools: ",k,o),x(o===0?[...k]:[...a,...k])}},[r,o]);const c=()=>{w&&h(!0),setTimeout(()=>{g(o+1),h(!1)},500)},b=u.useMemo(()=>r.length,[r]),w=u.useMemo(()=>t?!1:r.length>a.length,[r,t,a]);return{pagePoolList:a,hasNextPage:w,currentPage:o,loadNextPage:c,totalCount:b,lordMoreLoading:L}}function Ts(){var ge,fe;const{tokenA:l,tokenB:d}=Te.liquidity,{address:i}=Ze(),{tab:t}=An(),r=Ae(),[a,x]=u.useState(null),[o,g]=u.useState("pool"),{getAnalyticsData:L}=En(),{analyticsDate:h}=_n(),{getPoolList:c}=Rn(),{poolList:b,setSelectTab:w,selectTab:C,setSelectTabTokenA:y,setSelectTabTokenB:k}=ie(),{positionList:P,positionTotalAmount:f}=Re(),{getPositionListData:A,getPositionAmount:E}=Ie();u.useEffect(()=>{g(t||"pool")},[t]);const[F,J]=u.useState({limit:1e3,offset:0,orderBy:T.VOL_DESC}),B=()=>{console.log("clickPoolsRefresh"),o==="pool"?c(F):i&&A(b)};u.useEffect(()=>{window.scrollTo(0,0),L(),w("Add liquidity"),console.log("currentConfig: ",Te)},[]),u.useEffect(()=>{i&&o!=="position"&&E()},[i]),u.useEffect(()=>{o==="pool"&&c({limit:1e3,offset:0,orderBy:"-vol"})},[o]);const[$,H]=u.useState(!1),[Y,ce]=u.useState(""),[ee,N]=u.useState(Z.OfficialPools),{pagePoolList:K,hasNextPage:oe,loadNextPage:ue,totalCount:he,lordMoreLoading:n}=rs(Y,ee),[S,_]=u.useState(""),{filterPositionList:m}=ts({searchText:S}),de=u.useMemo(()=>i?m.length>0&&S.length>0?`(${m.length})`:f&&W(f).gt(0)?`(${f})`:"":"",[f,m,i]),X=u.useRef();u.useEffect(()=>{function v(be){X.current&&!X.current.contains(be.target)&&H(!1)}return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[X]);const re=u.useMemo(()=>o=="position"?S:Y,[o,Y,S]),ne=v=>{o=="position"?_(v):ce(v)},se=v=>{x(null),w(v),v=="Create a Pool"?k(void 0):(y(l),k(d))},{windowWidth:O}=_e(),we=()=>e.jsx(Dn,{handleClickRefresh:B,boxH:"32px",boxW:"32px"});return e.jsxs(z,{w:"100%",gap:"0",children:[e.jsx(z,{gap:"0",children:e.jsx(j,{color:"text_caption",fontSize:"32px",mb:"4px",sx:{"@media screen and (max-width: 810px)":{textAlign:"center",fontSize:"22px"}},children:"Tucana Liquidity Pools"})}),e.jsxs(D,{w:"55%",align:"center",justifyContent:"space-between",mt:"24px",sx:{"@media screen and (max-width: 810px)":{w:"100%",flexDirection:"column"}},children:[e.jsx(ve,{text:"Total Value Locked",value:`${ae((ge=h==null?void 0:h.pureTvlUSD)==null?void 0:ge.now,2)}`,fontWeight:"100",height:"36px"}),O<=810&&e.jsx(R,{h:"12px"}),e.jsx(ve,{text:"Trading Volume (24H)",value:`${ae((fe=h==null?void 0:h.volUSD)==null?void 0:fe.day,2)}`,fontWeight:"100",height:"36px"})]}),e.jsxs(D,{w:"100%",align:"center",justifyContent:"center",mt:"60px",zIndex:"1",sx:{"@media screen and (max-width: 810px)":{flexDirection:"column"}},children:[O>810?e.jsx(Wn,{currentTab:C,textList:[{text:"Add liquidity",link:""},{text:"Create a Pool",link:""}],onChange:v=>se(v)}):e.jsx(Vn,{w:"100%",h:"40px",p:"4px",borderRadius:"8px",currentTab:C,textList:["Add liquidity","Create a Pool"],onClick:v=>se(v)}),e.jsx(ns,{currentFee:a,changeFee:v=>x(v)})]}),e.jsxs(R,{w:"100%",gap:"0",mt:"40px",zIndex:"0",children:[e.jsxs(D,{w:"100%",align:"center",justifyContent:"space-between",pb:"11px",borderBottom:"1px solid",borderColor:"border",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column",alignItems:"flex-start"}},children:[e.jsxs(D,{align:"center",children:[e.jsx(Be,{text:"Pools",value:`(${he})`,ml:"48px",isActive:o=="pool",onClick:()=>{r("/pools/pool")}}),e.jsx(R,{w:"40px"}),e.jsx(Be,{text:"Positions",value:de,ml:"48px",isActive:o=="position",onClick:()=>{r("/pools/position")}})]}),O<=810&&e.jsx(R,{w:"100%",h:"1px",background:"border",mt:"16px"}),e.jsxs(Q,{sx:{"@media screen and (max-width: 810px)":{w:"100%",mt:o=="pool"?"12px":"4px",display:"flex",flexDirection:"column",justifyContent:"space-between"}},children:[e.jsxs(Q,{gap:"8px",sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",justifyContent:"space-between"}},children:[e.jsx(R,{w:o=="pool"?"":"0",children:o=="pool"&&e.jsx(os,{currType:ee,onFilterChange:v=>{N(v)}})}),e.jsxs(Q,{children:[O>810?$?e.jsx(R,{ref:X,w:$?"320px":"0",transition:"transform 2s",sx:{"@media screen and (max-width: 810px)":{w:$?"100%":"0"}},children:e.jsx(Ye,{isOpen:$,setIsOpen:v=>{H(v)},searchText:re,onChange:ne,placeholder:o=="position"?"Search by token or position address":"search by token or pool address"})}):e.jsx(te,{boxW:"32px",boxH:"32px",svgW:"24px",svgH:"24px",xlinkHref:"#icon-icon_search",variant:"rectangle",onClick:()=>H(!0)}):null,(o=="pool"||O>810)&&we()]})]}),O<=810&&e.jsxs(Q,{sx:{"@media screen and (max-width: 810px)":{w:"100%",display:"flex",justifyContent:"space-between"}},children:[e.jsx(R,{w:"100%",children:e.jsx(Ye,{isOpen:!0,setIsOpen:v=>{H(v)},searchText:re,onChange:ne,placeholder:o=="position"?"Search by token or position address":"search by token or pool address"})}),o!=="pool"&&we()]})]})]}),e.jsx(R,{h:"16px"}),o=="position"?e.jsx(Zn,{filterList:m}):e.jsx(Jn,{filterPoolList:K,currOrderBy:F.orderBy,handleSortChange:v=>{F.orderBy=v,J({...F}),B()},lordMoreLoading:n,hasNextPage:oe,loadNextPage:()=>{ue()}})]})]})}export{Ts as default};
