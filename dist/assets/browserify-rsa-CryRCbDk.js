import{B as R}from"./vite-plugin-node-polyfills-2b3IylRN.js";import{b as x}from"./bn.js-CjHYPH1W.js";import{b as y}from"./randombytes-cxG1aiJq.js";var n=x,g=y;function h(r){var e=u(r),o=e.toRed(n.mont(r.modulus)).redPow(new n(r.publicExponent)).fromRed();return{blinder:o,unblinder:e.invm(r.modulus)}}function u(r){var e=r.modulus.byteLength(),o;do o=new n(g(e));while(o.cmp(r.modulus)>=0||!o.umod(r.prime1)||!o.umod(r.prime2));return o}function t(r,e){var o=h(e),a=e.modulus.byteLength(),m=new n(r).mul(o.blinder).umod(e.modulus),l=m.toRed(n.mont(e.prime1)),b=m.toRed(n.mont(e.prime2)),s=e.coefficient,i=e.prime1,f=e.prime2,c=l.redPow(e.exponent1).fromRed(),d=b.redPow(e.exponent2).fromRed(),w=c.isub(d).imul(s).umod(i).imul(f);return d.iadd(w).imul(o.unblinder).umod(e.modulus).toArrayLike(R,"be",a)}t.getr=u;var L=t;export{L as b};
