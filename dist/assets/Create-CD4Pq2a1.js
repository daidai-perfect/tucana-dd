import{r as f,j as e}from"./react-CxzTU07i.js";import{B as Pe}from"./BackButton-CQFe92gG.js";import{B as ve}from"./bn.js-CjHYPH1W.js";import{i as we,a1 as Ae,q as ye,I as Y,b as de,p as _e,aj as W,f as Be,k as De,d as y,F as C,ak as Ie,T as Me,Q as re,K as ae,S as xe,m as Q}from"./App-Cb960mne.js";import"./numbro-DbF9-lIv.js";import{c as Re}from"./zustand--BHpADek.js";import{f as fe,c as Fe}from"./react-router-COZMEyo_.js";import{f as P,T as x,F as h,H as V,$ as q,a1 as Z,n as $e,p as he,Q as Le,O as ze,z as Ee,A as Ve,D as qe,E as Ne,G as He,J as Oe,V as Je,ap as se,B as ge,as as ce,ae as Ge,af as Ue,ag as We,ah as Qe,ai as Xe,aj as G,ak as Ye,al as Ze}from"./@chakra-ui-F3U2dpjw.js";import{m as X,C as je,f as O,n as Ke,c as I,b as et}from"./@tucana-network-DgPNddlX.js";import{T as ke}from"./@initia-CP5FTFDk.js";import{u as tt}from"./usePoolList-D7LBbYQN.js";import{u as it,P as ot}from"./useSelectRange-BFBP-BxQ.js";import{L as le}from"./LockMask-CVvwyGE1.js";import{P as nt,a as rt,C as at}from"./recharts-BEhUgXe7.js";import"./@improbable-eng-BU3rlaSz.js";import"./vite-plugin-node-polyfills-2b3IylRN.js";import"./react-router-dom-DspqRS0x.js";import"./react-dom-D0CDEAqu.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-CA71pd9M.js";import"./index-oyaI18XQ.js";import"./lodash.mergewith-0oSak3fd.js";import"./framesync-BLa_7oTh.js";import"./@emotion-Ci8Bc0jK.js";import"./hoist-non-react-statics-Buxaj0Kl.js";import"./react-is-8JwjhRSi.js";import"./@babel-Ds7TnLC8.js";import"./stylis-YPZU7XtI.js";import"./color2k-BSHHkqKj.js";import"./framer-motion-DN1fNAS_.js";import"./react-focus-lock-CdsTnkdS.js";import"./focus-lock-C3lLyJ0E.js";import"./use-sidecar-Mnt-C9DP.js";import"./use-callback-ref-BUZizod5.js";import"./react-clientside-effect-C1WRooe2.js";import"./react-remove-scroll-XbdGFyuF.js";import"./react-remove-scroll-bar-B8WFODEn.js";import"./react-style-singleton-BMjn4bnO.js";import"./get-nonce-C-Z93AgS.js";import"./aria-hidden-DQ5UC2Eg.js";import"./@zag-js-BxxExxl0.js";import"./@popperjs-BQBsAJpH.js";import"./react-fast-compare-ZNZLWkFJ.js";import"./decimal.js-g2JQ_dxE.js";import"./dayjs-ChilDtai.js";import"./copy-to-clipboard-BEgmPfpW.js";import"./toggle-selection-BHUZwh74.js";import"./cosmjs-types-HHI3LIsf.js";import"./axios-BGrCQLb0.js";import"./browser-headers-DaTTBGKg.js";import"./long-Bd8Jk2Sf.js";import"./@protobufjs-BFfFlHHM.js";import"./bignumber.js-CTO8iJYk.js";import"./jscrypto-DOxZ2vL9.js";import"./crypto-browserify-K7vti8ry.js";import"./randombytes-cxG1aiJq.js";import"./safe-buffer-B7h8REzA.js";import"./create-hash-B2etqZ4B.js";import"./inherits-BlmhoU4v.js";import"./md5.js-FaoCCiYs.js";import"./hash-base-Bol-vuw1.js";import"./events-BYvclee5.js";import"./util-mxsps8Rg.js";import"./is-arguments-CSFfgC6i.js";import"./has-tostringtag-BVm4gedm.js";import"./has-symbols-jRi3KFcs.js";import"./call-bind-B07GZeJl.js";import"./get-intrinsic-kTO65dkt.js";import"./es-errors-DzOT6E3C.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-DW3CJlDV.js";import"./define-data-property-BYhozZ9n.js";import"./es-define-property-BlMEMvNH.js";import"./gopd-rUakIY3f.js";import"./has-property-descriptors-B3Yvk56Z.js";import"./is-generator-function-DtmjroQB.js";import"./which-typed-array-DjIYTpty.js";import"./for-each-HDM-_-W4.js";import"./is-callable-ajMm-eR9.js";import"./available-typed-arrays-lJejVQbB.js";import"./possible-typed-array-names-ZWAIzZ1Z.js";import"./is-typed-array-BI6k7hxc.js";import"./util-deprecate-DPVjTvyT.js";import"./string_decoder-0MzJkBYb.js";import"./ripemd160-C1CpqImb.js";import"./sha.js-BDwlQsPx.js";import"./cipher-base-7AdYGBPO.js";import"./stream-browserify-BfQl1BUK.js";import"./create-hmac--QaKJlMo.js";import"./browserify-sign-GWTZlE0Z.js";import"./process-nextick-args-qzFE9GA4.js";import"./core-util-is-BRatBjl-.js";import"./browserify-rsa-CryRCbDk.js";import"./elliptic-CmlQxMT_.js";import"./minimalistic-assert-DDtZfRm3.js";import"./minimalistic-crypto-utils-BXubSNmL.js";import"./brorand-BrlY5gS_.js";import"./hash.js-itZKbfbK.js";import"./hmac-drbg-oB7aodci.js";import"./parse-asn1-DRtj1sMn.js";import"./asn1.js-BnSaV4mo.js";import"./vm-browserify-B6h6MQBh.js";import"./evp_bytestokey-Dyx8YxuJ.js";import"./browserify-aes-BUcIY7yD.js";import"./buffer-xor-De43xBeM.js";import"./pbkdf2-C-6u4RPY.js";import"./browserify-cipher-DYIcwHfU.js";import"./browserify-des-SXPfahZ7.js";import"./des.js-CDfWU-Dy.js";import"./diffie-hellman-Cjh9VIAB.js";import"./miller-rabin-D0hA1ZTO.js";import"./create-ecdh-BozzoSuA.js";import"./public-encrypt-Dmci0MFY.js";import"./randomfill-Cz20fUZ8.js";import"./keccak256-BDyJSpAN.js";import"./keccak-C1V6dJ9R.js";import"./bech32-MFBNfINK.js";import"./bs58-B7XvzY3E.js";import"./base-x-DaHpqjnx.js";import"./bip32-rT_4MDJf.js";import"./bs58check-DBgRgCjV.js";import"./tiny-secp256k1-DFomSNDX.js";import"./typeforce-Dson3yfq.js";import"./wif-Bj2Vat9l.js";import"./bip39-D04lJivS.js";import"./@noble-niMs0PSV.js";import"./secp256k1-BRtDzKq7.js";import"./ws-DLAd0t_s.js";import"./semver-DcF-0Uum.js";import"./@ledgerhq-BR4K6VrK.js";import"./useApiUrl-BWcjgV84.js";import"./clsx-B-dksMZM.js";import"./lodash-CF7ZZEzc.js";import"./react-smooth-CJ-TEnHD.js";import"./prop-types-DJYhzm_d.js";import"./fast-equals-C7I1S-bJ.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-C66BBtZo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-CWG3-CEL.js";import"./d3-scale-CaKF3Vy_.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-EePf7Sik.js";import"./d3-time-format-CKRkqwF6.js";import"./d3-time-nQs4M9wC.js";import"./d3-interpolate-m1gjL8b6.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";var A=(o=>(o.forward="forward",o.reverse="reverse",o))(A||{});const $=Re((o,i)=>({token0:void 0,token1:void 0,saveToken0:t=>{i().clearInputData(),o(()=>({token0:t}))},isValidRange:()=>{const{inputPriceData:t,minPriceData:n,maxPriceData:r}=i();return t&&n&&r?t.tick>=n.tick&&t.tick<r.tick:!0},saveToken1:t=>{i().clearInputData(),o(()=>({token1:t}))},feeTier:void 0,saveFeeTier:t=>{o(()=>({feeTier:t}))},inputPriceData:void 0,saveInputPriceData:t=>{o(()=>({inputPriceData:t}))},priceDirection:"forward",savePriceDirection:t=>{o(()=>({priceDirection:t}))},minPriceData:void 0,maxPriceData:void 0,saveMinPriceData:t=>{o(()=>({minPriceData:t}))},saveMaxPriceData:t=>{o(()=>({maxPriceData:t}))},tokenAmount0:"",tokenAmount1:"",isFixTokenAmount0:!0,saveTokenAmount:(t,n)=>{o(t?()=>({tokenAmount0:n}):()=>({tokenAmount1:n}))},saveIsFixTokenAmount0:t=>{o(()=>({isFixTokenAmount0:t}))},liquidityInputResult:void 0,saveLiquidityInputResult:t=>{o(()=>({liquidityInputResult:t}))},clearInputData:()=>{o(()=>({inputPriceData:void 0,priceDirection:"forward",minPriceData:void 0,maxPriceData:void 0,tokenAmount0:"",tokenAmount1:""}))}}));function st(){const{token0:o,token1:i}=fe(),{tokensObj:t}=we(),{token0:n,token1:r,saveToken0:a,saveToken1:l}=$();f.useEffect(()=>{if(console.log("testlb",{tokensObj:t,token0Params:o,token1Params:i}),o){const c=t[o];s(c,!0)}else s(void 0,!0);if(i){const c=t[i];s(c,!1)}else s(void 0,!1)},[!0]);const s=(c,m)=>{m?((c==null?void 0:c.metadata)===(r==null?void 0:r.metadata)&&l(void 0),a(c)):((c==null?void 0:c.metadata)===(n==null?void 0:n.metadata)&&a(void 0),l(c))};return{token0:n,token1:r,selectAndFixTokenType:s}}function ct(){const{token0:o,token1:i,selectAndFixTokenType:t}=st();return e.jsxs(P,{style:{width:"100%"},children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Select Pool"}),e.jsxs(h,{width:"100%",gap:"16px",children:[e.jsx(pe,{label:"Base Asset",currentCoin:o,onChange:n=>{t(n,!0)}}),e.jsx(pe,{label:"Quote Asset",currentCoin:i,onChange:n=>{t(n,!1)}})]})]})}function pe(o){const{currentCoin:i,onChange:t,label:n}=o;return e.jsxs(h,{width:"100%",mt:"14px",direction:"column",children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:n}),e.jsx(Ae,{showPopoverUI:!1,current:i,onChange:t,width:"100%",h:"48px",borderRadius:"16px",p:"12px",gap:"8px",marginTop:"8px",select_bg:"bg_secondary"})]})}function lt(){const{fee:o}=fe(),[i,t]=f.useState(!0),{token0:n,token1:r,feeTier:a,saveFeeTier:l}=$(),{getPoolByMatadata:s}=ye(),[c,m]=f.useState([{feeTier:100,fee:"0.01",text:"Best for very stable pairs.",tick_spacing:2,has_created:!1},{feeTier:500,fee:"0.05",text:"Best for stable pairs.",tick_spacing:10,has_created:!1},{feeTier:2500,fee:"0.25",text:"Best for most pairs.",tick_spacing:60,has_created:!1},{feeTier:1e4,fee:"1",text:"Best for exotic pairs.",tick_spacing:200,has_created:!1}]);return f.useEffect(()=>{t(!1);let u;if(n&&r){let p;if(u=c.map((d,k)=>(d.has_created=s(n.metadata,r.metadata,d.feeTier.toString())!==void 0,d.feeTier===2500&&!d.has_created&&(p=d),d)),p)l(p);else{const d=u.filter(k=>!k.has_created);d.length>0?l({...d[0]}):l(void 0)}}else l(void 0),u=c.map(p=>(p.has_created=!1,p)),l();if(m([...u]),o&&i){const p=c.filter(d=>d.feeTier.toString()===o);p.length>0&&l({...p[0]})}},[n,r]),{feeTier:a,saveFeeTier:l,feeTierList:c}}function pt(){const{feeTier:o,saveFeeTier:i,feeTierList:t}=lt();return e.jsxs(P,{style:{width:"100%",marginTop:"26px"},children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Select Fee Tier"}),e.jsx(h,{width:"100%",marginTop:"-8px",display:"flex",justifyContent:"center",flexWrap:"wrap",children:t.map((n,r)=>e.jsx(V,{marginTop:"16px",width:"49%",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:e.jsx(q,{h:"100%",marginLeft:r%2===0?"0px":"16px",cursor:n.has_created?"not-allowed":"pointer",width:"100%",paddingTop:"12px",paddingBottom:"12px",background:"bg_secondary",border:"1px solid",borderColor:n.fee===(o==null?void 0:o.fee)?"border_select":"bg_secondary",onClick:()=>{!n.has_created&&n.fee!==(o==null?void 0:o.fee)&&i(n)},sx:{"@media screen and (max-width: 810px)":{ml:"0"}},children:e.jsxs(Z,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{"@media screen and (max-width: 810px)":{w:"100%"}},children:[e.jsxs(P,{children:[e.jsxs(h,{children:[e.jsxs(x,{color:"text_caption",children:[n.fee,"%"]}),n.fee===(o==null?void 0:o.fee)&&e.jsx(Y,{xlinkHref:"#icon-icon_tick",marginLeft:"3px"})]}),e.jsx(x,{marginTop:"6px",fontSize:"sm",children:n.text})]}),e.jsx(x,{fontSize:"sm",children:n.has_created?"Created":"Not created"})]})})},r))})]})}function Te(){const{token0:o,token1:i,minPriceData:t,maxPriceData:n,inputPriceData:r,tokenAmount0:a,tokenAmount1:l,isFixTokenAmount0:s,saveTokenAmount:c,saveIsFixTokenAmount0:m,priceDirection:u,saveLiquidityInputResult:p,isValidRange:d}=$(),{tokenBalanceValue:k}=de(),{getCointAmountValue:w}=_e();f.useEffect(()=>{c(!0,""),c(!1,""),p(void 0)},[t,n]),f.useEffect(()=>{s?W(a)?b(a,!0):(c(!1,""),p(void 0)):W(l)?b(l,!0):(c(!0,""),p(void 0))},[a,l]);const _=(g,S)=>{m(g),c(g,S)},B=f.useMemo(()=>a&&Number(a)>0&&o?w(a,o.metadata,2,!0).toString():"0.00",[a,o]),T=f.useMemo(()=>l&&Number(l)>0&&i?w(l,i.metadata,2,!0).toString():"0.00",[l,i]),b=(g,S=!1)=>{if(o&&i&&r&&t&&n){const M=r.tokenA.metadata!==o.metadata;let j=r,R=t,F=n;M&&(console.log("进行反向",{inputPriceData:r.toStringJson(),maxPriceData:n.toStringJson(),minPriceData:t.toStringJson()}),j=r.getInversePrice(),R=n.getInverseTickPrice(),F=t.getInverseTickPrice());const L=X(g,(s?o:i).decimals).toFixed(0);console.log("estLiquidityAndcoinAmountFromOneAmounts: ",{fixMinPriceData:R.toStringJson(),fixMaxPriceData:F.toStringJson(),fixInputPriceData:j.toStringJson(),fixAmount:L});const z=je.estLiquidityAndcoinAmountFromOneAmounts(R.tick,F.tick,new ve(L),s,!0,.01,j.getSqrtPrice()),E=O(z.tokenMaxA.toString(),o.decimals).toString(),N=O(z.tokenMaxB.toString(),i.decimals).toString();console.log("计算结果: ",{isReverse:M,coinAmountA:E,coinAmounB:N,tokenA:o.symbol,tokenB:i.symbol,isFixAmount0:s});const H={liquidityInput:z,inputPriceData:j,minPriceData:R,maxPriceData:F};return S&&(p(H),c(!s,s?N:E)),H}};return{token0:o,token1:i,calculateTokenAmount:b,tokenBalanceValue:k,onAmountChange:_,tokenAmount0:a,tokenAmount1:l,tokenAmount0Value:B,tokenAmount1Value:T,isValidRange:d}}function mt(o){const{token0:i,token1:t,saveToken0:n,saveToken1:r,feeTier:a,saveFeeTier:l,inputPriceData:s,minPriceData:c,maxPriceData:m,tokenAmount0:u,tokenAmount1:p,clearInputData:d,liquidityInputResult:k,saveMinPriceData:w,saveMaxPriceData:_}=$(),[B,T]=f.useState(!1),b=Fe(),{address:g}=ke(),{tokenBalanceValue:S,fetchTokenBalances:M}=de(),{tucanaSpotSDK:j}=Be(),{signAndExecuteTransaction:R}=De();tt();const{tokenAmount0Value:F,tokenAmount1Value:K}=Te();f.useEffect(()=>{d()},[!0]);const L=f.useMemo(()=>{var v;return((v=c==null?void 0:c.uiPrice)==null?void 0:v.trim())==="0"&&(m==null?void 0:m.uiPrice)===Ke},[c==null?void 0:c.uiPrice,m==null?void 0:m.uiPrice]),z=()=>{n(),r(),w(),_()},E=f.useMemo(()=>{if(!i||!t)return T(!1),{ceateBtnText:"Select a token",ceateBtnDisable:!0};if(o===0)return T(!0),a===void 0?{ceateBtnText:"Select FeeTier",ceateBtnDisable:!0}:{ceateBtnText:"Next",ceateBtnDisable:!1};if(!s)return{ceateBtnText:"Enter starting price",ceateBtnDisable:!0};if(o===1)return{ceateBtnText:"Next",ceateBtnDisable:!1};if(!L){if(!c||!m)return{ceateBtnText:"Select Range",ceateBtnDisable:!0};if(!(s.tick<m.tick&&s.tick>c.tick))return{ceateBtnText:"Invalid range",ceateBtnDisable:!0}}if(o===2)return{ceateBtnText:"Next",ceateBtnDisable:!1};if(!g)return{ceateBtnText:"Connect Wallet",ceateBtnDisable:!1};if(o===3){if(u.length===0||p.length===0||Number(u)===0||Number(p)===0)return{ceateBtnText:"Enter an amount",ceateBtnDisable:!0};if(y(S(i.metadata)).lessThan(X(u,i.decimals)))return{ceateBtnText:`Insufficient ${C(i==null?void 0:i.symbol)} balance`,ceateBtnDisable:!0};if(y(S(t.metadata)).lessThan(X(p,t.decimals)))return{ceateBtnText:`Insufficient ${C(t==null?void 0:t.symbol)} balance`,ceateBtnDisable:!0}}return{ceateBtnText:"Create Pool",ceateBtnDisable:!1}},[i,t,a,g,s,L,c==null?void 0:c.price,m==null?void 0:m.tick,u,p,o]);f.useEffect(()=>{b(`/pools/create/${i==null?void 0:i.metadata}/${t==null?void 0:t.metadata}/${a==null?void 0:a.feeTier}`,{replace:!0})},[i,t,a]);const{failedTsToast:N}=Ie(),H=async()=>{if(j&&k){const{inputPriceData:v,minPriceData:J,maxPriceData:Se,liquidityInput:D}=k,ee=D.fix_amount_a?D.coinAmountA.toString():D.tokenMaxA.toString(),te=D.fix_amount_a?D.tokenMaxB.toString():D.coinAmountB.toString(),ie={tick_spacing:a.tick_spacing,uri:"",initialize_sqrt_price:v.getSqrtPrice().toString(),tick_lower:J.tick,tick_upper:Se.tick,fix_amount_a:D.fix_amount_a,amount_a:ee,amount_b:te,metadata_a:i.metadata,metadata_b:t.metadata};if(console.log("cerate pool : ",{params:ie}),await(j==null?void 0:j.Pool.hasPoolCreated(i.metadata,t.metadata,a.tick_spacing))){N({title:"Transaction failed",description:"The pool has already been created"});return}const oe=j==null?void 0:j.Pool.createPoolPaylod(ie);console.log("cerate pool : ",{payload:oe});const ne=await R([oe],{action:Me.CreatePool,description:`Create ${C(i.symbol)}-${C(t.symbol)} ${a==null?void 0:a.fee}% pool`,coinA:{...v.tokenA,amount:re(ee,i.decimals).toString()},coinB:{...v.tokenB,amount:re(te,t.decimals).toString()}});return ne.isSuccess&&setTimeout(()=>{j==null||j.Pool.getPoolList(),M()},2e3),ne}},Ce=()=>{let v="0.00";try{v=y(F).add(K).toFixed(2)}catch(J){console.log(J),v="--"}return{token0:i,token1:t,tokenAmount0:u,tokenAmount1:p,priceMin:c.uiPrice,priceMax:m.uiPrice,feeTier:a.fee,price:(i==null?void 0:i.metadata)===(s==null?void 0:s.tokenA.metadata)?(s==null?void 0:s.uiPrice)||"0":(s==null?void 0:s.getInversePrice().uiPrice)||"0",totalAmountValue:v}};return{token0:i,token1:t,saveToken0:n,saveToken1:r,showFeeTier:B,feeTier:a,saveFeeTier:l,inputPriceData:s,minPriceData:c,maxPriceData:m,tokenAmount0:u,tokenAmount1:p,ceateBtnText:E.ceateBtnText,ceateBtnDisable:E.ceateBtnDisable,handleCreatePoolSubmit:H,getCreateConfirmModalData:Ce,handleClearData:z}}function ut(){const{token0:o,token1:i,inputPriceData:t,saveInputPriceData:n,priceDirection:r,savePriceDirection:a}=$();f.useEffect(()=>{a(A.forward),n(void 0)},[o,i]);const l=f.useMemo(()=>!!t,[t]),s=()=>{if(t&&o&&i){const p=y(1).div(t.price).toString();r===A.forward?(n(I.buildPriceData(p,i,o)),a(A.reverse)):(a(A.forward),n(t.getInversePrice()))}},c=(p,d)=>{const k=p.target.value;W(k)&&o&&i?t?(t.updatePrice(k,d),n(t)):r===A.forward?n(I.buildPriceData(k,o,i)):n(I.buildPriceData(k,i,o)):n(void 0),console.log("inputPriceData",t,r)},m=f.useMemo(()=>r===A.reverse?`${C(o==null?void 0:o.symbol)} per ${C(i==null?void 0:i.symbol)}`:`${C(i==null?void 0:i.symbol)} per ${C(o==null?void 0:o.symbol)}`,[i,o,r]),u=f.useMemo(()=>{var p,d;return t?`1 ${C((p=t.tokenA)==null?void 0:p.symbol)} = ${t.uiPrice} ${C((d=t.tokenB)==null?void 0:d.symbol)}`:""},[t==null?void 0:t.price,r]);return{inputPriceData:t,handlePriceChange:c,priceDirection:r,handleSwitchPriceDirection:s,showConversionUi:l,priceLabelText:m,priceRateText:u}}function dt(){const{inputPriceData:o,priceLabelText:i,priceRateText:t,handlePriceChange:n,showConversionUi:r,handleSwitchPriceDirection:a}=ut();return e.jsxs(P,{style:{width:"100%",marginTop:"26px"},children:[e.jsxs(h,{justifyContent:"space-between",children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Set Initial Price"}),r&&e.jsxs(h,{children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:t}),e.jsx(Y,{xlinkHref:"#icon-icon_swap",marginLeft:"3px",onClick:a})]})]}),e.jsxs($e,{marginTop:"8px",children:[e.jsx(he,{placeholder:"0.0",value:(o==null?void 0:o.uiPrice)||"",variant:"outline",onChange:l=>{n(l,!1)},onBlur:l=>{n(l,!0)}}),e.jsx(Le,{children:e.jsx(x,{mr:"10px",children:i})})]})]})}function be(){const{token0:o,token1:i,inputPriceData:t,minPriceData:n,maxPriceData:r,saveMinPriceData:a,saveMaxPriceData:l,feeTier:s,priceDirection:c,isValidRange:m}=$(),{isFullRange:u,handleMinPriceClick:p,handleMaxPriceClick:d,onInputPriceChange:k}=it({minPriceData:n,maxPriceData:r,saveMinPriceData:a,saveMaxPriceData:l,token0:o,token1:i,tickSpacing:s==null?void 0:s.tick_spacing}),w=T=>{if(s&&o&&i){const b=c===A.forward?o:i,g=c===A.forward?i:o;T?(a(I.buildMinTickPriceData(s.tick_spacing,b,g)),l(I.buildMaxTickPriceData(s.tick_spacing,b,g))):t?(a(I.buildTickPriceData(y(t.price).mul(.8).toString(),s.tick_spacing,b,g)),l(I.buildTickPriceData(y(t.price).mul(1.2).toString(),s.tick_spacing,b,g))):(a(void 0),l(void 0))}else a(void 0),l(void 0)};f.useEffect(()=>{w(u)},[t==null?void 0:t.tick,s]);const _=()=>{w(!u)},B=f.useMemo(()=>{if(n&&r&&t&&o&&i){const T=n.tokenA.symbol,b=n.tokenB.symbol;let g=0,S=0;if(u)g=50,S=50;else if(y(n.tick).greaterThanOrEqualTo(t.tick))S=100;else if(y(r.tick).lessThanOrEqualTo(t.tick))g=100;else{const M=et.priceToSqrtPriceX64(y(t.price),n.tokenA.decimals,n.tokenB.decimals),j=je.calculateDepositRatioFixTokenA(n.tick,r.tick,M);g=Number(j.ratioA.mul(100).toFixed(0)),S=100-g}return[{symbol:T,ratio:g},{symbol:b,ratio:S}]}return[]},[n==null?void 0:n.price,r==null?void 0:r.price,t==null?void 0:t.tick]);return{minPriceData:n,maxPriceData:r,handleMinPriceClick:p,handleMaxPriceClick:d,isFullRange:u,handleFullRangeChange:_,depositRatios:B,onInputPriceChange:k,isValidRange:m}}function xt(){const{minPriceData:o,maxPriceData:i,handleMinPriceClick:t,handleMaxPriceClick:n,isFullRange:r,handleFullRangeChange:a,onInputPriceChange:l,isValidRange:s}=be();return e.jsxs(P,{style:{width:"100%",marginTop:"26px"},children:[e.jsxs(h,{justifyContent:"space-between",children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Select Range"}),e.jsxs(h,{children:[e.jsx(ze,{mr:"4px",isChecked:r,onChange:a}),e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Full Range"})]})]}),e.jsx("div",{style:{height:"8px"}}),e.jsx(ot,{min_price:(o==null?void 0:o.uiPrice)||"",max_price:(i==null?void 0:i.uiPrice)||"",handleMinPriceActoin:t,handleMaxPriceActoin:n,onInputPriceChange:l,isFullRange:r,direction:"row"}),!s()&&e.jsx(x,{color:"error",fontSize:"12px",mt:"8px",children:"To create a new pool, the initial price you set must be within your price range."})]})}function ft(){const{token0:o,token1:i,tokenBalanceValue:t,tokenAmount0:n,tokenAmount1:r,onAmountChange:a,tokenAmount0Value:l,tokenAmount1Value:s,isValidRange:c}=Te(),m=!c();return e.jsxs(P,{mt:"26px",style:{width:"100%"},children:[e.jsx(x,{fontSize:"xs",color:"text_paragraph",children:"Deposit Amounts"}),e.jsxs(h,{width:"100%",gap:"16px",mt:"8px",sx:{"@media screen and (max-width: 810px)":{flexDirection:"column"}},children:[o&&e.jsxs(P,{position:"relative",w:"100%",children:[m&&e.jsx(le,{notHaveText:!0}),e.jsx(me,{coin:o,balance:O(t(o.metadata),o.decimals).toString(),amount:n,amountValue:l||"",onAmountChange:function(u){a(!0,u)}})]}),i&&e.jsxs(P,{position:"relative",w:"100%",children:[m&&e.jsx(le,{notHaveText:!0}),e.jsx(me,{coin:i,balance:O(t(i.metadata),i.decimals).toString(),amount:r,amountValue:s||"",onAmountChange:function(u){a(!1,u)}})]})]})]})}function me(o){const{coin:i,balance:t,amount:n,amountValue:r,onAmountChange:a}=o;return e.jsx(q,{width:"100%",pt:"8px",pb:"8px",backgroundColor:"input_bg",children:e.jsx(Z,{children:e.jsxs(h,{justifyContent:"space-between",alignItems:"center",gap:"8px",children:[e.jsxs(h,{direction:"column",children:[e.jsx(he,{placeholder:"0.0",value:n,onChange:l=>{const s=l.target.value.replace(/[^\d.]+|(\..*)\./g,"$1");a(s||"")}}),e.jsxs(x,{fontSize:"sm",children:["$",ae(r)]})]}),e.jsxs(h,{direction:"column",alignItems:"end",children:[e.jsxs(h,{gap:"8px",children:[e.jsx(xe,{imageUrl:i.image,w:"24px"}),e.jsx(Q,{fontSize:"2xl",color:"text_caption",children:i.symbol})]}),e.jsxs(h,{justifyContent:"center",onClick:()=>{a(t)},children:[e.jsx(Y,{xlinkHref:"#icon-icon_wallet",marginLeft:"4px"}),e.jsxs(x,{fontSize:"sm",style:{cursor:"pointer"},children:["$",ae(t)]})]})]})]})})})}function ht(o){const{isOpen:i,onClose:t,onClick:n}=o,{token0:r,token1:a,tokenAmount0:l,tokenAmount1:s,price:c,priceMin:m,priceMax:u,totalAmountValue:p,feeTier:d}=o.data;return e.jsxs(Ee,{isOpen:i,onClose:t,isCentered:!0,children:[e.jsx(Ve,{}),e.jsxs(qe,{children:[e.jsx(Ne,{children:"Review Create"}),e.jsx(He,{}),e.jsx(Oe,{pb:"16px",children:e.jsxs(Je,{w:"100%",children:[e.jsxs(se,{w:"100%",gap:"20px",mt:"16px",children:[e.jsx(ue,{leftText:`${l} ${C(r.symbol)}`,icon:r.image,showTag:r.isImport||!1}),e.jsx(ue,{leftText:`${s} ${C(a.symbol)}`,icon:a.image,showTag:a.isImport||!1})]}),e.jsxs(V,{w:"100%",borderRadius:"8px",bg:"bg_secondary",mt:"30px",p:"10px",justifyContent:"space-between",gap:"3px",children:[e.jsx(x,{children:"Price Range"}),e.jsx(x,{color:"text_caption",children:`${m} - ${u}`})]}),e.jsxs(se,{w:"100%",gap:"16px",mt:"20px",children:[e.jsx(U,{leftText:"Fee Tier",rightText:`${d}%`}),e.jsx(U,{leftText:"Initial Price",rightText:c}),e.jsx(U,{leftText:"Total Amount",rightText:`$${p}`})]}),e.jsx(ge,{size:"lg",w:"100%",mt:"20px",onClick:n,children:"Create and Add Liquidity"})]})})]})]})}function ue(o){const{leftText:i,icon:t,showTag:n}=o;return e.jsxs(V,{justifyContent:"space-between",children:[e.jsx(x,{fontSize:"2xl",color:"text_caption",children:i}),e.jsx(xe,{width:"32px",height:"32px",imageUrl:t,showTag:n})]})}function U(o){const{leftText:i,rightText:t,right:n}=o;return e.jsxs(V,{justifyContent:"space-between",children:[e.jsx(x,{children:i}),t&&e.jsx(x,{color:"text_caption",children:t}),n&&n]})}function gt(o){const{setpIndex:i,setStepIndex:t}=o,[n,r]=f.useState(!1),{ceateBtnText:a,ceateBtnDisable:l,showFeeTier:s,token0:c,token1:m,saveToken0:u,saveToken1:p,handleCreatePoolSubmit:d,getCreateConfirmModalData:k,handleClearData:w}=mt(i),{address:_,onboard:B}=ke();return f.useEffect(()=>{(!c||!m)&&t(0)},[c,m]),e.jsx(q,{style:{width:"100%"},children:e.jsxs(Z,{children:[e.jsxs(h,{justifyContent:"space-between",alignItems:"center",children:[e.jsx(x,{fontSize:"md",color:"text_caption",children:"Create New Pool"}),e.jsx(x,{fontSize:"xs",color:"primary",style:{cursor:"pointer"},onClick:()=>{w()},children:"Clear all"})]}),e.jsx(P,{bg:"border",style:{width:"100%",height:"1px",marginTop:"20px"}}),e.jsx("div",{style:{height:"26px"}}),i>=0&&e.jsx(ct,{}),s&&e.jsx(pt,{}),i>=1&&e.jsx(dt,{}),i>=2&&e.jsx(xt,{}),i>=3&&e.jsx(ft,{}),e.jsx("div",{style:{width:"100%",textAlign:"center",marginTop:"38px"},children:e.jsx(ge,{isDisabled:l,size:"lg",width:"60%",onClick:()=>{if(i===3){if(!_){B();return}r(!0)}else t(i+1)},sx:{"@media screen and (max-width: 1280px)":{w:"100%"}},children:a})}),n&&e.jsx(ht,{isOpen:n,onClick:()=>{d().then(T=>{T!=null&&T.isSuccess&&t(0)}),r(!1)},onClose:()=>r(!1),data:k()})]})})}function jt(o){const{depositRatios:i}=be();if(i.length===0||o.stepIndex<2)return e.jsx(e.Fragment,{});const t=[{name:"Group A",value:Number(i[0].ratio)},{name:"Group B",value:Number(i[1].ratio)}],n=["#A6DEEB","#0EC8A8"];return e.jsxs(q,{w:"100%",style:{paddingLeft:"16px"},children:[e.jsx(x,{fontSize:"sm",children:"Deposit Ratio"}),e.jsx(nt,{width:180,height:150,children:e.jsx(rt,{data:t,cx:"50%",cy:"50%",labelLine:!1,innerRadius:25,outerRadius:60,dataKey:"value",stroke:"var(--chakra-colors-select_token_bg)",children:t.map((r,a)=>e.jsx(at,{fill:n[a%n.length]},`cell-${a}`))})}),e.jsxs(h,{justifyContent:"space-between",gap:"8px",children:[e.jsxs(h,{alignItems:"center",gap:"8px",children:[e.jsx(ce,{ml:"1",w:"12px",h:"12px",backgroundColor:"primary",borderRadius:"20px"}),e.jsx(Q,{color:"text_caption",children:i[0].symbol})]}),e.jsxs(x,{color:"text_caption",children:[i[0].ratio,"%"]})]}),e.jsxs(h,{justifyContent:"space-between",gap:"8px",children:[e.jsxs(h,{alignItems:"center",gap:"8px",children:[e.jsx(ce,{ml:"1",w:"12px",h:"12px",backgroundColor:"success",borderRadius:"20px"}),e.jsx(Q,{color:"text_caption",children:i[1].symbol})]}),e.jsxs(x,{color:"text_caption",children:[i[1].ratio,"%"]})]})]})}function kt(o){const{setpIndex:i}=o,t=[{title:"Select Pool",description:"Contact Info"},{title:"Set Initial Price",description:"Date & Time"},{title:"Select Range",description:"Select Rooms"},{title:"Add Liquidity",description:"Select Rooms"}];return Ge({index:i,count:t.length}),e.jsx(P,{style:{width:"100%"},children:e.jsx(q,{style:{paddingLeft:"16px"},children:e.jsx(Ue,{index:i,orientation:"vertical",gap:"0",children:t.map((n,r)=>e.jsxs(We,{children:[e.jsx(Qe,{children:e.jsx(Xe,{complete:e.jsx(G,{}),incomplete:e.jsx(G,{}),active:e.jsx(G,{})})}),e.jsx(P,{flexShrink:"0",children:e.jsx(Ye,{children:n.title})}),i>r&&e.jsx(Ze,{})]},r))})})})}function dn(){const[o,i]=f.useState(0);return f.useEffect(()=>{window.scrollTo(0,0)},[]),e.jsxs(h,{w:"100%",maxW:"100%",p:"10px 0px 0px",boxSizing:"content-box",direction:"column",children:[e.jsx(Pe,{}),e.jsxs(V,{mt:"18px",backdropFilter:"blur(10px)",align:"flex-start",sx:{"@media screen and (max-width: 810px)":{display:"flex",flexDirection:"column"}},children:[e.jsxs(h,{width:"280px",direction:"column",gap:"8px",sx:{"@media screen and (max-width: 810px)":{width:"100%"}},children:[e.jsx(kt,{setpIndex:o}),e.jsx(jt,{stepIndex:o})]}),e.jsx(gt,{setpIndex:o,setStepIndex:function(t){i(t)}})]})]})}export{dn as default};
