import{i as m}from"./inherits-BlmhoU4v.js";import{s as _}from"./safe-buffer-B7h8REzA.js";import{c as v}from"./cipher-base-7AdYGBPO.js";import{m as x}from"./create-hash-B2etqZ4B.js";import{r as B}from"./ripemd160-C1CpqImb.js";import{s as g}from"./sha.js-BDwlQsPx.js";var E=m,i=_.Buffer,u=v,$=i.alloc(128),h=64;function n(r,a){u.call(this,"digest"),typeof a=="string"&&(a=i.from(a)),this._alg=r,this._key=a,a.length>h?a=r(a):a.length<h&&(a=i.concat([a,$],h));for(var t=this._ipad=i.allocUnsafe(h),p=this._opad=i.allocUnsafe(h),s=0;s<h;s++)t[s]=a[s]^54,p[s]=a[s]^92;this._hash=[t]}E(n,u);n.prototype._update=function(r){this._hash.push(r)};n.prototype._final=function(){var r=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,r]))};var b=n,U=m,C=b,l=v,e=_.Buffer,H=x,c=B,d=g,R=e.alloc(128);function f(r,a){l.call(this,"digest"),typeof a=="string"&&(a=e.from(a));var t=r==="sha512"||r==="sha384"?128:64;if(this._alg=r,this._key=a,a.length>t){var p=r==="rmd160"?new c:d(r);a=p.update(a).digest()}else a.length<t&&(a=e.concat([a,R],t));for(var s=this._ipad=e.allocUnsafe(t),w=this._opad=e.allocUnsafe(t),o=0;o<t;o++)s[o]=a[o]^54,w[o]=a[o]^92;this._hash=r==="rmd160"?new c:d(r),this._hash.update(s)}U(f,l);f.prototype._update=function(r){this._hash.update(r)};f.prototype._final=function(){var r=this._hash.digest(),a=this._alg==="rmd160"?new c:d(this._alg);return a.update(this._opad).update(r).digest()};var D=function(a,t){return a=a.toLowerCase(),a==="rmd160"||a==="ripemd160"?new f("rmd160",t):a==="md5"?new C(H,t):new f(a,t)};export{D as b};
