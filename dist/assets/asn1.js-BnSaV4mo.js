import{c as He}from"./@improbable-eng-BU3rlaSz.js";import{r as Tt}from"./vite-plugin-node-polyfills-2b3IylRN.js";import{i as Bt}from"./inherits-BlmhoU4v.js";import{m as Je}from"./minimalistic-assert-DDtZfRm3.js";import{r as Ve}from"./vm-browserify-B6h6MQBh.js";var Qt={},ue={exports:{}};ue.exports;(function(k){(function(w,E){function m(l,t){if(!l)throw new Error(t||"Assertion failed")}function A(l,t){l.super_=t;var r=function(){};r.prototype=t.prototype,l.prototype=new r,l.prototype.constructor=l}function u(l,t,r){if(u.isBN(l))return l;this.negative=0,this.words=null,this.length=0,this.red=null,l!==null&&((t==="le"||t==="be")&&(r=t,t=10),this._init(l||0,t||10,r||"be"))}typeof w=="object"?w.exports=u:E.BN=u,u.BN=u,u.wordSize=26;var M;try{typeof window<"u"&&typeof window.Buffer<"u"?M=window.Buffer:M=Tt().Buffer}catch{}u.isBN=function(t){return t instanceof u?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===u.wordSize&&Array.isArray(t.words)},u.max=function(t,r){return t.cmp(r)>0?t:r},u.min=function(t,r){return t.cmp(r)<0?t:r},u.prototype._init=function(t,r,i){if(typeof t=="number")return this._initNumber(t,r,i);if(typeof t=="object")return this._initArray(t,r,i);r==="hex"&&(r=16),m(r===(r|0)&&r>=2&&r<=36),t=t.toString().replace(/\s+/g,"");var o=0;t[0]==="-"&&(o++,this.negative=1),o<t.length&&(r===16?this._parseHex(t,o,i):(this._parseBase(t,r,o),i==="le"&&this._initArray(this.toArray(),r,i)))},u.prototype._initNumber=function(t,r,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(m(t<9007199254740992),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),i==="le"&&this._initArray(this.toArray(),r,i)},u.prototype._initArray=function(t,r,i){if(m(typeof t.length=="number"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var f,c,p=0;if(i==="be")for(o=t.length-1,f=0;o>=0;o-=3)c=t[o]|t[o-1]<<8|t[o-2]<<16,this.words[f]|=c<<p&67108863,this.words[f+1]=c>>>26-p&67108863,p+=24,p>=26&&(p-=26,f++);else if(i==="le")for(o=0,f=0;o<t.length;o+=3)c=t[o]|t[o+1]<<8|t[o+2]<<16,this.words[f]|=c<<p&67108863,this.words[f+1]=c>>>26-p&67108863,p+=24,p>=26&&(p-=26,f++);return this.strip()};function _(l,t){var r=l.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function T(l,t,r){var i=_(l,r);return r-1>=t&&(i|=_(l,r-1)<<4),i}u.prototype._parseHex=function(t,r,i){this.length=Math.ceil((t.length-r)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var f=0,c=0,p;if(i==="be")for(o=t.length-1;o>=r;o-=2)p=T(t,r,o)<<f,this.words[c]|=p&67108863,f>=18?(f-=18,c+=1,this.words[c]|=p>>>26):f+=8;else{var s=t.length-r;for(o=s%2===0?r+1:r;o<t.length;o+=2)p=T(t,r,o)<<f,this.words[c]|=p&67108863,f>=18?(f-=18,c+=1,this.words[c]|=p>>>26):f+=8}this.strip()};function g(l,t,r,i){for(var o=0,f=Math.min(l.length,r),c=t;c<f;c++){var p=l.charCodeAt(c)-48;o*=i,p>=49?o+=p-49+10:p>=17?o+=p-17+10:o+=p}return o}u.prototype._parseBase=function(t,r,i){this.words=[0],this.length=1;for(var o=0,f=1;f<=67108863;f*=r)o++;o--,f=f/r|0;for(var c=t.length-i,p=c%o,s=Math.min(c,c-p)+i,e=0,h=i;h<s;h+=o)e=g(t,h,h+o,r),this.imuln(f),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e);if(p!==0){var b=1;for(e=g(t,h,t.length,r),h=0;h<p;h++)b*=r;this.imuln(b),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e)}this.strip()},u.prototype.copy=function(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++)t.words[r]=this.words[r];t.length=this.length,t.negative=this.negative,t.red=this.red},u.prototype.clone=function(){var t=new u(null);return this.copy(t),t},u.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},u.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},u.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},u.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var n=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],a=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];u.prototype.toString=function(t,r){t=t||10,r=r|0||1;var i;if(t===16||t==="hex"){i="";for(var o=0,f=0,c=0;c<this.length;c++){var p=this.words[c],s=((p<<o|f)&16777215).toString(16);f=p>>>24-o&16777215,f!==0||c!==this.length-1?i=n[6-s.length]+s+i:i=s+i,o+=2,o>=26&&(o-=26,c--)}for(f!==0&&(i=f.toString(16)+i);i.length%r!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}if(t===(t|0)&&t>=2&&t<=36){var e=a[t],h=v[t];i="";var b=this.clone();for(b.negative=0;!b.isZero();){var S=b.modn(h).toString(t);b=b.idivn(h),b.isZero()?i=S+i:i=n[e-S.length]+S+i}for(this.isZero()&&(i="0"+i);i.length%r!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}m(!1,"Base should be between 2 and 36")},u.prototype.toNumber=function(){var t=this.words[0];return this.length===2?t+=this.words[1]*67108864:this.length===3&&this.words[2]===1?t+=4503599627370496+this.words[1]*67108864:this.length>2&&m(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-t:t},u.prototype.toJSON=function(){return this.toString(16)},u.prototype.toBuffer=function(t,r){return m(typeof M<"u"),this.toArrayLike(M,t,r)},u.prototype.toArray=function(t,r){return this.toArrayLike(Array,t,r)},u.prototype.toArrayLike=function(t,r,i){var o=this.byteLength(),f=i||Math.max(1,o);m(o<=f,"byte array longer than desired length"),m(f>0,"Requested array length <= 0"),this.strip();var c=r==="le",p=new t(f),s,e,h=this.clone();if(c){for(e=0;!h.isZero();e++)s=h.andln(255),h.iushrn(8),p[e]=s;for(;e<f;e++)p[e]=0}else{for(e=0;e<f-o;e++)p[e]=0;for(e=0;!h.isZero();e++)s=h.andln(255),h.iushrn(8),p[f-e-1]=s}return p},Math.clz32?u.prototype._countBits=function(t){return 32-Math.clz32(t)}:u.prototype._countBits=function(t){var r=t,i=0;return r>=4096&&(i+=13,r>>>=13),r>=64&&(i+=7,r>>>=7),r>=8&&(i+=4,r>>>=4),r>=2&&(i+=2,r>>>=2),i+r},u.prototype._zeroBits=function(t){if(t===0)return 26;var r=t,i=0;return r&8191||(i+=13,r>>>=13),r&127||(i+=7,r>>>=7),r&15||(i+=4,r>>>=4),r&3||(i+=2,r>>>=2),r&1||i++,i},u.prototype.bitLength=function(){var t=this.words[this.length-1],r=this._countBits(t);return(this.length-1)*26+r};function d(l){for(var t=new Array(l.bitLength()),r=0;r<t.length;r++){var i=r/26|0,o=r%26;t[r]=(l.words[i]&1<<o)>>>o}return t}u.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,r=0;r<this.length;r++){var i=this._zeroBits(this.words[r]);if(t+=i,i!==26)break}return t},u.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},u.prototype.toTwos=function(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()},u.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},u.prototype.isNeg=function(){return this.negative!==0},u.prototype.neg=function(){return this.clone().ineg()},u.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},u.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]|t.words[r];return this.strip()},u.prototype.ior=function(t){return m((this.negative|t.negative)===0),this.iuor(t)},u.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},u.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},u.prototype.iuand=function(t){var r;this.length>t.length?r=t:r=this;for(var i=0;i<r.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=r.length,this.strip()},u.prototype.iand=function(t){return m((this.negative|t.negative)===0),this.iuand(t)},u.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},u.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},u.prototype.iuxor=function(t){var r,i;this.length>t.length?(r=this,i=t):(r=t,i=this);for(var o=0;o<i.length;o++)this.words[o]=r.words[o]^i.words[o];if(this!==r)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=r.length,this.strip()},u.prototype.ixor=function(t){return m((this.negative|t.negative)===0),this.iuxor(t)},u.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},u.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},u.prototype.inotn=function(t){m(typeof t=="number"&&t>=0);var r=Math.ceil(t/26)|0,i=t%26;this._expand(r),i>0&&r--;for(var o=0;o<r;o++)this.words[o]=~this.words[o]&67108863;return i>0&&(this.words[o]=~this.words[o]&67108863>>26-i),this.strip()},u.prototype.notn=function(t){return this.clone().inotn(t)},u.prototype.setn=function(t,r){m(typeof t=="number"&&t>=0);var i=t/26|0,o=t%26;return this._expand(i+1),r?this.words[i]=this.words[i]|1<<o:this.words[i]=this.words[i]&~(1<<o),this.strip()},u.prototype.iadd=function(t){var r;if(this.negative!==0&&t.negative===0)return this.negative=0,r=this.isub(t),this.negative^=1,this._normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,r=this.isub(t),t.negative=1,r._normSign();var i,o;this.length>t.length?(i=this,o=t):(i=t,o=this);for(var f=0,c=0;c<o.length;c++)r=(i.words[c]|0)+(o.words[c]|0)+f,this.words[c]=r&67108863,f=r>>>26;for(;f!==0&&c<i.length;c++)r=(i.words[c]|0)+f,this.words[c]=r&67108863,f=r>>>26;if(this.length=i.length,f!==0)this.words[this.length]=f,this.length++;else if(i!==this)for(;c<i.length;c++)this.words[c]=i.words[c];return this},u.prototype.add=function(t){var r;return t.negative!==0&&this.negative===0?(t.negative=0,r=this.sub(t),t.negative^=1,r):t.negative===0&&this.negative!==0?(this.negative=0,r=t.sub(this),this.negative=1,r):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},u.prototype.isub=function(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);return t.negative=1,r._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i=this.cmp(t);if(i===0)return this.negative=0,this.length=1,this.words[0]=0,this;var o,f;i>0?(o=this,f=t):(o=t,f=this);for(var c=0,p=0;p<f.length;p++)r=(o.words[p]|0)-(f.words[p]|0)+c,c=r>>26,this.words[p]=r&67108863;for(;c!==0&&p<o.length;p++)r=(o.words[p]|0)+c,c=r>>26,this.words[p]=r&67108863;if(c===0&&p<o.length&&o!==this)for(;p<o.length;p++)this.words[p]=o.words[p];return this.length=Math.max(this.length,p),o!==this&&(this.negative=1),this.strip()},u.prototype.sub=function(t){return this.clone().isub(t)};function y(l,t,r){r.negative=t.negative^l.negative;var i=l.length+t.length|0;r.length=i,i=i-1|0;var o=l.words[0]|0,f=t.words[0]|0,c=o*f,p=c&67108863,s=c/67108864|0;r.words[0]=p;for(var e=1;e<i;e++){for(var h=s>>>26,b=s&67108863,S=Math.min(e,t.length-1),B=Math.max(0,e-l.length+1);B<=S;B++){var D=e-B|0;o=l.words[D]|0,f=t.words[B]|0,c=o*f+b,h+=c/67108864|0,b=c&67108863}r.words[e]=b|0,s=h|0}return s!==0?r.words[e]=s|0:r.length--,r.strip()}var x=function(t,r,i){var o=t.words,f=r.words,c=i.words,p=0,s,e,h,b=o[0]|0,S=b&8191,B=b>>>13,D=o[1]|0,N=D&8191,j=D>>>13,bt=o[2]|0,I=bt&8191,U=bt>>>13,de=o[3]|0,L=de&8191,P=de>>>13,ce=o[4]|0,z=ce&8191,K=ce>>>13,ve=o[5]|0,F=ve&8191,$=ve>>>13,pe=o[6]|0,G=pe&8191,H=pe>>>13,me=o[7]|0,J=me&8191,V=me>>>13,ge=o[8]|0,Y=ge&8191,W=ge>>>13,ye=o[9]|0,Q=ye&8191,X=ye>>>13,Me=f[0]|0,tt=Me&8191,et=Me>>>13,we=f[1]|0,rt=we&8191,it=we>>>13,_e=f[2]|0,nt=_e&8191,ot=_e>>>13,xe=f[3]|0,st=xe&8191,ht=xe>>>13,be=f[4]|0,ft=be&8191,at=be>>>13,Se=f[5]|0,ut=Se&8191,lt=Se>>>13,Be=f[6]|0,dt=Be&8191,ct=Be>>>13,Ee=f[7]|0,vt=Ee&8191,pt=Ee>>>13,ke=f[8]|0,mt=ke&8191,gt=ke>>>13,Ae=f[9]|0,yt=Ae&8191,Mt=Ae>>>13;i.negative=t.negative^r.negative,i.length=19,s=Math.imul(S,tt),e=Math.imul(S,et),e=e+Math.imul(B,tt)|0,h=Math.imul(B,et);var Nt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,s=Math.imul(N,tt),e=Math.imul(N,et),e=e+Math.imul(j,tt)|0,h=Math.imul(j,et),s=s+Math.imul(S,rt)|0,e=e+Math.imul(S,it)|0,e=e+Math.imul(B,rt)|0,h=h+Math.imul(B,it)|0;var Ot=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,s=Math.imul(I,tt),e=Math.imul(I,et),e=e+Math.imul(U,tt)|0,h=Math.imul(U,et),s=s+Math.imul(N,rt)|0,e=e+Math.imul(N,it)|0,e=e+Math.imul(j,rt)|0,h=h+Math.imul(j,it)|0,s=s+Math.imul(S,nt)|0,e=e+Math.imul(S,ot)|0,e=e+Math.imul(B,nt)|0,h=h+Math.imul(B,ot)|0;var jt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(jt>>>26)|0,jt&=67108863,s=Math.imul(L,tt),e=Math.imul(L,et),e=e+Math.imul(P,tt)|0,h=Math.imul(P,et),s=s+Math.imul(I,rt)|0,e=e+Math.imul(I,it)|0,e=e+Math.imul(U,rt)|0,h=h+Math.imul(U,it)|0,s=s+Math.imul(N,nt)|0,e=e+Math.imul(N,ot)|0,e=e+Math.imul(j,nt)|0,h=h+Math.imul(j,ot)|0,s=s+Math.imul(S,st)|0,e=e+Math.imul(S,ht)|0,e=e+Math.imul(B,st)|0,h=h+Math.imul(B,ht)|0;var It=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(It>>>26)|0,It&=67108863,s=Math.imul(z,tt),e=Math.imul(z,et),e=e+Math.imul(K,tt)|0,h=Math.imul(K,et),s=s+Math.imul(L,rt)|0,e=e+Math.imul(L,it)|0,e=e+Math.imul(P,rt)|0,h=h+Math.imul(P,it)|0,s=s+Math.imul(I,nt)|0,e=e+Math.imul(I,ot)|0,e=e+Math.imul(U,nt)|0,h=h+Math.imul(U,ot)|0,s=s+Math.imul(N,st)|0,e=e+Math.imul(N,ht)|0,e=e+Math.imul(j,st)|0,h=h+Math.imul(j,ht)|0,s=s+Math.imul(S,ft)|0,e=e+Math.imul(S,at)|0,e=e+Math.imul(B,ft)|0,h=h+Math.imul(B,at)|0;var Ct=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,s=Math.imul(F,tt),e=Math.imul(F,et),e=e+Math.imul($,tt)|0,h=Math.imul($,et),s=s+Math.imul(z,rt)|0,e=e+Math.imul(z,it)|0,e=e+Math.imul(K,rt)|0,h=h+Math.imul(K,it)|0,s=s+Math.imul(L,nt)|0,e=e+Math.imul(L,ot)|0,e=e+Math.imul(P,nt)|0,h=h+Math.imul(P,ot)|0,s=s+Math.imul(I,st)|0,e=e+Math.imul(I,ht)|0,e=e+Math.imul(U,st)|0,h=h+Math.imul(U,ht)|0,s=s+Math.imul(N,ft)|0,e=e+Math.imul(N,at)|0,e=e+Math.imul(j,ft)|0,h=h+Math.imul(j,at)|0,s=s+Math.imul(S,ut)|0,e=e+Math.imul(S,lt)|0,e=e+Math.imul(B,ut)|0,h=h+Math.imul(B,lt)|0;var Ut=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,s=Math.imul(G,tt),e=Math.imul(G,et),e=e+Math.imul(H,tt)|0,h=Math.imul(H,et),s=s+Math.imul(F,rt)|0,e=e+Math.imul(F,it)|0,e=e+Math.imul($,rt)|0,h=h+Math.imul($,it)|0,s=s+Math.imul(z,nt)|0,e=e+Math.imul(z,ot)|0,e=e+Math.imul(K,nt)|0,h=h+Math.imul(K,ot)|0,s=s+Math.imul(L,st)|0,e=e+Math.imul(L,ht)|0,e=e+Math.imul(P,st)|0,h=h+Math.imul(P,ht)|0,s=s+Math.imul(I,ft)|0,e=e+Math.imul(I,at)|0,e=e+Math.imul(U,ft)|0,h=h+Math.imul(U,at)|0,s=s+Math.imul(N,ut)|0,e=e+Math.imul(N,lt)|0,e=e+Math.imul(j,ut)|0,h=h+Math.imul(j,lt)|0,s=s+Math.imul(S,dt)|0,e=e+Math.imul(S,ct)|0,e=e+Math.imul(B,dt)|0,h=h+Math.imul(B,ct)|0;var Zt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,s=Math.imul(J,tt),e=Math.imul(J,et),e=e+Math.imul(V,tt)|0,h=Math.imul(V,et),s=s+Math.imul(G,rt)|0,e=e+Math.imul(G,it)|0,e=e+Math.imul(H,rt)|0,h=h+Math.imul(H,it)|0,s=s+Math.imul(F,nt)|0,e=e+Math.imul(F,ot)|0,e=e+Math.imul($,nt)|0,h=h+Math.imul($,ot)|0,s=s+Math.imul(z,st)|0,e=e+Math.imul(z,ht)|0,e=e+Math.imul(K,st)|0,h=h+Math.imul(K,ht)|0,s=s+Math.imul(L,ft)|0,e=e+Math.imul(L,at)|0,e=e+Math.imul(P,ft)|0,h=h+Math.imul(P,at)|0,s=s+Math.imul(I,ut)|0,e=e+Math.imul(I,lt)|0,e=e+Math.imul(U,ut)|0,h=h+Math.imul(U,lt)|0,s=s+Math.imul(N,dt)|0,e=e+Math.imul(N,ct)|0,e=e+Math.imul(j,dt)|0,h=h+Math.imul(j,ct)|0,s=s+Math.imul(S,vt)|0,e=e+Math.imul(S,pt)|0,e=e+Math.imul(B,vt)|0,h=h+Math.imul(B,pt)|0;var Lt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,s=Math.imul(Y,tt),e=Math.imul(Y,et),e=e+Math.imul(W,tt)|0,h=Math.imul(W,et),s=s+Math.imul(J,rt)|0,e=e+Math.imul(J,it)|0,e=e+Math.imul(V,rt)|0,h=h+Math.imul(V,it)|0,s=s+Math.imul(G,nt)|0,e=e+Math.imul(G,ot)|0,e=e+Math.imul(H,nt)|0,h=h+Math.imul(H,ot)|0,s=s+Math.imul(F,st)|0,e=e+Math.imul(F,ht)|0,e=e+Math.imul($,st)|0,h=h+Math.imul($,ht)|0,s=s+Math.imul(z,ft)|0,e=e+Math.imul(z,at)|0,e=e+Math.imul(K,ft)|0,h=h+Math.imul(K,at)|0,s=s+Math.imul(L,ut)|0,e=e+Math.imul(L,lt)|0,e=e+Math.imul(P,ut)|0,h=h+Math.imul(P,lt)|0,s=s+Math.imul(I,dt)|0,e=e+Math.imul(I,ct)|0,e=e+Math.imul(U,dt)|0,h=h+Math.imul(U,ct)|0,s=s+Math.imul(N,vt)|0,e=e+Math.imul(N,pt)|0,e=e+Math.imul(j,vt)|0,h=h+Math.imul(j,pt)|0,s=s+Math.imul(S,mt)|0,e=e+Math.imul(S,gt)|0,e=e+Math.imul(B,mt)|0,h=h+Math.imul(B,gt)|0;var Pt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,s=Math.imul(Q,tt),e=Math.imul(Q,et),e=e+Math.imul(X,tt)|0,h=Math.imul(X,et),s=s+Math.imul(Y,rt)|0,e=e+Math.imul(Y,it)|0,e=e+Math.imul(W,rt)|0,h=h+Math.imul(W,it)|0,s=s+Math.imul(J,nt)|0,e=e+Math.imul(J,ot)|0,e=e+Math.imul(V,nt)|0,h=h+Math.imul(V,ot)|0,s=s+Math.imul(G,st)|0,e=e+Math.imul(G,ht)|0,e=e+Math.imul(H,st)|0,h=h+Math.imul(H,ht)|0,s=s+Math.imul(F,ft)|0,e=e+Math.imul(F,at)|0,e=e+Math.imul($,ft)|0,h=h+Math.imul($,at)|0,s=s+Math.imul(z,ut)|0,e=e+Math.imul(z,lt)|0,e=e+Math.imul(K,ut)|0,h=h+Math.imul(K,lt)|0,s=s+Math.imul(L,dt)|0,e=e+Math.imul(L,ct)|0,e=e+Math.imul(P,dt)|0,h=h+Math.imul(P,ct)|0,s=s+Math.imul(I,vt)|0,e=e+Math.imul(I,pt)|0,e=e+Math.imul(U,vt)|0,h=h+Math.imul(U,pt)|0,s=s+Math.imul(N,mt)|0,e=e+Math.imul(N,gt)|0,e=e+Math.imul(j,mt)|0,h=h+Math.imul(j,gt)|0,s=s+Math.imul(S,yt)|0,e=e+Math.imul(S,Mt)|0,e=e+Math.imul(B,yt)|0,h=h+Math.imul(B,Mt)|0;var zt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(zt>>>26)|0,zt&=67108863,s=Math.imul(Q,rt),e=Math.imul(Q,it),e=e+Math.imul(X,rt)|0,h=Math.imul(X,it),s=s+Math.imul(Y,nt)|0,e=e+Math.imul(Y,ot)|0,e=e+Math.imul(W,nt)|0,h=h+Math.imul(W,ot)|0,s=s+Math.imul(J,st)|0,e=e+Math.imul(J,ht)|0,e=e+Math.imul(V,st)|0,h=h+Math.imul(V,ht)|0,s=s+Math.imul(G,ft)|0,e=e+Math.imul(G,at)|0,e=e+Math.imul(H,ft)|0,h=h+Math.imul(H,at)|0,s=s+Math.imul(F,ut)|0,e=e+Math.imul(F,lt)|0,e=e+Math.imul($,ut)|0,h=h+Math.imul($,lt)|0,s=s+Math.imul(z,dt)|0,e=e+Math.imul(z,ct)|0,e=e+Math.imul(K,dt)|0,h=h+Math.imul(K,ct)|0,s=s+Math.imul(L,vt)|0,e=e+Math.imul(L,pt)|0,e=e+Math.imul(P,vt)|0,h=h+Math.imul(P,pt)|0,s=s+Math.imul(I,mt)|0,e=e+Math.imul(I,gt)|0,e=e+Math.imul(U,mt)|0,h=h+Math.imul(U,gt)|0,s=s+Math.imul(N,yt)|0,e=e+Math.imul(N,Mt)|0,e=e+Math.imul(j,yt)|0,h=h+Math.imul(j,Mt)|0;var Kt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,s=Math.imul(Q,nt),e=Math.imul(Q,ot),e=e+Math.imul(X,nt)|0,h=Math.imul(X,ot),s=s+Math.imul(Y,st)|0,e=e+Math.imul(Y,ht)|0,e=e+Math.imul(W,st)|0,h=h+Math.imul(W,ht)|0,s=s+Math.imul(J,ft)|0,e=e+Math.imul(J,at)|0,e=e+Math.imul(V,ft)|0,h=h+Math.imul(V,at)|0,s=s+Math.imul(G,ut)|0,e=e+Math.imul(G,lt)|0,e=e+Math.imul(H,ut)|0,h=h+Math.imul(H,lt)|0,s=s+Math.imul(F,dt)|0,e=e+Math.imul(F,ct)|0,e=e+Math.imul($,dt)|0,h=h+Math.imul($,ct)|0,s=s+Math.imul(z,vt)|0,e=e+Math.imul(z,pt)|0,e=e+Math.imul(K,vt)|0,h=h+Math.imul(K,pt)|0,s=s+Math.imul(L,mt)|0,e=e+Math.imul(L,gt)|0,e=e+Math.imul(P,mt)|0,h=h+Math.imul(P,gt)|0,s=s+Math.imul(I,yt)|0,e=e+Math.imul(I,Mt)|0,e=e+Math.imul(U,yt)|0,h=h+Math.imul(U,Mt)|0;var Ft=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,s=Math.imul(Q,st),e=Math.imul(Q,ht),e=e+Math.imul(X,st)|0,h=Math.imul(X,ht),s=s+Math.imul(Y,ft)|0,e=e+Math.imul(Y,at)|0,e=e+Math.imul(W,ft)|0,h=h+Math.imul(W,at)|0,s=s+Math.imul(J,ut)|0,e=e+Math.imul(J,lt)|0,e=e+Math.imul(V,ut)|0,h=h+Math.imul(V,lt)|0,s=s+Math.imul(G,dt)|0,e=e+Math.imul(G,ct)|0,e=e+Math.imul(H,dt)|0,h=h+Math.imul(H,ct)|0,s=s+Math.imul(F,vt)|0,e=e+Math.imul(F,pt)|0,e=e+Math.imul($,vt)|0,h=h+Math.imul($,pt)|0,s=s+Math.imul(z,mt)|0,e=e+Math.imul(z,gt)|0,e=e+Math.imul(K,mt)|0,h=h+Math.imul(K,gt)|0,s=s+Math.imul(L,yt)|0,e=e+Math.imul(L,Mt)|0,e=e+Math.imul(P,yt)|0,h=h+Math.imul(P,Mt)|0;var $t=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+($t>>>26)|0,$t&=67108863,s=Math.imul(Q,ft),e=Math.imul(Q,at),e=e+Math.imul(X,ft)|0,h=Math.imul(X,at),s=s+Math.imul(Y,ut)|0,e=e+Math.imul(Y,lt)|0,e=e+Math.imul(W,ut)|0,h=h+Math.imul(W,lt)|0,s=s+Math.imul(J,dt)|0,e=e+Math.imul(J,ct)|0,e=e+Math.imul(V,dt)|0,h=h+Math.imul(V,ct)|0,s=s+Math.imul(G,vt)|0,e=e+Math.imul(G,pt)|0,e=e+Math.imul(H,vt)|0,h=h+Math.imul(H,pt)|0,s=s+Math.imul(F,mt)|0,e=e+Math.imul(F,gt)|0,e=e+Math.imul($,mt)|0,h=h+Math.imul($,gt)|0,s=s+Math.imul(z,yt)|0,e=e+Math.imul(z,Mt)|0,e=e+Math.imul(K,yt)|0,h=h+Math.imul(K,Mt)|0;var Gt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,s=Math.imul(Q,ut),e=Math.imul(Q,lt),e=e+Math.imul(X,ut)|0,h=Math.imul(X,lt),s=s+Math.imul(Y,dt)|0,e=e+Math.imul(Y,ct)|0,e=e+Math.imul(W,dt)|0,h=h+Math.imul(W,ct)|0,s=s+Math.imul(J,vt)|0,e=e+Math.imul(J,pt)|0,e=e+Math.imul(V,vt)|0,h=h+Math.imul(V,pt)|0,s=s+Math.imul(G,mt)|0,e=e+Math.imul(G,gt)|0,e=e+Math.imul(H,mt)|0,h=h+Math.imul(H,gt)|0,s=s+Math.imul(F,yt)|0,e=e+Math.imul(F,Mt)|0,e=e+Math.imul($,yt)|0,h=h+Math.imul($,Mt)|0;var Ht=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,s=Math.imul(Q,dt),e=Math.imul(Q,ct),e=e+Math.imul(X,dt)|0,h=Math.imul(X,ct),s=s+Math.imul(Y,vt)|0,e=e+Math.imul(Y,pt)|0,e=e+Math.imul(W,vt)|0,h=h+Math.imul(W,pt)|0,s=s+Math.imul(J,mt)|0,e=e+Math.imul(J,gt)|0,e=e+Math.imul(V,mt)|0,h=h+Math.imul(V,gt)|0,s=s+Math.imul(G,yt)|0,e=e+Math.imul(G,Mt)|0,e=e+Math.imul(H,yt)|0,h=h+Math.imul(H,Mt)|0;var Jt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,s=Math.imul(Q,vt),e=Math.imul(Q,pt),e=e+Math.imul(X,vt)|0,h=Math.imul(X,pt),s=s+Math.imul(Y,mt)|0,e=e+Math.imul(Y,gt)|0,e=e+Math.imul(W,mt)|0,h=h+Math.imul(W,gt)|0,s=s+Math.imul(J,yt)|0,e=e+Math.imul(J,Mt)|0,e=e+Math.imul(V,yt)|0,h=h+Math.imul(V,Mt)|0;var Vt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,s=Math.imul(Q,mt),e=Math.imul(Q,gt),e=e+Math.imul(X,mt)|0,h=Math.imul(X,gt),s=s+Math.imul(Y,yt)|0,e=e+Math.imul(Y,Mt)|0,e=e+Math.imul(W,yt)|0,h=h+Math.imul(W,Mt)|0;var Yt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Yt>>>26)|0,Yt&=67108863,s=Math.imul(Q,yt),e=Math.imul(Q,Mt),e=e+Math.imul(X,yt)|0,h=Math.imul(X,Mt);var Wt=(p+s|0)+((e&8191)<<13)|0;return p=(h+(e>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,c[0]=Nt,c[1]=Ot,c[2]=jt,c[3]=It,c[4]=Ct,c[5]=Ut,c[6]=Zt,c[7]=Lt,c[8]=Pt,c[9]=zt,c[10]=Kt,c[11]=Ft,c[12]=$t,c[13]=Gt,c[14]=Ht,c[15]=Jt,c[16]=Vt,c[17]=Yt,c[18]=Wt,p!==0&&(c[19]=p,i.length++),i};Math.imul||(x=y);function q(l,t,r){r.negative=t.negative^l.negative,r.length=l.length+t.length;for(var i=0,o=0,f=0;f<r.length-1;f++){var c=o;o=0;for(var p=i&67108863,s=Math.min(f,t.length-1),e=Math.max(0,f-l.length+1);e<=s;e++){var h=f-e,b=l.words[h]|0,S=t.words[e]|0,B=b*S,D=B&67108863;c=c+(B/67108864|0)|0,D=D+p|0,p=D&67108863,c=c+(D>>>26)|0,o+=c>>>26,c&=67108863}r.words[f]=p,i=c,c=o}return i!==0?r.words[f]=i:r.length--,r.strip()}function R(l,t,r){var i=new O;return i.mulp(l,t,r)}u.prototype.mulTo=function(t,r){var i,o=this.length+t.length;return this.length===10&&t.length===10?i=x(this,t,r):o<63?i=y(this,t,r):o<1024?i=q(this,t,r):i=R(this,t,r),i};function O(l,t){this.x=l,this.y=t}O.prototype.makeRBT=function(t){for(var r=new Array(t),i=u.prototype._countBits(t)-1,o=0;o<t;o++)r[o]=this.revBin(o,i,t);return r},O.prototype.revBin=function(t,r,i){if(t===0||t===i-1)return t;for(var o=0,f=0;f<r;f++)o|=(t&1)<<r-f-1,t>>=1;return o},O.prototype.permute=function(t,r,i,o,f,c){for(var p=0;p<c;p++)o[p]=r[t[p]],f[p]=i[t[p]]},O.prototype.transform=function(t,r,i,o,f,c){this.permute(c,t,r,i,o,f);for(var p=1;p<f;p<<=1)for(var s=p<<1,e=Math.cos(2*Math.PI/s),h=Math.sin(2*Math.PI/s),b=0;b<f;b+=s)for(var S=e,B=h,D=0;D<p;D++){var N=i[b+D],j=o[b+D],bt=i[b+D+p],I=o[b+D+p],U=S*bt-B*I;I=S*I+B*bt,bt=U,i[b+D]=N+bt,o[b+D]=j+I,i[b+D+p]=N-bt,o[b+D+p]=j-I,D!==s&&(U=e*S-h*B,B=e*B+h*S,S=U)}},O.prototype.guessLen13b=function(t,r){var i=Math.max(r,t)|1,o=i&1,f=0;for(i=i/2|0;i;i=i>>>1)f++;return 1<<f+1+o},O.prototype.conjugate=function(t,r,i){if(!(i<=1))for(var o=0;o<i/2;o++){var f=t[o];t[o]=t[i-o-1],t[i-o-1]=f,f=r[o],r[o]=-r[i-o-1],r[i-o-1]=-f}},O.prototype.normalize13b=function(t,r){for(var i=0,o=0;o<r/2;o++){var f=Math.round(t[2*o+1]/r)*8192+Math.round(t[2*o]/r)+i;t[o]=f&67108863,f<67108864?i=0:i=f/67108864|0}return t},O.prototype.convert13b=function(t,r,i,o){for(var f=0,c=0;c<r;c++)f=f+(t[c]|0),i[2*c]=f&8191,f=f>>>13,i[2*c+1]=f&8191,f=f>>>13;for(c=2*r;c<o;++c)i[c]=0;m(f===0),m((f&-8192)===0)},O.prototype.stub=function(t){for(var r=new Array(t),i=0;i<t;i++)r[i]=0;return r},O.prototype.mulp=function(t,r,i){var o=2*this.guessLen13b(t.length,r.length),f=this.makeRBT(o),c=this.stub(o),p=new Array(o),s=new Array(o),e=new Array(o),h=new Array(o),b=new Array(o),S=new Array(o),B=i.words;B.length=o,this.convert13b(t.words,t.length,p,o),this.convert13b(r.words,r.length,h,o),this.transform(p,c,s,e,o,f),this.transform(h,c,b,S,o,f);for(var D=0;D<o;D++){var N=s[D]*b[D]-e[D]*S[D];e[D]=s[D]*S[D]+e[D]*b[D],s[D]=N}return this.conjugate(s,e,o),this.transform(s,e,B,c,o,f),this.conjugate(B,c,o),this.normalize13b(B,o),i.negative=t.negative^r.negative,i.length=t.length+r.length,i.strip()},u.prototype.mul=function(t){var r=new u(null);return r.words=new Array(this.length+t.length),this.mulTo(t,r)},u.prototype.mulf=function(t){var r=new u(null);return r.words=new Array(this.length+t.length),R(this,t,r)},u.prototype.imul=function(t){return this.clone().mulTo(t,this)},u.prototype.imuln=function(t){m(typeof t=="number"),m(t<67108864);for(var r=0,i=0;i<this.length;i++){var o=(this.words[i]|0)*t,f=(o&67108863)+(r&67108863);r>>=26,r+=o/67108864|0,r+=f>>>26,this.words[i]=f&67108863}return r!==0&&(this.words[i]=r,this.length++),this},u.prototype.muln=function(t){return this.clone().imuln(t)},u.prototype.sqr=function(){return this.mul(this)},u.prototype.isqr=function(){return this.imul(this.clone())},u.prototype.pow=function(t){var r=d(t);if(r.length===0)return new u(1);for(var i=this,o=0;o<r.length&&r[o]===0;o++,i=i.sqr());if(++o<r.length)for(var f=i.sqr();o<r.length;o++,f=f.sqr())r[o]!==0&&(i=i.mul(f));return i},u.prototype.iushln=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26,o=67108863>>>26-r<<26-r,f;if(r!==0){var c=0;for(f=0;f<this.length;f++){var p=this.words[f]&o,s=(this.words[f]|0)-p<<r;this.words[f]=s|c,c=p>>>26-r}c&&(this.words[f]=c,this.length++)}if(i!==0){for(f=this.length-1;f>=0;f--)this.words[f+i]=this.words[f];for(f=0;f<i;f++)this.words[f]=0;this.length+=i}return this.strip()},u.prototype.ishln=function(t){return m(this.negative===0),this.iushln(t)},u.prototype.iushrn=function(t,r,i){m(typeof t=="number"&&t>=0);var o;r?o=(r-r%26)/26:o=0;var f=t%26,c=Math.min((t-f)/26,this.length),p=67108863^67108863>>>f<<f,s=i;if(o-=c,o=Math.max(0,o),s){for(var e=0;e<c;e++)s.words[e]=this.words[e];s.length=c}if(c!==0)if(this.length>c)for(this.length-=c,e=0;e<this.length;e++)this.words[e]=this.words[e+c];else this.words[0]=0,this.length=1;var h=0;for(e=this.length-1;e>=0&&(h!==0||e>=o);e--){var b=this.words[e]|0;this.words[e]=h<<26-f|b>>>f,h=b&p}return s&&h!==0&&(s.words[s.length++]=h),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},u.prototype.ishrn=function(t,r,i){return m(this.negative===0),this.iushrn(t,r,i)},u.prototype.shln=function(t){return this.clone().ishln(t)},u.prototype.ushln=function(t){return this.clone().iushln(t)},u.prototype.shrn=function(t){return this.clone().ishrn(t)},u.prototype.ushrn=function(t){return this.clone().iushrn(t)},u.prototype.testn=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26,o=1<<r;if(this.length<=i)return!1;var f=this.words[i];return!!(f&o)},u.prototype.imaskn=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26;if(m(this.negative===0,"imaskn works only with positive numbers"),this.length<=i)return this;if(r!==0&&i++,this.length=Math.min(i,this.length),r!==0){var o=67108863^67108863>>>r<<r;this.words[this.length-1]&=o}return this.strip()},u.prototype.maskn=function(t){return this.clone().imaskn(t)},u.prototype.iaddn=function(t){return m(typeof t=="number"),m(t<67108864),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},u.prototype._iaddn=function(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++)this.words[r]-=67108864,r===this.length-1?this.words[r+1]=1:this.words[r+1]++;return this.length=Math.max(this.length,r+1),this},u.prototype.isubn=function(t){if(m(typeof t=="number"),m(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var r=0;r<this.length&&this.words[r]<0;r++)this.words[r]+=67108864,this.words[r+1]-=1;return this.strip()},u.prototype.addn=function(t){return this.clone().iaddn(t)},u.prototype.subn=function(t){return this.clone().isubn(t)},u.prototype.iabs=function(){return this.negative=0,this},u.prototype.abs=function(){return this.clone().iabs()},u.prototype._ishlnsubmul=function(t,r,i){var o=t.length+i,f;this._expand(o);var c,p=0;for(f=0;f<t.length;f++){c=(this.words[f+i]|0)+p;var s=(t.words[f]|0)*r;c-=s&67108863,p=(c>>26)-(s/67108864|0),this.words[f+i]=c&67108863}for(;f<this.length-i;f++)c=(this.words[f+i]|0)+p,p=c>>26,this.words[f+i]=c&67108863;if(p===0)return this.strip();for(m(p===-1),p=0,f=0;f<this.length;f++)c=-(this.words[f]|0)+p,p=c>>26,this.words[f]=c&67108863;return this.negative=1,this.strip()},u.prototype._wordDiv=function(t,r){var i=this.length-t.length,o=this.clone(),f=t,c=f.words[f.length-1]|0,p=this._countBits(c);i=26-p,i!==0&&(f=f.ushln(i),o.iushln(i),c=f.words[f.length-1]|0);var s=o.length-f.length,e;if(r!=="mod"){e=new u(null),e.length=s+1,e.words=new Array(e.length);for(var h=0;h<e.length;h++)e.words[h]=0}var b=o.clone()._ishlnsubmul(f,1,s);b.negative===0&&(o=b,e&&(e.words[s]=1));for(var S=s-1;S>=0;S--){var B=(o.words[f.length+S]|0)*67108864+(o.words[f.length+S-1]|0);for(B=Math.min(B/c|0,67108863),o._ishlnsubmul(f,B,S);o.negative!==0;)B--,o.negative=0,o._ishlnsubmul(f,1,S),o.isZero()||(o.negative^=1);e&&(e.words[S]=B)}return e&&e.strip(),o.strip(),r!=="div"&&i!==0&&o.iushrn(i),{div:e||null,mod:o}},u.prototype.divmod=function(t,r,i){if(m(!t.isZero()),this.isZero())return{div:new u(0),mod:new u(0)};var o,f,c;return this.negative!==0&&t.negative===0?(c=this.neg().divmod(t,r),r!=="mod"&&(o=c.div.neg()),r!=="div"&&(f=c.mod.neg(),i&&f.negative!==0&&f.iadd(t)),{div:o,mod:f}):this.negative===0&&t.negative!==0?(c=this.divmod(t.neg(),r),r!=="mod"&&(o=c.div.neg()),{div:o,mod:c.mod}):this.negative&t.negative?(c=this.neg().divmod(t.neg(),r),r!=="div"&&(f=c.mod.neg(),i&&f.negative!==0&&f.isub(t)),{div:c.div,mod:f}):t.length>this.length||this.cmp(t)<0?{div:new u(0),mod:this}:t.length===1?r==="div"?{div:this.divn(t.words[0]),mod:null}:r==="mod"?{div:null,mod:new u(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new u(this.modn(t.words[0]))}:this._wordDiv(t,r)},u.prototype.div=function(t){return this.divmod(t,"div",!1).div},u.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},u.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},u.prototype.divRound=function(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var i=r.div.negative!==0?r.mod.isub(t):r.mod,o=t.ushrn(1),f=t.andln(1),c=i.cmp(o);return c<0||f===1&&c===0?r.div:r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)},u.prototype.modn=function(t){m(t<=67108863);for(var r=(1<<26)%t,i=0,o=this.length-1;o>=0;o--)i=(r*i+(this.words[o]|0))%t;return i},u.prototype.idivn=function(t){m(t<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(this.words[i]|0)+r*67108864;this.words[i]=o/t|0,r=o%t}return this.strip()},u.prototype.divn=function(t){return this.clone().idivn(t)},u.prototype.egcd=function(t){m(t.negative===0),m(!t.isZero());var r=this,i=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var o=new u(1),f=new u(0),c=new u(0),p=new u(1),s=0;r.isEven()&&i.isEven();)r.iushrn(1),i.iushrn(1),++s;for(var e=i.clone(),h=r.clone();!r.isZero();){for(var b=0,S=1;!(r.words[0]&S)&&b<26;++b,S<<=1);if(b>0)for(r.iushrn(b);b-- >0;)(o.isOdd()||f.isOdd())&&(o.iadd(e),f.isub(h)),o.iushrn(1),f.iushrn(1);for(var B=0,D=1;!(i.words[0]&D)&&B<26;++B,D<<=1);if(B>0)for(i.iushrn(B);B-- >0;)(c.isOdd()||p.isOdd())&&(c.iadd(e),p.isub(h)),c.iushrn(1),p.iushrn(1);r.cmp(i)>=0?(r.isub(i),o.isub(c),f.isub(p)):(i.isub(r),c.isub(o),p.isub(f))}return{a:c,b:p,gcd:i.iushln(s)}},u.prototype._invmp=function(t){m(t.negative===0),m(!t.isZero());var r=this,i=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var o=new u(1),f=new u(0),c=i.clone();r.cmpn(1)>0&&i.cmpn(1)>0;){for(var p=0,s=1;!(r.words[0]&s)&&p<26;++p,s<<=1);if(p>0)for(r.iushrn(p);p-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var e=0,h=1;!(i.words[0]&h)&&e<26;++e,h<<=1);if(e>0)for(i.iushrn(e);e-- >0;)f.isOdd()&&f.iadd(c),f.iushrn(1);r.cmp(i)>=0?(r.isub(i),o.isub(f)):(i.isub(r),f.isub(o))}var b;return r.cmpn(1)===0?b=o:b=f,b.cmpn(0)<0&&b.iadd(t),b},u.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone(),i=t.clone();r.negative=0,i.negative=0;for(var o=0;r.isEven()&&i.isEven();o++)r.iushrn(1),i.iushrn(1);do{for(;r.isEven();)r.iushrn(1);for(;i.isEven();)i.iushrn(1);var f=r.cmp(i);if(f<0){var c=r;r=i,i=c}else if(f===0||i.cmpn(1)===0)break;r.isub(i)}while(!0);return i.iushln(o)},u.prototype.invm=function(t){return this.egcd(t).a.umod(t)},u.prototype.isEven=function(){return(this.words[0]&1)===0},u.prototype.isOdd=function(){return(this.words[0]&1)===1},u.prototype.andln=function(t){return this.words[0]&t},u.prototype.bincn=function(t){m(typeof t=="number");var r=t%26,i=(t-r)/26,o=1<<r;if(this.length<=i)return this._expand(i+1),this.words[i]|=o,this;for(var f=o,c=i;f!==0&&c<this.length;c++){var p=this.words[c]|0;p+=f,f=p>>>26,p&=67108863,this.words[c]=p}return f!==0&&(this.words[c]=f,this.length++),this},u.prototype.isZero=function(){return this.length===1&&this.words[0]===0},u.prototype.cmpn=function(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var i;if(this.length>1)i=1;else{r&&(t=-t),m(t<=67108863,"Number is too big");var o=this.words[0]|0;i=o===t?0:o<t?-1:1}return this.negative!==0?-i|0:i},u.prototype.cmp=function(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);return this.negative!==0?-r|0:r},u.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var r=0,i=this.length-1;i>=0;i--){var o=this.words[i]|0,f=t.words[i]|0;if(o!==f){o<f?r=-1:o>f&&(r=1);break}}return r},u.prototype.gtn=function(t){return this.cmpn(t)===1},u.prototype.gt=function(t){return this.cmp(t)===1},u.prototype.gten=function(t){return this.cmpn(t)>=0},u.prototype.gte=function(t){return this.cmp(t)>=0},u.prototype.ltn=function(t){return this.cmpn(t)===-1},u.prototype.lt=function(t){return this.cmp(t)===-1},u.prototype.lten=function(t){return this.cmpn(t)<=0},u.prototype.lte=function(t){return this.cmp(t)<=0},u.prototype.eqn=function(t){return this.cmpn(t)===0},u.prototype.eq=function(t){return this.cmp(t)===0},u.red=function(t){return new Z(t)},u.prototype.toRed=function(t){return m(!this.red,"Already a number in reduction context"),m(this.negative===0,"red works only with positives"),t.convertTo(this)._forceRed(t)},u.prototype.fromRed=function(){return m(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},u.prototype._forceRed=function(t){return this.red=t,this},u.prototype.forceRed=function(t){return m(!this.red,"Already a number in reduction context"),this._forceRed(t)},u.prototype.redAdd=function(t){return m(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},u.prototype.redIAdd=function(t){return m(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},u.prototype.redSub=function(t){return m(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},u.prototype.redISub=function(t){return m(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},u.prototype.redShl=function(t){return m(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},u.prototype.redMul=function(t){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},u.prototype.redIMul=function(t){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},u.prototype.redSqr=function(){return m(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},u.prototype.redISqr=function(){return m(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},u.prototype.redSqrt=function(){return m(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},u.prototype.redInvm=function(){return m(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},u.prototype.redNeg=function(){return m(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},u.prototype.redPow=function(t){return m(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var wt={k256:null,p224:null,p192:null,p25519:null};function C(l,t){this.name=l,this.p=new u(t,16),this.n=this.p.bitLength(),this.k=new u(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var t=new u(null);return t.words=new Array(Math.ceil(this.n/13)),t},C.prototype.ireduce=function(t){var r=t,i;do this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),i=r.bitLength();while(i>this.n);var o=i<this.n?-1:r.ucmp(this.p);return o===0?(r.words[0]=0,r.length=1):o>0?r.isub(this.p):r.strip!==void 0?r.strip():r._strip(),r},C.prototype.split=function(t,r){t.iushrn(this.n,0,r)},C.prototype.imulK=function(t){return t.imul(this.k)};function _t(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}A(_t,C),_t.prototype.split=function(t,r){for(var i=4194303,o=Math.min(t.length,9),f=0;f<o;f++)r.words[f]=t.words[f];if(r.length=o,t.length<=9){t.words[0]=0,t.length=1;return}var c=t.words[9];for(r.words[r.length++]=c&i,f=10;f<t.length;f++){var p=t.words[f]|0;t.words[f-10]=(p&i)<<4|c>>>22,c=p}c>>>=22,t.words[f-10]=c,c===0&&t.length>10?t.length-=10:t.length-=9},_t.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var r=0,i=0;i<t.length;i++){var o=t.words[i]|0;r+=o*977,t.words[i]=r&67108863,r=o*64+(r/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t};function Et(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}A(Et,C);function Dt(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}A(Dt,C);function At(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}A(At,C),At.prototype.imulK=function(t){for(var r=0,i=0;i<t.length;i++){var o=(t.words[i]|0)*19+r,f=o&67108863;o>>>=26,t.words[i]=f,r=o}return r!==0&&(t.words[t.length++]=r),t},u._prime=function(t){if(wt[t])return wt[t];var r;if(t==="k256")r=new _t;else if(t==="p224")r=new Et;else if(t==="p192")r=new Dt;else if(t==="p25519")r=new At;else throw new Error("Unknown prime "+t);return wt[t]=r,r};function Z(l){if(typeof l=="string"){var t=u._prime(l);this.m=t.p,this.prime=t}else m(l.gtn(1),"modulus must be greater than 1"),this.m=l,this.prime=null}Z.prototype._verify1=function(t){m(t.negative===0,"red works only with positives"),m(t.red,"red works only with red numbers")},Z.prototype._verify2=function(t,r){m((t.negative|r.negative)===0,"red works only with positives"),m(t.red&&t.red===r.red,"red works only with red numbers")},Z.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},Z.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},Z.prototype.add=function(t,r){this._verify2(t,r);var i=t.add(r);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},Z.prototype.iadd=function(t,r){this._verify2(t,r);var i=t.iadd(r);return i.cmp(this.m)>=0&&i.isub(this.m),i},Z.prototype.sub=function(t,r){this._verify2(t,r);var i=t.sub(r);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},Z.prototype.isub=function(t,r){this._verify2(t,r);var i=t.isub(r);return i.cmpn(0)<0&&i.iadd(this.m),i},Z.prototype.shl=function(t,r){return this._verify1(t),this.imod(t.ushln(r))},Z.prototype.imul=function(t,r){return this._verify2(t,r),this.imod(t.imul(r))},Z.prototype.mul=function(t,r){return this._verify2(t,r),this.imod(t.mul(r))},Z.prototype.isqr=function(t){return this.imul(t,t.clone())},Z.prototype.sqr=function(t){return this.mul(t,t)},Z.prototype.sqrt=function(t){if(t.isZero())return t.clone();var r=this.m.andln(3);if(m(r%2===1),r===3){var i=this.m.add(new u(1)).iushrn(2);return this.pow(t,i)}for(var o=this.m.subn(1),f=0;!o.isZero()&&o.andln(1)===0;)f++,o.iushrn(1);m(!o.isZero());var c=new u(1).toRed(this),p=c.redNeg(),s=this.m.subn(1).iushrn(1),e=this.m.bitLength();for(e=new u(2*e*e).toRed(this);this.pow(e,s).cmp(p)!==0;)e.redIAdd(p);for(var h=this.pow(e,o),b=this.pow(t,o.addn(1).iushrn(1)),S=this.pow(t,o),B=f;S.cmp(c)!==0;){for(var D=S,N=0;D.cmp(c)!==0;N++)D=D.redSqr();m(N<B);var j=this.pow(h,new u(1).iushln(B-N-1));b=b.redMul(j),h=j.redSqr(),S=S.redMul(h),B=N}return b},Z.prototype.invm=function(t){var r=t._invmp(this.m);return r.negative!==0?(r.negative=0,this.imod(r).redNeg()):this.imod(r)},Z.prototype.pow=function(t,r){if(r.isZero())return new u(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var i=4,o=new Array(1<<i);o[0]=new u(1).toRed(this),o[1]=t;for(var f=2;f<o.length;f++)o[f]=this.mul(o[f-1],t);var c=o[0],p=0,s=0,e=r.bitLength()%26;for(e===0&&(e=26),f=r.length-1;f>=0;f--){for(var h=r.words[f],b=e-1;b>=0;b--){var S=h>>b&1;if(c!==o[0]&&(c=this.sqr(c)),S===0&&p===0){s=0;continue}p<<=1,p|=S,s++,!(s!==i&&(f!==0||b!==0))&&(c=this.mul(c,o[p]),s=0,p=0)}e=26}return c},Z.prototype.convertTo=function(t){var r=t.umod(this.m);return r===t?r.clone():r},Z.prototype.convertFrom=function(t){var r=t.clone();return r.red=null,r},u.mont=function(t){return new St(t)};function St(l){Z.call(this,l),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new u(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}A(St,Z),St.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},St.prototype.convertFrom=function(t){var r=this.imod(t.mul(this.rinv));return r.red=null,r},St.prototype.imul=function(t,r){if(t.isZero()||r.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(r),o=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(o).iushrn(this.shift),c=f;return f.cmp(this.m)>=0?c=f.isub(this.m):f.cmpn(0)<0&&(c=f.iadd(this.m)),c._forceRed(this)},St.prototype.mul=function(t,r){if(t.isZero()||r.isZero())return new u(0)._forceRed(this);var i=t.mul(r),o=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(o).iushrn(this.shift),c=f;return f.cmp(this.m)>=0?c=f.isub(this.m):f.cmpn(0)<0&&(c=f.iadd(this.m)),c._forceRed(this)},St.prototype.invm=function(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(k,He)})(ue);var Ye=ue.exports,Xt={},qe;function We(){return qe||(qe=1,function(k){var w=le(),E=Bt,m=k;m.define=function(M,_){return new A(M,_)};function A(u,M){this.name=u,this.body=M,this.decoders={},this.encoders={}}A.prototype._createNamed=function(M){var _;try{_=Ve().runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{_=function(g){this._initNamed(g)}}return E(_,M),_.prototype._initNamed=function(g){M.call(this,g)},new _(this)},A.prototype._getDecoder=function(M){return M=M||"der",this.decoders.hasOwnProperty(M)||(this.decoders[M]=this._createNamed(w.decoders[M])),this.decoders[M]},A.prototype.decode=function(M,_,T){return this._getDecoder(_).decode(M,T)},A.prototype._getEncoder=function(M){return M=M||"der",this.encoders.hasOwnProperty(M)||(this.encoders[M]=this._createNamed(w.encoders[M])),this.encoders[M]},A.prototype.encode=function(M,_,T){return this._getEncoder(_).encode(M,T)}}(Xt)),Xt}var te={},Ke={},Qe=Bt;function xt(k){this._reporterState={obj:null,path:[],options:k||{},errors:[]}}Ke.Reporter=xt;xt.prototype.isError=function(w){return w instanceof kt};xt.prototype.save=function(){var w=this._reporterState;return{obj:w.obj,pathLen:w.path.length}};xt.prototype.restore=function(w){var E=this._reporterState;E.obj=w.obj,E.path=E.path.slice(0,w.pathLen)};xt.prototype.enterKey=function(w){return this._reporterState.path.push(w)};xt.prototype.exitKey=function(w){var E=this._reporterState;E.path=E.path.slice(0,w-1)};xt.prototype.leaveKey=function(w,E,m){var A=this._reporterState;this.exitKey(w),A.obj!==null&&(A.obj[E]=m)};xt.prototype.path=function(){return this._reporterState.path.join("/")};xt.prototype.enterObject=function(){var w=this._reporterState,E=w.obj;return w.obj={},E};xt.prototype.leaveObject=function(w){var E=this._reporterState,m=E.obj;return E.obj=w,m};xt.prototype.error=function(w){var E,m=this._reporterState,A=w instanceof kt;if(A?E=w:E=new kt(m.path.map(function(u){return"["+JSON.stringify(u)+"]"}).join(""),w.message||w,w.stack),!m.options.partial)throw E;return A||m.errors.push(E),E};xt.prototype.wrapResult=function(w){var E=this._reporterState;return E.options.partial?{result:this.isError(w)?null:w,errors:E.errors}:w};function kt(k,w){this.path=k,this.rethrow(w)}Qe(kt,Error);kt.prototype.rethrow=function(w){if(this.message=w+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,kt),!this.stack)try{throw new Error(this.message)}catch(E){this.stack=E.stack}return this};var Rt={},De;function Re(){if(De)return Rt;De=1;var k=Bt,w=qt().Reporter,E=Tt().Buffer;function m(u,M){if(w.call(this,M),!E.isBuffer(u)){this.error("Input not Buffer");return}this.base=u,this.offset=0,this.length=u.length}k(m,w),Rt.DecoderBuffer=m,m.prototype.save=function(){return{offset:this.offset,reporter:w.prototype.save.call(this)}},m.prototype.restore=function(M){var _=new m(this.base);return _.offset=M.offset,_.length=this.offset,this.offset=M.offset,w.prototype.restore.call(this,M.reporter),_},m.prototype.isEmpty=function(){return this.offset===this.length},m.prototype.readUInt8=function(M){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(M||"DecoderBuffer overrun")},m.prototype.skip=function(M,_){if(!(this.offset+M<=this.length))return this.error(_||"DecoderBuffer overrun");var T=new m(this.base);return T._reporterState=this._reporterState,T.offset=this.offset,T.length=this.offset+M,this.offset+=M,T},m.prototype.raw=function(M){return this.base.slice(M?M.offset:this.offset,this.length)};function A(u,M){if(Array.isArray(u))this.length=0,this.value=u.map(function(_){return _ instanceof A||(_=new A(_,M)),this.length+=_.length,_},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return M.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=E.byteLength(u);else if(E.isBuffer(u))this.value=u,this.length=u.length;else return M.error("Unsupported type: "+typeof u)}return Rt.EncoderBuffer=A,A.prototype.join=function(M,_){return M||(M=new E(this.length)),_||(_=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(T){T.join(M,_),_+=T.length}):(typeof this.value=="number"?M[_]=this.value:typeof this.value=="string"?M.write(this.value,_):E.isBuffer(this.value)&&this.value.copy(M,_),_+=this.length)),M},Rt}var ee,Te;function Xe(){if(Te)return ee;Te=1;var k=qt().Reporter,w=qt().EncoderBuffer,E=qt().DecoderBuffer,m=Je,A=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(A),M=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function _(g,n){var a={};this._baseState=a,a.enc=g,a.parent=n||null,a.children=null,a.tag=null,a.args=null,a.reverseArgs=null,a.choice=null,a.optional=!1,a.any=!1,a.obj=!1,a.use=null,a.useDecoder=null,a.key=null,a.default=null,a.explicit=null,a.implicit=null,a.contains=null,a.parent||(a.children=[],this._wrap())}ee=_;var T=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return _.prototype.clone=function(){var n=this._baseState,a={};T.forEach(function(d){a[d]=n[d]});var v=new this.constructor(a.parent);return v._baseState=a,v},_.prototype._wrap=function(){var n=this._baseState;u.forEach(function(a){this[a]=function(){var d=new this.constructor(this);return n.children.push(d),d[a].apply(d,arguments)}},this)},_.prototype._init=function(n){var a=this._baseState;m(a.parent===null),n.call(this),a.children=a.children.filter(function(v){return v._baseState.parent===this},this),m.equal(a.children.length,1,"Root node can have only one child")},_.prototype._useArgs=function(n){var a=this._baseState,v=n.filter(function(d){return d instanceof this.constructor},this);n=n.filter(function(d){return!(d instanceof this.constructor)},this),v.length!==0&&(m(a.children===null),a.children=v,v.forEach(function(d){d._baseState.parent=this},this)),n.length!==0&&(m(a.args===null),a.args=n,a.reverseArgs=n.map(function(d){if(typeof d!="object"||d.constructor!==Object)return d;var y={};return Object.keys(d).forEach(function(x){x==(x|0)&&(x|=0);var q=d[x];y[q]=x}),y}))},M.forEach(function(g){_.prototype[g]=function(){var a=this._baseState;throw new Error(g+" not implemented for encoding: "+a.enc)}}),A.forEach(function(g){_.prototype[g]=function(){var a=this._baseState,v=Array.prototype.slice.call(arguments);return m(a.tag===null),a.tag=g,this._useArgs(v),this}}),_.prototype.use=function(n){m(n);var a=this._baseState;return m(a.use===null),a.use=n,this},_.prototype.optional=function(){var n=this._baseState;return n.optional=!0,this},_.prototype.def=function(n){var a=this._baseState;return m(a.default===null),a.default=n,a.optional=!0,this},_.prototype.explicit=function(n){var a=this._baseState;return m(a.explicit===null&&a.implicit===null),a.explicit=n,this},_.prototype.implicit=function(n){var a=this._baseState;return m(a.explicit===null&&a.implicit===null),a.implicit=n,this},_.prototype.obj=function(){var n=this._baseState,a=Array.prototype.slice.call(arguments);return n.obj=!0,a.length!==0&&this._useArgs(a),this},_.prototype.key=function(n){var a=this._baseState;return m(a.key===null),a.key=n,this},_.prototype.any=function(){var n=this._baseState;return n.any=!0,this},_.prototype.choice=function(n){var a=this._baseState;return m(a.choice===null),a.choice=n,this._useArgs(Object.keys(n).map(function(v){return n[v]})),this},_.prototype.contains=function(n){var a=this._baseState;return m(a.use===null),a.contains=n,this},_.prototype._decode=function(n,a){var v=this._baseState;if(v.parent===null)return n.wrapResult(v.children[0]._decode(n,a));var d=v.default,y=!0,x=null;if(v.key!==null&&(x=n.enterKey(v.key)),v.optional){var q=null;if(v.explicit!==null?q=v.explicit:v.implicit!==null?q=v.implicit:v.tag!==null&&(q=v.tag),q===null&&!v.any){var R=n.save();try{v.choice===null?this._decodeGeneric(v.tag,n,a):this._decodeChoice(n,a),y=!0}catch{y=!1}n.restore(R)}else if(y=this._peekTag(n,q,v.any),n.isError(y))return y}var O;if(v.obj&&y&&(O=n.enterObject()),y){if(v.explicit!==null){var wt=this._decodeTag(n,v.explicit);if(n.isError(wt))return wt;n=wt}var C=n.offset;if(v.use===null&&v.choice===null){if(v.any)var R=n.save();var _t=this._decodeTag(n,v.implicit!==null?v.implicit:v.tag,v.any);if(n.isError(_t))return _t;v.any?d=n.raw(R):n=_t}if(a&&a.track&&v.tag!==null&&a.track(n.path(),C,n.length,"tagged"),a&&a.track&&v.tag!==null&&a.track(n.path(),n.offset,n.length,"content"),v.any?d=d:v.choice===null?d=this._decodeGeneric(v.tag,n,a):d=this._decodeChoice(n,a),n.isError(d))return d;if(!v.any&&v.choice===null&&v.children!==null&&v.children.forEach(function(At){At._decode(n,a)}),v.contains&&(v.tag==="octstr"||v.tag==="bitstr")){var Et=new E(d);d=this._getUse(v.contains,n._reporterState.obj)._decode(Et,a)}}return v.obj&&y&&(d=n.leaveObject(O)),v.key!==null&&(d!==null||y===!0)?n.leaveKey(x,v.key,d):x!==null&&n.exitKey(x),d},_.prototype._decodeGeneric=function(n,a,v){var d=this._baseState;return n==="seq"||n==="set"?null:n==="seqof"||n==="setof"?this._decodeList(a,n,d.args[0],v):/str$/.test(n)?this._decodeStr(a,n,v):n==="objid"&&d.args?this._decodeObjid(a,d.args[0],d.args[1],v):n==="objid"?this._decodeObjid(a,null,null,v):n==="gentime"||n==="utctime"?this._decodeTime(a,n,v):n==="null_"?this._decodeNull(a,v):n==="bool"?this._decodeBool(a,v):n==="objDesc"?this._decodeStr(a,n,v):n==="int"||n==="enum"?this._decodeInt(a,d.args&&d.args[0],v):d.use!==null?this._getUse(d.use,a._reporterState.obj)._decode(a,v):a.error("unknown tag: "+n)},_.prototype._getUse=function(n,a){var v=this._baseState;return v.useDecoder=this._use(n,a),m(v.useDecoder._baseState.parent===null),v.useDecoder=v.useDecoder._baseState.children[0],v.implicit!==v.useDecoder._baseState.implicit&&(v.useDecoder=v.useDecoder.clone(),v.useDecoder._baseState.implicit=v.implicit),v.useDecoder},_.prototype._decodeChoice=function(n,a){var v=this._baseState,d=null,y=!1;return Object.keys(v.choice).some(function(x){var q=n.save(),R=v.choice[x];try{var O=R._decode(n,a);if(n.isError(O))return!1;d={type:x,value:O},y=!0}catch{return n.restore(q),!1}return!0},this),y?d:n.error("Choice not matched")},_.prototype._createEncoderBuffer=function(n){return new w(n,this.reporter)},_.prototype._encode=function(n,a,v){var d=this._baseState;if(!(d.default!==null&&d.default===n)){var y=this._encodeValue(n,a,v);if(y!==void 0&&!this._skipDefault(y,a,v))return y}},_.prototype._encodeValue=function(n,a,v){var d=this._baseState;if(d.parent===null)return d.children[0]._encode(n,a||new k);var R=null;if(this.reporter=a,d.optional&&n===void 0)if(d.default!==null)n=d.default;else return;var y=null,x=!1;if(d.any)R=this._createEncoderBuffer(n);else if(d.choice)R=this._encodeChoice(n,a);else if(d.contains)y=this._getUse(d.contains,v)._encode(n,a),x=!0;else if(d.children)y=d.children.map(function(C){if(C._baseState.tag==="null_")return C._encode(null,a,n);if(C._baseState.key===null)return a.error("Child should have a key");var _t=a.enterKey(C._baseState.key);if(typeof n!="object")return a.error("Child expected, but input is not object");var Et=C._encode(n[C._baseState.key],a,n);return a.leaveKey(_t),Et},this).filter(function(C){return C}),y=this._createEncoderBuffer(y);else if(d.tag==="seqof"||d.tag==="setof"){if(!(d.args&&d.args.length===1))return a.error("Too many args for : "+d.tag);if(!Array.isArray(n))return a.error("seqof/setof, but data is not Array");var q=this.clone();q._baseState.implicit=null,y=this._createEncoderBuffer(n.map(function(C){var _t=this._baseState;return this._getUse(_t.args[0],n)._encode(C,a)},q))}else d.use!==null?R=this._getUse(d.use,v)._encode(n,a):(y=this._encodePrimitive(d.tag,n),x=!0);var R;if(!d.any&&d.choice===null){var O=d.implicit!==null?d.implicit:d.tag,wt=d.implicit===null?"universal":"context";O===null?d.use===null&&a.error("Tag could be omitted only for .use()"):d.use===null&&(R=this._encodeComposite(O,x,wt,y))}return d.explicit!==null&&(R=this._encodeComposite(d.explicit,!1,"context",R)),R},_.prototype._encodeChoice=function(n,a){var v=this._baseState,d=v.choice[n.type];return d||m(!1,n.type+" not found in "+JSON.stringify(Object.keys(v.choice))),d._encode(n.value,a)},_.prototype._encodePrimitive=function(n,a){var v=this._baseState;if(/str$/.test(n))return this._encodeStr(a,n);if(n==="objid"&&v.args)return this._encodeObjid(a,v.reverseArgs[0],v.args[1]);if(n==="objid")return this._encodeObjid(a,null,null);if(n==="gentime"||n==="utctime")return this._encodeTime(a,n);if(n==="null_")return this._encodeNull();if(n==="int"||n==="enum")return this._encodeInt(a,v.args&&v.reverseArgs[0]);if(n==="bool")return this._encodeBool(a);if(n==="objDesc")return this._encodeStr(a,n);throw new Error("Unsupported tag: "+n)},_.prototype._isNumstr=function(n){return/^[0-9 ]*$/.test(n)},_.prototype._isPrintstr=function(n){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(n)},ee}var Ne;function qt(){return Ne||(Ne=1,function(k){var w=k;w.Reporter=Ke.Reporter,w.DecoderBuffer=Re().DecoderBuffer,w.EncoderBuffer=Re().EncoderBuffer,w.Node=Xe()}(te)),te}var re={},ie={},Oe;function tr(){return Oe||(Oe=1,function(k){var w=Fe();k.tagClass={0:"universal",1:"application",2:"context",3:"private"},k.tagClassByName=w._reverse(k.tagClass),k.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},k.tagByName=w._reverse(k.tag)}(ie)),ie}var je;function Fe(){return je||(je=1,function(k){var w=k;w._reverse=function(m){var A={};return Object.keys(m).forEach(function(u){(u|0)==u&&(u=u|0);var M=m[u];A[M]=u}),A},w.der=tr()}(re)),re}var ne={},oe,Ie;function $e(){if(Ie)return oe;Ie=1;var k=Bt,w=le(),E=w.base,m=w.bignum,A=w.constants.der;function u(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new M,this.tree._init(g.body)}oe=u,u.prototype.decode=function(n,a){return n instanceof E.DecoderBuffer||(n=new E.DecoderBuffer(n,a)),this.tree._decode(n,a)};function M(g){E.Node.call(this,"der",g)}k(M,E.Node),M.prototype._peekTag=function(n,a,v){if(n.isEmpty())return!1;var d=n.save(),y=_(n,'Failed to peek tag: "'+a+'"');return n.isError(y)?y:(n.restore(d),y.tag===a||y.tagStr===a||y.tagStr+"of"===a||v)},M.prototype._decodeTag=function(n,a,v){var d=_(n,'Failed to decode tag of "'+a+'"');if(n.isError(d))return d;var y=T(n,d.primitive,'Failed to get length of "'+a+'"');if(n.isError(y))return y;if(!v&&d.tag!==a&&d.tagStr!==a&&d.tagStr+"of"!==a)return n.error('Failed to match tag: "'+a+'"');if(d.primitive||y!==null)return n.skip(y,'Failed to match body of: "'+a+'"');var x=n.save(),q=this._skipUntilEnd(n,'Failed to skip indefinite length body: "'+this.tag+'"');return n.isError(q)?q:(y=n.offset-x.offset,n.restore(x),n.skip(y,'Failed to match body of: "'+a+'"'))},M.prototype._skipUntilEnd=function(n,a){for(;;){var v=_(n,a);if(n.isError(v))return v;var d=T(n,v.primitive,a);if(n.isError(d))return d;var y;if(v.primitive||d!==null?y=n.skip(d):y=this._skipUntilEnd(n,a),n.isError(y))return y;if(v.tagStr==="end")break}},M.prototype._decodeList=function(n,a,v,d){for(var y=[];!n.isEmpty();){var x=this._peekTag(n,"end");if(n.isError(x))return x;var q=v.decode(n,"der",d);if(n.isError(q)&&x)break;y.push(q)}return y},M.prototype._decodeStr=function(n,a){if(a==="bitstr"){var v=n.readUInt8();return n.isError(v)?v:{unused:v,data:n.raw()}}else if(a==="bmpstr"){var d=n.raw();if(d.length%2===1)return n.error("Decoding of string type: bmpstr length mismatch");for(var y="",x=0;x<d.length/2;x++)y+=String.fromCharCode(d.readUInt16BE(x*2));return y}else if(a==="numstr"){var q=n.raw().toString("ascii");return this._isNumstr(q)?q:n.error("Decoding of string type: numstr unsupported characters")}else{if(a==="octstr")return n.raw();if(a==="objDesc")return n.raw();if(a==="printstr"){var R=n.raw().toString("ascii");return this._isPrintstr(R)?R:n.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(a)?n.raw().toString():n.error("Decoding of string type: "+a+" unsupported")}},M.prototype._decodeObjid=function(n,a,v){for(var d,y=[],x=0;!n.isEmpty();){var q=n.readUInt8();x<<=7,x|=q&127,q&128||(y.push(x),x=0)}q&128&&y.push(x);var R=y[0]/40|0,O=y[0]%40;if(v?d=y:d=[R,O].concat(y.slice(1)),a){var wt=a[d.join(" ")];wt===void 0&&(wt=a[d.join(".")]),wt!==void 0&&(d=wt)}return d},M.prototype._decodeTime=function(n,a){var v=n.raw().toString();if(a==="gentime")var d=v.slice(0,4)|0,y=v.slice(4,6)|0,x=v.slice(6,8)|0,q=v.slice(8,10)|0,R=v.slice(10,12)|0,O=v.slice(12,14)|0;else if(a==="utctime"){var d=v.slice(0,2)|0,y=v.slice(2,4)|0,x=v.slice(4,6)|0,q=v.slice(6,8)|0,R=v.slice(8,10)|0,O=v.slice(10,12)|0;d<70?d=2e3+d:d=1900+d}else return n.error("Decoding "+a+" time is not supported yet");return Date.UTC(d,y-1,x,q,R,O,0)},M.prototype._decodeNull=function(n){return null},M.prototype._decodeBool=function(n){var a=n.readUInt8();return n.isError(a)?a:a!==0},M.prototype._decodeInt=function(n,a){var v=n.raw(),d=new m(v);return a&&(d=a[d.toString(10)]||d),d},M.prototype._use=function(n,a){return typeof n=="function"&&(n=n(a)),n._getDecoder("der").tree};function _(g,n){var a=g.readUInt8(n);if(g.isError(a))return a;var v=A.tagClass[a>>6],d=(a&32)===0;if((a&31)===31){var y=a;for(a=0;(y&128)===128;){if(y=g.readUInt8(n),g.isError(y))return y;a<<=7,a|=y&127}}else a&=31;var x=A.tag[a];return{cls:v,primitive:d,tag:a,tagStr:x}}function T(g,n,a){var v=g.readUInt8(a);if(g.isError(v))return v;if(!n&&v===128)return null;if(!(v&128))return v;var d=v&127;if(d>4)return g.error("length octect is too long");v=0;for(var y=0;y<d;y++){v<<=8;var x=g.readUInt8(a);if(g.isError(x))return x;v|=x}return v}return oe}var se,Ce;function er(){if(Ce)return se;Ce=1;var k=Bt,w=Tt().Buffer,E=$e();function m(A){E.call(this,A),this.enc="pem"}return k(m,E),se=m,m.prototype.decode=function(u,M){for(var _=u.toString().split(/[\r\n]+/g),T=M.label.toUpperCase(),g=/^-----(BEGIN|END) ([^-]+)-----$/,n=-1,a=-1,v=0;v<_.length;v++){var d=_[v].match(g);if(d!==null&&d[2]===T)if(n===-1){if(d[1]!=="BEGIN")break;n=v}else{if(d[1]!=="END")break;a=v;break}}if(n===-1||a===-1)throw new Error("PEM section not found for: "+T);var y=_.slice(n+1,a).join("");y.replace(/[^a-z0-9\+\/=]+/gi,"");var x=new w(y,"base64");return E.prototype.decode.call(this,x,M)},se}var Ue;function rr(){return Ue||(Ue=1,function(k){var w=k;w.der=$e(),w.pem=er()}(ne)),ne}var he={},fe,Ze;function Ge(){if(Ze)return fe;Ze=1;var k=Bt,w=Tt().Buffer,E=le(),m=E.base,A=E.constants.der;function u(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new M,this.tree._init(g.body)}fe=u,u.prototype.encode=function(n,a){return this.tree._encode(n,a).join()};function M(g){m.Node.call(this,"der",g)}k(M,m.Node),M.prototype._encodeComposite=function(n,a,v,d){var y=T(n,a,v,this.reporter);if(d.length<128){var R=new w(2);return R[0]=y,R[1]=d.length,this._createEncoderBuffer([R,d])}for(var x=1,q=d.length;q>=256;q>>=8)x++;var R=new w(2+x);R[0]=y,R[1]=128|x;for(var q=1+x,O=d.length;O>0;q--,O>>=8)R[q]=O&255;return this._createEncoderBuffer([R,d])},M.prototype._encodeStr=function(n,a){if(a==="bitstr")return this._createEncoderBuffer([n.unused|0,n.data]);if(a==="bmpstr"){for(var v=new w(n.length*2),d=0;d<n.length;d++)v.writeUInt16BE(n.charCodeAt(d),d*2);return this._createEncoderBuffer(v)}else return a==="numstr"?this._isNumstr(n)?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: numstr supports only digits and space"):a==="printstr"?this._isPrintstr(n)?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(a)?this._createEncoderBuffer(n):a==="objDesc"?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: "+a+" unsupported")},M.prototype._encodeObjid=function(n,a,v){if(typeof n=="string"){if(!a)return this.reporter.error("string objid given, but no values map found");if(!a.hasOwnProperty(n))return this.reporter.error("objid not found in values map");n=a[n].split(/[\s\.]+/g);for(var d=0;d<n.length;d++)n[d]|=0}else if(Array.isArray(n)){n=n.slice();for(var d=0;d<n.length;d++)n[d]|=0}if(!Array.isArray(n))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(n));if(!v){if(n[1]>=40)return this.reporter.error("Second objid identifier OOB");n.splice(0,2,n[0]*40+n[1])}for(var y=0,d=0;d<n.length;d++){var x=n[d];for(y++;x>=128;x>>=7)y++}for(var q=new w(y),R=q.length-1,d=n.length-1;d>=0;d--){var x=n[d];for(q[R--]=x&127;(x>>=7)>0;)q[R--]=128|x&127}return this._createEncoderBuffer(q)};function _(g){return g<10?"0"+g:g}M.prototype._encodeTime=function(n,a){var v,d=new Date(n);return a==="gentime"?v=[_(d.getFullYear()),_(d.getUTCMonth()+1),_(d.getUTCDate()),_(d.getUTCHours()),_(d.getUTCMinutes()),_(d.getUTCSeconds()),"Z"].join(""):a==="utctime"?v=[_(d.getFullYear()%100),_(d.getUTCMonth()+1),_(d.getUTCDate()),_(d.getUTCHours()),_(d.getUTCMinutes()),_(d.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+a+" time is not supported yet"),this._encodeStr(v,"octstr")},M.prototype._encodeNull=function(){return this._createEncoderBuffer("")},M.prototype._encodeInt=function(n,a){if(typeof n=="string"){if(!a)return this.reporter.error("String int or enum given, but no values map");if(!a.hasOwnProperty(n))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(n));n=a[n]}if(typeof n!="number"&&!w.isBuffer(n)){var v=n.toArray();!n.sign&&v[0]&128&&v.unshift(0),n=new w(v)}if(w.isBuffer(n)){var d=n.length;n.length===0&&d++;var x=new w(d);return n.copy(x),n.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(n<128)return this._createEncoderBuffer(n);if(n<256)return this._createEncoderBuffer([0,n]);for(var d=1,y=n;y>=256;y>>=8)d++;for(var x=new Array(d),y=x.length-1;y>=0;y--)x[y]=n&255,n>>=8;return x[0]&128&&x.unshift(0),this._createEncoderBuffer(new w(x))},M.prototype._encodeBool=function(n){return this._createEncoderBuffer(n?255:0)},M.prototype._use=function(n,a){return typeof n=="function"&&(n=n(a)),n._getEncoder("der").tree},M.prototype._skipDefault=function(n,a,v){var d=this._baseState,y;if(d.default===null)return!1;var x=n.join();if(d.defaultBuffer===void 0&&(d.defaultBuffer=this._encodeValue(d.default,a,v).join()),x.length!==d.defaultBuffer.length)return!1;for(y=0;y<x.length;y++)if(x[y]!==d.defaultBuffer[y])return!1;return!0};function T(g,n,a,v){var d;if(g==="seqof"?g="seq":g==="setof"&&(g="set"),A.tagByName.hasOwnProperty(g))d=A.tagByName[g];else if(typeof g=="number"&&(g|0)===g)d=g;else return v.error("Unknown tag: "+g);return d>=31?v.error("Multi-octet tag encoding unsupported"):(n||(d|=32),d|=A.tagClassByName[a||"universal"]<<6,d)}return fe}var ae,Le;function ir(){if(Le)return ae;Le=1;var k=Bt,w=Ge();function E(m){w.call(this,m),this.enc="pem"}return k(E,w),ae=E,E.prototype.encode=function(A,u){for(var M=w.prototype.encode.call(this,A),_=M.toString("base64"),T=["-----BEGIN "+u.label+"-----"],g=0;g<_.length;g+=64)T.push(_.slice(g,g+64));return T.push("-----END "+u.label+"-----"),T.join(`
`)},ae}var Pe;function nr(){return Pe||(Pe=1,function(k){var w=k;w.der=Ge(),w.pem=ir()}(he)),he}var ze;function le(){return ze||(ze=1,function(k){var w=k;w.bignum=Ye,w.define=We().define,w.base=qt(),w.constants=Fe(),w.decoders=rr(),w.encoders=nr()}(Qt)),Qt}export{le as r};
